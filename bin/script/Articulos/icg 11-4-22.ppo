#line 203 "C:\fwh1801\Gestool\bin\include\hbclass.ch"
DECLARE HBClass  New( cName AS STRING, OPTIONAL SuperParams ) AS CLASS HBClass  Create() AS OBJECT  Instance() AS OBJECT  AddClsMethod( cName AS STRING, @MethodName(), nScope AS NUMERIC, n2 AS NUMERIC, n3 AS NUMERIC )  AddMultiClsData( cType AS STRING, uVal, nScope AS NUMERIC, aDatas AS ARRAY OF STRING )  AddMultiData( cType AS STRING, uVal, nScope AS NUMERIC, aDatas AS ARRAY OF STRING, x AS LOGICAL, lPer AS LOGICAL )  AddMethod( cName AS STRING, @MethodName(), nScope AS NUMERIC )  AddInLine( cName AS STRING, bBlock AS CODEBLOCK, nScope AS NUMERIC )  AddVirtual( cName AS STRING )
#line 16 "C:\fwh1801\Gestool\bin\Script\Articulos\icg 11-4-22.prg"
Function Inicio()

   ArticulosICG():New()

   msgInfo( "Proceso finalizado")

Return ( nil )



_HB_CLASS ArticulosICG ; function ArticulosICG ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ArticulosICG", iif( .F., { }, { @HBObject() } ), @ArticulosICG() ) ) ;

; _HB_MEMBER { nView } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nView"}, .F. )

; _HB_MEMBER { cTarifa } ; oClass:AddMultiData(, "00 Netos T/4 al 30 margen ", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTarifa"}, .F. )
; _HB_MEMBER { aTarifa } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aTarifa"}, .F. )





















































































































































































































































































































































































































































































; _HB_MEMBER { hTarifa } ; oClass:AddMultiData(, {   {  "00 Netos T/4 al 30 margen ", {  "Factor descuento 1" => 2, "Descuento 1" => 0, "Factor descuento 2" => 1.80, "Descuento 2" => 20, "Factor descuento 3" => 1.60, "Descuento 3" => 20, "Factor descuento 4" => 1.30, "Descuento 4" => 35, "Factor descuento 5" => 1.25, "Descuento 5" => 37.5, "Factor descuento 6" => 1.20, "Descuento 6" => 40 } },    {  "01 Andel Filtros T1=T2 ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 1, "Descuento 2" => 0, "Factor descuento 3" => 0.60, "Descuento 3" => 40, "Factor descuento 4" => 0.45, "Descuento 4" => 55, "Factor descuento 5" => 0.43, "Descuento 5" => 57, "Factor descuento 6" => 0.40, "Descuento 6" => 60 } },    {  "02 Netos Margen Normal 150-50-40-30-20-10 ", {  "Factor descuento 1" => 3, "Descuento 1" => 0, "Factor descuento 2" => 1.50, "Descuento 2" => 25, "Factor descuento 3" => 1.40, "Descuento 3" => 30, "Factor descuento 4" => 1.30, "Descuento 4" => 35, "Factor descuento 5" => 1.20, "Descuento 5" => 40, "Factor descuento 6" => 1.10, "Descuento 6" => 45 } },    {  "6 Junta homcinetica Neto*3 ", {  "Factor descuento 1" => 3, "Descuento 1" => 0, "Factor descuento 2" => 2, "Descuento 2" => 33, "Factor descuento 3" => 1.75, "Descuento 3" => 41.5, "Factor descuento 4" => 1.30, "Descuento 4" => 56.5, "Factor descuento 5" => 1.20, "Descuento 5" => 60, "Factor descuento 6" => 1.15, "Descuento 6" => 61.65 } },    {  "15 LUK 53% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.85, "Descuento 2" => 15, "Factor descuento 3" => 0.70, "Descuento 3" => 30, "Factor descuento 4" => 0.58, "Descuento 4" => 42, "Factor descuento 5" => 0.55, "Descuento 5" => 45, "Factor descuento 6" => 0.50, "Descuento 6" => 50 } },    {  "19 COJALI DTO 1 40% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.90, "Descuento 2" => 10, "Factor descuento 3" => 0.85, "Descuento 3" => 15, "Factor descuento 4" => 0.78, "Descuento 4" => 22, "Factor descuento 5" => 0.75, "Descuento 5" => 25, "Factor descuento 6" => 0.70, "Descuento 6" => 30 } },    {  "20 Jbm 40% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.90, "Descuento 2" => 10, "Factor descuento 3" => 0.85, "Descuento 3" => 15, "Factor descuento 4" => 0.75, "Descuento 4" => 25, "Factor descuento 5" => 0.70, "Descuento 5" => 30, "Factor descuento 6" => 0.65, "Descuento 6" => 35 } },    {  "23 Surglass 53% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.85, "Descuento 2" => 15, "Factor descuento 3" => 0.75, "Descuento 3" => 25, "Factor descuento 4" => 0.60, "Descuento 4" => 40, "Factor descuento 5" => 0.55, "Descuento 5" => 45, "Factor descuento 6" => 0.53, "Descuento 6" => 47 } },    {  "24 Bottari 40% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.85, "Descuento 2" => 15, "Factor descuento 3" => 0.80, "Descuento 3" => 20, "Factor descuento 4" => 0.75, "Descuento 4" => 25, "Factor descuento 5" => 0.75, "Descuento 5" => 25, "Factor descuento 6" => 0.70, "Descuento 6" => 30 } },    {  "27 Dayco Scooter 50% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.90, "Descuento 2" => 10, "Factor descuento 3" => 0.80, "Descuento 3" => 20, "Factor descuento 4" => 0.65, "Descuento 4" => 35, "Factor descuento 5" => 0.63, "Descuento 5" => 37, "Factor descuento 6" => 0.57, "Descuento 6" => 43 } },    {  "33 Luk Embragues 57% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.80, "Descuento 2" => 20, "Factor descuento 3" => 0.70, "Descuento 3" => 30, "Factor descuento 4" => 0.55, "Descuento 4" => 45, "Factor descuento 5" => 0.50, "Descuento 5" => 50, "Factor descuento 6" => 0.48, "Descuento 6" => 52 } },    {  "34 Trw 67% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.75, "Descuento 2" => 25, "Factor descuento 3" => 0.60, "Descuento 3" => 40, "Factor descuento 4" => 0.43, "Descuento 4" => 57, "Factor descuento 5" => 0.40, "Descuento 5" => 60, "Factor descuento 6" => 0.38, "Descuento 6" => 62 } },    {  "37 Carbureibar 45% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.90, "Descuento 2" => 10, "Factor descuento 3" => 0.85, "Descuento 3" => 15, "Factor descuento 4" => 0.72, "Descuento 4" => 28, "Factor descuento 5" => 0.68, "Descuento 5" => 32, "Factor descuento 6" => 0.63, "Descuento 6" => 37 } },    {  "44 Mdr 55% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.85, "Descuento 2" => 15, "Factor descuento 3" => 0.70, "Descuento 3" => 30, "Factor descuento 4" => 0.58, "Descuento 4" => 42, "Factor descuento 5" => 0.55, "Descuento 5" => 45, "Factor descuento 6" => 0.53, "Descuento 6" => 47 } },    {  "59 OJO Costo+neto ", {  "Factor descuento 1" => 2, "Descuento 1" => 0, "Factor descuento 2" => 1.80, "Descuento 2" => 10, "Factor descuento 3" => 1.60, "Descuento 3" => 20, "Factor descuento 4" => 1.30, "Descuento 4" => 35, "Factor descuento 5" => 1.25, "Descuento 5" => 37.5, "Factor descuento 6" => 1.20, "Descuento 6" => 40 } },    {  "60 Andel transmisiones 58% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.85, "Descuento 2" => 15, "Factor descuento 3" => 0.75, "Descuento 3" => 25, "Factor descuento 4" => 0.55, "Descuento 4" => 45, "Factor descuento 5" => 0.53, "Descuento 5" => 47, "Factor descuento 6" => 0.50, "Descuento 6" => 50 } },    {  "61 Andel T1=T2 dto 58% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 1, "Descuento 2" => 0, "Factor descuento 3" => 0.75, "Descuento 3" => 25, "Factor descuento 4" => 0.55, "Descuento 4" => 45, "Factor descuento 5" => 0.53, "Descuento 5" => 47, "Factor descuento 6" => 0.50, "Descuento 6" => 50 } },    {  "67 Trw direcciones 48% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.90, "Descuento 2" => 10, "Factor descuento 3" => 0.80, "Descuento 3" => 20, "Factor descuento 4" => 0.70, "Descuento 4" => 30, "Factor descuento 5" => 0.65, "Descuento 5" => 35, "Factor descuento 6" => 0.60, "Descuento 6" => 40 } },    {  "68 Rinder Rotativos 32% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.95, "Descuento 2" => 5, "Factor descuento 3" => 0.90, "Descuento 3" => 10, "Factor descuento 4" => 0.85, "Descuento 4" => 15, "Factor descuento 5" => 0.83, "Descuento 5" => 17, "Factor descuento 6" => 0.80, "Descuento 6" => 20 } },    {  "69 Ngk 61% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.80, "Descuento 2" => 20, "Factor descuento 3" => 0.65, "Descuento 3" => 35, "Factor descuento 4" => 0.50, "Descuento 4" => 50, "Factor descuento 5" => 0.48, "Descuento 5" => 52, "Factor descuento 6" => 0.45, "Descuento 6" => 55 } },    {  "70 Poleas 68.72% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.75, "Descuento 2" => 25, "Factor descuento 3" => 0.60, "Descuento 3" => 40, "Factor descuento 4" => 0.38, "Descuento 4" => 62, "Factor descuento 5" => 0.36, "Descuento 5" => 64, "Factor descuento 6" => 0.34, "Descuento 6" => 66 } },    {  "77 Aurilis 40% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.95, "Descuento 2" => 5, "Factor descuento 3" => 0.90, "Descuento 3" => 10, "Factor descuento 4" => 0.8, "Descuento 4" => 20, "Factor descuento 5" => 0.75, "Descuento 5" => 25, "Factor descuento 6" => 0.70, "Descuento 6" => 30 } },    {  "82 Snr rodamientos 78% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.65, "Descuento 2" => 35, "Factor descuento 3" => 0.55, "Descuento 3" => 45, "Factor descuento 4" => 0.30, "Descuento 4" => 70, "Factor descuento 5" => 0.28, "Descuento 5" => 72, "Factor descuento 6" => 0.26, "Descuento 6" => 74 } }, {  "84 fAE 59% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.80, "Descuento 2" => 20, "Factor descuento 3" => 0.70, "Descuento 3" => 30, "Factor descuento 4" => 0.53, "Descuento 4" => 47, "Factor descuento 5" => 0.50, "Descuento 5" => 50, "Factor descuento 6" => 0.47, "Descuento 6" => 53 } },    {  "85 Dayco correas 74% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.65, "Descuento 2" => 35, "Factor descuento 3" => 0.55, "Descuento 3" => 45, "Factor descuento 4" => 0.35, "Descuento 4" => 65, "Factor descuento 5" => 0.33, "Descuento 5" => 67, "Factor descuento 6" => 0.30, "Descuento 6" => 70 } }, {  "86 ANGLOREC 50% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.90, "Descuento 2" => 10, "Factor descuento 3" => 0.80, "Descuento 3" => 20, "Factor descuento 4" => 0.67, "Descuento 4" => 33, "Factor descuento 5" => 0.65, "Descuento 5" => 35, "Factor descuento 6" => 0.60, "Descuento 6" => 40 } },    {  "87 Costo+margen baterias ", {  "Factor descuento 1" => 2, "Descuento 1" => 0, "Factor descuento 2" => 1.35, "Descuento 2" => 33, "Factor descuento 3" => 1.35, "Descuento 3" => 33, "Factor descuento 4" => 1.20, "Descuento 4" => 40, "Factor descuento 5" => 1.15, "Descuento 5" => 43, "Factor descuento 6" => 1.10, "Descuento 6" => 45 } },    {  "88 Andel escobillas 65% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.75, "Descuento 2" => 25, "Factor descuento 3" => 0.60, "Descuento 3" => 40, "Factor descuento 4" => 0.45, "Descuento 4" => 55, "Factor descuento 5" => 0.43, "Descuento 5" => 57, "Factor descuento 6" => 0.40, "Descuento 6" => 60 } },    {  "89 Textar pastillas 75% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.60, "Descuento 2" => 40, "Factor descuento 3" => 0.50, "Descuento 3" => 50, "Factor descuento 4" => 0.32, "Descuento 4" => 68, "Factor descuento 5" => 0.30, "Descuento 5" => 70, "Factor descuento 6" => 0.28, "Descuento 6" => 72 } },    {  "90 Conti Correa+rodillo 65% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.75, "Descuento 2" => 25, "Factor descuento 3" => 0.65, "Descuento 3" => 35, "Factor descuento 4" => 0.46, "Descuento 4" => 54, "Factor descuento 5" => 0.44, "Descuento 5" => 56, "Factor descuento 6" => 0.42, "Descuento 6" => 58 } },    {  "91 Purflux con * 68.98% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.75, "Descuento 2" => 25, "Factor descuento 3" => 0.6, "Descuento 3" => 40, "Factor descuento 4" => 0.4, "Descuento 4" => 60, "Factor descuento 5" => 0.38, "Descuento 5" => 62, "Factor descuento 6" => 0.35, "Descuento 6" => 65 } },    {  "92 Dayco  79.15% ", {  "Factor descuento 1" => 1, "Descuento 1" => 0, "Factor descuento 2" => 0.6, "Descuento 2" => 40, "Factor descuento 3" => 0.5, "Descuento 3" => 50, "Factor descuento 4" => 0.27, "Descuento 4" => 73, "Factor descuento 5" => 0.25, "Descuento 5" => 75, "Factor descuento 6" => 0.23, "Descuento 6" => 77 } },    {  "99 OJO Cascos Netos+30% ", {  "Factor descuento 1" => 1.3, "Descuento 1" => 0, "Factor descuento 2" => 1.3, "Descuento 2" => 0, "Factor descuento 3" => 1.3, "Descuento 3" => 0, "Factor descuento 4" => 1.3, "Descuento 4" => 0, "Factor descuento 5" => 1.30, "Descuento 5" => 0, "Factor descuento 6" => 1.30, "Descuento 6" => 0 } }, {  "100 OJO Netos especiales ", {  "Factor descuento 1" => 2, "Descuento 1" => 0, "Factor descuento 2" => 1.6, "Descuento 2" => 20, "Factor descuento 3" => 1.4, "Descuento 3" => 30, "Factor descuento 4" => 1.15, "Descuento 4" => 42.50, "Factor descuento 5" => 1.10, "Descuento 5" => 45, "Factor descuento 6" => 1.10, "Descuento 6" => 45 } },    {  "101 OJO Netos JBM Herramientas ", {  "Factor descuento 1" => 2, "Descuento 1" => 0, "Factor descuento 2" => 1.25, "Descuento 2" => 37.5, "Factor descuento 3" => 1.25, "Descuento 3" => 37.5, "Factor descuento 4" => 1.15, "Descuento 4" => 42.5, "Factor descuento 5" => 1.15, "Descuento 5" => 42.5, "Factor descuento 6" => 1.10, "Descuento 6" => 45 } },    {  "102 PLACAS DE MATRICULAS ", {  "Factor descuento 1" => 4, "Descuento 1" => 0, "Factor descuento 2" => 3.25, "Descuento 2" => 15, "Factor descuento 3" => 2.50, "Descuento 3" => 30, "Factor descuento 4" => 2.25, "Descuento 4" => 35, "Factor descuento 5" => 2.25, "Descuento 5" => 35, "Factor descuento 6" => 2.25, "Descuento 6" => 35 } } }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"hTarifa"}, .F. )

; _HB_MEMBER { cPrecio } ; oClass:AddMultiData(, "P.V.P.", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPrecio"}, .F. )
; _HB_MEMBER { aPrecio } ; oClass:AddMultiData(, { "P.V.P.", "Costo" }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aPrecio"}, .F. )

; _HB_MEMBER { oOleExcel } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oOleExcel"}, .F. )

; _HB_MEMBER { nRow } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nRow"}, .F. )
; _HB_MEMBER { nLineaComienzo } ; oClass:AddMultiData(, 2, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nLineaComienzo"}, .F. )

; _HB_MEMBER { cCodigoArticulo } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCodigoArticulo"}, .F. )
; _HB_MEMBER { cDescipcionArticulo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cDescipcionArticulo"}, .F. )
; _HB_MEMBER { cCodigoBarrasArticulo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCodigoBarrasArticulo"}, .F. )
; _HB_MEMBER { cSustituyeA } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSustituyeA"}, .F. )
; _HB_MEMBER { cSustituidoPor } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSustituidoPor"}, .F. )
; _HB_MEMBER { cDescipcionCasco } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cDescipcionCasco"}, .F. )
; _HB_MEMBER { cReferenciaCasco } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cReferenciaCasco"}, .F. )
; _HB_MEMBER { cFechaCreacion } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFechaCreacion"}, .F. )

; _HB_MEMBER { nPrecioCosto } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioCosto"}, .F. )
; _HB_MEMBER { nPrecioCasco } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioCasco"}, .F. )

; _HB_MEMBER { nLitros } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nLitros"}, .F. )

; _HB_MEMBER { nPrecioVigor } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVigor"}, .F. )
; _HB_MEMBER { nDescuentoVigor } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nDescuentoVigor"}, .F. )
; _HB_MEMBER { nPrecioVenta1 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVenta1"}, .F. )
; _HB_MEMBER { nPrecioVentaIVA1 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVentaIVA1"}, .F. )
; _HB_MEMBER { nPrecioVenta2 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVenta2"}, .F. )
; _HB_MEMBER { nPrecioVentaIVA2 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVentaIVA2"}, .F. )
; _HB_MEMBER { nPrecioVenta3 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVenta3"}, .F. )
; _HB_MEMBER { nPrecioVentaIVA3 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVentaIVA3"}, .F. )
; _HB_MEMBER { nPrecioVenta4 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVenta4"}, .F. )
; _HB_MEMBER { nPrecioVentaIVA4 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVentaIVA4"}, .F. )
; _HB_MEMBER { nPrecioVenta5 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVenta5"}, .F. )
; _HB_MEMBER { nPrecioVentaIVA5 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVentaIVA5"}, .F. )
; _HB_MEMBER { nPrecioVenta6 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVenta6"}, .F. )
; _HB_MEMBER { nPrecioVentaIVA6 } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecioVentaIVA6"}, .F. )

; _HB_MEMBER { cFamilia } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFamilia"}, .F. )
; _HB_MEMBER { cFamilia1 } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFamilia1"}, .F. )
; _HB_MEMBER { cFamilia2 } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFamilia2"}, .F. )
; _HB_MEMBER { cFamilia3 } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFamilia3"}, .F. )
; _HB_MEMBER { cFamilia4 } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFamilia4"}, .F. )

; _HB_MEMBER { aFichero } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aFichero"}, .F. )

   _HB_MEMBER New() AS CLASS ArticulosICG; oClass:AddMethod( "New", @ArticulosICG_New(), nScope + iif( .T., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Dialog(); oClass:AddMethod( "Dialog", @ArticulosICG_Dialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER showDescuentos(); oClass:AddMethod( "showDescuentos", @ArticulosICG_showDescuentos(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddFichero(); oClass:AddMethod( "AddFichero", @ArticulosICG_AddFichero(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER OpenFiles(); oClass:AddMethod( "OpenFiles", @ArticulosICG_OpenFiles(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CloseFiles(); oClass:AddInline( "CloseFiles", {|Self | ( ( Self ) ), ( D():DeleteView( ::nView ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ProcessFile(); oClass:AddMethod( "ProcessFile", @ArticulosICG_ProcessFile(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ProcessRow(); oClass:AddMethod( "ProcessRow", @ArticulosICG_ProcessRow(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AppendArticulo(); oClass:AddMethod( "AppendArticulo", @ArticulosICG_AppendArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER SetArticulo(); oClass:AddMethod( "SetArticulo", @ArticulosICG_SetArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER updateDescription(); oClass:AddMethod( "updateDescription", @ArticulosICG_updateDescription(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AppendEscandallo(); oClass:AddMethod( "AppendEscandallo", @ArticulosICG_AppendEscandallo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER setEscandallo(); oClass:AddMethod( "setEscandallo", @ArticulosICG_setEscandallo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER DeleteEscandallo(); oClass:AddMethod( "DeleteEscandallo", @ArticulosICG_DeleteEscandallo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AppendCodigosBarras(); oClass:AddMethod( "AppendCodigosBarras", @ArticulosICG_AppendCodigosBarras(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER SetCodigosBarras(); oClass:AddMethod( "SetCodigosBarras", @ArticulosICG_SetCodigosBarras(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getReferenciaCasco(); oClass:AddMethod( "getReferenciaCasco", @ArticulosICG_getReferenciaCasco(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER GetRange(); oClass:AddMethod( "GetRange", @ArticulosICG_GetRange(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER GetNumeric(); oClass:AddMethod( "GetNumeric", @ArticulosICG_GetNumeric(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getTarifa(); oClass:AddMethod( "getTarifa", @ArticulosICG_getTarifa(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER factorDescuento1(); oClass:AddInline( "factorDescuento1", {|Self | ( ( Self ) ), ::getTarifa( "Factor descuento 1" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER descuento1(); oClass:AddInline( "descuento1", {|Self | ( ( Self ) ), ::getTarifa( "Descuento 1" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER factorDescuento2(); oClass:AddInline( "factorDescuento2", {|Self | ( ( Self ) ), ::getTarifa( "Factor descuento 2" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER descuento2(); oClass:AddInline( "descuento2", {|Self | ( ( Self ) ), ::getTarifa( "Descuento 2" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER factorDescuento3(); oClass:AddInline( "factorDescuento3", {|Self | ( ( Self ) ), ::getTarifa( "Factor descuento 3" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER descuento3(); oClass:AddInline( "descuento3", {|Self | ( ( Self ) ), ::getTarifa( "Descuento 3" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER factorDescuento4(); oClass:AddInline( "factorDescuento4", {|Self | ( ( Self ) ), ::getTarifa( "Factor descuento 4" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER descuento4(); oClass:AddInline( "descuento4", {|Self | ( ( Self ) ), ::getTarifa( "Descuento 4" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER factorDescuento5(); oClass:AddInline( "factorDescuento5", {|Self | ( ( Self ) ), ::getTarifa( "Factor descuento 5" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER descuento5(); oClass:AddInline( "descuento5", {|Self | ( ( Self ) ), ::getTarifa( "Descuento 5" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER factorDescuento6(); oClass:AddInline( "factorDescuento6", {|Self | ( ( Self ) ), ::getTarifa( "Factor descuento 6" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER descuento6(); oClass:AddInline( "descuento6", {|Self | ( ( Self ) ), ::getTarifa( "Descuento 6" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lEscandallos(); oClass:AddInline( "lEscandallos", {|Self | ( ( Self ) ), ( !empty( ::cDescipcionCasco ) .OR. ::nLitros > 0 ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ArticulosICG ;



static FUNCTION ArticulosICG_New( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local cFichero

    if !::Dialog()
        Return ( Self )
    end

   ::AddFichero()
   if empty( ::aFichero )
      Return ( Self )
   end

   if !::showDescuentos()
      Return ( Self )
   end

   if !::OpenFiles()
        Return ( Self )
    end

   for each cFichero in ::aFichero
      if !empty(cFichero)
         msgRun( "Procesando hoja de calculo " + cFichero, "Espere", {|| ::ProcessFile( cFichero ) } )
      end
   next

   ::CloseFiles()

Return ( Self )



static FUNCTION ArticulosICG_Dialog( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local oDlg
   local oBtn
   local aTarifa
   local bTarifa       := { | u | if( pCount () == 0, ::cTarifa, ::cTarifa := u ) }
   local bPrecio       := { | u | if( pCount () == 0, ::cPrecio, ::cPrecio := u ) }

   ::aTarifa           := {}

   for each aTarifa in ::hTarifa
      aAdd( ::aTarifa, aTarifa[ 1 ] )
   next

   oDlg                 := TDialog():New( 5, 5, 15, 40, "Importacion ICG" )

   TSay():New( 1, 1, {|| "Tarifa" }, oDlg )

   TCombobox():New( 1, 4, bTarifa, ::aTarifa, 100, 14, oDlg )

   TSay():New( 2, 1, {|| "Precio" }, oDlg )

   TCombobox():New( 2, 4, bPrecio, ::aPrecio, 100, 14, oDlg )

   TButton():New( 3, 4, "&Aceptar", oDlg, {|| ( oDlg:End(1) ) }, 40, 12 )

   TButton():New( 3, 12, "&Cancel", oDlg, {|| oDlg:End() }, 40, 12 )

   oDlg:Activate( , , , .T. )

Return ( oDlg:nResult == 1 )



static FUNCTION ArticulosICG_showDescuentos( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local cTexto
   local cFichero

   cTexto         := ""

   for each cFichero in ::aFichero
      if !empty( cFichero )
         cTexto   += "Fichero a procesar " + cFichero + chr( 13 ) + chr( 10 )
      end
   next

   cTexto         += replicate( "-", 40 ) + chr( 13 ) + chr( 10 )
   cTexto         += "Factor descuento 1 : (" + cValtoChar( ::factorDescuento1() ) + ") > " + alltrim( cValtoChar( ::descuento1() ) ) + "%" + chr( 13 ) + chr( 10 )
   cTexto         += "Factor descuento 2 : (" + cValtoChar( ::factorDescuento2() ) + ") > " + alltrim( cValtoChar( ::descuento2() ) ) + "%" + chr( 13 ) + chr( 10 )
   cTexto         += "Factor descuento 3 : (" + cValtoChar( ::factorDescuento3() ) + ") > " + alltrim( cValtoChar( ::descuento3() ) ) + "%" + chr( 13 ) + chr( 10 )
   cTexto         += "Factor descuento 4 : (" + cValtoChar( ::factorDescuento4() ) + ") > " + alltrim( cValtoChar( ::descuento4() ) ) + "%" + chr( 13 ) + chr( 10 )
   cTexto         += "Factor descuento 5 : (" + cValtoChar( ::factorDescuento5() ) + ") > " + alltrim( cValtoChar( ::descuento5() ) ) + "%" + chr( 13 ) + chr( 10 )
   cTexto         += "Factor descuento 6 : (" + cValtoChar( ::factorDescuento6() ) + ") > " + alltrim( cValtoChar( ::descuento6() ) ) + "%"

Return ( msgYesNo( cTexto, "Valores" ) )



static FUNCTION ArticulosICG_AddFichero( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local i
   local cFile
   local aFile
   local nFlag    := nOr( 0x00000800, 0x00000008, 0x00000200, 0x00080000, 0x00200000 )

   ::aFichero     := cGetFile( "All | *.xlsx", "Seleccione los ficheros a importar", "*.xlsx" , , .F., .T., nFlag )

































RETURN ( ::aFichero )



static FUNCTION ArticulosICG_OpenFiles( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local oError
   local oBlock
   local lOpenFiles     := .T.

   oBlock               := ErrorBlock( { | oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

      ::nView           := D():CreateView()

      D():Articulos( ::nView )

      D():ArticulosCodigosBarras( ::nView )
      ( D():ArticulosCodigosBarras( ::nView ) )->( ordsetfocus( "cArtBar" ) )

      D():Get( "ArtKit", ::nView )
      ( D():Get( "ArtKit", ::nView ) )->( ordsetfocus( "cCodRef" ) )

      D():Get( "Ruta", ::nView )

      D():Get( "Agentes", ::nView )

   RECOVER USING oError

      lOpenFiles        := .F.

      msgStop( "Imposible abrir todas las bases de datos" + chr( 13 ) + chr( 10 ) + ErrorMessage( oError ) )

   end

   ErrorBlock( oBlock )

Return ( lOpenFiles )



static FUNCTION ArticulosICG_ProcessFile( cFichero ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local oError
   local oBlock

   oBlock               := ErrorBlock( { | oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   CursorWait()

      ::oOleExcel                        := TOleExcel():New( "Importando hoja de excel", "Conectando...", .F. )

      ::oOleExcel:oExcel:Visible         := .F.
      ::oOleExcel:oExcel:DisplayAlerts   := .F.
      ::oOleExcel:oExcel:WorkBooks:Open( cFichero )

      ::oOleExcel:oExcel:WorkSheets( 1 ):Activate()





      SysRefresh()

      for ::nRow := ::nLineaComienzo to 65536

         msgWait( "Procesando linea " + str(::nRow), "", 0.0001 )





         ::cCodigoArticulo                := ::GetRange( "A" )
         if empty( ::cCodigoArticulo )
            exit
         end

         ::cDescipcionArticulo            := ::GetRange( "B" )
         ::cCodigoBarrasArticulo          := ::GetRange( "E" )
         ::cSustituyeA                    := ::GetRange( "S" )
         ::cSustituidoPor                 := ::GetRange( "T" )
         ::nPrecioVigor                   := ::GetNumeric( "F" )
         ::nDescuentoVigor                := ::GetNumeric( "O" )
         ::cFamilia1                      := ::GetRange( "H" )
         ::cFamilia2                      := ::GetRange( "I" )
         ::cFamilia3                      := ::GetRange( "J" )
         ::cFamilia4                      := ::GetRange( "K" )
         ::cFechaCreacion                 := ::GetRange( "G" )
         ::cDescipcionCasco               := ::GetRange( "R" )
         ::nPrecioCasco                   := ::GetNumeric( "N" )
         ::nLitros                        := ::GetNumeric( "U" )



         ::updateDescription()



         ::ProcessRow()



         ::AppendArticulo()

         ::AppendCodigosBarras()

         if ::lEscandallos()
            ::DeleteEscandallo()
            ::AppendEscandallo()
         end

      next



      ::oOleExcel:oExcel:WorkBooks:Close()
      ::oOleExcel:oExcel:Quit()
      ::oOleExcel:oExcel:DisplayAlerts   := .T.

      ::oOleExcel:End()

      Msginfo( "Porceso finalizado con exito" )

   CursorWE()

   RECOVER USING oError

      msgStop( "Imposible importar datos de excel" + chr( 13 ) + chr( 10 ) + ErrorMessage( oError ) )

   end

   ErrorBlock( oBlock )

Return ( Self )



static FUNCTION ArticulosICG_updateDescription( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

    if "** EXTINGUIDA **" $ ::cDescipcionArticulo
        ::cDescipcionArticulo := alltrim( strtran( ::cDescipcionArticulo, "** EXTINGUIDA **", "" ) )
        ::cDescipcionArticulo += space(1) + "** EXTINGUIDA **"
    end

Return ( nil )



static FUNCTION ArticulosICG_ProcessRow( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   ::nPrecioCosto       := ::nPrecioVigor - ( ::nPrecioVigor * ::nDescuentoVigor / 100 )

   if ::cPrecio == "Costo"
      ::nPrecioVigor    := ::nPrecioCosto
   end

   ::nPrecioVenta1      := ::nPrecioVigor * ::factorDescuento1()
   ::nPrecioVentaIVA1   := ::nPrecioVenta1 * 1.21

   ::nPrecioVenta2      := ::nPrecioVigor * ::factorDescuento2()
   ::nPrecioVentaIVA2   := ::nPrecioVenta2 * 1.21

   ::nPrecioVenta3      := ::nPrecioVigor * ::factorDescuento3()
   ::nPrecioVentaIVA3   := ::nPrecioVenta3 * 1.21

   ::nPrecioVenta4      := ::nPrecioVigor * ::factorDescuento4()
   ::nPrecioVentaIVA4   := ::nPrecioVenta4 * 1.21

   ::nPrecioVenta5      := ::nPrecioVigor * ::factorDescuento5()
   ::nPrecioVentaIVA5   := ::nPrecioVenta5 * 1.21

   ::nPrecioVenta6      := ::nPrecioVigor * ::factorDescuento6()
   ::nPrecioVentaIVA6   := ::nPrecioVenta6 * 1.21

   ::cFamilia           := ""
   if !empty( ::cFamilia1 )
      ::cFamilia        += alltrim( ::cFamilia1 )
   end
   if !empty( ::cFamilia2 )
      ::cFamilia        += "." + alltrim( ::cFamilia2 )
   end
   if !empty( ::cFamilia3 )
      ::cFamilia        += "." + alltrim( ::cFamilia3 )
   end
   if !empty( ::cFamilia4 )
      ::cFamilia        += "." + alltrim( ::cFamilia4 )
   end

Return ( nil )



static FUNCTION ArticulosICG_AppendArticulo( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   if ( D():Articulos( ::nView ) )->( dbseek( ::cCodigoArticulo ) )
      if ( D():Articulos( ::nView ) )->( dbrlock() )
         ::SetArticulo()
         ( D():Articulos( ::nView ) )->( dbunlock() )
      end
   else
      if ( D():Articulos( ::nView ) )->( dbappend() )
         ::SetArticulo()
         ( D():Articulos( ::nView ) )->( dbunlock() )
      end
   end

return ( nil )



static FUNCTION ArticulosICG_SetArticulo( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local oError
   local oBlock

   oBlock               := ErrorBlock( { | oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

      SysRefresh()

      ( D():Articulos( ::nView ) )->Codigo      := ::cCodigoArticulo
      ( D():Articulos( ::nView ) )->Nombre      := ::cDescipcionArticulo
      ( D():Articulos( ::nView ) )->TipoIva     := "G"
      ( D():Articulos( ::nView ) )->CodeBar     := ::cCodigoBarrasArticulo
      ( D():Articulos( ::nView ) )->pVenta1     := ::nPrecioVenta1
      ( D():Articulos( ::nView ) )->pVenta2     := ::nPrecioVenta2
      ( D():Articulos( ::nView ) )->pVenta3     := ::nPrecioVenta3
      ( D():Articulos( ::nView ) )->pVenta4     := ::nPrecioVenta4
      ( D():Articulos( ::nView ) )->pVenta5     := ::nPrecioVenta5
      ( D():Articulos( ::nView ) )->pVenta6     := ::nPrecioVenta6
      ( D():Articulos( ::nView ) )->pVtaIVA1    := ::nPrecioVentaIVA1
      ( D():Articulos( ::nView ) )->pVtaIVA2    := ::nPrecioVentaIVA2
      ( D():Articulos( ::nView ) )->pVtaIVA3    := ::nPrecioVentaIVA3
      ( D():Articulos( ::nView ) )->pVtaIVA4    := ::nPrecioVentaIVA4
      ( D():Articulos( ::nView ) )->pVtaIVA5    := ::nPrecioVentaIVA5
      ( D():Articulos( ::nView ) )->pVtaIVA6    := ::nPrecioVentaIVA6

      ( D():Articulos( ::nView ) )->lBnf1       := .T.
      ( D():Articulos( ::nView ) )->lBnf2       := .T.
      ( D():Articulos( ::nView ) )->lBnf3       := .T.
      ( D():Articulos( ::nView ) )->lBnf4       := .T.
      ( D():Articulos( ::nView ) )->lBnf5       := .T.
      ( D():Articulos( ::nView ) )->lBnf6       := .T.

      ( D():Articulos( ::nView ) )->Benef1      := ( ::nPrecioVenta1 / ::nPrecioCosto * 100 ) - 100
      ( D():Articulos( ::nView ) )->Benef2      := ( ::nPrecioVenta2 / ::nPrecioCosto * 100 ) - 100
      ( D():Articulos( ::nView ) )->Benef3      := ( ::nPrecioVenta3 / ::nPrecioCosto * 100 ) - 100
      ( D():Articulos( ::nView ) )->Benef4      := ( ::nPrecioVenta4 / ::nPrecioCosto * 100 ) - 100
      ( D():Articulos( ::nView ) )->Benef5      := ( ::nPrecioVenta5 / ::nPrecioCosto * 100 ) - 100
      ( D():Articulos( ::nView ) )->Benef6      := ( ::nPrecioVenta6 / ::nPrecioCosto * 100 ) - 100

      ( D():Articulos( ::nView ) )->pCosto      := ::nPrecioCosto
      ( D():Articulos( ::nView ) )->Familia     := ::cFamilia
      ( D():Articulos( ::nView ) )->cCodSus     := ::cSustituyeA
      ( D():Articulos( ::nView ) )->cCodPor     := ::cSustituidoPor
      ( D():Articulos( ::nView ) )->lNotVta     := .T.
      ( D():Articulos( ::nView ) )->lMsgvta     := .T.
      ( D():Articulos( ::nView ) )->lMsgMov     := .T.
      ( D():Articulos( ::nView ) )->lMsgSer     := .T.
      ( D():Articulos( ::nView ) )->lMosCom     := !empty( ::cDescipcionCasco )
      ( D():Articulos( ::nView ) )->lKitArt     := ::lEscandallos()
      ( D():Articulos( ::nView ) )->lKitAsc     := ::lEscandallos()

      if !empty( ::cDescipcionCasco )
         ( D():Articulos( ::nView ) )->mComent  := "Ref. casco " + alltrim( ::cDescipcionCasco ) + " por valor de " + alltrim( transform( ::nPrecioCasco * 1.3, "99999999,99" ) ) + " euros"
      end

      ( D():Articulos( ::nView ) )->LastChg     := stod( ::cFechaCreacion )
      ( D():Articulos( ::nView ) )->dFecChg     := date()

   RECOVER USING oError

      msgStop( "Imposible almacenar registro en base de datos" + chr( 13 ) + chr( 10 ) + ErrorMessage( oError ) )

   end

   ErrorBlock( oBlock )

Return ( nil )



static FUNCTION ArticulosICG_AppendCodigosBarras( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local cCodigo  := padr( ::cCodigoArticulo, 18 ) + padr( ::cCodigoBarrasArticulo, 20 )

   if ( D():ArticulosCodigosBarras( ::nView ) )->( dbseek( cCodigo ) )
      if ( D():ArticulosCodigosBarras( ::nView ) )->( dbrlock() )
         ::SetCodigosBarras()
         ( D():ArticulosCodigosBarras( ::nView ) )->( dbunlock() )
      end
   else
      if ( D():ArticulosCodigosBarras( ::nView ) )->( dbappend() )
         ::SetCodigosBarras()
         ( D():ArticulosCodigosBarras( ::nView ) )->( dbunlock() )
      end
   end

return ( nil )



static FUNCTION ArticulosICG_SetCodigosBarras( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local oError
   local oBlock

   oBlock               := ErrorBlock( { | oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

      SysRefresh()

      ( D():ArticulosCodigosBarras( ::nView ) )->cCodArt      := ::cCodigoArticulo
      ( D():ArticulosCodigosBarras( ::nView ) )->cCodBar      := ::cCodigoBarrasArticulo

   RECOVER USING oError

      msgStop( "Imposible almacenar registro en base de datos" + chr( 13 ) + chr( 10 ) + ErrorMessage( oError ) )

   end

   ErrorBlock( oBlock )

Return ( nil )



static FUNCTION ArticulosICG_getReferenciaCasco( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local cReferenciaCasco     := ""

   if !empty(::cDescipcionCasco)
      if D():seekInOrd( D():Articulos( ::nView ), ::cDescipcionCasco, "Nombre" )
         cReferenciaCasco     := ( D():Articulos( ::nView ) )->Codigo
      end
   end

Return ( cReferenciaCasco )



static FUNCTION ArticulosICG_AppendEscandallo( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local cCodigo

   if empty( ::cDescipcionCasco )
      ::cReferenciaCasco   := "1"
   else
      ::cReferenciaCasco   := ::getReferenciaCasco()
   end

   if empty( ::nLitros )
      ::nLitros            := 1
   end

   cCodigo                 := Padr( ::cCodigoArticulo, 18 ) + Padr( ::cReferenciaCasco, 18 )

   if ( D():Kit( ::nView ) )->( dbseek( cCodigo ) )
      if ( D():Kit( ::nView ) )->( dbrlock() )
         ::setEscandallo()
         ( D():Kit( ::nView ) )->( dbunlock() )
      end
   else
      if ( D():Kit( ::nView ) )->( dbappend() )
         ::setEscandallo()
         ( D():Kit( ::nView ) )->( dbunlock() )
      end
   end

return ( nil )



static FUNCTION ArticulosICG_DeleteEscandallo( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local cCodigo
   local cNombre
   local nRecAnt           := ( D():Kit( ::nView ) )->( Recno() )
   local nOrdAnt           := ( D():Kit( ::nView ) )->( OrdSetFocus( "CCODKIT" ) )

   cCodigo                 := Padr( ::cCodigoArticulo, 18 )

   if ( D():Kit( ::nView ) )->( dbseek( cCodigo ) )

      while ( D():Kit( ::nView ) )->cCodKit == cCodigo .AND. !( D():Kit( ::nView ) )->( Eof() )

         cNombre := ArticulosModel():getNombre( ( D():Kit( ::nView ) )->cRefKit )

         MsgWait( "Borrando escandallo: "+ AllTrim( cNombre ), "Eliminando escandallo", 0.1 )

         if At( "CASCO", upper( cNombre ) ) <> 0 .OR. At( "CASCOS", upper( cNombre ) ) <> 0
            MsgWait( "Borrando escandallo: "+ AllTrim( cNombre ), "Eliminando escandallo", 0.1 )
            ( D():Kit( ::nView ) )->( dbDelete() )
            ( D():Kit( ::nView ) )->( dbSkip() )
         else
            ( D():Kit( ::nView ) )->( dbSkip() )
         end

      end

   end

   ( D():Kit( ::nView ) )->( OrdSetFocus( nOrdAnt ) )
   ( D():Kit( ::nView ) )->( dbGoto( nRecAnt ) )

return ( nil )



static FUNCTION ArticulosICG_setEscandallo( ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   ( D():Kit( ::nView ) )->cCodKit     := ::cCodigoArticulo
   ( D():Kit( ::nView ) )->cRefKit     := ::cReferenciaCasco
   ( D():Kit( ::nView ) )->cDesKit     := retFld( ::cReferenciaCasco, D():Articulos( ::nView ), "Nombre" )
   ( D():Kit( ::nView ) )->nUndKit     := ::nLitros

Return ( nil )



static FUNCTION ArticulosICG_GetRange( cColumn ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local oError
   local oBlock
   local uValue
   local cValue   := ""

   oBlock         := ErrorBlock( { | oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   uValue         := ::oOleExcel:oExcel:ActiveSheet:Range( cColumn + lTrim( Str( ::nRow ) ) ):Value
   if Valtype( uValue ) == "C"
      cValue      := alltrim( uValue )
   end

   RECOVER USING oError

      msgStop( "Imposible obtener columna de excel" + chr( 13 ) + chr( 10 ) + ErrorMessage( oError ) )

   end

   ErrorBlock( oBlock )

Return ( cValue )



static FUNCTION ArticulosICG_GetNumeric( cColumn ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local oError
   local oBlock
   local uValue
   local nValue   := 0

   oBlock         := ErrorBlock( { | oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   uValue         := ::oOleExcel:oExcel:ActiveSheet:Range( cColumn + lTrim( Str( ::nRow ) ) ):Value

   if Valtype( uValue ) == "C"
      nValue      := Val( StrTran( uValue, ",", "." ) )
   end

   if Valtype( uValue ) == "N"
      nValue      := uValue
   end

   RECOVER USING oError

      msgStop( "Imposible obtener columna de excel" + chr( 13 ) + chr( 10 ) + ErrorMessage( oError ) )

   end

   ErrorBlock( oBlock )

Return ( nValue )



static FUNCTION ArticulosICG_getTarifa( cKey ) ; local Self AS CLASS ArticulosICG := QSelf() AS CLASS ArticulosICG

   local nTarifa  := 0
   local nPos     := aScan( ::hTarifa, {|a| alltrim( a[ 1 ] ) == alltrim( ::cTarifa ) } )
   if nPos <> 0
      nTarifa     := hGet( ::hTarifa[ nPos, 2 ], cKey )
   end

Return ( nTarifa )



function aItmArt()

   local aBase  := {}

   aAdd( aBase, { "Codigo",    "C", 18, 0, "Código del artículo" ,                    "'@!'",               "", "( cDbfArt )", nil } )
   aAdd( aBase, { "Nombre",    "C",100, 0, "Nombre del artículo",                     "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cDesTik",   "C", 20, 0, "Descripción para el tiket" ,              "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "pCosto",    "N", 15, 6, "Precio de costo" ,                        "PicIn()",            "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PvpRec",    "N", 15, 6, "Precio venta recomendado" ,               "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lBnf1",     "L",  1, 0, "Lógico aplicar porcentaje de beneficio 1","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LBNF2",     "L",  1, 0, "Lógico aplicar porcentaje de beneficio 2","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LBNF3",     "L",  1, 0, "Lógico aplicar porcentaje de beneficio 3","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LBNF4",     "L",  1, 0, "Lógico aplicar porcentaje de beneficio 4","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LBNF5",     "L",  1, 0, "Lógico aplicar porcentaje de beneficio 5","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LBNF6",     "L",  1, 0, "Lógico aplicar porcentaje de beneficio 6","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "BENEF1",    "N",  6, 2, "Porcentaje de beneficio precio 1" ,       "'@EZ 99.99'",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "BENEF2",    "N",  6, 2, "Porcentaje de beneficio precio 2" ,       "'@EZ 99.99'",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "BENEF3",    "N",  6, 2, "Porcentaje de beneficio precio 3" ,       "'@EZ 99.99'",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "BENEF4",    "N",  6, 2, "Porcentaje de beneficio precio 4" ,       "'@EZ 99.99'",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "BENEF5",    "N",  6, 2, "Porcentaje de beneficio precio 5" ,       "'@EZ 99.99'",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "BENEF6",    "N",  6, 2, "Porcentaje de beneficio precio 6" ,       "'@EZ 99.99'",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NBNFSBR1",  "N",  1, 0, "Beneficio sobre el costo o sobre venta 1","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NBNFSBR2",  "N",  1, 0, "Beneficio sobre el costo o sobre venta 2","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NBNFSBR3",  "N",  1, 0, "Beneficio sobre el costo o sobre venta 3","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NBNFSBR4",  "N",  1, 0, "Beneficio sobre el costo o sobre venta 4","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NBNFSBR5",  "N",  1, 0, "Beneficio sobre el costo o sobre venta 5","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NBNFSBR6",  "N",  1, 0, "Beneficio sobre el costo o sobre venta 6","",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVENTA1",   "N", 15, 6, "Precio de venta precio 1" ,               "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVENTA2",   "N", 15, 6, "Precio de venta precio 2" ,               "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVENTA3",   "N", 15, 6, "Precio de venta precio 3" ,               "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVENTA4",   "N", 15, 6, "Precio de venta precio 4" ,               "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVENTA5",   "N", 15, 6, "Precio de venta precio 5" ,               "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVENTA6",   "N", 15, 6, "Precio de venta precio 6" ,               "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVTAIVA1",  "N", 15, 6, "Precio de venta precio 1 " + cImp() + " incluido" ,  "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVTAIVA2",  "N", 15, 6, "Precio de venta precio 2 " + cImp() + " incluido" ,  "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVTAIVA3",  "N", 15, 6, "Precio de venta precio 3 " + cImp() + " incluido" ,  "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVTAIVA4",  "N", 15, 6, "Precio de venta precio 4 " + cImp() + " incluido" ,  "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVTAIVA5",  "N", 15, 6, "Precio de venta precio 5 " + cImp() + " incluido" ,  "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PVTAIVA6",  "N", 15, 6, "Precio de venta precio 6 " + cImp() + " incluido" ,  "PicOut()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQ1",     "N", 15, 6, "Precio de alquiler precio 1" ,               "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQ2",     "N", 15, 6, "Precio de alquiler precio 2" ,               "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQ3",     "N", 15, 6, "Precio de alquiler precio 3" ,               "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQ4",     "N", 15, 6, "Precio de alquiler precio 4" ,               "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQ5",     "N", 15, 6, "Precio de alquiler precio 5" ,               "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQ6",     "N", 15, 6, "Precio de alquiler precio 6" ,               "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQIVA1",  "N", 15, 6, "Precio de alquiler precio 1 " + cImp() + " incluido" ,    "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQIVA2",  "N", 15, 6, "Precio de alquiler precio 2 " + cImp() + " incluido" ,    "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQIVA3",  "N", 15, 6, "Precio de alquiler precio 3 " + cImp() + " incluido" ,    "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQIVA4",  "N", 15, 6, "Precio de alquiler precio 4 " + cImp() + " incluido" ,    "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQIVA5",  "N", 15, 6, "Precio de alquiler precio 5 " + cImp() + " incluido" ,    "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "PALQIVA6",  "N", 15, 6, "Precio de alquiler precio 6 " + cImp() + " incluido" ,    "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NPNTVER1",  "N", 15, 6, "Contribución punto verde" ,                               "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NPNVIVA1",  "N", 15, 6, "Contribución punto verde " + cImp() + " inc.",            "PicOut()",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NACTUAL",   "N", 15, 6, "Número de artículos" ,                    "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NCAJENT",   "N", 15, 6, "Número de cajas por defecto" ,            "MasUnd()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NUNICAJA",  "N", 15, 6, "Número de unidades por defecto" ,         "MasUnd()",           "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NMINIMO",   "N", 15, 6, "Número de stock mínimo" ,                 "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NMAXIMO",   "N", 15, 6, "Número de stock maximo" ,                 "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NCNTACT",   "N", 15, 6, "Número del contador" ,                    "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LASTIN",    "D",  8, 0, "Fecha ultima entrada" ,                   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LASTCHG",   "D",  8, 0, "Fecha de creación" ,                      "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LASTOUT",   "D",  8, 0, "Fecha ultima salida" ,                    "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "TIPOIVA",   "C",  1, 0, "Código tipo de " + cImp(),                "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LIVAINC",   "L",  1, 0, "Lógico " + cImp() + " incluido (S/N)" ,   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "FAMILIA",   "C", 16, 0, "Código de la familia del artículo" ,      "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CSUBFAM",   "C",  8, 0, "Código de la subfamilia del artículo" ,   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "GRPVENT",   "C",  9, 0, "Código del grupo de ventas" ,             "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCTAVTA",   "C", 12, 0, "Código de la cuenta de ventas" ,          "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCTACOM",   "C", 12, 0, "Código de la cuenta de compras" ,         "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCTATRN",   "C", 12, 0, "Código de la cuenta de portes" ,          "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CODEBAR",   "C", 20, 0, "Código de barras" ,                       "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NTIPBAR",   "N",  2, 0, "Tipo de código de barras" ,               "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "DESCRIP",   "M", 10, 0, "Descripción larga" ,                      "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LLABEL",    "L",  1, 0, "Lógico de selección de etiqueta",         "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NLABEL",    "N",  5, 0, "Número de etiquetas a imprimir",          "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NCTLSTOCK", "N",  1, 0, "Control de stock (1/2/3)",                "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LSELPRE",   "L",  1, 0, "",                                        "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NSELPRE",   "N",  5, 0, "",                                        "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NTIPPRE",   "N",  1, 0, "",                                        "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NPESOKG",   "N", 16, 6, "Peso del artículo" ,                      "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "CUNIDAD",   "C",  2, 0, "Unidad de medición del peso" ,            "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NVOLUMEN",  "N", 16, 6, "Volumen del artículo" ,                   "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "CVOLUMEN",  "C",  2, 0, "Unidad de medición del volumen" ,         "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NLNGART",   "N", 16, 6, "Largo del artículo" ,                     "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "NALTART",   "N", 16, 6, "Alto del artículo" ,                      "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "NANCART",   "N", 16, 6, "Ancho del artículo" ,                     "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "CUNDDIM",   "C",  2, 0, "Unidad de medición de las longitudes" ,   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPPES",   "N", 15, 6, "Importe de peso/volumen del articulo" ,   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CIMAGEN",   "C",250, 0, "Fichero de imagen" ,                      "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lSndDoc",   "L",  1, 0, "Lógico para envios" ,                     "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cCodUsr",   "C",  3, 0, "Código de usuario que realiza el cambio" ,"",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "dFecChg",   "D",  8, 0, "Fecha de cambio" ,                        "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cTimChg",   "C",  5, 0, "Hora de cambio" ,                         "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lKitArt",   "L",  1, 0, "Lógico de escandallos" ,                  "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lKitAsc",   "L",  1, 0, "Lógico de asociado" ,                     "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nKitImp",   "N",  1, 0, "" ,                                       "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nKitStk",   "N",  1, 0, "" ,                                       "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nKitPrc",   "N",  1, 0, "" ,                                       "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lAutSer",   "L",  1, 0, "Lógico de autoserializar" ,               "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LOBS",      "L",  1, 0, "Lógico de obsoleto" ,                     "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LNUMSER",   "L",  1, 0, "Lógico solicitar numero de serie" ,       "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CPRVHAB",   "C", 12, 0, "Proveedor habitual" ,                     "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LFACCNV",   "L",  1, 0, "Usar factor de conversión" ,              "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CFACCNV",   "C",  2, 0, "Código del factor de conversión" ,        "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCODTNK",   "C",  3, 0, "Código del tanque de combustible" ,       "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCODTIP",   "C",  3, 0, "Código del tipo de artículo" ,            "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LTIPACC",   "L",  1, 0, "Lógico de acceso por unidades o importe", "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LCOMBUS",   "L",  1, 0, "Lógico si el artículo es del tipo combustible", "",             "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCODIMP",   "C",  3, 0, "Código del impuesto especiales",          "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LMSGVTA",   "L",  1, 0, "Lógico para avisar en venta sin stock",   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LNOTVTA",   "L",  1, 0, "Lógico para no permitir venta sin stock", "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NLOTE",     "N",  9, 0, "",                                        "'999999999'",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CLOTE",     "C", 12, 0, "Número de lote",                          "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LLOTE",     "L",  1, 0, "Lote (S/N)",                              "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LPUBINT",   "L",  1, 0, "Lógico para publicar en internet (S/N)",  "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LPUBOFE",   "L",  1, 0, "Lógico para publicar como oferta (S/N)",  "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LPUBPOR",   "L",  1, 0, "Lógico para publicar como artículo destacado (S/N)",  "",       "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NDTOINT1",  "N",  6, 2, "Descuento de oferta para tienda web 1",   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPINT1",  "N", 15, 6, "Precio del producto en oferta 1",         "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPIVA1",  "N", 15, 6, "Precio del producto en oferta con " + cImp() + " 1", "",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NDTOINT2",  "N",  6, 2, "Descuento de oferta para tienda web 2",   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPINT2",  "N", 15, 6, "Precio del producto en oferta 2",         "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPIVA2",  "N", 15, 6, "Precio del producto en oferta con " + cImp() + " 2", "",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NDTOINT3",  "N",  6, 2, "Descuento de oferta para tienda web 3",   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPINT3",  "N", 15, 6, "Precio del producto en oferta 3",         "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPIVA3",  "N", 15, 6, "Precio del producto en oferta con " + cImp() + " 3", "",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NDTOINT4",  "N",  6, 2, "Descuento de oferta para tienda web 4",   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPINT4",  "N", 15, 6, "Precio del producto en oferta 4",         "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPIVA4",  "N", 15, 6, "Precio del producto en oferta con " + cImp() + " 4", "",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NDTOINT5",  "N",  6, 2, "Descuento de oferta para tienda web 5",   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPINT5",  "N", 15, 6, "Precio del producto en oferta 5",         "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPIVA5",  "N", 15, 6, "Precio del producto en oferta con " + cImp() + " 5", "",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NDTOINT6",  "N",  6, 2, "Descuento de oferta para tienda web 6",   "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPINT6",  "N", 15, 6, "Precio del producto en oferta 6",         "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NIMPIVA6",  "N", 15, 6, "Precio del producto en oferta con " + cImp() + " 6", "",        "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NMESGRT",   "N",  2, 0, "Meses de garantía",                       "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NINFENT",   "N",  1, 0, "Información de entrega",                  "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NINFENT1",  "N",  3, 0, "Dias en entregar la mercancia ( desde )", "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NINFENT2",  "N",  3, 0, "Dias en entregar la mercancia ( hasta )", "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "MDESTEC",   "M", 10, 0, "Descripción técnica del artículo",        "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NLNGCAJ",   "N", 16, 6, "Largo de la caja" ,                       "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "NALTCAJ",   "N", 16, 6, "Alto de la caja" ,                        "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "NANCCAJ",   "N", 16, 6, "Ancho de la caja" ,                       "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "CUNDCAJ",   "C",  2, 0, "Unidad de medición de la caja" ,          "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NPESCAJ",   "N", 16, 6, "Peso de la caja" ,                        "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCAJPES",   "C",  2, 0, "Unidad de medición del peso de la caja" , "",                   "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NVOLCAJ",   "N", 16, 6, "Volumen de la caja" ,                     "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCAJVOL",   "C",  2, 0, "Unidad de medición del volumen de la caja","",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NCAJPLT",   "N", 16, 6, "Número de cajas por palets" ,             "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "NBASPLT",   "N", 16, 6, "Base del palet" ,                         "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "NALTPLT",   "N", 16, 6, "Altura del palet" ,                       "'@E 999,999.999999'","", "( cDbfArt )", nil } )
   aAdd( aBase, { "CUNDPLT",   "C",  2, 0, "Unidad de medición de la altura del palet","",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LINCTCL",   "L",  1, 0, "Incluir en pantalla táctil",               "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CDESTCL",   "C", 20, 0, "Descripción en pantalla táctil",           "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CDESCMD",   "M", 10, 0, "Descripción para comanda",                 "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NPOSTCL",   "N", 16, 6, "Posición en pantalla táctil",              "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCODCAT",   "C",  4, 0, "Código del catálogo del artículo" ,        "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NPUNTOS",   "N", 16, 6, "Puntos del catalogo" ,                     "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NDTOPNT",   "N",  6, 2, "Dto. del catalogo" ,                       "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "NRENMIN",   "N",  6, 2, "Rentabilidad mínima" ,                     "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCODCATE",  "C",  3, 0, "Código de categoría",                      "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCODTEMP",  "C",  3, 0, "Código de la temporada",                   "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LECOTASA",  "L",  1, 0, "Lógico para usar ECOTASA",                 "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LMOSCOM",   "L",  1, 0, "Lógico mostrar comentario" ,               "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "MCOMENT",   "M", 10, 0, "Comentario a mostrar" ,                    "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "LPUNTO",    "L",  1, 0, "Lógico para trabajar con puntos" ,         "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCODPRP1",  "C", 20, 0, "Código de la primera propiedad" ,          "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "CCODPRP2",  "C", 20, 0, "Código de la segunda propiedad" ,          "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lCodPrp",   "L",  1, 0, "" ,                                        "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cCodFra",   "C",  3, 0, "Código de frases publiciarias",            "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cCodWeb",   "N", 11, 0, "Código del producto en la web",            "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nPosTpv",   "N", 10, 2, "Posición para mostrar en TPV táctil",      "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nDuracion", "N",  3, 0, "Duración del producto",                    "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nTipDur",   "N",  1, 0, "Tipo duración (dia, mes, año)",            "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cCodFab",   "C",  3, 0, "Código del fabricante",                    "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nImpCom1",  "N",  1, 0, "Impresora de comanda 1",                   "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nImpCom2",  "N",  1, 0, "Impresora de comanda 2",                   "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lMsgMov",   "L",  1, 0, "Lógico para avisar en movimientos sin stock","",                "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cImagenWeb","C",250, 0, "Imagen para la web",                       "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cChgBar",   "D",  8, 0, "Fecha de cambio de código de barras",      "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cCodUbi1",  "C",  5, 0, "Código primera ubicación",                 "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cCodUbi2",  "C",  5, 0, "Código segunda ubicación",                 "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cCodUbi3",  "C",  5, 0, "Código tercera ubicación",                 "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cValUbi1",  "C",  5, 0, "Valor primera ubicación",                  "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cValUbi2",  "C",  5, 0, "Valor segunda ubicación",                  "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cValUbi3",  "C",  5, 0, "Valor tercera ubicación",                  "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "dFecVta",   "D",  8, 0, "Fecha de puesta a la venta",               "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "dFinVta",   "D",  8, 0, "Fecha de fin de la venta",                 "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lMsgSer",   "L",  1, 0, "Avisar en ventas por series sin stock",    "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cValPrp1",  "C", 10, 0, "Valor de la primera propiedad",            "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cValPrp2",  "C", 10, 0, "Valor de la segunda propiedad",            "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "mValPrp1",  "M", 10, 0, "Valores seleccionables de la primera propiedad", "",            "", "( cDbfArt )", nil } )
   aAdd( aBase, { "mValPrp2",  "M", 10, 0, "Valores seleccionables de la segunda propiedad", "",            "", "( cDbfArt )", nil } )
   aAdd( aBase, { "dChgBar",   "D",  8, 0, "Fecha de cambio de codigos de barras",     "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cCodSus",   "C", 18, 0, "Código del artículo al que se sustituye" , "'@!'",              "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cCodPor",   "C", 18, 0, "Código del artículo por el que es sustituido" , "'@!'",         "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nDtoArt1",  "N",  6, 2, "Primer descuento de artículo",             "@EZ 99.99",         "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nDtoArt2",  "N",  6, 2, "Segundo descuento de artículo",            "@EZ 99.99",         "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nDtoArt3",  "N",  6, 2, "Tercer descuento de artículo",             "@EZ 99.99",         "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nDtoArt4",  "N",  6, 2, "Cuarto descuento de artículo",             "@EZ 99.99",         "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nDtoArt5",  "N",  6, 2, "Quinto descuento de artículo",             "@EZ 99.99",         "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nDtoArt6",  "N",  6, 2, "Sexto descuento de artículo",              "@EZ 99.99",         "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lMarAju",   "L",  1, 0, "Lógico para utilizar el margen de ajuste", "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cMarAju",   "C",  5, 0, "Cadena descriptiva del margen de ajuste",  "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nTarWeb",   "N",  1, 0, "Tarifa a aplicar en la Web" ,              "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "pVtaWeb",   "N", 16, 6, "Precio venta en la Web",                   "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cTipImp1",  "C", 50, 0, "Tipo impresora comanda 1",                 "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cTipImp2",  "C", 50, 0, "Tipo impresora comanda 2",                 "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cRefPrv",   "C", 18, 0, "Referencia del proveedor al artículo" ,    "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cCodSec",   "C",  3, 0, "Código de la sección para producción" ,    "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nFacCnv",   "N", 16, 6, "Factor de conversión" ,                    "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lSbrInt",   "L",  1, 0, "Lógico precio libre internet" ,            "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nColBtn",   "N", 10, 0, "Color para táctil" ,                       "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cOrdOrd",   "C",  2, 0, "Orden de comanda" ,                        "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lTerminado","L",  1, 0, "Lógico de producto terminado (producción)" , "",                "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lPeso",     "L",  1, 0, "Lógico de producto por peso",              "",                  "", "( cDbfArt )", nil } )

return ( aBase )






Function aItmKit()

   local aBase := {}

   aAdd( aBase, { "cCodKit",   "C", 18, 0, "Código del contenedor"               , "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cRefKit",   "C", 18, 0, "Código de artículo escandallo"       , "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nUndKit",   "N", 16, 6, "Unidades de escandallo"              , "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nPreKit",   "N", 16, 6, "Precio de escandallo"                , "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cDesKit",   "C", 50, 0, "Descripción del escandallo"          , "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "cUniDad",   "C",  2, 0, "Unidad de medición"                  , "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nValPnt",   "N", 16, 6, ""                                    , "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "nDtoPnt",   "N",  6, 2, "Descuento del punto"                 , "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lAplDto",   "L",  1, 0, "Lógico aplicar descuentos"           , "",                  "", "( cDbfArt )", nil } )
   aAdd( aBase, { "lExcPro",   "L",  1, 0, "Lógico para excluir de producción"   , "",                  "", "( cDbfArt )", nil } )

Return ( aBase )
