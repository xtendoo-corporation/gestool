#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 6 ".\Prg\Controllers\ArticulosController.prg"
_HB_CLASS ArticulosController ; function ArticulosController ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ArticulosController", iif( .T., { @SQLNavigatorController() }, { @HBObject() } ), @ArticulosController() ) ) ;

   _HB_MEMBER { oArticulosTipoController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArticulosTipoController"}, .F. )

   _HB_MEMBER { oArticulosCategoriasController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArticulosCategoriasController"}, .F. )

   _HB_MEMBER { oArticulosFamiliasController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArticulosFamiliasController"}, .F. )

   _HB_MEMBER { oArticulosFabricantesController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArticulosFabricantesController"}, .F. )

   _HB_MEMBER { oArticulosPreciosController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArticulosPreciosController"}, .F. )

   _HB_MEMBER { oTipoIvaController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTipoIvaController"}, .F. )

   _HB_MEMBER { oImpuestosEspecialesController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oImpuestosEspecialesController"}, .F. )

   _HB_MEMBER { oCamposExtraValoresController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oCamposExtraValoresController"}, .F. )

   _HB_MEMBER { oArticulosUnidadesMedicionController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArticulosUnidadesMedicionController"}, .F. )

   _HB_MEMBER { oPrimeraPropiedadController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPrimeraPropiedadController"}, .F. )

   _HB_MEMBER { oSegundaPropiedadController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSegundaPropiedadController"}, .F. )

   _HB_MEMBER { oTraduccionesController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTraduccionesController"}, .F. )

   _HB_MEMBER { oImagenesController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oImagenesController"}, .F. )

   _HB_MEMBER { oArticulosTemporadasController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArticulosTemporadasController"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @ArticulosController_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER End(); oClass:AddMethod( "End", @ArticulosController_End(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER insertPreciosWhereArticulo(); oClass:AddMethod( "insertPreciosWhereArticulo", @ArticulosController_insertPreciosWhereArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getPrecioCosto(); oClass:AddMethod( "getPrecioCosto", @ArticulosController_getPrecioCosto(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getPorcentajeIVA(); oClass:AddMethod( "getPorcentajeIVA", @ArticulosController_getPorcentajeIVA(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER validColumnArticulosFamiliaBrowse(); oClass:AddInline( "validColumnArticulosFamiliaBrowse", {|Self, oCol, uValue, nKey | ( ( Self ) ), ( ::validColumnBrowse( oCol, uValue, nKey, ::oArticulosFamiliasController:oModel, "articulo_familia_codigo" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER validColumnArticulosTipoBrowse(); oClass:AddInline( "validColumnArticulosTipoBrowse", {|Self, oCol, uValue, nKey | ( ( Self ) ), ( ::validColumnBrowse( oCol, uValue, nKey, ::oArticulosTipoController:oModel, "articulo_tipo_codigo" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER validColumnArticulosCategoriasBrowse(); oClass:AddInline( "validColumnArticulosCategoriasBrowse", {|Self, oCol, uValue, nKey | ( ( Self ) ), ( ::validColumnBrowse( oCol, uValue, nKey, ::oArticulosCategoriasController:oModel, "articulo_categoria_codigo" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER validColumnArticulosFabricantesBrowse(); oClass:AddInline( "validColumnArticulosFabricantesBrowse", {|Self, oCol, uValue, nKey | ( ( Self ) ), ( ::validColumnBrowse( oCol, uValue, nKey, ::oArticulosFabricantesController:oModel, "articulo_fabricante_codigo" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER validColumnArticulosTemporadasBrowse(); oClass:AddInline( "validColumnArticulosTemporadasBrowse", {|Self, oCol, uValue, nKey | ( ( Self ) ), ( ::validColumnBrowse( oCol, uValue, nKey, ::oArticulosTemporadasController:oModel, "articulo_temporada_codigo" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER validColumnTiposIvaBrowse(); oClass:AddInline( "validColumnTiposIvaBrowse", {|Self, oCol, uValue, nKey | ( ( Self ) ), ( ::validColumnBrowse( oCol, uValue, nKey, ::oTipoIvaController:oModel, "tipo_iva_codigo" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER validColumnImpuestosEspecialesBrowse(); oClass:AddInline( "validColumnImpuestosEspecialesBrowse", {|Self, oCol, uValue, nKey | ( ( Self ) ), ( ::validColumnBrowse( oCol, uValue, nKey, ::oImpuestosEspecialesController:oModel, "impuesto_especial_codigo" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER validPrimeraPropiedadBrowse(); oClass:AddInline( "validPrimeraPropiedadBrowse", {|Self, oCol, uValue, nKey | ( ( Self ) ), ( ::validColumnBrowse( oCol, uValue, nKey, ::oPrimeraPropiedadController:oModel, "primera_propiedad_codigo" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER validSegundaPropiedadBrowse(); oClass:AddInline( "validSegundaPropiedadBrowse", {|Self, oCol, uValue, nKey | ( ( Self ) ), ( ::validColumnBrowse( oCol, uValue, nKey, ::oSegundaPropiedadController:oModel, "segunda_propiedad_codigo" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ArticulosController ;



static FUNCTION ArticulosController_New( ) ; local Self AS CLASS ArticulosController := QSelf() AS CLASS ArticulosController

   ::Super:New()

   ::cTitle                                  := "Artículos"

   ::cName                                   := "articulos"



   ::hImage                                  := {  "16" => "gc_object_cube_16", "32" => "gc_object_cube_32", "48" => "gc_object_cube_48" }

   ::lTransactional                          := .T.

   ::nLevel                                  := Auth():Level( ::cName )

   ::oModel                                  := SQLArticulosModel():New( self )

   ::oBrowseView                             := ArticulosBrowseView():New( self )

   ::oDialogView                             := ArticulosView():New( self )

   ::oValidator                              := ArticulosValidator():New( self, ::oDialogView )

   ::oRepository                             := ArticulosRepository():New( self )

   ::oCamposExtraValoresController           := CamposExtraValoresController():New( self, "clientes" )

   ::oImagenesController                     := ImagenesController():New( self )

   ::oTraduccionesController                 := TraduccionesController():New( self )

   ::oArticulosFamiliasController            := ArticulosFamiliasController():New( self )
   ::oArticulosFamiliasController:setView( ::oDialogView )

   ::oArticulosTipoController                := ArticulosTipoController():New( self )
   ::oArticulosTipoController:setView( ::oDialogView )

   ::oArticulosCategoriasController          := ArticulosCategoriasController():New( self )
   ::oArticulosCategoriasController:setView( ::oDialogView )

   ::oArticulosFabricantesController         := ArticulosFabricantesController():New( self )
   ::oArticulosFabricantesController:setView( ::oDialogView )

   ::oTipoIvaController                      := TipoIvaController():New( self )
   ::oTipoIvaController:setView( ::oDialogView )

   ::oImpuestosEspecialesController          := ImpuestosEspecialesController():New( self )
   ::oImpuestosEspecialesController:setView( ::oDialogView )

   ::oArticulosPreciosController             := ArticulosPreciosController():New( self )
   ::oArticulosPreciosController:setView( ::oDialogView )

   ::oPrimeraPropiedadController             := PropiedadesController():New( self )
   ::oPrimeraPropiedadController:setView( ::oDialogView )

   ::oSegundaPropiedadController             := PropiedadesController():New( self )
   ::oSegundaPropiedadController:setView( ::oDialogView )

   ::oArticulosUnidadesMedicionController    := ArticulosUnidadesMedicionController():New( self )
   ::oArticulosUnidadesMedicionController:setView( ::oDialogView )

   ::oArticulosTemporadasController          := ArticulosTemporadasController():New( self )
   ::oArticulosTemporadasController:setView( ::oDialogView )

   ::oFilterController:setTableToFilter( ::oModel:cTableName )

   ::oModel:setEvents( { "loadedBlankBuffer", "loadedCurrentBuffer" }, {|| ::insertPreciosWhereArticulo() } )

RETURN ( Self )



static FUNCTION ArticulosController_End( ) ; local Self AS CLASS ArticulosController := QSelf() AS CLASS ArticulosController

   ::oModel:End()

   ::oBrowseView:End()

   ::oDialogView:End()

   ::oValidator:End()

   ::oRepository:End()

   ::oCamposExtraValoresController:End()

   ::oArticulosFamiliasController:End()

   ::oArticulosTipoController:End()

   ::oArticulosCategoriasController:End()

   ::oArticulosFabricantesController:End()

   ::oArticulosPreciosController:End()

   ::oTipoIvaController:End()

   ::oImpuestosEspecialesController:End()

   ::oPrimeraPropiedadController:End()

   ::oSegundaPropiedadController:End()

   ::oArticulosUnidadesMedicionController:End()

   ::oImagenesController:End()

   ::oTraduccionesController:End()

   ::oArticulosTemporadasController:End()

   ::Super:End()

RETURN ( Self )



static FUNCTION ArticulosController_getPrecioCosto( ) ; local Self AS CLASS ArticulosController := QSelf() AS CLASS ArticulosController

   if empty(::oModel)
      RETURN ( 0 )
   end

   if empty(::oModel:hBuffer)
      RETURN ( 0 )
   end

RETURN ( ::oModel:hBuffer[ "precio_costo" ] )



static FUNCTION ArticulosController_getPorcentajeIVA( ) ; local Self AS CLASS ArticulosController := QSelf() AS CLASS ArticulosController

   if empty(::oModel)
      RETURN ( 0 )
   end

   if empty(::oModel:hBuffer)
      RETURN ( 0 )
   end

RETURN ( ::oTipoIvaController:oModel:getPorcentajeWhereCodigo( ::oModel:hBuffer[ "tipo_iva_codigo" ] ) )



static FUNCTION ArticulosController_insertPreciosWhereArticulo( ) ; local Self AS CLASS ArticulosController := QSelf() AS CLASS ArticulosController

   local uuidArticulo   := hget( ::oModel:hBuffer, "uuid" )

   if empty( uuidArticulo )
      RETURN ( Self )
   end

   SQLArticulosPreciosModel():insertPreciosWhereArticulo( uuidArticulo )

RETURN ( Self )








_HB_CLASS ArticulosRepository ; function ArticulosRepository ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ArticulosRepository", iif( .T., { @SQLBaseRepository() }, { @HBObject() } ), @ArticulosRepository() ) ) ;

   _HB_MEMBER getTableName(); oClass:AddInline( "getTableName", {|Self | ( ( Self ) ), ( SQLArticulosModel():getTableName() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ArticulosRepository ;