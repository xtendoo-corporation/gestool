#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 6 ".\Prg\Views\Dialogs\ArticulosView.prg"
_HB_CLASS ArticulosView ; function ArticulosView ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ArticulosView", iif( .T., { @SQLBaseView() }, { @HBObject() } ), @ArticulosView() ) ) ;

   _HB_MEMBER { oGetCodigo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetCodigo"}, .F. )

   _HB_MEMBER { oGetTipo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetTipo"}, .F. )

   _HB_MEMBER { oGetMarcador } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetMarcador"}, .F. )

   _HB_MEMBER { cGetMarcador } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetMarcador"}, .F. )

   _HB_MEMBER { oBtnTags } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnTags"}, .F. )

   _HB_MEMBER { oTagsEver } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTagsEver"}, .F. )

   _HB_MEMBER { oComboPeriodoCaducidad } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oComboPeriodoCaducidad"}, .F. )

   _HB_MEMBER { oGetLoteActual } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetLoteActual"}, .F. )

   _HB_MEMBER { oGetPrecioCosto } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetPrecioCosto"}, .F. )

   _HB_MEMBER { oSayCodificacionProveedores } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayCodificacionProveedores"}, .F. )

   _HB_MEMBER Activate(); oClass:AddMethod( "Activate", @ArticulosView_Activate(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER startActivate(); oClass:AddMethod( "startActivate", @ArticulosView_startActivate(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER addLinksToExplorerBar(); oClass:AddMethod( "addLinksToExplorerBar", @ArticulosView_addLinksToExplorerBar(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER changeLote(); oClass:AddInline( "changeLote", {|Self | ( ( Self ) ), ( iif( ::oController:oModel:hBuffer[ "lote" ], ::oGetLoteActual:Show(), ::oGetLoteActual:Hide() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ArticulosView ;








static FUNCTION ArticulosView_Activate( ) ; local Self AS CLASS ArticulosView := QSelf() AS CLASS ArticulosView



   ::oDialog = TDialog():New(,,,, ::LblTitle() + "articulo", "CONTAINER_MEDIUM_EXTENDED",, .F.,,,,,, .F.,,,,,, .F.,, "::oDialog", nil, )





   ::oBitmap := TBitmap():ReDefine( 900, ::oController:getimage( "48" ),, ::oDialog,,, .F., .F.,,, .F.,,, .T. )





   ::oMessage := TSay():ReDefine( 800, {||      "Artículos"}, ::oDialog,,,, .F., getBoldFont(), .F., .F., )

   ::redefineExplorerBar()







   ::oFolder := TFolder():ReDefine( 500, {"&General", "&Precios"}, { "ARTICULO_GENERAL","ARTICULO_PRECIO" }, ::oDialog,,,,, .F., )







   ::oGetCodigo := TGetHlp():ReDefine( 100, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "codigo" ], ::oController:oModel:hBuffer[ "codigo" ]:= u ) }, ::oFolder:aDialogs[1],, "@! NNNNNNNNNNNNNNNNNN", {||       ( ::oController:validate( "codigo" ) )},,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )





   TGetHlp():ReDefine( 110, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "nombre" ], ::oController:oModel:hBuffer[ "nombre" ]:= u ) }, ::oFolder:aDialogs[1],,, {||       ( ::oController:validate( "nombre" ) )},,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )



   ::oController:oArticulosFamiliasController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "articulo_familia_codigo" ], ::oController:oModel:hBuffer[ "articulo_familia_codigo" ]:= u ) } )
   ::oController:oArticulosFamiliasController:oGetSelector:Activate( 120, 121, ::oFolder:aDialogs[ 1 ] )



   ::oController:oArticulosTipoController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "articulo_tipo_codigo" ], ::oController:oModel:hBuffer[ "articulo_tipo_codigo" ]:= u ) } )
   ::oController:oArticulosTipoController:oGetSelector:Activate( 130, 131, ::oFolder:aDialogs[ 1 ] )



   ::oController:oArticulosCategoriasController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "articulo_categoria_codigo" ], ::oController:oModel:hBuffer[ "articulo_categoria_codigo" ]:= u ) } )
   ::oController:oArticulosCategoriasController:oGetSelector:Activate( 140, 141, ::oFolder:aDialogs[ 1 ] )



   ::oController:oArticulosFabricantesController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "articulo_fabricante_codigo" ], ::oController:oModel:hBuffer[ "articulo_fabricante_codigo" ]:= u ) } )
   ::oController:oArticulosFabricantesController:oGetSelector:Activate( 150, 151, ::oFolder:aDialogs[ 1 ] )



   ::oController:oTipoIvaController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "tipo_iva_codigo" ], ::oController:oModel:hBuffer[ "tipo_iva_codigo" ]:= u ) } )
   ::oController:oTipoIvaController:oGetSelector:Activate( 160, 161, ::oFolder:aDialogs[ 1 ] )



   ::oController:oImpuestosEspecialesController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "impuesto_especial_codigo" ], ::oController:oModel:hBuffer[ "impuesto_especial_codigo" ]:= u ) } )
   ::oController:oImpuestosEspecialesController:oGetSelector:Activate( 170, 171, ::oFolder:aDialogs[ 1 ] )



   ::oController:oPrimeraPropiedadController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "primera_propiedad_codigo" ], ::oController:oModel:hBuffer[ "primera_propiedad_codigo" ]:= u ) } )
   ::oController:oPrimeraPropiedadController:oGetSelector:Activate( 230, 231, ::oFolder:aDialogs[ 1 ] )



   ::oController:oSegundaPropiedadController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "segunda_propiedad_codigo" ], ::oController:oModel:hBuffer[ "segunda_propiedad_codigo" ]:= u ) } )
   ::oController:oSegundaPropiedadController:oGetSelector:Activate( 240, 241, ::oFolder:aDialogs[ 1 ] )



   ::oController:oArticulosTemporadasController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "articulo_temporada_codigo" ], ::oController:oModel:hBuffer[ "articulo_temporada_codigo" ]:= u ) } )
   ::oController:oArticulosTemporadasController:oGetSelector:Activate( 250, 251, ::oFolder:aDialogs[ 1 ] )









   TSayCheck():ReDefine( 200, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "obsoleto" ], ::oController:oModel:hBuffer[ "obsoleto" ]:= u ) }, ::oFolder:aDialogs[1],,,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, 202 )









   TGetHlp():ReDefine( 190, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "caducidad" ], ::oController:oModel:hBuffer[ "caducidad" ]:= u ) }, ::oFolder:aDialogs[1],, "999", {||       ( ::oController:oModel:hBuffer[ "caducidad" ] >= 0 )},,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .T.,,,,,, nil,,, )






   ::oComboPeriodoCaducidad := TComboBox():ReDefine( 191, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "periodo_caducidad" ], ::oController:oModel:hBuffer[ "periodo_caducidad" ]:= u ) }, { "Dia(s)", "Mes(es)", "Año(s)" }, ::oFolder:aDialogs[1],,,,,,, .F., {||        ( ::oController:isNotZoomMode() )},,,,,, "::oComboPeriodoCaducidad",,,,,,, )








   TSayCheck():ReDefine( 210, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "lote" ], ::oController:oModel:hBuffer[ "lote" ]:= u ) }, ::oFolder:aDialogs[1],, {||   ( ::changeLote() )},,,,, .F., {||        ( ::oController:isNotZoomMode() )},, 212 )






   ::oGetLoteActual := TGetHlp():ReDefine( 220, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "lote_actual" ], ::oController:oModel:hBuffer[ "lote_actual" ]:= u ) }, ::oFolder:aDialogs[1],,,,,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,, 221, )








   ::oGetPrecioCosto := TGetHlp():ReDefine( 100, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "precio_costo" ], ::oController:oModel:hBuffer[ "precio_costo" ]:= u ) }, ::oFolder:aDialogs[2],, "@E 99999999.999999",,,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )

   ::oController:oArticulosPreciosController:Activate( 130, ::oFolder:aDialogs[2] )










   TButton():ReDefine( 1, {||( if( validateDialog( ::oDialog ), ::oDialog:end( 1 ), ) )}, ::oDialog,,, .F., {||        ( ::oController:isNotZoomMode() )},,, .F. )





   TButton():ReDefine( 2, {||( ::oDialog:end() )}, ::oDialog,,, .F.,,,, .T. )

   if ::oController:isNotZoomMode()
      ::oDialog:AddFastKey( 116, {|| if( validateDialog( ::oDialog ), ::oDialog:end( 1 ), ) } )
   end

   ::oDialog:bStart  := {|| ::startActivate() }

   ::oDialog:Activate( ::oDialog:bLClicked, ::oDialog:bMoved, ::oDialog:bPainted, .T.,,,, ::oDialog:bRClicked,,, )

   ::oBitmap:end()

RETURN ( ::oDialog:nResult )



static FUNCTION ArticulosView_startActivate( ) ; local Self AS CLASS ArticulosView := QSelf() AS CLASS ArticulosView

   SendMessage( ::oComboPeriodoCaducidad:hWnd, 0x0153, -1, 14 )

   ::addLinksToExplorerBar()

   ::oController:oArticulosFamiliasController:oGetSelector:Start()

   ::oController:oArticulosTipoController:oGetSelector:Start()

   ::oController:oArticulosCategoriasController:oGetSelector:Start()

   ::oController:oArticulosFabricantesController:oGetSelector:Start()

   ::oController:oTipoIvaController:oGetSelector:Start()

   ::oController:oImpuestosEspecialesController:oGetSelector:Start()

   ::oController:oPrimeraPropiedadController:oGetSelector:Start()

   ::oController:oSegundaPropiedadController:oGetSelector:Start()

   ::oController:oArticulosTemporadasController:oGetSelector:Start()

   ::changeLote()

   ::oGetCodigo:SetFocus()

RETURN ( self )



static FUNCTION ArticulosView_addLinksToExplorerBar( ) ; local Self AS CLASS ArticulosView := QSelf() AS CLASS ArticulosView

   local oPanel

   oPanel            := ::oExplorerBar:AddPanel( "Datos relacionados", nil, 1 )

   if ::oController:isZoomMode()
      RETURN ( self )
   end



   oPanel:AddLink(   "Codificación de proveedores...", {|| msgalert( "todo" ) }, ::oController:oArticulosUnidadesMedicionController:getImage( "16" ) )



   oPanel:AddLink(   "Unidades de medición...", {|| ::oController:oArticulosUnidadesMedicionController:activateDialogView() }, ::oController:oArticulosUnidadesMedicionController:getImage( "16" ) )



   oPanel:AddLink(   "Imagenes...", {|| ::oController:oImagenesController:activateDialogView() }, ::oController:oImagenesController:getImage( "16" ) )



   oPanel:AddLink(   "Traducciones...", {|| ::oController:oTraduccionesController:activateDialogView() }, ::oController:oTraduccionesController:getImage( "16" ) )

   oPanel            := ::oExplorerBar:AddPanel( "Otros", nil, 1 )



   oPanel:AddLink(   "Campos extra...", {|| ::oController:oCamposExtraValoresController:Edit( ::oController:getUuid() ) }, ::oController:oCamposExtraValoresController:getImage( "16" ) )

RETURN ( self )
