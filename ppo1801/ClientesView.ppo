#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 4 ".\Prg\Views\Dialogs\ClientesView.prg"
_HB_CLASS ClientesView ; function ClientesView ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ClientesView", iif( .T., { @SQLBaseView() }, { @HBObject() } ), @ClientesView() ) ) ;

   _HB_MEMBER { oExplorerBar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oExplorerBar"}, .F. )
   _HB_MEMBER { oGetDni } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetDni"}, .F. )
   _HB_MEMBER { oGetProvincia } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetProvincia"}, .F. )
   _HB_MEMBER { oGetPoblacion } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetPoblacion"}, .F. )
   _HB_MEMBER { oGetPais } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetPais"}, .F. )

   _HB_MEMBER { oGetFechaBloqueo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetFechaBloqueo"}, .F. )
   _HB_MEMBER { oGetCausaBloqueo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetCausaBloqueo"}, .F. )

   _HB_MEMBER { oGetAgentes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetAgentes"}, .F. )

   _HB_MEMBER { oGetFechaUltimaLlamada } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetFechaUltimaLlamada"}, .F. )

   _HB_MEMBER { oGetFechaPeticion } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetFechaPeticion"}, .F. )
   _HB_MEMBER { oGetFechaConcesion } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetFechaConcesion"}, .F. )

   _HB_MEMBER { oBloqueoRiesgo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBloqueoRiesgo"}, .F. )
   _HB_MEMBER { oRiesgo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oRiesgo"}, .F. )

   _HB_MEMBER { oRiesgoAlcanzado } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oRiesgoAlcanzado"}, .F. )
   _HB_MEMBER { nRiesgoAlcanzado } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nRiesgoAlcanzado"}, .F. )

   _HB_MEMBER { oInfoSubCuenta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oInfoSubCuenta"}, .F. )
   _HB_MEMBER { oInfoSubCuentaDescuento } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oInfoSubCuentaDescuento"}, .F. )

   _HB_MEMBER { oGetSubcuenta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetSubcuenta"}, .F. )
   _HB_MEMBER { oGetCuentaVenta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetCuentaVenta"}, .F. )
   _HB_MEMBER { oGetSubcuentaDescuento } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetSubcuentaDescuento"}, .F. )

   _HB_MEMBER { oSaldoSubcuenta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSaldoSubcuenta"}, .F. )
   _HB_MEMBER { nSaldoSubcuenta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nSaldoSubcuenta"}, .F. )

   _HB_MEMBER { oSaldoSubcuentaDescuento } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSaldoSubcuentaDescuento"}, .F. )
   _HB_MEMBER { nSaldoSubcuentaDescuento } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nSaldoSubcuentaDescuento"}, .F. )

   _HB_MEMBER Activate(); oClass:AddMethod( "Activate", @ClientesView_Activate(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Activating(); oClass:AddMethod( "Activating", @ClientesView_Activating(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getDireccionesController(); oClass:AddInline( "getDireccionesController", {|Self | ( ( Self ) ), ( ::oController:oDireccionesController ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER startDialog(); oClass:AddMethod( "startDialog", @ClientesView_startDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER redefineGeneral(); oClass:AddMethod( "redefineGeneral", @ClientesView_redefineGeneral(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER redefineComercial(); oClass:AddMethod( "redefineComercial", @ClientesView_redefineComercial(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER addLinksToExplorerBar(); oClass:AddMethod( "addLinksToExplorerBar", @ClientesView_addLinksToExplorerBar(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER changeBloqueo(); oClass:AddMethod( "changeBloqueo", @ClientesView_changeBloqueo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER loadFechaLlamada(); oClass:AddMethod( "loadFechaLlamada", @ClientesView_loadFechaLlamada(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER changeAutorizacioncredito(); oClass:AddMethod( "changeAutorizacioncredito", @ClientesView_changeAutorizacioncredito(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ClientesView ;



static FUNCTION ClientesView_Activating( ) ; local Self AS CLASS ClientesView := QSelf() AS CLASS ClientesView

   if ::oController:isAppendOrDuplicateMode()
      ::oController:oModel:hBuffer()
   end

RETURN ( self )



static FUNCTION ClientesView_Activate( ) ; local Self AS CLASS ClientesView := QSelf() AS CLASS ClientesView



   ::oDialog = TDialog():New(,,,, ::LblTitle() + "cliente", "CONTAINER_MEDIUM_EXTENDED",, .F.,,,,,, .F.,,,,,, .F.,, "::oDialog", nil, )





   ::oBitmap := TBitmap():ReDefine( 900, ::oController:getImage( "48" ),, ::oDialog,,, .F., .F.,,, .F.,,, .T. )





   ::oMessage := TSay():ReDefine( 800, {||      "Clientes"}, ::oDialog,,,, .F., getBoldFont(), .F., .F., )







   ::oFolder := TFolder():ReDefine( 500, {"General", "Comercial"}, { "CLIENTE_GENERAL","CLIENTE_COMERCIAL" }, ::oDialog,,,,, .F., )

   ::redefineGeneral()

   ::redefineComercial()

   ::redefineExplorerBar()









   TButton():ReDefine( 1, {||( if( validateDialog( ::oFolder:aDialogs ), ::oDialog:end( 1 ), ) )}, ::oDialog,,, .F., {||        ( ::oController:isNotZoomMode() )},,, .F. )





   TButton():ReDefine( 2, {||( ::oDialog:end() )}, ::oDialog,,, .F.,,,, .T. )

   if ::oController:isNotZoomMode()
      ::oDialog:AddFastKey( 116, {|| if( validateDialog( ::oFolder:aDialogs ), ::oDialog:end( 1 ), ) } )
   end

   ::oDialog:bStart := {|| ::startDialog() }

   ::oDialog:Activate( ::oDialog:bLClicked, ::oDialog:bMoved, ::oDialog:bPainted, .T.,,,, ::oDialog:bRClicked,,, )

   ::oBitmap:end()

RETURN ( ::oDialog:nResult )



static FUNCTION ClientesView_redefineGeneral( ) ; local Self AS CLASS ClientesView := QSelf() AS CLASS ClientesView

   local oSay






   TGetHlp():ReDefine( 100, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "codigo" ], ::oController:oModel:hBuffer[ "codigo" ]:= u ) }, ::oFolder:aDialogs[1],, ( "@! NNNNNNNNNNNN" ), {||       ( ::oController:validate( "codigo" ) )},,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )





   TGetHlp():ReDefine( 110, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "nombre" ], ::oController:oModel:hBuffer[ "nombre" ]:= u ) }, ::oFolder:aDialogs[1],,, {||       ( ::oController:validate( "nombre" ) )},,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )





   ::oGetDni := TGetHlp():ReDefine( 120, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "dni" ], ::oController:oModel:hBuffer[ "dni" ]:= u ) }, ::oFolder:aDialogs[1],,, {||       ( CheckCif( ::oGetDni ) )},,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )

   ::oController:oDireccionesController:oDialogView:ExternalRedefine( ::oFolder:aDialogs[1] )




   TGetHlp():ReDefine( 130, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "web" ], ::oController:oModel:hBuffer[ "web" ]:= u ) }, ::oFolder:aDialogs[1],,,,,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )




   TGetHlp():ReDefine( 140, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "establecimiento" ], ::oController:oModel:hBuffer[ "establecimiento" ]:= u ) }, ::oFolder:aDialogs[1],,,,,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )





   TSayCheck():ReDefine( 150, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "excluir_fidelizacion" ], ::oController:oModel:hBuffer[ "excluir_fidelizacion" ]:= u ) }, ::oFolder:aDialogs[1],,,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, 152 )





   TSayCheck():ReDefine( 160, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "no_editar_datos" ], ::oController:oModel:hBuffer[ "no_editar_datos" ]:= u ) }, ::oFolder:aDialogs[1],,,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, 162 )






   ::oGetFechaUltimaLlamada := TGetHlp():ReDefine( 170, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "fecha_ultima_llamada" ], ::oController:oModel:hBuffer[ "fecha_ultima_llamada" ]:= u ) }, ::oFolder:aDialogs[1],,,,,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .T.,,,,,, nil,,, )

   TBtnBmp():ReDefine( 180, "gc_recycle_16",,,,,{|| ::loadFechaLlamada() }, ::oFolder:aDialogs[1], .F., {|| ::oController:isNotZoomMode() }, .F. )

RETURN ( self )



static FUNCTION ClientesView_redefineComercial( ) ; local Self AS CLASS ClientesView := QSelf() AS CLASS ClientesView

   ::oController:oCuentasRemesasController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "cuenta_remesa_uuid" ], ::oController:oModel:hBuffer[ "cuenta_remesa_uuid" ]:= u ) } )
   ::oController:oCuentasRemesasController:oGetSelector:Activate( 110, 111, ::oFolder:aDialogs[2] )

   ::oController:oRutasController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "ruta_uuid" ], ::oController:oModel:hBuffer[ "ruta_uuid" ]:= u ) } )
   ::oController:oRutasController:oGetSelector:Activate( 120, 121, ::oFolder:aDialogs[2] )

   ::oController:oAgentesController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "agente_uuid" ], ::oController:oModel:hBuffer[ "agente_uuid" ]:= u ) } )
   ::oController:oAgentesController:oGetSelector:Activate( 130, 131, ::oFolder:aDialogs[2] )

   ::oController:oClientesGruposController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "cliente_grupo_uuid" ], ::oController:oModel:hBuffer[ "cliente_grupo_uuid" ]:= u ) } )
   ::oController:oClientesGruposController:oGetSelector:Activate( 140, 141, ::oFolder:aDialogs[2] )

   ::oController:oFormasPagoController:oGetSelector:Bind( { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "forma_pago_uuid" ], ::oController:oModel:hBuffer[ "forma_pago_uuid" ]:= u ) } )
   ::oController:oFormasPagoController:oGetSelector:Activate( 150, 151, ::oFolder:aDialogs[2] )






   TGetHlp():ReDefine( 160, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "primer_dia_pago" ], ::oController:oModel:hBuffer[ "primer_dia_pago" ]:= u ) }, ::oFolder:aDialogs[2],, "99",,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .T.,,,,,, nil,,, )






   TGetHlp():ReDefine( 170, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "segundo_dia_pago" ], ::oController:oModel:hBuffer[ "segundo_dia_pago" ]:= u ) }, ::oFolder:aDialogs[2],, "99",,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .T.,,,,,, nil,,, )






   TGetHlp():ReDefine( 310, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "tercer_dia_pago" ], ::oController:oModel:hBuffer[ "tercer_dia_pago" ]:= u ) }, ::oFolder:aDialogs[2],, "99",,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .T.,,,,,, nil,,, )





   TComboBox():ReDefine( 180, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "mes_vacaciones" ], ::oController:oModel:hBuffer[ "mes_vacaciones" ]:= u ) }, { "Ninguno", "Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre" }, ::oFolder:aDialogs[2],,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},,,,,,,,,,,,, )





   TComboBox():ReDefine( 190, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "regimen_iva" ], ::oController:oModel:hBuffer[ "regimen_iva" ]:= u ) }, { "General", "Unión Europea", "Excento", "Exportación" }, ::oFolder:aDialogs[2],,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},,,,,,,,,,,,, )





   TSayCheck():ReDefine( 200, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "recargo_equivalencia" ], ::oController:oModel:hBuffer[ "recargo_equivalencia" ]:= u ) }, ::oFolder:aDialogs[2],,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, 202 )






   TGetHlp():ReDefine( 210, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "porcentaje_irpf" ], ::oController:oModel:hBuffer[ "porcentaje_irpf" ]:= u ) }, ::oFolder:aDialogs[2],, "@E 999.99",,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .T.,,,,,, nil,,, )






   TSayCheck():ReDefine( 220, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "bloqueado" ], ::oController:oModel:hBuffer[ "bloqueado" ]:= u ) }, ::oFolder:aDialogs[2],, {||( ::changeBloqueo() )},,,,, .F., {||     ( ::oController:isNotZoomMode() )},, 222 )







   ::oGetFechaBloqueo := TGetHlp():ReDefine( 230, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "fecha_bloqueo" ], ::oController:oModel:hBuffer[ "fecha_bloqueo" ]:= u ) }, ::oFolder:aDialogs[2],,,,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .T.,,,,,, nil,, 232, )






   ::oGetCausaBloqueo := TGetHlp():ReDefine( 240, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "causa_bloqueo" ], ::oController:oModel:hBuffer[ "causa_bloqueo" ]:= u ) }, ::oFolder:aDialogs[2],,,,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,, 242, )






   TSayCheck():ReDefine( 250, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "autorizado_venta_credito" ], ::oController:oModel:hBuffer[ "autorizado_venta_credito" ]:= u ) }, ::oFolder:aDialogs[2],, {||( ::changeAutorizacioncredito() )},,,,, .F., {||     ( ::oController:isNotZoomMode() )},, 252 )







   ::oGetFechaPeticion := TGetHlp():ReDefine( 260, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "fecha_peticion_riesgo" ], ::oController:oModel:hBuffer[ "fecha_peticion_riesgo" ]:= u ) }, ::oFolder:aDialogs[2],,,,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .T.,,,,,, nil,, 262, )







   ::oGetFechaConcesion := TGetHlp():ReDefine( 270, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "fecha_concesion_riesgo" ], ::oController:oModel:hBuffer[ "fecha_concesion_riesgo" ]:= u ) }, ::oFolder:aDialogs[2],,,,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .T.,,,,,, nil,, 272, )






   ::oBloqueoRiesgo := TSayCheck():ReDefine( 280, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "bloquear_riesgo_alcanzado" ], ::oController:oModel:hBuffer[ "bloquear_riesgo_alcanzado" ]:= u ) }, ::oFolder:aDialogs[2],,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, 282 )








   ::oRiesgo := TGetHlp():ReDefine( 290, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "riesgo" ], ::oController:oModel:hBuffer[ "riesgo" ]:= u ) }, ::oFolder:aDialogs[2],, "@E 9999999999999999.99",,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .T.,,,,,, nil,, 292, )







   ::oRiesgoAlcanzado := TGetHlp():ReDefine( 300, { | u | If( PCount()==0, ::nRiesgoAlcanzado, ::nRiesgoAlcanzado:= u ) }, ::oFolder:aDialogs[2],, "@E 9999999999999999.99",,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,, 302, )






   ::oInfoSubCuenta := TSay():ReDefine( 320, {||   "Subcuenta..."}, ::oFolder:aDialogs[2],, ( 10 + ( 152 * 256 ) + ( 234 * 65536 ) ),, .F., getBoldFont(), .F., .F., )

   ::oInfoSubCuenta:lWantClick  := .T.
   ::oInfoSubCuenta:OnClick     := {|| if( ::oController:isNotZoomMode(),  msgalert( "Informe subcuenta del cliente" ), ) }








   ::oGetSubcuenta := TGetHlp():ReDefine( 330, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "subcuenta" ], ::oController:oModel:hBuffer[ "subcuenta" ]:= u ) }, ::oFolder:aDialogs[2],,,,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .F.,,,,, {|Self|( MsgInfo( "Conectar con Contaplus" ) )}, nil, "LUPA",, 331 )





   ::oSaldoSubcuenta := TGetHlp():ReDefine( 340, { | u | If( PCount()==0, ::nSaldoSubcuenta, ::nSaldoSubcuenta:= u ) }, ::oFolder:aDialogs[2],,,,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )








   ::oGetCuentaVenta := TGetHlp():ReDefine( 350, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "cuenta_venta" ], ::oController:oModel:hBuffer[ "cuenta_venta" ]:= u ) }, ::oFolder:aDialogs[2],,,,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .F.,,,,, {|Self|( MsgInfo( "Conectar con Contaplus" ) )}, nil, "LUPA",, 351 )






   ::oInfoSubCuentaDescuento := TSay():ReDefine( 360, {||   "Descuento..."}, ::oFolder:aDialogs[2],, ( 10 + ( 152 * 256 ) + ( 234 * 65536 ) ),, .F., getBoldFont(), .F., .F., )

   ::oInfoSubCuentaDescuento:lWantClick  := .T.
   ::oInfoSubCuentaDescuento:OnClick     := {|| if( ::oController:isNotZoomMode(), msgalert( "Informe subcuenta dedescuento" ), ) }








   ::oGetSubcuentaDescuento := TGetHlp():ReDefine( 370, { | u | If( PCount()==0, ::oController:oModel:hBuffer[ "cuenta_venta" ], ::oController:oModel:hBuffer[ "cuenta_venta" ]:= u ) }, ::oFolder:aDialogs[2],,,,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .F.,,,,, {|Self|( MsgInfo( "Conectar con Contaplus" ) )}, nil, "LUPA",, 371 )





   ::oSaldoSubcuentaDescuento := TGetHlp():ReDefine( 380, { | u | If( PCount()==0, ::nSaldoSubcuentaDescuento, ::nSaldoSubcuentaDescuento:= u ) }, ::oFolder:aDialogs[2],,,,,,,,, .F., {||     ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )

RETURN ( self )



static FUNCTION ClientesView_startDialog( ) ; local Self AS CLASS ClientesView := QSelf() AS CLASS ClientesView

   ::addLinksToExplorerBar()

   ::oController:oAgentesController:oGetSelector:Start()

   ::oController:oFormasPagoController:oGetSelector:Start()

   ::oController:oCuentasRemesasController:oGetSelector:Start()

   ::oController:oRutasController:oGetSelector:Start()

   ::oController:oClientesGruposController:oGetSelector:Start()

   ::oController:oDireccionesController:externalStartDialog()

   if !::oController:oModel:hBuffer[ "bloqueado" ]
      ::oGetFechaBloqueo:Hide()
      ::oGetCausaBloqueo:Hide()
   end

   if !::oController:oModel:hBuffer[ "autorizado_venta_credito" ]
      ::oGetFechaPeticion:Hide()
      ::oGetFechaConcesion:Hide()
      ::oBloqueoRiesgo:Hide()
      ::oRiesgo:Hide()
      ::oRiesgoAlcanzado:Hide()
   end

RETURN ( self )



static FUNCTION ClientesView_addLinksToExplorerBar( ) ; local Self AS CLASS ClientesView := QSelf() AS CLASS ClientesView

   local oPanel

   oPanel            := ::oExplorerBar:AddPanel( "Datos relacionados", nil, 1 )

   if ::oController:isNotZoomMode()
      oPanel:AddLink( "Tarifas...",             {|| MsgInfo( "Tarifas" ) }, "gc_money_interest_16" )
      oPanel:AddLink( "Direcciones...",         {|| ::oController:oDireccionesController:activateDialogView() }, ::oController:oDireccionesController:getImage( "16" ) )
      oPanel:AddLink( "Contactos...",           {|| ::oController:oContactosController:activateDialogView() }, ::oController:oContactosController:getImage( "16" ) )
      oPanel:AddLink( "Cuentas bancarias...",   {|| ::oController:oCuentasBancariasController:activateDialogView() }, ::oController:oCuentasBancariasController:getImage( "16" ) )
      oPanel:AddLink( "Incidencias...",         {|| ::oController:oIncidenciasController:activateDialogView() }, ::oController:oIncidenciasController:getImage( "16" ) )
      oPanel:AddLink( "Documentos...",          {|| ::oController:oDocumentosController:activateDialogView() }, ::oController:oDocumentosController:getImage( "16" ) )
      oPanel:AddLink( "Entidades facturae...",  {|| ::oController:oClientesEntidadesController:activateDialogView() }, ::oController:oClientesEntidadesController:getImage( "16" ) )
      oPanel:AddLink( "Descuentos...",          {|| ::oController:oDescuentosController:activateDialogView( ::oController:getUuid() ) }, ::oController:oDescuentosController:getImage( "16" ) )
   end

   oPanel            := ::oExplorerBar:AddPanel( "Otros datos", nil, 1 )

   if ::oController:isNotZoomMode()
      oPanel:AddLink( "Campos extra...",        {|| ::oController:oCamposExtraValoresController:Edit( ::oController:getUuid() ) }, ::oController:oCamposExtraValoresController:getImage( "16" ) )
   end

RETURN ( self )



static FUNCTION ClientesView_changeBloqueo( ) ; local Self AS CLASS ClientesView := QSelf() AS CLASS ClientesView

   if ::oController:oModel:hBuffer[ "bloqueado" ]

      hSet( ::oController:oModel:hBuffer, "fecha_bloqueo", date() )
      ::oGetFechaBloqueo:Show()

      ::oGetCausaBloqueo:Show()

   else

      hSet( ::oController:oModel:hBuffer, "fecha_bloqueo", cTod( "" ) )
      ::oGetFechaBloqueo:Hide()

      hSet( ::oController:oModel:hBuffer, "causa_bloqueo", Space( 100 ) )
      ::oGetCausaBloqueo:Hide()

   end

   ::oGetFechaBloqueo:Refresh()

   ::oGetCausaBloqueo:Refresh()

Return ( self )



static FUNCTION ClientesView_loadFechaLlamada( ) ; local Self AS CLASS ClientesView := QSelf() AS CLASS ClientesView

   hSet( ::oController:oModel:hBuffer, "fecha_ultima_llamada", date() )

   ::oGetFechaUltimaLlamada:Refresh()

Return ( self )



static FUNCTION ClientesView_changeAutorizacioncredito( ) ; local Self AS CLASS ClientesView := QSelf() AS CLASS ClientesView

   if ::oController:oModel:hBuffer[ "autorizado_venta_credito" ]

      ::oGetFechaPeticion:Show()
      ::oGetFechaConcesion:Show()
      ::oBloqueoRiesgo:Show()
      ::oRiesgo:Show()
      ::oRiesgoAlcanzado:Show()

   else

      hSet( ::oController:oModel:hBuffer, "fecha_peticion_riesgo", cTod( "" ) )
      hSet( ::oController:oModel:hBuffer, "fecha_concesion_riesgo", cTod( "" ) )
      hSet( ::oController:oModel:hBuffer, "riesgo", 0 )

      ::oGetFechaPeticion:Hide()
      ::oGetFechaConcesion:Hide()
      ::oBloqueoRiesgo:Hide()
      ::oRiesgo:Hide()
      ::oRiesgoAlcanzado:Hide()

   end

   ::oGetFechaPeticion:Refresh()
   ::oGetFechaConcesion:Refresh()
   ::oBloqueoRiesgo:Refresh()
   ::oRiesgo:Refresh()
   ::oRiesgoAlcanzado:Refresh()

Return ( self )
