#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 14 ".\.\Prg\Components.prg"
_HB_CLASS DialogBuilder ; function DialogBuilder ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "DialogBuilder", iif( .F., { }, { @HBObject() } ), @DialogBuilder() ) ) ;

   _HB_MEMBER { aComponents } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aComponents"}, .F. )

   _HB_MEMBER { nView } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nView"}, .F. )

   _HB_MEMBER { oDlg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDlg"}, .F. )

   _HB_MEMBER End(); oClass:AddInline( "End", {|Self | ( ( Self ) ), ( ::oDlg:end() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER addComponent(); oClass:AddInline( "addComponent", {|Self, oComponent | ( ( Self ) ), ( aAdd( ::aComponents, oComponent ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS DialogBuilder ;



_HB_CLASS ResourceBuilder ; function ResourceBuilder ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ResourceBuilder", iif( .T., { @DialogBuilder() }, { @HBObject() } ), @ResourceBuilder() ) ) ;

   _HB_MEMBER { bInit } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bInit"}, .F. )
   _HB_MEMBER { bWhile } ; oClass:AddMultiData(, {|| .T. }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bWhile"}, .F. )
   _HB_MEMBER { bFor } ; oClass:AddMultiData(, {|| .T. }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bFor"}, .F. )
   _HB_MEMBER { bAction } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bAction"}, .F. )
   _HB_MEMBER { bSkip } ; oClass:AddMultiData(, {|| .T. }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bSkip"}, .F. )
   _HB_MEMBER { bExit } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bExit"}, .F. )
   _HB_MEMBER { bStart } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bStart"}, .F. )

   _HB_MEMBER { nTotalPrinted } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nTotalPrinted"}, .F. )

   _HB_MEMBER { oSerieInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSerieInicio"}, .F. )
   _HB_MEMBER { oSerieFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSerieFin"}, .F. )

   _HB_MEMBER { oDocumentoInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDocumentoInicio"}, .F. )
   _HB_MEMBER { oDocumentoFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDocumentoFin"}, .F. )

   _HB_MEMBER { oSufijoInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSufijoInicio"}, .F. )
   _HB_MEMBER { oSufijoFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSufijoFin"}, .F. )

   _HB_MEMBER { oClienteInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oClienteInicio"}, .F. )
   _HB_MEMBER { oClienteFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oClienteFin"}, .F. )

   _HB_MEMBER { oAgenteInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAgenteInicio"}, .F. )
   _HB_MEMBER { oAgenteFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAgenteFin"}, .F. )

   _HB_MEMBER { oGrupoClienteInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoClienteInicio"}, .F. )
   _HB_MEMBER { oGrupoClienteFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoClienteFin"}, .F. )

   _HB_MEMBER { oProveedorInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oProveedorInicio"}, .F. )
   _HB_MEMBER { oProveedorFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oProveedorFin"}, .F. )

   _HB_MEMBER { oGrupoProveedorInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoProveedorInicio"}, .F. )
   _HB_MEMBER { oGrupoProveedorFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoProveedorFin"}, .F. )

   _HB_MEMBER { oFechaInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFechaInicio"}, .F. )
   _HB_MEMBER { oFechaFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFechaFin"}, .F. )

   _HB_MEMBER { oImpresora } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oImpresora"}, .F. )

   _HB_MEMBER { oCopias } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oCopias"}, .F. )

   _HB_MEMBER { oFormatoDocumento } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFormatoDocumento"}, .F. )

   _HB_MEMBER Serie(); oClass:AddInline( "Serie", {|Self, cSerie | ( ( Self ) ), ( ::oSerieInicio:cText( cSerie ), ::oSerieFin:cText( cSerie ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Documento(); oClass:AddInline( "Documento", {|Self, cDocumento | ( ( Self ) ), ( ::oDocumentoInicio:cText( cDocumento ), ::oDocumentoFin:cText( cDocumento ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Sufijo(); oClass:AddInline( "Sufijo", {|Self, cSufijo | ( ( Self ) ), ( ::oSufijoInicio:cText( cSufijo ), ::oSufijoFin:cText( cSufijo ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER FormatoDocumento(); oClass:AddInline( "FormatoDocumento", {|Self, cFormato | ( ( Self ) ), ( ::oFormatoDocumento:cText( cFormato ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER DocumentoInicio(); oClass:AddInline( "DocumentoInicio", {|Self | ( ( Self ) ), ( ::oSerieInicio:Value() + str( ::oDocumentoInicio:Value(), 9 ) + ::oSufijoInicio:Value() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER DocumentoFin(); oClass:AddInline( "DocumentoFin", {|Self | ( ( Self ) ), ( ::oSerieFin:Value() + str( ::oDocumentoFin:Value(), 9 ) + ::oSufijoFin:Value() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )



   _HB_MEMBER InRangeDocumento(); oClass:AddInline( "InRangeDocumento", {|Self, uValue | ( ( Self ) ), ( empty( uValue ) .OR. ( uValue >= ::DocumentoInicio() .AND. uValue <= ::DocumentoFin() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER InRangeCliente(); oClass:AddInline( "InRangeCliente", {|Self, uValue | ( ( Self ) ), ( empty( uValue ) .OR. ( uValue >= ::oClienteInicio:Value() .AND. uValue <= ::oClienteFin:Value() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER InRangeGrupoCliente(); oClass:AddInline( "InRangeGrupoCliente", {|Self, uValue | ( ( Self ) ), ( empty( uValue ) .OR. ( uValue >= ::oGrupoClienteInicio:Value() .AND. uValue <= ::oGrupoClienteFin:Value() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER InRangeAgente(); oClass:AddInline( "InRangeAgente", {|Self, uValue | ( ( Self ) ), ( empty( uValue ) .OR. ( uValue >= ::oAgenteInicio:Value() .AND. uValue <= ::oAgenteFin:Value() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER InRangeProveedor(); oClass:AddInline( "InRangeProveedor", {|Self, uValue | ( ( Self ) ), ( empty( uValue ) .OR. ( uValue >= ::oProveedorInicio:Value() .AND. uValue <= ::oProveedorFin:Value() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER InRangeGrupoProveedor(); oClass:AddInline( "InRangeGrupoProveedor", {|Self, uValue | ( ( Self ) ), ( empty( uValue ) .OR. ( uValue >= ::oGrupoProveedorInicio:Value() .AND. uValue <= ::oGrupoProveedorFin:Value() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER InRangeFecha(); oClass:AddInline( "InRangeFecha", {|Self, uValue | ( ( Self ) ), ( empty( uValue ) .OR. ( uValue >= ::oFechaInicio:Value() .AND. uValue <= ::oFechaFin:Value() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ResourceBuilder ;



_HB_CLASS PrintSeries ; function PrintSeries ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "PrintSeries", iif( .T., { @ResourceBuilder() }, { @HBObject() } ), @PrintSeries() ) ) ;

   _HB_MEMBER { lShowAgentes } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lShowAgentes"}, .F. )

   _HB_MEMBER New( nView); oClass:AddMethod( "New", @PrintSeries_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetCompras(); oClass:AddMethod( "SetCompras", @PrintSeries_SetCompras(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER SetVentas(); oClass:AddMethod( "SetVentas", @PrintSeries_SetVentas(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setPrinter(); oClass:AddInline( "setPrinter", {|Self, cPrinter | ( ( Self ) ), ( if( !empty( ::oImpresora ), ::oImpresora:set( cPrinter ), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @PrintSeries_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER StartResource(); oClass:AddMethod( "StartResource", @PrintSeries_StartResource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER ActionResource(); oClass:AddMethod( "ActionResource", @PrintSeries_ActionResource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER DisableRange(); oClass:AddMethod( "DisableRange", @PrintSeries_DisableRange(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS PrintSeries ;



static FUNCTION PrintSeries_New( nView ) ; local Self AS CLASS PrintSeries := QSelf() AS CLASS PrintSeries

   ::nView                 := nView

   ::oSerieInicio          := GetSerie():New( 100, Self )
   ::oSerieFin             := GetSerie():New( 110, Self )

   ::oDocumentoInicio      := GetNumero():New( 120, Self )
   ::oDocumentoFin         := GetNumero():New( 130, Self )

   ::oSufijoInicio         := GetSufijo():New( 140, Self )
   ::oSufijoFin            := GetSufijo():New( 150, Self )


   ::oFechaInicio          := GetFecha():New( 210, Self )
   ::oFechaInicio:FirstDayYear()

   ::oFechaFin             := GetFecha():New( 220, Self )

   ::oFormatoDocumento     := GetDocumentoComponent():New( 90, 91, 92, Self )

   ::oImpresora            := GetPrinter():New( 160, 161, Self )

   ::oCopias               := GetCopias():New( 170, 180, Self )

RETURN ( Self )



static FUNCTION PrintSeries_SetCompras( ) ; local Self AS CLASS PrintSeries := QSelf() AS CLASS PrintSeries



   ::oProveedorInicio      := GetProveedor():New( 300, 310, 301, Self )
   ::oProveedorInicio:SetText( "Desde proveedor" )
   ::oProveedorInicio:First()

   ::oProveedorFin         := GetProveedor():New( 320, 330, 321, Self )
   ::oProveedorFin:SetText( "Hasta proveedor" )
   ::oProveedorFin:Last()



   ::oGrupoProveedorInicio := GetGrupoProveedor():New( 340, 350, 341, Self )
   ::oGrupoProveedorInicio:SetText( "Desde grupo proveedor" )
   ::oGrupoProveedorInicio:First()

   ::oGrupoProveedorFin    := GetGrupoProveedor():New( 360, 370, 361, Self )
   ::oGrupoProveedorFin:SetText( "Hasta grupo proveedor" )
   ::oGrupoProveedorFin:Last()

   ::oAgenteInicio         := GetAgente():New( 400, 410, 401, Self )
   ::oAgenteFin            := GetAgente():New( 420, 430, 421, Self )

   ::lShowAgentes          := .F.

Return ( Self )



static FUNCTION PrintSeries_SetVentas( ) ; local Self AS CLASS PrintSeries := QSelf() AS CLASS PrintSeries



   ::oClienteInicio        := GetCliente():New( 300, 310, 301, Self )
   ::oClienteInicio:SetText( "Desde cliente" )
   ::oClienteInicio:First()

   ::oClienteFin           := GetCliente():New( 320, 330, 321, Self )
   ::oClienteFin:SetText( "Hasta cliente" )
   ::oClienteFin:Last()



   ::oAgenteInicio        := GetAgente():New( 400, 410, 401, Self )
   ::oAgenteInicio:SetText( "Desde agente" )
   ::oAgenteInicio:First()

   ::oAgenteFin           := GetAgente():New( 420, 430, 421, Self )
   ::oAgenteFin:SetText( "Hasta agente" )
   ::oAgenteFin:Last()



   ::oGrupoClienteInicio   := GetGrupoCliente():New( 340, 350, 341, Self )
   ::oGrupoClienteInicio:SetText( "Desde grupo cliente" )
   ::oGrupoClienteInicio:First()

   ::oGrupoClienteFin      := GetGrupoCliente():New( 360, 370, 361, Self )
   ::oGrupoClienteFin:SetText( "Hasta grupo cliente" )
   ::oGrupoClienteFin:Last()

Return ( Self )



static FUNCTION PrintSeries_Resource( ) ; local Self AS CLASS PrintSeries := QSelf() AS CLASS PrintSeries

   local oBmp

   ::oDlg = TDialog():New(,,,, "Imprimir series de documentos", "ImprimirSeries",, .F.,,,,,, .F.,,,,,, .F.,, "::oDlg", nil, )





   oBmp := TBitmap():ReDefine( 500, "gc_printer2_48",, ::oDlg,,, .F., .F.,,, .F.,,, .T. )

   aEval( ::aComponents, {| o | o:Resource(::oDlg) } )




   TButton():ReDefine( 1, {||( ::ActionResource() )}, ::oDlg,,, .F.,,,, .F. )




   TButton():ReDefine( 2, {||( ::oDlg:end() )}, ::oDlg,,, .F.,,,, .F. )

   ::oDlg:AddFastKey( 116, {|| ::ActionResource() } )

   ::oDlg:bStart  := {|| ::StartResource() }

   ::oDlg:Activate( ::oDlg:bLClicked, ::oDlg:bMoved, ::oDlg:bPainted, .T.,,,, ::oDlg:bRClicked,,, )

   oBmp:end()

RETURN ( Self )



static FUNCTION PrintSeries_StartResource( ) ; local Self AS CLASS PrintSeries := QSelf() AS CLASS PrintSeries



   if !empty( ::oClienteInicio )
      ::oClienteInicio:Valid()
   end

   if !empty( ::oClienteFin )
      ::oClienteFin:Valid()
   end

   if !empty( ::oAgenteInicio )
      if ::lShowAgentes
         ::oAgenteInicio:Valid()
      else
         ::oAgenteInicio:Hide()
      end
   end

   if !empty( ::oAgenteFin )
      if ::lShowAgentes
         ::oAgenteFin:Valid()
      else
         ::oAgenteFin:Hide()
      end
   end

   if !empty( ::oGrupoClienteInicio )
      ::oGrupoClienteInicio:Valid()
   end

   if !empty( ::oGrupoClienteFin )
      ::oGrupoClienteFin:Valid()
   end



   if !empty( ::oProveedorInicio )
      ::oProveedorInicio:Valid()
   end

   if !empty( ::oProveedorFin )
      ::oProveedorFin:Valid()
   end

   if !empty( ::oGrupoProveedorInicio )
      ::oGrupoProveedorInicio:Valid()
   end

   if !empty( ::oGrupoProveedorFin )
      ::oGrupoProveedorFin:Valid()
   end

   ::oFormatoDocumento:Valid()

   if !empty( ::bStart )
      Eval( ::bStart )
   end

RETURN ( Self )



static FUNCTION PrintSeries_ActionResource( ) ; local Self AS CLASS PrintSeries := QSelf() AS CLASS PrintSeries

   local nRecno
   local nOrdAnt

   ::nTotalPrinted   := 0

   ::oDlg:disable()

   if !empty( ::bInit )
      eval( ::bInit )
   end

   while eval( ::bWhile )

      if eval( ::bFor )

         if !empty( ::bAction )
            eval( ::bAction )
            ++::nTotalPrinted
         end

      end

      eval( ::bSkip )

   end

   if !empty( ::bExit )
      eval( ::bExit )
   end

   ::oDlg:enable()
   ::oDlg:end( 1 )

RETURN ( Self )



static FUNCTION PrintSeries_DisableRange( ) ; local Self AS CLASS PrintSeries := QSelf() AS CLASS PrintSeries

   ::oSerieInicio:Disable()
   ::oSerieFin:Disable()

   ::oDocumentoInicio:Disable()
   ::oDocumentoFin:Disable()

   ::oSufijoInicio:Disable()
   ::oSufijoFin:Disable()

   ::oClienteInicio:Disable()
   ::oClienteFin:Disable()

   ::oGrupoClienteInicio:Disable()
   ::oGrupoClienteFin:Disable()

   ::oFechaInicio:Disable()
   ::oFechaFin:Disable()

RETURN ( Self )



_HB_CLASS ImportarProductosProveedor ; function ImportarProductosProveedor ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ImportarProductosProveedor", iif( .T., { @PrintSeries() }, { @HBObject() } ), @ImportarProductosProveedor() ) ) ;

   _HB_MEMBER { oPorcentaje } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPorcentaje"}, .F. )

   _HB_MEMBER { oProceso } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oProceso"}, .F. )

   _HB_MEMBER New( nView); oClass:AddMethod( "New", @ImportarProductosProveedor_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @ImportarProductosProveedor_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ActionResource(); oClass:AddMethod( "ActionResource", @ImportarProductosProveedor_ActionResource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ImportarProductosProveedor ;



static FUNCTION ImportarProductosProveedor_New( nView ) ; local Self AS CLASS ImportarProductosProveedor := QSelf() AS CLASS ImportarProductosProveedor

   ::nView                 := nView

   ::oFechaInicio          := GetFecha():New( 100, Self )
   ::oFechaInicio:FirstDayPreviusMonth()

   ::oFechaFin             := GetFecha():New( 110, Self )
   ::oFechaFin:LastDayPreviusMonth()

   ::oPorcentaje           := GetPorcentaje():New( 120, Self )

   ::oProceso              := nil

RETURN ( Self )



static FUNCTION ImportarProductosProveedor_Resource( ) ; local Self AS CLASS ImportarProductosProveedor := QSelf() AS CLASS ImportarProductosProveedor

   ::oDlg = TDialog():New(,,,,, "ImportarProductosProveedor",, .F.,,,,,, .F.,,,,,, .F.,, "::oDlg", nil, )

   aEval( ::aComponents, {| o | o:Resource(::oDlg) } )




   TButton():ReDefine( 1, {||( ::ActionResource() )}, ::oDlg,,, .F.,,,, .F. )




   TButton():ReDefine( 2, {||( ::oDlg:end() )}, ::oDlg,,, .F.,,,, .F. )

   ::oDlg:AddFastKey( 116, {|| ::ActionResource() } )

   ::oDlg:Activate( ::oDlg:bLClicked, ::oDlg:bMoved, ::oDlg:bPainted, .T.,,,, ::oDlg:bRClicked,,, )

RETURN ( Self )



static FUNCTION ImportarProductosProveedor_ActionResource( ) ; local Self AS CLASS ImportarProductosProveedor := QSelf() AS CLASS ImportarProductosProveedor

   ::oDlg:disable()

      if !empty( ::bAction )
         eval( ::bAction )
      end

   ::oDlg:enable()
   ::oDlg:end( 1 )

RETURN ( Self )





_HB_CLASS Component ; function Component ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "Component", iif( .F., { }, { @HBObject() } ), @Component() ) ) ;

   _HB_MEMBER { oContainer } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oContainer"}, .F. )

   _HB_MEMBER New( oContainer); oClass:AddMethod( "New", @Component_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS Component ;

static FUNCTION Component_New( oContainer ) ; local Self AS CLASS Component := QSelf() AS CLASS Component

   if !empty( oContainer )
      ::oContainer   := oContainer
      ::oContainer:AddComponent( Self )
   end

Return ( Self )





_HB_CLASS ComponentGet ; function ComponentGet ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ComponentGet", iif( .T., { @Component() }, { @HBObject() } ), @ComponentGet() ) ) ;

   _HB_MEMBER { idGet } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idGet"}, .F. )
   _HB_MEMBER { idSay } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idSay"}, .F. )

   _HB_MEMBER { bValid } ; oClass:AddMultiData(, {|| .T. }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bValid"}, .F. )
   _HB_MEMBER { bHelp } ; oClass:AddMultiData(, {|| .T. }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bHelp"}, .F. )
   _HB_MEMBER { bWhen } ; oClass:AddMultiData(, {|| .T. }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bWhen"}, .F. )

   _HB_MEMBER { oGetControl } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetControl"}, .F. )
   _HB_MEMBER { uGetValue } ; oClass:AddMultiData(, Space( 12 ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"uGetValue"}, .F. )

   _HB_MEMBER New( idGet, oContainer); oClass:AddMethod( "New", @ComponentGet_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @ComponentGet_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER cText(); oClass:AddInline( "cText", {|Self, uGetValue | ( ( Self ) ), ( if( !empty( ::oGetControl ), ::oGetControl:cText( uGetValue ), ), ::uGetValue := uGetValue ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER varGet(); oClass:AddInline( "varGet", {|Self | ( ( Self ) ), ( ::oGetControl:varGet() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Value(); oClass:AddInline( "Value", {|Self | ( ( Self ) ), ( ::uGetValue ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Valid(); oClass:AddInline( "Valid", {|Self | ( ( Self ) ), ( if( !empty( ::oGetControl ), ::oGetControl:lValid(), .T. ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Disable(); oClass:AddInline( "Disable", {|Self | ( ( Self ) ), ( ::oGetControl:Disable() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Enable(); oClass:AddInline( "Enable", {|Self | ( ( Self ) ), ( ::oGetControl:Enable() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ComponentGet ;

static FUNCTION ComponentGet_New( idGet, oContainer ) ; local Self AS CLASS ComponentGet := QSelf() AS CLASS ComponentGet

   ::idGet  := idGet

   ::Super:New( oContainer )

RETURN ( Self )

static FUNCTION ComponentGet_Resource( oDlg ) ; local Self AS CLASS ComponentGet := QSelf() AS CLASS ComponentGet





   ::oGetControl := TGetHlp():ReDefine( ::idGet, { | u | If( PCount()==0, ::uGetValue, ::uGetValue:= u ) }, oDlg,,,,,,,,, .F.,,, .F., .F.,,,,,, nil, "LUPA",, )

   ::oGetControl:bValid    := ::bValid
   ::oGetControl:bHelp     := ::bHelp
   ::oGetControl:bWhen     := ::bWhen

Return ( Self )






_HB_CLASS ComponentSay ; function ComponentSay ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ComponentSay", iif( .T., { @Component() }, { @HBObject() } ), @ComponentSay() ) ) ;

   _HB_MEMBER { idSay } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idSay"}, .F. )

   _HB_MEMBER { oSayControl } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayControl"}, .F. )
   _HB_MEMBER { uSayValue } ; oClass:AddMultiData(, Space( 12 ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"uSayValue"}, .F. )

   _HB_MEMBER New( idSay, oContainer); oClass:AddMethod( "New", @ComponentSay_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @ComponentSay_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER cText(); oClass:AddInline( "cText", {|Self, uSayValue | ( ( Self ) ), ( if( !empty( ::oSayControl ), ::oSayControl:SetText( uSayValue ), ::uSayValue := uSayValue ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Value(); oClass:AddInline( "Value", {|Self | ( ( Self ) ), ( ::uSayValue ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Disable(); oClass:AddInline( "Disable", {|Self | ( ( Self ) ), ( ::oSayControl:Disable() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Enable(); oClass:AddInline( "Enable", {|Self | ( ( Self ) ), ( ::oSayControl:Enable() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ComponentSay ;

static FUNCTION ComponentSay_New( idSay, oContainer ) ; local Self AS CLASS ComponentSay := QSelf() AS CLASS ComponentSay

   ::idSay        := idSay

   ::Super:New( oContainer )

RETURN ( Self )

static FUNCTION ComponentSay_Resource( oDlg ) ; local Self AS CLASS ComponentSay := QSelf() AS CLASS ComponentSay




   ::oSayControl := TSay():ReDefine( ::idSay, {||      ::uSayValue}, oDlg,,,, .F.,, .F., .F., )

Return ( Self )






_HB_CLASS ComponentCheck ; function ComponentCheck ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ComponentCheck", iif( .T., { @Component() }, { @HBObject() } ), @ComponentCheck() ) ) ;

   _HB_MEMBER { idCheck } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idCheck"}, .F. )

   _HB_MEMBER { oCheckControl } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oCheckControl"}, .F. )
   _HB_MEMBER { uCheckValue } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"uCheckValue"}, .F. )

   _HB_MEMBER { bWhen } ; oClass:AddMultiData(, {|| .T. }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bWhen"}, .F. )

   _HB_MEMBER New( idCheck, lDefault, oContainer); oClass:AddMethod( "New", @ComponentCheck_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @ComponentCheck_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Value(); oClass:AddInline( "Value", {|Self | ( ( Self ) ), ( ::uCheckValue ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Disable(); oClass:AddInline( "Disable", {|Self | ( ( Self ) ), ( ::oCheckControl:Disable() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Enable(); oClass:AddInline( "Enable", {|Self | ( ( Self ) ), ( ::oCheckControl:Enable() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ComponentCheck ;

static FUNCTION ComponentCheck_New( idCheck, lDefault, oContainer ) ; local Self AS CLASS ComponentCheck := QSelf() AS CLASS ComponentCheck

   If( lDefault == nil, lDefault := .T., ) ;

   ::idCheck         := idCheck

   ::uCheckValue     := lDefault

   ::Super:New( oContainer )

RETURN ( Self )

static FUNCTION ComponentCheck_Resource( oDlg ) ; local Self AS CLASS ComponentCheck := QSelf() AS CLASS ComponentCheck




   ::oCheckControl := TCheckBox():ReDefine( ::idCheck, { | u | If( PCount()==0, ::uCheckValue, ::uCheckValue:= u ) }, oDlg,,,,,,, .F.,, .F. )

   ::oCheckControl:bWhen     := ::bWhen

Return ( Self )






_HB_CLASS ComponentUrlLink ; function ComponentUrlLink ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ComponentUrlLink", iif( .T., { @Component() }, { @HBObject() } ), @ComponentUrlLink() ) ) ;

   _HB_MEMBER { idUrlLink } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idUrlLink"}, .F. )
   _HB_MEMBER { bAction } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bAction"}, .F. )
   _HB_MEMBER { cCaption } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCaption"}, .F. )

   _HB_MEMBER { oUrlLinkControl } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oUrlLinkControl"}, .F. )

   _HB_MEMBER New( idCheck, oContainer); oClass:AddMethod( "New", @ComponentUrlLink_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @ComponentUrlLink_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Disable(); oClass:AddInline( "Disable", {|Self | ( ( Self ) ), ( ::oUrlLinkControl:Disable() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Enable(); oClass:AddInline( "Enable", {|Self | ( ( Self ) ), ( ::oUrlLinkControl:Enable() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ComponentUrlLink ;

static FUNCTION ComponentUrlLink_New( idUrlLink, bAction, cCaption, oContainer ) ; local Self AS CLASS ComponentUrlLink := QSelf() AS CLASS ComponentUrlLink

   ::idUrlLink    := idUrlLink
   ::bAction      := bAction
   ::cCaption     := cCaption

   ::Super:New( oContainer )

RETURN ( Self )

static FUNCTION ComponentUrlLink_Resource( oDlg ) ; local Self AS CLASS ComponentUrlLink := QSelf() AS CLASS ComponentUrlLink

   ::oUrlLinkControl          := TURLLink():ReDefine( ::idUrlLink, oDlg, , ::cCaption, ::cCaption )
   ::oUrlLinkControl:bAction  := ::bAction

Return ( Self )






_HB_CLASS SayCompras ; function SayCompras ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "SayCompras", iif( .T., { @ComponentSay() }, { @HBObject() } ), @SayCompras() ) ) ;

   _HB_MEMBER New( idSay, oContainer); oClass:AddMethod( "New", @SayCompras_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @SayCompras_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS SayCompras ;

static FUNCTION SayCompras_New( idSay, oContainer ) ; local Self AS CLASS SayCompras := QSelf() AS CLASS SayCompras

   ::Super:New( idSay, oContainer )

   ::uSayValue    := 0

RETURN ( Self )

static FUNCTION SayCompras_Resource( oDlg ) ; local Self AS CLASS SayCompras := QSelf() AS CLASS SayCompras





   ::oSayControl := TSay():ReDefine( ::idSay, {||      ::uSayValue}, oDlg, ( cPorDiv() ),,, .F.,, .F., .F., )

Return ( Self )






_HB_CLASS ComponentGetSay ; function ComponentGetSay ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ComponentGetSay", iif( .T., { @ComponentGet() }, { @HBObject() } ), @ComponentGetSay() ) ) ;

   _HB_MEMBER { idSay } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idSay"}, .F. )
   _HB_MEMBER { idText } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idText"}, .F. )

   _HB_MEMBER { oSayControl } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayControl"}, .F. )
   _HB_MEMBER { cSayValue } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSayValue"}, .F. )

   _HB_MEMBER { oTextControl } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTextControl"}, .F. )
   _HB_MEMBER { cTextValue } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTextValue"}, .F. )

   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @ComponentGetSay_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @ComponentGetSay_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )



   _HB_MEMBER Show(); oClass:AddInline( "Show", {|Self | ( ( Self ) ), ( if( !empty( ::oGetControl ), ::oGetControl:Show(), ), if( !empty( ::oSayControl ), ::oSayControl:Show(), ), if( !empty( ::oTextControl ), ::oTextControl:Show(), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER Hide(); oClass:AddInline( "Hide", {|Self | ( ( Self ) ), ( if( !empty( ::oGetControl ), ::oGetControl:Hide(), ), if( !empty( ::oSayControl ), ::oSayControl:Hide(), ), if( !empty( ::oTextControl ), ::oTextControl:Hide(), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetText(); oClass:AddInline( "SetText", {|Self, cText | ( ( Self ) ), ( if( !empty( ::oTextControl ), ::oTextControl:SetText( cText ), ::cTextValue := cText ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ComponentGetSay ;



static FUNCTION ComponentGetSay_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS ComponentGetSay := QSelf() AS CLASS ComponentGetSay

   ::idSay        := idSay
   ::idText       := idText

   ::Super:New( idGet, oContainer )

RETURN ( Self )



static FUNCTION ComponentGetSay_Resource( oDlg ) ; local Self AS CLASS ComponentGetSay := QSelf() AS CLASS ComponentGetSay

   ::Super:Resource( oDlg )





   ::oSayControl := TGetHlp():ReDefine( ::idSay, { | u | If( PCount()==0, ::cSayValue, ::cSayValue:= u ) }, oDlg,,,,,,,,, .F., {||        ( .F. )},, .F., .F.,,,,,, nil,,, )

   if !empty( ::idText )




   ::oTextControl := TSay():ReDefine( ::idText, {||      ::cTextValue}, oDlg,,,, .F.,, .F., .F., )

   end

Return ( Self )







_HB_CLASS GetCombo ; function GetCombo ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetCombo", iif( .T., { @Component() }, { @HBObject() } ), @GetCombo() ) ) ;

   _HB_MEMBER { oControl } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oControl"}, .F. )

   _HB_MEMBER { idCombo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idCombo"}, .F. )

   _HB_MEMBER { uValue } ; oClass:AddMultiData(, "Combo", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"uValue"}, .F. )
   _HB_MEMBER { aValues } ; oClass:AddMultiData(, {"Combo"}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aValues"}, .F. )

   _HB_MEMBER { bChange } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bChange"}, .F. )

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetCombo_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER New( idGet, uValue, aValues, oContainer); oClass:AddMethod( "New", @GetCombo_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @GetCombo_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Value(); oClass:AddInline( "Value", {|Self | ( ( Self ) ), ( eval( ::oControl:bSetGet ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Disable(); oClass:AddInline( "Disable", {|Self | ( ( Self ) ), ( ::oControl:Disable() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Enable(); oClass:AddInline( "Enable", {|Self | ( ( Self ) ), ( ::oControl:Enable() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetChange(); oClass:AddInline( "SetChange", {|Self, bChange | ( ( Self ) ), ( if( isBlock( bChange ), ::bChange := bChange, ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Change(); oClass:AddInline( "Change", {|Self | ( ( Self ) ), ( if( isBlock( ::bChange ), eval( ::bChange ), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setWhen(); oClass:AddInline( "setWhen", {|Self, bWhen | ( ( Self ) ), ( if( isBlock( bWhen ), ::oControl:bWhen := bWhen, ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetCombo ;



static FUNCTION GetCombo_Build( hBuilder ) ; local Self AS CLASS GetCombo := QSelf() AS CLASS GetCombo

   local idCombo     := if( hhaskey( hBuilder, "idCombo" ),    hBuilder[ "idCombo"   ], nil )
   local uValue      := if( hhaskey( hBuilder, "uValue"),      hBuilder[ "uValue"    ], nil )
   local aValues     := if( hhaskey( hBuilder, "aValues"),     hBuilder[ "aValues"   ], nil )
   local oContainer  := if( hhaskey( hBuilder, "oContainer"),  hBuilder[ "oContainer"], nil )

   ::New( idCombo, uValue, aValues, oContainer )

Return ( Self )

static FUNCTION GetCombo_New( idCombo, uValue, aValues, oContainer ) ; local Self AS CLASS GetCombo := QSelf() AS CLASS GetCombo

   ::idCombo      := idCombo
   ::uValue       := uValue

   if !empty( aValues )
      ::aValues   := aValues
   end

   ::Super:New( oContainer )

RETURN ( Self )

static FUNCTION GetCombo_Resource( oDlg ) ; local Self AS CLASS GetCombo := QSelf() AS CLASS GetCombo





   ::oControl := TComboBox():ReDefine( ::idCombo, { | u | If( PCount()==0, ::uValue, ::uValue:= u ) }, ::aValues, oDlg,,,,,,, .F.,,,,,,, "::oControl",,,,,,, )

   ::oControl:bChange      := {|| ::Change() }

Return ( Self )








_HB_CLASS comboTarifa ; function comboTarifa ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "comboTarifa", iif( .T., { @GetCombo() }, { @HBObject() } ), @comboTarifa() ) ) ;

   _HB_MEMBER { idCombo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idCombo"}, .F. )
   _HB_MEMBER { uValue } ; oClass:AddMultiData(, "Combo", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"uValue"}, .F. )
   _HB_MEMBER { aValues } ; oClass:AddMultiData(, {"Combo"}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aValues"}, .F. )
   _HB_MEMBER { oControl } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oControl"}, .F. )

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @comboTarifa_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getTarifa(); oClass:AddMethod( "getTarifa", @comboTarifa_getTarifa(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER setTarifa(); oClass:AddInline( "setTarifa", {|Self, nTarifa | ( ( Self ) ), ( ::oControl:set( ::getTarifaNombre( nTarifa ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getTarifaNombre( nTarifa); oClass:AddMethod( "getTarifaNombre", @comboTarifa_getTarifaNombre(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER varGet(); oClass:AddInline( "varGet", {|Self | ( ( Self ) ), ( ::oControl:varGet() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS comboTarifa ;



static FUNCTION comboTarifa_Build( hBuilder ) ; local Self AS CLASS comboTarifa := QSelf() AS CLASS comboTarifa

   local idCombo     := if( hhaskey( hBuilder, "idCombo" ),    hBuilder[ "idCombo"   ], nil )
   local uValue      := if( hhaskey( hBuilder, "uValue"),      hBuilder[ "uValue"    ], nil )
   local oContainer  := if( hhaskey( hBuilder, "oContainer"),  hBuilder[ "oContainer"], nil )

   ::aValues         := aNombreTarifas()

   uValue            := ::getTarifaNombre( uValue )

   ::New( idCombo, uValue )

Return ( Self )



static FUNCTION comboTarifa_getTarifa( ) ; local Self AS CLASS comboTarifa := QSelf() AS CLASS comboTarifa

   local n

   for n := 1 to 6
      if uFieldEmpresa( "lShwTar" + alltrim( str( n ) ) )
         if !empty( alltrim( uFieldEmpresa( "cTxtTar" + alltrim( str( n ) ) ) ))
            if alltrim( uFieldEmpresa( "cTxtTar" + alltrim( str( n ) ) ) ) == ::VarGet()
               Return ( n )
            end
         else
            if ( "Precio " + alltrim( str( n ) ) ) == ::VarGet()
               Return( n )
            end
         end

      endif
   next

Return ( 1 )



static FUNCTION comboTarifa_getTarifaNombre( nTarifa ) ; local Self AS CLASS comboTarifa := QSelf() AS CLASS comboTarifa

   local cTarifaNombre  := ""

   if aScan( ::aValues, uFieldEmpresa( "cTxtTar" + alltrim( str( nTarifa ) ) ) ) <> 0
      cTarifaNombre     := uFieldEmpresa( "cTxtTar" + alltrim( str( nTarifa ) ) )
   end








Return ( cTarifaNombre )








_HB_CLASS ComponentGetSayDatabase ; function ComponentGetSayDatabase ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ComponentGetSayDatabase", iif( .T., { @ComponentGetSay() }, { @HBObject() } ), @ComponentGetSayDatabase() ) ) ;

   _HB_MEMBER { nView } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nView"}, .F. )

   _HB_MEMBER getView(); oClass:AddInline( "getView", {|Self | ( ( Self ) ), ( if( empty( ::nView ), ::oContainer:nView, ::nView ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER setView(); oClass:AddInline( "setView", {|Self, nView | ( ( Self ) ), ( ::nView := nView ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ComponentGetSayDatabase ;



_HB_CLASS GetCliente ; function GetCliente ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetCliente", iif( .T., { @ComponentGetSayDatabase() }, { @HBObject() } ), @GetCliente() ) ) ;

   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @GetCliente_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetCliente_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER First(); oClass:AddInline( "First", {|Self | ( ( Self ) ), ( ::cText( Space( RetNumCodCliEmp() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Last(); oClass:AddInline( "Last", {|Self | ( ( Self ) ), ( ::cText( Replicate( "Z", RetNumCodCliEmp() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Top(); oClass:AddInline( "Top", {|Self | ( ( Self ) ), ( ::cText( D():Top( "Client", ::oContainer:nView ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Bottom(); oClass:AddInline( "Bottom", {|Self | ( ( Self ) ), ( ::cText( D():Bottom( "Client", ::oContainer:nView ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetCliente ;

static FUNCTION GetCliente_Build( hBuilder ) ; local Self AS CLASS GetCliente := QSelf() AS CLASS GetCliente

   local idGet          := if( hhaskey( hBuilder, "idGet" ),      hBuilder[ "idGet"  ], nil )
   local idSay          := if( hhaskey( hBuilder, "idSay" ),      hBuilder[ "idSay"  ], nil )
   local idText         := if( hhaskey( hBuilder, "idText" ),     hBuilder[ "idText" ], nil )
   local oContainer     := if( hhaskey( hBuilder, "oContainer" ), hBuilder[ "oContainer" ], nil )

   ::New( idGet, idSay, idText, oContainer )

Return ( Self )



static FUNCTION GetCliente_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS GetCliente := QSelf() AS CLASS GetCliente

   ::cTextValue   := "Cliente"

   ::Super:New( idGet, idSay, idText, oContainer )

   ::bValid       := {|| cClient( ::oGetControl, D():Clientes( ::getView() ), ::oSayControl ) }
   ::bHelp        := {|| BrwClient( ::oGetControl, ::oSayControl ) }

Return ( Self )



_HB_CLASS GetAgente ; function GetAgente ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetAgente", iif( .T., { @ComponentGetSayDatabase() }, { @HBObject() } ), @GetAgente() ) ) ;

   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @GetAgente_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetAgente_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER First(); oClass:AddInline( "First", {|Self | ( ( Self ) ), ( ::cText( space( 3 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Last(); oClass:AddInline( "Last", {|Self | ( ( Self ) ), ( ::cText( replicate( "Z", 3 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Top(); oClass:AddInline( "Top", {|Self | ( ( Self ) ), ( ::cText( D():Top( "Agentes", ::oContainer:nView ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Bottom(); oClass:AddInline( "Bottom", {|Self | ( ( Self ) ), ( ::cText( D():Bottom( "Agentes", ::oContainer:nView ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetAgente ;

static FUNCTION GetAgente_Build( hBuilder ) ; local Self AS CLASS GetAgente := QSelf() AS CLASS GetAgente

   local idGet          := if( hhaskey( hBuilder, "idGet" ),      hBuilder[ "idGet"  ], nil )
   local idSay          := if( hhaskey( hBuilder, "idSay" ),      hBuilder[ "idSay"  ], nil )
   local idText         := if( hhaskey( hBuilder, "idText" ),     hBuilder[ "idText" ], nil )
   local oContainer     := if( hhaskey( hBuilder, "oContainer" ), hBuilder[ "oContainer" ], nil )

   ::New( idGet, idSay, idText, oContainer )

Return ( Self )



static FUNCTION GetAgente_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS GetAgente := QSelf() AS CLASS GetAgente

   ::cTextValue   := "Agentes"

   ::Super:New( idGet, idSay, idText, oContainer )

   ::bValid       := {|| cAgentes( ::oGetControl, D():Agentes( ::getView() ), ::oSayControl ) }
   ::bHelp        := {|| BrwAgentes( ::oGetControl, ::oSayControl ) }

Return ( Self )





_HB_CLASS GetGrupoCliente ; function GetGrupoCliente ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetGrupoCliente", iif( .T., { @ComponentGetSay() }, { @HBObject() } ), @GetGrupoCliente() ) ) ;

   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @GetGrupoCliente_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER First(); oClass:AddInline( "First", {|Self | ( ( Self ) ), ( ::cText( Space( 4 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Last(); oClass:AddInline( "Last", {|Self | ( ( Self ) ), ( ::cText( Replicate( "Z", 4 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Top(); oClass:AddInline( "Top", {|Self | ( ( Self ) ), ( ::cText( D():GetObject( "GruposClientes", ::oContainer:nView ):Top() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Bottom(); oClass:AddInline( "Bottom", {|Self | ( ( Self ) ), ( ::cText( D():GetObject( "GruposClientes", ::oContainer:nView ):Bottom() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetGrupoCliente ;

static FUNCTION GetGrupoCliente_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS GetGrupoCliente := QSelf() AS CLASS GetGrupoCliente

   ::Super:New( idGet, idSay, idText, oContainer )

   ::uGetValue    := Space( 4 )

   ::bValid       := {|| D():objectGruposClientes( ::oContainer:nView ):Existe( ::oGetControl, ::oSayControl, "cNomGrp", .T., .T., "0" ) }
   ::bHelp        := {|| D():objectGruposClientes( ::oContainer:nView ):Buscar( ::oGetControl ) }

Return ( Self )





_HB_CLASS GetDocumentoComponent ; function GetDocumentoComponent ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetDocumentoComponent", iif( .T., { @ComponentGetSay() }, { @HBObject() } ), @GetDocumentoComponent() ) ) ;

   _HB_MEMBER { idBtn } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idBtn"}, .F. )
   _HB_MEMBER { cTypeDocumento } ; oClass:AddMultiData(, Space( 2 ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTypeDocumento"}, .F. )

   _HB_MEMBER New( idGet, idSay, idBtn, oContainer); oClass:AddMethod( "New", @GetDocumentoComponent_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @GetDocumentoComponent_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER TypeDocumento(); oClass:AddInline( "TypeDocumento", {|Self, cType | ( ( Self ) ), ( if( !empty( cType ), ::cTypeDocumento := cType, ::cTypeDocumento ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetDocumentoComponent ;

static FUNCTION GetDocumentoComponent_New( idGet, idSay, idBtn, oContainer ) ; local Self AS CLASS GetDocumentoComponent := QSelf() AS CLASS GetDocumentoComponent

   ::Super:New( idGet, idSay, nil, oContainer )

   ::idBtn        := idBtn

   ::uGetValue    := Space( 3 )

   ::bValid       := {|| cDocumento( ::oGetControl, ::oSayControl, D():Documentos( ::oContainer:nView ) ) }
   ::bHelp        := {|| brwDocumento( ::oGetControl, ::oSayControl, ::TypeDocumento() ) }

Return ( Self )

static FUNCTION GetDocumentoComponent_Resource( oDlg ) ; local Self AS CLASS GetDocumentoComponent := QSelf() AS CLASS GetDocumentoComponent

   ::Super:Resource(oDlg)

   TBtnBmp():ReDefine( ::idBtn, "gc_document_text_pencil_12",,,,,{|| EdtDocumento( ::uGetValue ) }, oDlg, .F., , .F.,  )

Return ( Self )





_HB_CLASS GetPrinter ; function GetPrinter ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetPrinter", iif( .T., { @ComponentGet() }, { @HBObject() } ), @GetPrinter() ) ) ;

   _HB_MEMBER { idBtn } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idBtn"}, .F. )

   _HB_MEMBER { cTypeDocumento } ; oClass:AddMultiData(, Space( 2 ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTypeDocumento"}, .F. )

   _HB_MEMBER New( idGet, oContainer); oClass:AddMethod( "New", @GetPrinter_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @GetPrinter_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER TypeDocumento(); oClass:AddInline( "TypeDocumento", {|Self, cType | ( ( Self ) ), ( if( !empty( cType ), ::cTypeDocumento := cType, ::cTypeDocumento ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER set( cPrinter); oClass:AddMethod( "set", @GetPrinter_set(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetPrinter ;



static FUNCTION GetPrinter_New( idGet, idBtn, oContainer ) ; local Self AS CLASS GetPrinter := QSelf() AS CLASS GetPrinter

   ::Super:New( idGet, oContainer )

   ::idBtn        := idBtn

   ::uGetValue    := ImpresoraDefectoUsuario()

Return ( Self )



static FUNCTION GetPrinter_Resource( oDlg ) ; local Self AS CLASS GetPrinter := QSelf() AS CLASS GetPrinter





   ::oGetControl := TComboBox():ReDefine( ::idGet, { | u | If( PCount()==0, ::uGetValue, ::uGetValue:= u ) }, aGetPrinters(), oDlg,,,,,,, .F.,,,,,,, "::oGetControl",,,,,,, )

Return ( Self )



static FUNCTION GetPrinter_set( cPrinter ) ; local Self AS CLASS GetPrinter := QSelf() AS CLASS GetPrinter

   if !empty( ::oGetControl )
      ::oGetControl:set( cPrinter )
   end

   ::uGetValue    := cPrinter

Return ( Self )





_HB_CLASS GetSerie ; function GetSerie ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetSerie", iif( .T., { @ComponentGet() }, { @HBObject() } ), @GetSerie() ) ) ;

   _HB_MEMBER New( idGet, oContainer); oClass:AddMethod( "New", @GetSerie_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @GetSerie_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetSerie ;

static FUNCTION GetSerie_New( idGet, oContainer ) ; local Self AS CLASS GetSerie := QSelf() AS CLASS GetSerie

   ::Super:New( idGet, oContainer )

   ::uGetValue    := "A"

Return ( Self )

static FUNCTION GetSerie_Resource( oDlg ) ; local Self AS CLASS GetSerie := QSelf() AS CLASS GetSerie









   ::oGetControl := TGetHlp():ReDefine( ::idGet, { | u | If( PCount()==0, ::uGetValue, ::uGetValue:= u ) }, oDlg,, "@!",,,,,,, .T.,,, .F., .T., {||       ( UpSerie( ::oGetControl ) )}, {||     ( DwSerie( ::oGetControl ) )},,,, nil,,, )

   ::oGetControl:bValid    := {|| if( ::oGetControl:varGet() >= "A" .AND. ::oGetControl:varGet() <= "Z", .T., ( msgStop( "La serie no es valida" ), .F. ) ) }

Return ( Self )






_HB_CLASS GetNumero ; function GetNumero ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetNumero", iif( .T., { @ComponentGet() }, { @HBObject() } ), @GetNumero() ) ) ;

   _HB_MEMBER New( idGet, oContainer); oClass:AddMethod( "New", @GetNumero_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @GetNumero_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetPicture(); oClass:AddMethod( "SetPicture", @GetNumero_SetPicture(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetNumero ;

static FUNCTION GetNumero_New( idGet, oContainer ) ; local Self AS CLASS GetNumero := QSelf() AS CLASS GetNumero

   ::Super:New( idGet, oContainer )

   ::uGetValue    := 1

   ::bValid       := {|| ::uGetValue >= 1 .AND. ::uGetValue <= 999999999 }

Return ( Self )

static FUNCTION GetNumero_Resource( oDlg ) ; local Self AS CLASS GetNumero := QSelf() AS CLASS GetNumero







   ::oGetControl := TGetHlp():ReDefine( ::idGet, { | u | If( PCount()==0, ::uGetValue, ::uGetValue:= u ) }, oDlg,, "999999999", {||       ::bValid},,,,,, .F.,,, .F., .T.,,,,,, nil,,, )

Return ( Self )

static FUNCTION GetNumero_SetPicture( cPicture ) ; local Self AS CLASS GetNumero := QSelf() AS CLASS GetNumero

   ::oGetControl:oGet:Assign()
   ::oGetControl:oGet:Picture   := cPicture
   ::oGetControl:oGet:UpdateBuffer()

Return ( Self )






_HB_CLASS GetSufijo ; function GetSufijo ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetSufijo", iif( .T., { @ComponentGet() }, { @HBObject() } ), @GetSufijo() ) ) ;

   _HB_MEMBER New( idGet, oContainer); oClass:AddMethod( "New", @GetSufijo_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDlg); oClass:AddMethod( "Resource", @GetSufijo_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetSufijo ;

static FUNCTION GetSufijo_New( idGet, oContainer ) ; local Self AS CLASS GetSufijo := QSelf() AS CLASS GetSufijo

   ::Super:New( idGet, oContainer )

   ::uGetValue    := RetSufEmp()

Return ( Self )

static FUNCTION GetSufijo_Resource( oDlg ) ; local Self AS CLASS GetSufijo := QSelf() AS CLASS GetSufijo





   ::oGetControl := TGetHlp():ReDefine( ::idGet, { | u | If( PCount()==0, ::uGetValue, ::uGetValue:= u ) }, oDlg,, "@!",,,,,,, .F.,,, .F., .F.,,,,,, nil,,, )

Return ( Self )






_HB_CLASS GetFecha ; function GetFecha ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetFecha", iif( .T., { @ComponentGet() }, { @HBObject() } ), @GetFecha() ) ) ;

   _HB_MEMBER New( idGet, oContainer); oClass:AddMethod( "New", @GetFecha_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @GetFecha_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FirstDayLastYear(); oClass:AddInline( "FirstDayLastYear", {|Self | ( ( Self ) ), ( ::cText( ctod( "01/01/" + str( year( GetSysDate() ) - 1 ) ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FirstDayYear(); oClass:AddInline( "FirstDayYear", {|Self | ( ( Self ) ), ( ::cText( BoY( date() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER LastDayYear(); oClass:AddInline( "LastDayYear", {|Self | ( ( Self ) ), ( ::cText( EoY( date() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FirstDayMonth(); oClass:AddInline( "FirstDayMonth", {|Self | ( ( Self ) ), ( ::cText( BoM( date() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER LastDayMonth(); oClass:AddInline( "LastDayMonth", {|Self | ( ( Self ) ), ( ::cText( EoM( date() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FirstDayPreviusMonth(); oClass:AddInline( "FirstDayPreviusMonth", {|Self | ( ( Self ) ), ( ::cText( BoM( AddMonth( date(), -1 ) ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER LastDayPreviusMonth(); oClass:AddInline( "LastDayPreviusMonth", {|Self | ( ( Self ) ), ( ::cText( EoM( AddMonth( date(), -1 ) ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetFecha ;

static FUNCTION GetFecha_New( idGet, oContainer ) ; local Self AS CLASS GetFecha := QSelf() AS CLASS GetFecha

   ::Super:New( idGet, oContainer )

   ::uGetValue    := Date()

Return ( Self )

static FUNCTION GetFecha_Resource( oDlg ) ; local Self AS CLASS GetFecha := QSelf() AS CLASS GetFecha





   ::oGetControl := TGetHlp():ReDefine( ::idGet, { | u | If( PCount()==0, ::uGetValue, ::uGetValue:= u ) }, oDlg,,,,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )

Return ( Self )






_HB_CLASS GetPeriodo ; function GetPeriodo ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetPeriodo", iif( .T., { @ComponentGet() }, { @HBObject() } ), @GetPeriodo() ) ) ;

   _HB_MEMBER { oComboPeriodo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oComboPeriodo"}, .F. )

   _HB_MEMBER { oFechaInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFechaInicio"}, .F. )
   _HB_MEMBER { oFechaFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFechaFin"}, .F. )

   _HB_MEMBER { cPeriodo } ; oClass:AddMultiData(, "Ao anterior y en curso", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPeriodo"}, .F. )
   _HB_MEMBER { aPeriodo } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aPeriodo"}, .F. )

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetPeriodo_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER New( idCombo, idFechaInicio, idFechaFin, oContainer); oClass:AddMethod( "New", @GetPeriodo_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CambiaPeriodo(); oClass:AddMethod( "CambiaPeriodo", @GetPeriodo_CambiaPeriodo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CargaPeriodo(); oClass:AddMethod( "CargaPeriodo", @GetPeriodo_CargaPeriodo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oContainer); oClass:AddMethod( "Resource", @GetPeriodo_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getFechaInicio(); oClass:AddInline( "getFechaInicio", {|Self | ( ( Self ) ), ( ::oFechaInicio:Value() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getFechaFin(); oClass:AddInline( "getFechaFin", {|Self | ( ( Self ) ), ( ::oFechaFin:Value() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER inRange(); oClass:AddInline( "inRange", {|Self, uValue | ( ( Self ) ), ( uValue >= ::getFechaInicio() .AND. uValue <= ::getFechaFin() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetPeriodo ;

static FUNCTION GetPeriodo_Build( hBuilder ) ; local Self AS CLASS GetPeriodo := QSelf() AS CLASS GetPeriodo

   local idCombo        := if( hhaskey( hBuilder, "idCombo" ),       hBuilder[ "idCombo"        ], nil )
   local idFechaInicio  := if( hhaskey( hBuilder, "idFechaInicio"),  hBuilder[ "idFechaInicio"  ], nil )
   local idFechaFin     := if( hhaskey( hBuilder, "idFechaFin"),     hBuilder[ "idFechaFin"     ], nil )
   local oContainer     := if( hhaskey( hBuilder, "oContainer"),     hBuilder[ "oContainer"     ], nil )

   ::New( idCombo, idFechaInicio, idFechaFin, oContainer )

Return ( Self )

static FUNCTION GetPeriodo_New( idCombo, idFechaInicio, idFechaFin, oContainer ) ; local Self AS CLASS GetPeriodo := QSelf() AS CLASS GetPeriodo

   ::CargaPeriodo()

   ::oComboPeriodo            := GetCombo():New( idCombo, ::cPeriodo, ::aPeriodo, oContainer )
   ::oComboPeriodo:SetChange( {|| ::CambiaPeriodo() } )

   ::oFechaInicio             := GetFecha():New( idFechaInicio, oContainer )
   ::oFechaInicio:FirstDayLastYear()

   ::oFechaFin                := GetFecha():New( idFechaFin, oContainer )

Return ( Self )

static FUNCTION GetPeriodo_Resource( oContainer ) ; local Self AS CLASS GetPeriodo := QSelf() AS CLASS GetPeriodo

   ::oComboPeriodo:Resource( oContainer )
   ::oFechaInicio:Resource( oContainer )
   ::oFechaFin:Resource( oContainer )

Return ( Self )

static FUNCTION GetPeriodo_CargaPeriodo( ) ; local Self AS CLASS GetPeriodo := QSelf() AS CLASS GetPeriodo

   ::aPeriodo                 := {}

   aAdd( ::aPeriodo, "Hoy" )
   aAdd( ::aPeriodo, "Ayer" )
   aAdd( ::aPeriodo, "Mes en curso" )
   aAdd( ::aPeriodo, "Mes anterior" )
   aAdd( ::aPeriodo, "Primer trimestre" )
   aAdd( ::aPeriodo, "Segundo trimestre" )
   aAdd( ::aPeriodo, "Tercer trimestre" )
   aAdd( ::aPeriodo, "Cuatro trimestre" )
   aAdd( ::aPeriodo, "Doce ltimos meses" )
   aAdd( ::aPeriodo, "Ao anterior y en curso" )
   aAdd( ::aPeriodo, "Ao en curso" )
   aAdd( ::aPeriodo, "Ao anterior" )

RETURN ( Self )



static FUNCTION GetPeriodo_CambiaPeriodo( ) ; local Self AS CLASS GetPeriodo := QSelf() AS CLASS GetPeriodo

   local cPeriodo    := ::oComboPeriodo:Value()

   do case
      case cPeriodo == "Hoy"

         ::oFechaInicio:cText( GetSysDate() )
         ::oFechaFin:cText( GetSysDate() )

      case cPeriodo == "Ayer"

         ::oFechaInicio:cText( GetSysDate() -1 )
         ::oFechaFin:cText( GetSysDate() -1 )

      case cPeriodo == "Mes en curso"

         ::oFechaInicio:cText( CtoD( "01/" + Str( Month( GetSysDate() ) ) + "/" + Str( Year( GetSysDate() ) ) ) )
         ::oFechaFin:cText( GetSysDate() )

      case cPeriodo == "Mes anterior"

         ::oFechaInicio:cText( BoM( addMonth( GetSysDate(), - 1 ) ) )
         ::oFechaFin:cText( EoM( addMonth( GetSysDate(), - 1 ) ) )

      case cPeriodo == "Primer trimestre"

         ::oFechaInicio:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) ) ) )
         ::oFechaFin:cText( CtoD( "31/03/" + Str( Year( GetSysDate() ) ) ) )

      case cPeriodo == "Segundo trimestre"

         ::oFechaInicio:cText( CtoD( "01/04/" + Str( Year( GetSysDate() ) ) ) )
         ::oFechaFin:cText( CtoD( "30/06/" + Str( Year( GetSysDate() ) ) ) )

      case cPeriodo == "Tercer trimestre"

         ::oFechaInicio:cText( CtoD( "01/07/" + Str( Year( GetSysDate() ) ) ) )
         ::oFechaFin:cText( CtoD( "30/09/" + Str( Year( GetSysDate() ) ) ) )

      case cPeriodo == "Cuatro trimestre"

         ::oFechaInicio:cText( CtoD( "01/10/" + Str( Year( GetSysDate() ) ) ) )
         ::oFechaFin:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case cPeriodo == "Doce ltimos meses"

         ::oFechaInicio:cText( BoY( GetSysDate() ) )
         ::oFechaFin:cText( EoY( GetSysDate() ) )

      case cPeriodo == "Ao anterior y en curso"

         ::oFechaInicio:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) - 1 ) ) )
         ::oFechaFin:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case cPeriodo == "Ao en curso"

         ::oFechaInicio:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) ) ) )
         ::oFechaFin:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case cPeriodo == "Ao anterior"

         ::oFechaInicio:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) - 1 ) ) )
         ::oFechaFin:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) - 1 ) ) )

   end

RETURN ( .T. )






_HB_CLASS GetRangoCliente ; function GetRangoCliente ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetRangoCliente", iif( .T., { @Component() }, { @HBObject() } ), @GetRangoCliente() ) ) ;

   _HB_MEMBER { oAll } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAll"}, .F. )
   _HB_MEMBER { oInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oInicio"}, .F. )
   _HB_MEMBER { oFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFin"}, .F. )

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetRangoCliente_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER New( idAll, idGetInicio, idSayInicio, idTextInicio, idGetFin, idSayFin, idTextFin, oContainer); oClass:AddMethod( "New", @GetRangoCliente_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oContainer); oClass:AddMethod( "Resource", @GetRangoCliente_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER InRange(); oClass:AddInline( "InRange", {|Self, uValue | ( ( Self ) ), ( ::oAll:Value() .OR. ( uValue >= ::oInicio:Value() .AND. uValue <= ::oFin:Value() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetRangoCliente ;

static FUNCTION GetRangoCliente_Build( hBuilder ) ; local Self AS CLASS GetRangoCliente := QSelf() AS CLASS GetRangoCliente

   local idAll          := if( hhaskey( hBuilder, "idAll" ),         hBuilder[ "idAll"        ], nil )
   local idGetInicio    := if( hhaskey( hBuilder, "idGetInicio" ),   hBuilder[ "idGetInicio"  ], nil )
   local idSayInicio    := if( hhaskey( hBuilder, "idSayInicio" ),   hBuilder[ "idSayInicio"  ], nil )
   local idTextInicio   := if( hhaskey( hBuilder, "idTextInicio" ),  hBuilder[ "idTextInicio" ], nil )
   local idGetFin       := if( hhaskey( hBuilder, "idGetFin" ),      hBuilder[ "idGetFin"     ], nil )
   local idSayFin       := if( hhaskey( hBuilder, "idSayFin" ),      hBuilder[ "idSayFin"     ], nil )
   local idTextFin      := if( hhaskey( hBuilder, "idTextFin" ),     hBuilder[ "idTextFin"    ], nil )
   local oContainer     := if( hhaskey( hBuilder, "oContainer" ),    hBuilder[ "oContainer"   ], nil )

   ::New( idAll, idGetInicio, idSayInicio, idTextInicio, idGetFin, idSayFin, idTextFin, oContainer )

Return ( Self )

static FUNCTION GetRangoCliente_New( idAll, idGetInicio, idSayInicio, idTextInicio, idGetFin, idSayFin, idTextFin, oContainer ) ; local Self AS CLASS GetRangoCliente := QSelf() AS CLASS GetRangoCliente

   ::oAll           := ComponentCheck():New( idAll, .T., oContainer )

   ::oInicio        := GetCliente():New( idGetInicio, idSayInicio, idTextInicio, oContainer )
   ::oInicio:SetText( "Desde" )
   ::oInicio:First()
   ::oInicio:bWhen  := {|| !::oAll:Value() }

   ::oFin           := GetCliente():New( idGetFin, idSayFin, idTextFin, oContainer )
   ::oFin:SetText( "Hasta" )
   ::oFin:Last()
   ::oFin:bWhen     := {|| !::oAll:Value() }

Return ( Self )

static FUNCTION GetRangoCliente_Resource( oDialog ) ; local Self AS CLASS GetRangoCliente := QSelf() AS CLASS GetRangoCliente

   ::oAll:Resource( oDialog )
   ::oInicio:Resource( oDialog )
   ::oFin:Resource( oDialog )

Return ( Self )






_HB_CLASS GetRangoGrupoCliente ; function GetRangoGrupoCliente ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetRangoGrupoCliente", iif( .T., { @Component() }, { @HBObject() } ), @GetRangoGrupoCliente() ) ) ;

   _HB_MEMBER { oAll } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAll"}, .F. )
   _HB_MEMBER { oInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oInicio"}, .F. )
   _HB_MEMBER { oFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFin"}, .F. )

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetRangoGrupoCliente_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER New( idAll, idGetInicio, idSayInicio, idTextInicio, idGetFin, idSayFin, idTextFin, oContainer); oClass:AddMethod( "New", @GetRangoGrupoCliente_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oContainer); oClass:AddMethod( "Resource", @GetRangoGrupoCliente_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER InRange(); oClass:AddInline( "InRange", {|Self, uValue | ( ( Self ) ), ( ::oAll:Value() .OR. ( uValue >= ::oInicio:Value() .AND. uValue <= ::oFin:Value() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetRangoGrupoCliente ;

static FUNCTION GetRangoGrupoCliente_Build( hBuilder ) ; local Self AS CLASS GetRangoGrupoCliente := QSelf() AS CLASS GetRangoGrupoCliente

   local idAll          := if( hhaskey( hBuilder, "idAll" ),         hBuilder[ "idAll"        ], nil )
   local idGetInicio    := if( hhaskey( hBuilder, "idGetInicio" ),   hBuilder[ "idGetInicio"  ], nil )
   local idSayInicio    := if( hhaskey( hBuilder, "idSayInicio" ),   hBuilder[ "idSayInicio"  ], nil )
   local idTextInicio   := if( hhaskey( hBuilder, "idTextInicio" ),  hBuilder[ "idTextInicio" ], nil )
   local idGetFin       := if( hhaskey( hBuilder, "idGetFin" ),      hBuilder[ "idGetFin"     ], nil )
   local idSayFin       := if( hhaskey( hBuilder, "idSayFin" ),      hBuilder[ "idSayFin"     ], nil )
   local idTextFin      := if( hhaskey( hBuilder, "idTextFin" ),     hBuilder[ "idTextFin"    ], nil )
   local oContainer     := if( hhaskey( hBuilder, "oContainer" ),    hBuilder[ "oContainer"   ], nil )

   ::New( idAll, idGetInicio, idSayInicio, idTextInicio, idGetFin, idSayFin, idTextFin, oContainer )

Return ( Self )

static FUNCTION GetRangoGrupoCliente_New( idAll, idGetInicio, idSayInicio, idTextInicio, idGetFin, idSayFin, idTextFin, oContainer ) ; local Self AS CLASS GetRangoGrupoCliente := QSelf() AS CLASS GetRangoGrupoCliente

   ::oAll           := ComponentCheck():New( idAll, .T., oContainer )

   ::oInicio        := GetGrupoCliente():New( idGetInicio, idSayInicio, idTextInicio, oContainer )
   ::oInicio:SetText( "Desde" )
   ::oInicio:First()
   ::oInicio:bWhen  := {|| !::oAll:Value() }

   ::oFin           := GetGrupoCliente():New( idGetFin, idSayFin, idTextFin, oContainer )
   ::oFin:SetText( "Hasta" )
   ::oFin:Last()
   ::oFin:bWhen     := {|| !::oAll:Value() }

Return ( Self )

static FUNCTION GetRangoGrupoCliente_Resource( oDialog ) ; local Self AS CLASS GetRangoGrupoCliente := QSelf() AS CLASS GetRangoGrupoCliente

   ::oAll:Resource( oDialog )
   ::oInicio:Resource( oDialog )
   ::oFin:Resource( oDialog )

Return ( Self )






_HB_CLASS GetRangoSeries ; function GetRangoSeries ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetRangoSeries", iif( .T., { @Component() }, { @HBObject() } ), @GetRangoSeries() ) ) ;

   _HB_MEMBER { oTodas } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTodas"}, .F. )
   _HB_MEMBER { oNinguna } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oNinguna"}, .F. )
   _HB_MEMBER { hObjectSerie } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"hObjectSerie"}, .F. )

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetRangoSeries_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER New( idTodas, idNinguna, idInicio, oContainer); oClass:AddMethod( "New", @GetRangoSeries_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( oDialog); oClass:AddMethod( "Resource", @GetRangoSeries_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SelectAll(); oClass:AddInline( "SelectAll", {|Self | ( ( Self ) ), ( if( !empty( ::hObjectSerie ), hEval( ::hObjectSerie, {| h, o, i | o:uCheckValue := .T., o:oCheckControl:Refresh() } ), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER UnselectAll(); oClass:AddInline( "UnselectAll", {|Self | ( ( Self ) ), ( if( !empty( ::hObjectSerie ), hEval( ::hObjectSerie, {| h, o, i | o:uCheckValue := .F., o:oCheckControl:Refresh() } ), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER InRange( uValue); oClass:AddMethod( "InRange", @GetRangoSeries_InRange(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetRangoSeries ;

static FUNCTION GetRangoSeries_Build( hBuilder ) ; local Self AS CLASS GetRangoSeries := QSelf() AS CLASS GetRangoSeries

   local idTodas        := if( hhaskey( hBuilder, "idTodas" ),          hBuilder[ "idTodas"        ], nil )
   local idNinguna      := if( hhaskey( hBuilder, "idNinguna" ),        hBuilder[ "idNinguna"      ], nil )
   local idInicio       := if( hhaskey( hBuilder, "idInicio" ),         hBuilder[ "idInicio"       ], nil )
   local bActionTodas   := if( hhaskey( hBuilder, "bActionTodas" ),     hBuilder[ "bActionTodas"   ], nil )
   local bActionNinguna := if( hhaskey( hBuilder, "bActionNinguna" ),   hBuilder[ "bActionNinguna" ], nil )
   local oContainer     := if( hhaskey( hBuilder, "oContainer" ),       hBuilder[ "oContainer"     ], nil )

   ::New( idTodas, idNinguna, idInicio, oContainer )

Return ( Self )

static FUNCTION GetRangoSeries_New( idTodas, idNinguna, idInicio, oContainer ) ; local Self AS CLASS GetRangoSeries := QSelf() AS CLASS GetRangoSeries

   ::oTodas          := ComponentUrlLink():New( idTodas, {|| ::SelectAll() }, "Todas", oContainer )
   ::oNinguna        := ComponentUrlLink():New( idNinguna, {|| ::UnselectAll() }, "Ninguna", oContainer )


























   ::hObjectSerie    := { "A"  =>  ComponentCheck():New( idInicio, .T., oContainer ), "B"  =>  ComponentCheck():New( idInicio + 1, .T., oContainer ), "C"  =>  ComponentCheck():New( idInicio + 2, .T., oContainer ), "D"  =>  ComponentCheck():New( idInicio + 3, .T., oContainer ), "E"  =>  ComponentCheck():New( idInicio + 4, .T., oContainer ), "F"  =>  ComponentCheck():New( idInicio + 5, .T., oContainer ), "G"  =>  ComponentCheck():New( idInicio + 6, .T., oContainer ), "H"  =>  ComponentCheck():New( idInicio + 7, .T., oContainer ), "I"  =>  ComponentCheck():New( idInicio + 8, .T., oContainer ), "J"  =>  ComponentCheck():New( idInicio + 9, .T., oContainer ), "K"  =>  ComponentCheck():New( idInicio + 10, .T., oContainer ), "L"  =>  ComponentCheck():New( idInicio + 11, .T., oContainer ), "M"  =>  ComponentCheck():New( idInicio + 12, .T., oContainer ), "N"  =>  ComponentCheck():New( idInicio + 13, .T., oContainer ), "O"  =>  ComponentCheck():New( idInicio + 14, .T., oContainer ), "P"  =>  ComponentCheck():New( idInicio + 15, .T., oContainer ), "Q"  =>  ComponentCheck():New( idInicio + 16, .T., oContainer ), "R"  =>  ComponentCheck():New( idInicio + 17, .T., oContainer ), "S"  =>  ComponentCheck():New( idInicio + 18, .T., oContainer ), "T"  =>  ComponentCheck():New( idInicio + 19, .T., oContainer ), "U"  =>  ComponentCheck():New( idInicio + 20, .T., oContainer ), "V"  =>  ComponentCheck():New( idInicio + 21, .T., oContainer ), "W"  =>  ComponentCheck():New( idInicio + 22, .T., oContainer ), "X"  =>  ComponentCheck():New( idInicio + 23, .T., oContainer ), "Y"  =>  ComponentCheck():New( idInicio + 24, .T., oContainer ), "Z"  =>  ComponentCheck():New( idInicio + 25, .T., oContainer ) }

Return ( Self )

static FUNCTION GetRangoSeries_Resource( oDialog ) ; local Self AS CLASS GetRangoSeries := QSelf() AS CLASS GetRangoSeries

   ::oTodas:Resource( oDialog )
   ::oNinguna:Resource( oDialog )

   if !empty( ::hObjectSerie )

      hEval( ::hObjectSerie, {| h, o, i | o:Resource( oDialog ) } )

   end

Return ( Self )

static FUNCTION GetRangoSeries_InRange( uValue ) ; local Self AS CLASS GetRangoSeries := QSelf() AS CLASS GetRangoSeries

   local value    := .F.

   if empty( uValue )
      Return .F.
   end

   if !( isChar( uValue ) )
      Return .F.
   end

   uValue         := upper( uValue )

   if !empty( ::hObjectSerie )

      if !( hb_hhaskey( ::hObjectSerie, uValue ) )
         Return .F.
      end

      value       := hGet( ::hObjectSerie, uValue ):Value()

   end

return ( value )






_HB_CLASS GetCopias ; function GetCopias ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetCopias", iif( .T., { @ComponentGet() }, { @HBObject() } ), @GetCopias() ) ) ;

   _HB_MEMBER { idCheck } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idCheck"}, .F. )

   _HB_MEMBER { lCopiasPredeterminadas } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lCopiasPredeterminadas"}, .F. )

   _HB_MEMBER New( idGet, oContainer); oClass:AddMethod( "New", @GetCopias_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @GetCopias_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetCopias ;

static FUNCTION GetCopias_New( idCheck, idGet, oContainer ) ; local Self AS CLASS GetCopias := QSelf() AS CLASS GetCopias

   ::Super:New( idGet, oContainer )

   ::idCheck      := idCheck

   ::uGetValue    := 1

   ::bValid       := {|| ::uGetValue >= 1 .AND. ::uGetValue <= 99999 }

Return ( Self )

static FUNCTION GetCopias_Resource( oDlg ) ; local Self AS CLASS GetCopias := QSelf() AS CLASS GetCopias



   TCheckBox():ReDefine( ::idCheck, { | u | If( PCount()==0, ::lCopiasPredeterminadas, ::lCopiasPredeterminadas:= u ) }, oDlg,,,,,,, .F.,, .F. )








   ::oGetControl := TGetHlp():ReDefine( ::idGet, { | u | If( PCount()==0, ::uGetValue, ::uGetValue:= u ) }, oDlg,, "99999", {||       ::bValid},,,,,, .F., {||        !::lCopiasPredeterminadas},, .F., .T.,,,,,, nil,,, )

Return ( Self )



_HB_CLASS GetPorcentaje ; function GetPorcentaje ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetPorcentaje", iif( .T., { @ComponentGet() }, { @HBObject() } ), @GetPorcentaje() ) ) ;

   _HB_MEMBER { idGet } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idGet"}, .F. )

   _HB_MEMBER New( idGet, oContainer); oClass:AddMethod( "New", @GetPorcentaje_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @GetPorcentaje_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetPorcentaje ;

static FUNCTION GetPorcentaje_New( idGet, oContainer ) ; local Self AS CLASS GetPorcentaje := QSelf() AS CLASS GetPorcentaje

   ::Super:New( idGet, oContainer )

   ::uGetValue    := 0

   ::bValid       := {|| ::uGetValue >= 0 .AND. ::uGetValue <= 100 }

Return ( Self )

static FUNCTION GetPorcentaje_Resource( oDlg ) ; local Self AS CLASS GetPorcentaje := QSelf() AS CLASS GetPorcentaje







   ::oGetControl := TGetHlp():ReDefine( ::idGet, { | u | If( PCount()==0, ::uGetValue, ::uGetValue:= u ) }, oDlg,, "999", {||       ::bValid},,,,,, .F.,,, .F., .T.,,,,,, nil,,, )

Return ( Self )









Function nLastDay( nMes )

   local cMes     := Str( if( nMes == 12, 1, nMes + 1 ), 2 )
   local cAno     := Str( if( nMes == 12, Year( Date() ) + 1, Year( Date() ) ) )

Return ( Ctod( "01/" + cMes + "/" + cAno ) - 1 )









_HB_CLASS GetProveedor ; function GetProveedor ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetProveedor", iif( .T., { @ComponentGetSayDatabase() }, { @HBObject() } ), @GetProveedor() ) ) ;

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetProveedor_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @GetProveedor_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER First(); oClass:AddInline( "First", {|Self | ( ( Self ) ), ( ::cText( Space( RetNumCodPrvEmp() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Last(); oClass:AddInline( "Last", {|Self | ( ( Self ) ), ( ::cText( Replicate( "Z", RetNumCodPrvEmp() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Top(); oClass:AddInline( "Top", {|Self | ( ( Self ) ), ( ::cText( D():Top( "Provee", ::getView() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Bottom(); oClass:AddInline( "Bottom", {|Self | ( ( Self ) ), ( ::cText( D():Bottom( "Provee", ::getView() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetProveedor ;



static FUNCTION GetProveedor_Build( hBuilder ) ; local Self AS CLASS GetProveedor := QSelf() AS CLASS GetProveedor

   local idGet       := if( hhaskey( hBuilder, "idGet" ),      hBuilder[ "idGet"     ], nil )
   local idSay       := if( hhaskey( hBuilder, "idSay"),       hBuilder[ "idSay"     ], nil )
   local idText      := if( hhaskey( hBuilder, "idText"),      hBuilder[ "idText"    ], nil )
   local oContainer  := if( hhaskey( hBuilder, "oContainer"),  hBuilder[ "oContainer"], nil )

   ::New( idGet, idSay, idText, oContainer )

Return ( Self )



static FUNCTION GetProveedor_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS GetProveedor := QSelf() AS CLASS GetProveedor

   ::cTextValue   := "Proveedor"

   ::Super:New( idGet, idSay, idText, oContainer )

   ::bValid       := {|| cProvee( ::oGetControl, D():Proveedores( ::getView() ), ::oSayControl ) }
   ::bHelp        := {|| BrwProvee( ::oGetControl, ::oSayControl ) }

Return ( Self )









_HB_CLASS GetEmpresa ; function GetEmpresa ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetEmpresa", iif( .T., { @ComponentGetSayDatabase() }, { @HBObject() } ), @GetEmpresa() ) ) ;

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetEmpresa_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @GetEmpresa_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Current(); oClass:AddInline( "Current", {|Self | ( ( Self ) ), ( ::cText( cCodEmp() ), ::Valid() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetEmpresa ;



static FUNCTION GetEmpresa_Build( hBuilder ) ; local Self AS CLASS GetEmpresa := QSelf() AS CLASS GetEmpresa

   local idGet       := if( hhaskey( hBuilder, "idGet" ),      hBuilder[ "idGet"     ], nil )
   local idSay       := if( hhaskey( hBuilder, "idSay"),       hBuilder[ "idSay"     ], nil )
   local idText      := if( hhaskey( hBuilder, "idText"),      hBuilder[ "idText"    ], nil )
   local oContainer  := if( hhaskey( hBuilder, "oContainer"),  hBuilder[ "oContainer"], nil )

   ::New( idGet, idSay, idText, oContainer )

Return ( Self )



static FUNCTION GetEmpresa_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS GetEmpresa := QSelf() AS CLASS GetEmpresa

   ::cTextValue   := "Empresa"

   ::Super:New( idGet, idSay, idText, oContainer )

   ::bValid       := {|| cEmpresa( ::oGetControl, D():Empresa( ::getView() ), ::oSayControl ) }
   ::bHelp        := {|| brwEmpresa( ::oGetControl, D():Empresa( ::getView() ), ::oSayControl ) }

Return ( Self )









_HB_CLASS GetArticulo ; function GetArticulo ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetArticulo", iif( .T., { @ComponentGetSayDatabase() }, { @HBObject() } ), @GetArticulo() ) ) ;

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetArticulo_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @GetArticulo_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER First(); oClass:AddInline( "First", {|Self | ( ( Self ) ), ( ::cText( Space( 18 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Last(); oClass:AddInline( "Last", {|Self | ( ( Self ) ), ( ::cText( Replicate( "Z", 18 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Top(); oClass:AddInline( "Top", {|Self | ( ( Self ) ), ( ::cText( D():Top( "Articulo", ::getView() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Bottom(); oClass:AddInline( "Bottom", {|Self | ( ( Self ) ), ( ::cText( D():Bottom( "Articulo", ::getView() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetArticulo ;



static FUNCTION GetArticulo_Build( hBuilder ) ; local Self AS CLASS GetArticulo := QSelf() AS CLASS GetArticulo

   local idGet       := if( hhaskey( hBuilder, "idGet" ),      hBuilder[ "idGet"     ], nil )
   local idSay       := if( hhaskey( hBuilder, "idSay"),       hBuilder[ "idSay"     ], nil )
   local idText      := if( hhaskey( hBuilder, "idText"),      hBuilder[ "idText"    ], nil )
   local oContainer  := if( hhaskey( hBuilder, "oContainer"),  hBuilder[ "oContainer"], nil )

   ::New( idGet, idSay, idText, oContainer )

Return ( Self )



static FUNCTION GetArticulo_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS GetArticulo := QSelf() AS CLASS GetArticulo

   ::cTextValue   := "Artculo"

   ::Super:New( idGet, idSay, idText, oContainer )

   ::bValid       := {|| cArticulo( ::oGetControl, D():Get( "Articulo", ::getView() ), ::oSayControl ) }
   ::bHelp        := {|| brwArticulo( ::oGetControl, ::oSayControl ) }

Return ( Self )









_HB_CLASS GetAlmacen ; function GetAlmacen ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetAlmacen", iif( .T., { @ComponentGetSayDatabase() }, { @HBObject() } ), @GetAlmacen() ) ) ;

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetAlmacen_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @GetAlmacen_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER First(); oClass:AddInline( "First", {|Self | ( ( Self ) ), ( ::cText( Space( 16 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Last(); oClass:AddInline( "Last", {|Self | ( ( Self ) ), ( ::cText( Replicate( "Z", 16 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Top(); oClass:AddInline( "Top", {|Self | ( ( Self ) ), ( ::cText( D():Top( "Articulo", ::getView() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Bottom(); oClass:AddInline( "Bottom", {|Self | ( ( Self ) ), ( ::cText( D():Bottom( "Articulo", ::getView() ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetAlmacen ;



static FUNCTION GetAlmacen_Build( hBuilder ) ; local Self AS CLASS GetAlmacen := QSelf() AS CLASS GetAlmacen

   local idGet       := if( hhaskey( hBuilder, "idGet" ),      hBuilder[ "idGet"     ], nil )
   local idSay       := if( hhaskey( hBuilder, "idSay"),       hBuilder[ "idSay"     ], nil )
   local idText      := if( hhaskey( hBuilder, "idText"),      hBuilder[ "idText"    ], nil )
   local oContainer  := if( hhaskey( hBuilder, "oContainer"),  hBuilder[ "oContainer"], nil )

   ::New( idGet, idSay, idText, oContainer )

Return ( Self )



static FUNCTION GetAlmacen_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS GetAlmacen := QSelf() AS CLASS GetAlmacen

   ::cTextValue   := "Almacn"

   ::Super:New( idGet, idSay, idText, oContainer )

   ::bValid       := {|| cAlmacen( ::oGetControl, D():Almacen( ::getView() ), ::oSayControl ) }
   ::bHelp        := {|| brwAlmacen( ::oGetControl, ::oSayControl ) }

Return ( Self )








_HB_CLASS GetPropiedad ; function GetPropiedad ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetPropiedad", iif( .T., { @ComponentGetSay() }, { @HBObject() } ), @GetPropiedad() ) ) ;

   _HB_MEMBER Build( hBuilder); oClass:AddMethod( "Build", @GetPropiedad_Build(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @GetPropiedad_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER First(); oClass:AddInline( "First", {|Self | ( ( Self ) ), ( ::cText( Space( 20 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Last(); oClass:AddInline( "Last", {|Self | ( ( Self ) ), ( ::cText( Replicate( "Z", 20 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetPropiedad ;



static FUNCTION GetPropiedad_Build( hBuilder ) ; local Self AS CLASS GetPropiedad := QSelf() AS CLASS GetPropiedad

   local idGet       := if( hhaskey( hBuilder, "idGet" ),      hBuilder[ "idGet"     ], nil )
   local idSay       := if( hhaskey( hBuilder, "idSay"),       hBuilder[ "idSay"     ], nil )
   local idText      := if( hhaskey( hBuilder, "idText"),      hBuilder[ "idText"    ], nil )
   local oContainer  := if( hhaskey( hBuilder, "oContainer"),  hBuilder[ "oContainer"], nil )

   ::New( idGet, idSay, idText, oContainer )

Return ( Self )



static FUNCTION GetPropiedad_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS GetPropiedad := QSelf() AS CLASS GetPropiedad

   ::Super:New( idGet, idSay, idText, oContainer )

   ::bValid       := {|| cProp( ::oGetControl, ::oSayControl ) }
   ::bHelp        := {|| brwProp( ::oGetControl, ::oSayControl ) }

Return ( Self )








_HB_CLASS GetPropiedadActual ; function GetPropiedadActual ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetPropiedadActual", iif( .T., { @GetPropiedad() }, { @HBObject() } ), @GetPropiedadActual() ) ) ;

   _HB_MEMBER { cPropiedad } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPropiedad"}, .F. )

   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @GetPropiedadActual_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER PropiedadActual(); oClass:AddInline( "PropiedadActual", {|Self, cPropiedad | ( ( Self ) ), ( iif( cPropiedad <> nil, ::cPropiedad := cPropiedad, ::cPropiedad ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetPropiedadActual ;



static FUNCTION GetPropiedadActual_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS GetPropiedadActual := QSelf() AS CLASS GetPropiedadActual

   ::Super:New( idGet, idSay, idText, oContainer )

   ::bValid       := {|| cProp( ::oGetControl, ::oSayControl ) }
   ::bHelp        := {|| brwPropiedadActual( ::oGetControl, ::oSayControl, ::PropiedadActual() ) }

Return ( Self )









_HB_CLASS GetGrupoProveedor ; function GetGrupoProveedor ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetGrupoProveedor", iif( .T., { @ComponentGetSay() }, { @HBObject() } ), @GetGrupoProveedor() ) ) ;

   _HB_MEMBER New( idGet, idSay, idText, oContainer); oClass:AddMethod( "New", @GetGrupoProveedor_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER First(); oClass:AddInline( "First", {|Self | ( ( Self ) ), ( ::cText( Space( 4 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Last(); oClass:AddInline( "Last", {|Self | ( ( Self ) ), ( ::cText( Replicate( "Z", 4 ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Top(); oClass:AddInline( "Top", {|Self | ( ( Self ) ), ( ::cText( D():GetObject( "GruposProveedores", ::oContainer:nView ):Top() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Bottom(); oClass:AddInline( "Bottom", {|Self | ( ( Self ) ), ( ::cText( D():GetObject( "GruposProveedores", ::oContainer:nView ):Bottom() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetGrupoProveedor ;

static FUNCTION GetGrupoProveedor_New( idGet, idSay, idText, oContainer ) ; local Self AS CLASS GetGrupoProveedor := QSelf() AS CLASS GetGrupoProveedor

   ::Super:New( idGet, idSay, idText, oContainer )

   ::uGetValue    := Space( 4 )

   ::bValid       := {|| D():GruposProveedores( ::oContainer:nView ):Existe( ::oGetControl, ::oSayControl, "cNomGrp", .T., .T., "0" ) }
   ::bHelp        := {|| D():GruposProveedores( ::oContainer:nView ):Buscar( ::oGetControl ) }

Return ( Self )





_HB_CLASS GetRichEdit ; function GetRichEdit ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "GetRichEdit", iif( .F., { }, { @HBObject() } ), @GetRichEdit() ) ) ;

   _HB_MEMBER { oDlg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDlg"}, .F. )

   _HB_MEMBER { oClp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oClp"}, .F. )

   _HB_MEMBER { oRTF } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oRTF"}, .F. )
   _HB_MEMBER { cRTF } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cRTF"}, .F. )

   _HB_MEMBER { oBtnPrint } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnPrint"}, .F. )
   _HB_MEMBER { oBtnPreview } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnPreview"}, .F. )
   _HB_MEMBER { oBtnSearch } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnSearch"}, .F. )
   _HB_MEMBER { oBtnCut } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnCut"}, .F. )
   _HB_MEMBER { oBtnCopy } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnCopy"}, .F. )
   _HB_MEMBER { oBtnPaste } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnPaste"}, .F. )
   _HB_MEMBER { oBtnUndo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnUndo"}, .F. )
   _HB_MEMBER { oBtnRedo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnRedo"}, .F. )
   _HB_MEMBER { oBtnBold } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnBold"}, .F. )
   _HB_MEMBER { oBtnItalics } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnItalics"}, .F. )
   _HB_MEMBER { oBtnTextAlignLeft } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnTextAlignLeft"}, .F. )
   _HB_MEMBER { oBtnTextAlignCenter } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnTextAlignCenter"}, .F. )
   _HB_MEMBER { oBtnTextAlignRight } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnTextAlignRight"}, .F. )
   _HB_MEMBER { oBtnTextJustify } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnTextJustify"}, .F. )
   _HB_MEMBER { oBtnBullet } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnBullet"}, .F. )
   _HB_MEMBER { oBtnUnderLine } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnUnderLine"}, .F. )
   _HB_MEMBER { oBtnDateTime } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnDateTime"}, .F. )
   _HB_MEMBER { oBtnCorrector } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnCorrector"}, .F. )

   _HB_MEMBER { oZoom } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oZoom"}, .F. )
   _HB_MEMBER { cZoom } ; oClass:AddMultiData(, "100%", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cZoom"}, .F. )
   _HB_MEMBER { aZoom } ; oClass:AddMultiData(, { "500%", "200%", "150%", "100%", "75%", "50%", "25%", "10%" }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aZoom"}, .F. )

   _HB_MEMBER { oFuente } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFuente"}, .F. )
   _HB_MEMBER { cFuente } ; oClass:AddMultiData(, "Courier New", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFuente"}, .F. )
   _HB_MEMBER { aFuente } ; oClass:AddMultiData(, aGetFont( oWnd() ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aFuente"}, .F. )

   _HB_MEMBER { oSize } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSize"}, .F. )
   _HB_MEMBER { cSize } ; oClass:AddMultiData(, "12", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSize"}, .F. )
   _HB_MEMBER { aSize } ; oClass:AddMultiData(, { " 6", " 7", " 8", " 9", "10", "11", "12", "13", "14", "16", "18", "20", "22", "24", "26", "28", "36", "48", "72" }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aSize"}, .F. )

   _HB_MEMBER { aRatio } ; oClass:AddMultiData(, { { 5, 1 }, { 2, 1 }, { 3, 2 }, { 1, 1 }, { 3, 4 }, { 1, 2 }, { 1, 4 }, { 1, 10 } }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aRatio"}, .F. )

   _HB_MEMBER { lItalic } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lItalic"}, .F. )
   _HB_MEMBER { lUnderline } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lUnderline"}, .F. )
   _HB_MEMBER { lBullet } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lBullet"}, .F. )
   _HB_MEMBER { lBold } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lBold"}, .F. )

   _HB_MEMBER Redefine( id, oDlg); oClass:AddMethod( "Redefine", @GetRichEdit_Redefine(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER RTFRefreshButtons(); oClass:AddMethod( "RTFRefreshButtons", @GetRichEdit_RTFRefreshButtons(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetText(); oClass:AddInline( "SetText", {|Self, cText | ( ( Self ) ), ( ::oRTF:SetText( cText ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER GetText(); oClass:AddInline( "GetText", {|Self | ( ( Self ) ), ( ::oRTF:GetText() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER cText(); oClass:AddInline( "cText", {|Self, cText | ( ( Self ) ), ( ::oRTF:cText( cText ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER SaveAsRTF(); oClass:AddInline( "SaveAsRTF", {|Self | ( ( Self ) ), ( ::oRTF:SaveAsRTF() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SaveToFile(); oClass:AddInline( "SaveToFile", {|Self, cFileName | ( ( Self ) ), ( ::oRTF:SavetoFile( cFileName ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


   _HB_MEMBER LoadFromRTFFile(); oClass:AddInline( "LoadFromRTFFile", {|Self, cFileName | ( ( Self ) ), ( ::oRTF:LoadFromRTFFile( cFileName ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Paste(); oClass:AddInline( "Paste", {|Self | ( ( Self ) ), ( ::oRTF:Paste() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Blod(); oClass:AddInline( "Blod", {|Self | ( ( Self ) ), ( ::oClp:Clear(), ::oClp:SetText( "<b></b>" ), ::oRTF:Paste() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )










   _HB_MEMBER SetHTML(); oClass:AddInline( "SetHTML", {|Self | ( ( Self ) ), ( ::oBtnBold:Hide() ,    ::oBtnItalics:Hide() ,    ::oBtnUnderLine:Hide() ,    ::oBtnTextAlignLeft:Hide() ,    ::oBtnTextAlignCenter :Hide() ,    ::oBtnTextAlignRight:Hide() ,    ::oBtnTextJustify:Hide() ,    ::oBtnBullet:Hide() ,    ::oBtnDateTime:Hide(), ::oBtnCorrector:Show() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )










   _HB_MEMBER SetRTF(); oClass:AddInline( "SetRTF", {|Self | ( ( Self ) ), ( ::oBtnBold:Show() ,    ::oBtnItalics:Show() ,    ::oBtnUnderLine:Show() ,    ::oBtnTextAlignLeft:Show() ,    ::oBtnTextAlignCenter :Show() ,    ::oBtnTextAlignRight:Show() ,    ::oBtnTextJustify:Show() ,    ::oBtnBullet:Show() ,    ::oBtnDateTime:Show(), ::oBtnCorrector:Show() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER end(); oClass:AddInline( "end", {|Self | ( ( Self ) ), ( ::oRTF:oFont:end(), ::oRTF:end(), ::oRTF := nil ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Corrector(); oClass:AddMethod( "Corrector", @GetRichEdit_Corrector(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS GetRichEdit ;



   static FUNCTION GetRichEdit_Redefine( id, oDlg ) ; local Self AS CLASS GetRichEdit := QSelf() AS CLASS GetRichEdit

      If( id == nil, id := 600, ) ;
      If( oDlg == nil, oDlg := ::oDlg, ) ;

      ::oClp := TClipBoard():New( Upper("TEXT"), oDlg )








      ::oBtnPrint := TBtnBmp():ReDefine( ( id ), "gc_printer2_16",,,,,, oDlg, .F., {||     ( .T. )}, .F., "Imprimir",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnPrint:bAction     := {|| ::oRTF:Print(), ::oRTF:SetFocus() }








      ::oBtnPreview := TBtnBmp():ReDefine( ( id + 1 ), "PREV116",,,,,, oDlg, .F., {||     ( .T. )}, .F., "Previsualizar",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnPreview:bAction := {|| ::oRTF:Preview( "Class TRichEdit" ) }








      ::oBtnSearch := TBtnBmp():ReDefine( ( id + 2 ), "Bus16",,,,,, oDlg, .F., {||     ( .T. )}, .F., "Buscar",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnSearch:bAction := {|| FindRich( ::oRTF ) }








      ::oBtnCut := TBtnBmp():ReDefine( ( id + 3 ), "gc_cut_16",,,,,, oDlg, .F., {||     ( ! empty( ::oRTF:GetSel() ) .AND. ! ::oRTF:lReadOnly )}, .F., "Cortar",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnCut:bAction     := {|| ::oRTF:Cut(), ::oRTF:SetFocus() }








      ::oBtnCopy := TBtnBmp():ReDefine( ( id + 4 ), "gc_copy_16",,,,,, oDlg, .F., {||     ( ! empty( ::oRTF:GetSel() ) )}, .F., "Copiar",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnCopy:bAction    := {|| ::oRTF:Copy(), ::oRTF:SetFocus() }








      ::oBtnPaste := TBtnBmp():ReDefine( ( id + 5 ), "gc_clipboard_paste_16",,,,,, oDlg, .F., {||     ( ! empty( ::oClp:GetText() ) .AND. ! ::oRTF:lReadOnly )}, .F., "Pegar",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnPaste:bAction     := {|| ::oRTF:Paste(), ::oRTF:SetFocus() }








      ::oBtnUndo := TBtnBmp():ReDefine( ( id + 6 ), "gc_undo_inv_16",,,,,, oDlg, .F., {||     ( ::oRTF:SendMsg( 198 ) <> 0 )}, .F., "Deshacer",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnUndo:bAction     := {|| ::oRTF:Undo(), ::oRTF:SetFocus() }








      ::oBtnRedo := TBtnBmp():ReDefine( ( id + 7 ), "gc_undo_16",,,,,, oDlg, .F., {||     ( ::oRTF:SendMsg( ( 1024 + 85 ) ) <> 0 )}, .F., "Rehacer",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnRedo:bAction := {|| ::oRTF:Redo(), ::oRTF:SetFocus() }





      ::oZoom := TComboBox():ReDefine( ( id + 8 ), { | u | If( PCount()==0, ::cZoom, ::cZoom:= u ) }, ::aZoom, oDlg,,,,,,, .F.,,,,,,, "::oZoom",,,,,,, )

      ::oZoom:bChange      := {|| ::oRTF:SetZoom( ::aRatio[ ::oZoom:nAt, 1 ], ::aRatio[ ::oZoom:nAt, 2 ] ), ::oRTF:SetFocus()  }





      ::oFuente := TComboBox():ReDefine( ( id + 9 ), { | u | If( PCount()==0, ::cFuente, ::cFuente:= u ) }, ::aFuente, oDlg,,,,,,, .F.,,,,,,, "::oFuente",,,,,,, )

      ::oFuente:bChange    := {|| ::oRTF:SetFontName( ::oFuente:VarGet() ), ::oRTF:SetFocus() }





      ::oSize := TComboBox():ReDefine( ( id + 10 ), { | u | If( PCount()==0, ::cSize, ::cSize:= u ) }, ::aSize, oDlg,,,,,,, .F.,,,,,,, "::oSize",,,,,,, )

      ::oSize:bChange      := {|| ::oRTF:SetFontSize( Val( ::oSize:VarGet() ) ), ::oRTF:SetFocus() }








      ::oBtnBold := TBtnBmp():ReDefine( ( id + 11 ), "gc_text_bold_16",,,,,, oDlg, .F., {||     ( ! ::oRTF:lReadOnly )}, .F., "Negrita",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnBold:bAction    := {|| ( ::lBold  := !::lBold, ::oRTF:SetBold( ::lBold ), ::oRTF:SetFocus() ) }








      ::oBtnItalics := TBtnBmp():ReDefine( ( id + 12 ), "gc_text_italics_16",,,,,, oDlg, .F., {||     ( ! ::oRTF:lReadOnly )}, .F., "Cursiva",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnItalics:bAction     := {|| ( ::lItalic := !::lItalic, ::oRTF:SetItalic( ::lItalic ), ::oRTF:SetFocus() ) }








      ::oBtnUnderLine := TBtnBmp():ReDefine( ( id + 13 ), "gc_text_underline_16",,,,,, oDlg, .F., {||     ( ! ::oRTF:lReadOnly )}, .F., "Subrayado",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnUnderLine:bAction     := {|| ( ::lUnderline := !::lUnderline, ::oRTF:SetUnderline( ::lUnderline ), ::oRTF:SetFocus() ) }








      ::oBtnTextAlignLeft := TBtnBmp():ReDefine( ( id + 14 ), "gc_text_align_left_16",,,,,, oDlg, .F., {||     ( ! ::oRTF:lReadOnly )}, .F., "Izquierda",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnTextAlignLeft:bAction     := {|| ::oRTF:SetAlign( 1 ), ::oRTF:SetFocus() }








      ::oBtnTextAlignCenter := TBtnBmp():ReDefine( ( id + 15 ), "gc_text_center_16",,,,,, oDlg, .F., {||     ( ! ::oRTF:lReadOnly )}, .F., "Centro",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnTextAlignCenter:bAction := {|| ::oRTF:SetAlign( 3 ), ::oRTF:SetFocus() }








      ::oBtnTextAlignRight := TBtnBmp():ReDefine( ( id + 16 ), "gc_text_align_right_16",,,,,, oDlg, .F., {||     ( ! ::oRTF:lReadOnly )}, .F., "Derecha",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnTextAlignRight:bAction     := {|| ::oRTF:SetAlign( 2 ), ::oRTF:SetFocus() }








      ::oBtnTextJustify := TBtnBmp():ReDefine( ( id + 17 ), "gc_text_justified_16",,,,,, oDlg, .F., {||     ( ! ::oRTF:lReadOnly )}, .F., "Justificado",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnTextJustify:bAction     := {|| ::oRTF:SetAlign( 4 ), ::oRTF:SetFocus() }








      ::oBtnBullet := TBtnBmp():ReDefine( ( id + 18 ), "gc_pin_blue_16",,,,,, oDlg, .F., {||     ( ! ::oRTF:lReadOnly .AND. ! ::oRTF:GetNumbering() )}, .F., "Vietas",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnBullet:bAction             := {|| ::lBullet := !::lBullet, ::oRTF:SetBullet( ::lBullet ), ::oRTF:SetFocus() }







      ::oBtnDateTime := TBtnBmp():ReDefine( ( id + 19 ), "gc_calendar_16",,,,,, oDlg, .F.,, .F., "Fecha/Hora",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnDateTime:bAction         := {|| DateTimeRich( ::oRTF ) }







      ::oBtnCorrector := TBtnBmp():ReDefine( ( id + 21 ), "spellcheck_16",,,,,, oDlg, .F.,, .F., "Corrector",,,,, !.T.,, .F.,,, .F., !.F.,, .F. )
      ::oBtnCorrector:bAction     := {|| ::Corrector() }




      ::oRTF := TRichEdit():ReDefine( ( id + 20 ), { | u | If( PCount()==0, ::cRTF, ::cRTF:= u ) }, oDlg,,,, .F., .F.,,, .F.,,, )

      ::oRTF:lHighLight             := .F.
      ::oRTF:bChange                := { || ::RTFRefreshButtons() }

   RETURN ( Self )



   static FUNCTION GetRichEdit_Corrector( ) ; local Self AS CLASS GetRichEdit := QSelf() AS CLASS GetRichEdit

      ::SetText( checkOrtography( ::GetText() ) )

   RETURN ( Self )



   static FUNCTION GetRichEdit_RTFRefreshButtons( ) ; local Self AS CLASS GetRichEdit := QSelf() AS CLASS GetRichEdit

      local aChar    := REGetCharFormat( ::oRTF:hWnd )

      ::lBold        := aChar[ 5 ] == 700
      ::lItalic      := aChar[ 6 ]
      ::lUnderline   := aChar[ 7 ]
      ::lBullet      := REGetBullet( ::oRTF:hWnd )

      if ::oBtnCut:lWhen()
         ::oBtnCut:Enable()
      else
         ::oBtnCut:Disable()
      end

      ::oBtnCut:Refresh()

      if ::oBtnCopy:lWhen()
         ::oBtnCopy:Enable()
      else
         ::oBtnCopy:Disable()
      end

      ::oBtnCopy:Refresh()

   RETURN ( nil )



_HB_CLASS BrowseRangos ; function BrowseRangos ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "BrowseRangos", iif( .F., { }, { @HBObject() } ), @BrowseRangos() ) ) ;

   _HB_MEMBER { idBrowse } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idBrowse"}, .F. )
   _HB_MEMBER { oContainer } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oContainer"}, .F. )
   _HB_MEMBER { aInitGroup } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aInitGroup"}, .F. )
   _HB_MEMBER { oBrwRango } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrwRango"}, .F. )
   _HB_MEMBER { oColNombre } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oColNombre"}, .F. )
   _HB_MEMBER { oColDesde } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oColDesde"}, .F. )
   _HB_MEMBER { oColHasta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oColHasta"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @BrowseRangos_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @BrowseRangos_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddGroup(); oClass:AddInline( "AddGroup", {|Self, oGroup | ( ( Self ) ), ( aAdd( ::aInitGroup, oGroup ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER EditValueTextDesde(); oClass:AddInline( "EditValueTextDesde", {|Self | ( ( Self ) ), ( Eval( ::aInitGroup[ ::oBrwRango:nArrayAt ]:HelpDesde ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER EditValueTextHasta(); oClass:AddInline( "EditValueTextHasta", {|Self | ( ( Self ) ), ( Eval( ::aInitGroup[ ::oBrwRango:nArrayAt ]:HelpHasta ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER EditTextDesde(); oClass:AddInline( "EditTextDesde", {|Self | ( ( Self ) ), ( Eval( ::aInitGroup[ ::oBrwRango:nArrayAt ]:TextDesde ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER EditTextHasta(); oClass:AddInline( "EditTextHasta", {|Self | ( ( Self ) ), ( Eval( ::aInitGroup[ ::oBrwRango:nArrayAt ]:TextHasta ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ValidValueTextDesde(); oClass:AddInline( "ValidValueTextDesde", {|Self, oGet | ( ( Self ) ), ( Eval( ::aInitGroup[ ::oBrwRango:nArrayAt ]:ValidDesde, oGet ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER ValidValueTextHasta(); oClass:AddInline( "ValidValueTextHasta", {|Self, oGet | ( ( Self ) ), ( Eval( ::aInitGroup[ ::oBrwRango:nArrayAt ]:ValidHasta, oGet ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ResizeColumns(); oClass:AddMethod( "ResizeColumns", @BrowseRangos_ResizeColumns(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS BrowseRangos ;



static FUNCTION BrowseRangos_New( idBrowse, oContainer ) ; local Self AS CLASS BrowseRangos := QSelf() AS CLASS BrowseRangos

   ::idBrowse     := idBrowse
   ::oContainer   := oContainer

Return ( Self )



static FUNCTION BrowseRangos_Resource( ) ; local Self AS CLASS BrowseRangos := QSelf() AS CLASS BrowseRangos

   local o

   ::oBrwRango                      := IXBrowse():New( ::oContainer )

   ::oBrwRango:bClrSel              := {|| { 0, ( 229 + ( 229 * 256 ) + ( 229 * 65536 ) ) } }
   ::oBrwRango:bClrSelFocus         := {|| { 0, ( 167 + ( 205 * 256 ) + ( 240 * 65536 ) ) } }

   ::oBrwRango:SetArray( ::aInitGroup, , , .F. )

   ::oBrwRango:lHScroll             := .F.
   ::oBrwRango:lVScroll             := .F.
   ::oBrwRango:lRecordSelector      := .T.
   ::oBrwRango:lFastEdit            := .T.

   ::oBrwRango:nFreeze              := 1
   ::oBrwRango:nMarqueeStyle        := 3

   ::oBrwRango:nColSel              := 2

   ::oBrwRango:CreateFromResource( ::idBrowse )

   ::oColNombre                     := ::oBrwRango:AddCol()
   ::oColNombre:cHeader             := ""
   ::oColNombre:bStrData            := {|| ::aInitGroup[ ::oBrwRango:nArrayAt ]:Nombre }
   ::oColNombre:bBmpData            := {|| ::oBrwRango:nArrayAt }
   ::oColNombre:nWidth              := 200
   ::oColNombre:Cargo               := 0.20

   for each o in ::aInitGroup
      ::oColNombre:AddResource( o:cBitmap )
   next

   with object ( ::oColDesde := ::oBrwRango:AddCol() )
      :cHeader       := "Desde"
      :bEditValue    := {|| ::aInitGroup[ ::oBrwRango:nArrayAt ]:Desde }
      :bOnPostEdit   := {|o,x| ::aInitGroup[ ::oBrwRango:nArrayAt ]:Desde := x }
      :bEditValid    := {|oGet| ::ValidValueTextDesde( oGet ) }
      :bEditBlock    := {|| ::EditValueTextDesde() }
      :cEditPicture  := "@!"
      :nEditType     := 5
      :nWidth        := 120
      :Cargo         := 0.15
      :nBtnBmp       := 1
      :AddResource( "Lupa" )
   end

   with object ( ::oBrwRango:AddCol() )
      :cHeader       := ""
      :bEditValue    := {|| ::EditTextDesde() }
      :nEditType     := 0
      :nWidth        := 200
      :Cargo         := 0.25
   end

   with object ( ::oColHasta := ::oBrwRango:AddCol() )
      :cHeader       := "Hasta"
      :bEditValue    := {|| ::aInitGroup[ ::oBrwRango:nArrayAt ]:Hasta }
      :bOnPostEdit   := {|o,x| ::aInitGroup[ ::oBrwRango:nArrayAt ]:Hasta := x }
      :bEditValid    := {|oGet| ::ValidValueTextHasta( oGet ) }
      :bEditBlock    := {|| ::EditValueTextHasta() }
      :cEditPicture  := "@!"
      :nEditType     := 5
      :nWidth        := 120
      :Cargo         := 0.15
      :nBtnBmp       := 1
      :AddResource( "Lupa" )
   end

   with object ( ::oBrwRango:AddCol() )
      :cHeader       := ""
      :bEditValue    := {|| ::EditTextHasta() }
      :nEditType     := 0
      :nWidth        := 200
      :Cargo         := 0.25
   end

Return .T.



static FUNCTION BrowseRangos_ResizeColumns( ) ; local Self AS CLASS BrowseRangos := QSelf() AS CLASS BrowseRangos

   ::oBrwRango:CheckSize()

   aeval( ::oBrwRango:aCols, {|o, n, oCol| o:nWidth := ::oBrwRango:nWidth * o:Cargo } )

Return .T.







_HB_CLASS BrowseProperties ; function BrowseProperties ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "BrowseProperties", iif( .F., { }, { @HBObject() } ), @BrowseProperties() ) ) ;

   _HB_MEMBER { idBrowse } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"idBrowse"}, .F. )
   _HB_MEMBER { oContainer } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oContainer"}, .F. )

   _HB_MEMBER { nView } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nView"}, .F. )

   _HB_MEMBER { oBrwProperties } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrwProperties"}, .F. )
   _HB_MEMBER { aPropertiesTable } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aPropertiesTable"}, .F. )

   _HB_MEMBER { oGetUnidades } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetUnidades"}, .F. )

   _HB_MEMBER { oInstance } ; oClass:AddMultiClsData(,, nScope + iif( .F., 16, 0 ) + iif( .T., 32, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oInstance"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @BrowseProperties_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER newInstance(); oClass:AddInline( "newInstance", {|Self, idBrowse, oContainer, nView | ( ( Self ) ), ( ::endInstance(), ::GetInstance( idBrowse, oContainer, nView ), ::oInstance ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getInstance(); oClass:AddInline( "getInstance", {|Self, idBrowse, oContainer, nView | ( ( Self ) ), ( if( empty( ::oInstance ), ::oInstance := ::New( idBrowse, oContainer, nView ), ::oInstance ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER endInstance(); oClass:AddInline( "endInstance", {|Self | ( ( Self ) ), ( if( !empty( ::oInstance ), ::oInstance := nil, ), nil ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @BrowseProperties_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER buildPropertiesTable(); oClass:AddMethod( "buildPropertiesTable", @BrowseProperties_buildPropertiesTable(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER setPropertiesTableToBrowse(); oClass:AddMethod( "setPropertiesTableToBrowse", @BrowseProperties_setPropertiesTableToBrowse(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER bGenerateEditText( n); oClass:AddMethod( "bGenerateEditText", @BrowseProperties_bGenerateEditText(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER bGenerateEditValue( n); oClass:AddMethod( "bGenerateEditValue", @BrowseProperties_bGenerateEditValue(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER bGenerateRGBValue( n); oClass:AddMethod( "bGenerateRGBValue", @BrowseProperties_bGenerateRGBValue(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER bPostEditProperties(); oClass:AddMethod( "bPostEditProperties", @BrowseProperties_bPostEditProperties(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER nTotalProperties(); oClass:AddMethod( "nTotalProperties", @BrowseProperties_nTotalProperties(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Hide(); oClass:AddInline( "Hide", {|Self | ( ( Self ) ), ( ::setCargo(), ::oBrwProperties:Hide() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER setCargo(); oClass:AddInline( "setCargo", {|Self, uValue | ( ( Self ) ), ( ::oBrwProperties:Cargo := uValue ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Cargo(); oClass:AddInline( "Cargo", {|Self | ( ( Self ) ), ( ::oBrwProperties:Cargo )}, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER setBindingUnidades(); oClass:AddInline( "setBindingUnidades", {|Self, oGetUnidades | ( ( Self ) ), ( ::oGetUnidades := oGetUnidades ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setPropertiesUnits(); oClass:AddMethod( "setPropertiesUnits", @BrowseProperties_setPropertiesUnits(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER cleanPropertiesUnits(); oClass:AddMethod( "cleanPropertiesUnits", @BrowseProperties_cleanPropertiesUnits(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS BrowseProperties ;



static FUNCTION BrowseProperties_New( idBrowse, oContainer, nView ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

   ::idBrowse     := idBrowse
   ::oContainer   := oContainer
   ::nView        := nView

   ::Resource()

Return ( Self )



static FUNCTION BrowseProperties_Resource( ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

   ::oBrwProperties                 := IXBrowse():New( ::oContainer )

   ::oBrwProperties:nDataType       := 2

   ::oBrwProperties:bClrSel         := {|| { 0, ( 229 + ( 229 * 256 ) + ( 229 * 65536 ) ) } }
   ::oBrwProperties:bClrSelFocus    := {|| { 0, ( 167 + ( 205 * 256 ) + ( 240 * 65536 ) ) } }

   ::oBrwProperties:lHScroll        := .T.
   ::oBrwProperties:lVScroll        := .T.

   ::oBrwProperties:nMarqueeStyle   := 3
   ::oBrwProperties:lRecordSelector := .F.
   ::oBrwProperties:lFastEdit       := .T.
   ::oBrwProperties:nFreeze         := 1
   ::oBrwProperties:lFooter         := .F.

   ::oBrwProperties:SetArray( {}, .F., 0, .F. )

   ::oBrwProperties:CreateFromResource( ::idBrowse )

Return ( Self )



static FUNCTION BrowseProperties_buildPropertiesTable( idArticulo, idPrimeraPropiedad, idSegundaPropiedad, nPrecioCosto ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

   local n
   local a
   local o
   local nRow                    := 1
   local nCol                    := 1
   local nTotalRow               := 0
   local nTotalCol               := 0
   local hValorPropiedad
   local aHeadersTable           := {}
   local aSizesTable             := {}
   local aJustifyTable           := {}
   local aPropiedadesArticulo1
   local aPropiedadesArticulo2

   ::aPropertiesTable            := {}

   aPropiedadesArticulo1         := aPropiedadesArticulo1( idArticulo, ::nView )
   nTotalRow                     := len( aPropiedadesArticulo1 )
   if nTotalRow <> 0
      aPropiedadesArticulo2      := aPropiedadesArticulo2( idArticulo, ::nView )
   else
      aPropiedadesArticulo1      := aPropiedadesGeneral( idPrimeraPropiedad, ::nView )
      nTotalRow                  := len( aPropiedadesArticulo1 )
      if nTotalRow <> 0
         aPropiedadesArticulo2   := aPropiedadesGeneral( idSegundaPropiedad, ::nView )
      else
         Return nil
      end
   end



   if len( aPropiedadesArticulo2 ) == 0
      nTotalCol                  := 2
   else
      nTotalCol                  := len( aPropiedadesArticulo2 ) + 1
   end

   ::aPropertiesTable            := array( nTotalRow, nTotalCol )

   if ( D():Propiedades( ::nView ) )->( dbSeek( idPrimeraPropiedad ) )
      aadd( aHeadersTable, ( D():Propiedades( ::nView ) )->cDesPro )
      aadd( aSizesTable,   60 )
      aadd( aJustifyTable, .F. )
   end

   for each hValorPropiedad in aPropiedadesArticulo1

      ::aPropertiesTable[ nRow, nCol ]                        := TPropertiesItems():New()
      ::aPropertiesTable[ nRow, nCol ]:cCodigo                := idArticulo
      ::aPropertiesTable[ nRow, nCol ]:cHead                  := hValorPropiedad[ "TipoPropiedad" ]
      ::aPropertiesTable[ nRow, nCol ]:cText                  := hValorPropiedad[ "CabeceraPropiedad" ]
      ::aPropertiesTable[ nRow, nCol ]:cCodigoPropiedad1      := hValorPropiedad[ "CodigoPropiedad" ]
      ::aPropertiesTable[ nRow, nCol ]:cValorPropiedad1       := hValorPropiedad[ "ValorPropiedad" ]
      ::aPropertiesTable[ nRow, nCol ]:lColor                 := hValorPropiedad[ "ColorPropiedad" ]
      ::aPropertiesTable[ nRow, nCol ]:nRgb                   := hValorPropiedad[ "RgbPropiedad" ]

      nRow++

   next

   if !empty( idSegundaPropiedad ) .AND. !empty( aPropiedadesArticulo2 )

      for each hValorPropiedad in aPropiedadesArticulo2

         nCol++

         aadd( aHeadersTable, hValorPropiedad[ "CabeceraPropiedad" ] )
         aadd( aSizesTable,   60 )
         aadd( aJustifyTable, .T. )

         for n := 1 to nTotalRow
            ::aPropertiesTable[ n, nCol ]                     := TPropertiesItems():New()
            ::aPropertiesTable[ n, nCol ]:Value               := 0
            ::aPropertiesTable[ n, nCol ]:cHead               := hValorPropiedad[ "CabeceraPropiedad" ]
            ::aPropertiesTable[ n, nCol ]:cCodigo             := idArticulo
            ::aPropertiesTable[ n, nCol ]:cCodigoPropiedad1   := ::aPropertiesTable[ n, 1 ]:cCodigoPropiedad1
            ::aPropertiesTable[ n, nCol ]:cValorPropiedad1    := ::aPropertiesTable[ n, 1 ]:cValorPropiedad1
            ::aPropertiesTable[ n, nCol ]:cCodigoPropiedad2   := hValorPropiedad[ "CodigoPropiedad" ]
            ::aPropertiesTable[ n, nCol ]:cValorPropiedad2    := hValorPropiedad[ "ValorPropiedad" ]
            ::aPropertiesTable[ n, nCol ]:lColor              := ::aPropertiesTable[ n, 1 ]:lColor
            ::aPropertiesTable[ n, nCol ]:nRgb                := ::aPropertiesTable[ n, 1 ]:nRgb
         next

      next

   else

      nCol++

      aAdd( aHeadersTable, "Unidades" )
      aAdd( aSizesTable,   60 )
      aAdd( aJustifyTable, .T. )

      for n := 1 to nTotalRow
         ::aPropertiesTable[ n, nCol ]                        := TPropertiesItems():New()
         ::aPropertiesTable[ n, nCol ]:Value                  := 0
         ::aPropertiesTable[ n, nCol ]:cHead                  := "Unidades"
         ::aPropertiesTable[ n, nCol ]:cCodigo                := idArticulo
         ::aPropertiesTable[ n, nCol ]:cCodigoPropiedad1      := ::aPropertiesTable[ n, 1 ]:cCodigoPropiedad1
         ::aPropertiesTable[ n, nCol ]:cValorPropiedad1       := ::aPropertiesTable[ n, 1 ]:cValorPropiedad1
         ::aPropertiesTable[ n, nCol ]:cCodigoPropiedad2      := Space( 20 )
         ::aPropertiesTable[ n, nCol ]:cValorPropiedad2       := Space( 40 )
         ::aPropertiesTable[ n, nCol ]:lColor                 := ::aPropertiesTable[ n, 1 ]:lColor
         ::aPropertiesTable[ n, nCol ]:nRgb                   := ::aPropertiesTable[ n, 1 ]:nRgb
      next

   end



   for each a in ::aPropertiesTable
      for each o in a
         if IsObject( o )
            o:PrecioCompra( nPrecioCosto, D():ArticuloPrecioPropiedades( ::nView ) )
         end
      next
   next



   ::setPropertiesTableToBrowse()

Return ( Self )



static FUNCTION BrowseProperties_setPropertiesTableToBrowse( aPropertiesTable ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

   local n

   if empty( ::oBrwProperties )
      Return ( Self )
   end

   if !empty( aPropertiesTable )
      ::aPropertiesTable      := aPropertiesTable
   end

   ::oBrwProperties:Hide()

   ::oBrwProperties:aCols     := {}
   ::oBrwProperties:Cargo     := ::aPropertiesTable
   ::oBrwProperties:nFreeze   := 1

   ::oBrwProperties:SetArray( ::aPropertiesTable, .F., 0, .F. )

   for n := 1 to len( ::aPropertiesTable[ 1 ] )

      if !Empty( ::aPropertiesTable[ ::oBrwProperties:nArrayAt, n ] )

         if isNil( ::aPropertiesTable[ ::oBrwProperties:nArrayAt, n ]:Value )



            with object ( ::oBrwProperties:AddCol() )
               :Adjust()
               :cHeader          := ::aPropertiesTable[ ::oBrwProperties:nArrayAt, n ]:getHead()
               :bEditValue       := ::bGenerateEditText( n )
               :nWidth           := 100
            end



            if ::aPropertiesTable[ ::oBrwProperties:nArrayAt, n ]:lColor

               with object ( ::oBrwProperties:AddCol() )
                  :Adjust()
                  :cHeader       := "Color"
                  :nWidth        := 40
                  :bStrData      := {|| "" }
                  :nWidth        := 16
                  :bClrStd       := ::bGenerateRGBValue( n )
                  :bClrSel       := ::bGenerateRGBValue( n )
                  :bClrSelFocus  := ::bGenerateRGBValue( n )
               end

               ::oBrwProperties:nFreeze++


            end

         else

            with object ( ::oBrwProperties:AddCol() )
               :Adjust()
               :cHeader          := ::aPropertiesTable[ ::oBrwProperties:nArrayAt, n ]:getHead()
               :bEditValue       := ::bGenerateEditValue( n )
               :cEditPicture     := MasUnd()
               :nWidth           := 50
               :setAlign( 1 )
               :nEditType        := 1
               :nHeadStrAlign    := 1
               :bOnPostEdit      := {| oCol, xVal, nKey | ::bPostEditProperties( oCol, xVal, nKey ) }
               :nFootStyle       := :defStyle( 1, .T. )
               :Cargo            := n
            end

         end

      end

   next

   ::oBrwProperties:aCols[ 1 ]:Hide()
   ::oBrwProperties:Adjust()

   ::oBrwProperties:nColSel         := ::oBrwProperties:nFreeze + 1

   ::oBrwProperties:nRowHeight      := 20
   ::oBrwProperties:nHeaderHeight   := 20

   ::oBrwProperties:Show()

Return ( self )



static FUNCTION BrowseProperties_bGenerateEditText( n ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

Return ( {|| ::aPropertiesTable[ ::oBrwProperties:nArrayAt, n ]:cText } )



static FUNCTION BrowseProperties_bGenerateEditValue( n ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

Return ( {|| ::aPropertiesTable[ ::oBrwProperties:nArrayAt, n ]:Value } )



static FUNCTION BrowseProperties_bGenerateRGBValue( n ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

Return ( {|| { nRGB( 0, 0, 0), ::aPropertiesTable[ ::oBrwProperties:nArrayAt, n ]:nRgb } } )



static FUNCTION BrowseProperties_bPostEditProperties( oCol, xVal, nKey ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

   ::oBrwProperties:Cargo[ ::oBrwProperties:nArrayAt, oCol:Cargo ]:Value := xVal

   ::nTotalProperties()

Return ( .T. )



static FUNCTION BrowseProperties_nTotalProperties( ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

   local aRow
   local aCol
   local nTot     := 0

   for each aRow in ::aPropertiesTable
      for each aCol in aRow
         if !Empty( aCol )
            if isNum( aCol:Value )
               nTot  += aCol:Value
            end
         end
      next
   next

   if !empty( ::oGetUnidades )
      ::oGetUnidades:cText( nTot )
   end

Return ( .T. )



static FUNCTION BrowseProperties_setPropertiesUnits( idArticulo, idCodigoPrimeraPropiedad, idCodigoSegundaPropiedad, idValorPrimeraPropiedad, idValorSegundaPropiedad, nUnidades ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

   local oColumn
   local aProperty

   for each aProperty in ::aPropertiesTable
      for each oColumn in aProperty




         if rtrim( oColumn:cCodigo )            == rtrim( idArticulo ) .AND.  rtrim( oColumn:cCodigoPropiedad1 )  == rtrim( idCodigoPrimeraPropiedad ) .AND.  rtrim( oColumn:cCodigoPropiedad2 )  == rtrim( idCodigoSegundaPropiedad ) .AND.  rtrim( oColumn:cValorPropiedad1 )   == rtrim( idValorPrimeraPropiedad ) .AND.  rtrim( oColumn:cValorPropiedad2 )   == rtrim( idValorSegundaPropiedad )

            oColumn:Value  := nUnidades

         end
      next
   next

Return ( .T. )



static FUNCTION BrowseProperties_cleanPropertiesUnits( ) ; local Self AS CLASS BrowseProperties := QSelf() AS CLASS BrowseProperties

   local oColumn
   local aProperty

   for each aProperty in ::aPropertiesTable
      for each oColumn in aProperty
         oColumn:Value  := 0
      next
   next

   ::nTotalProperties()

   ::oBrwProperties:Refresh()

Return ( .T. )





_HB_CLASS DialogBrowseProperties ; function DialogBrowseProperties ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "DialogBrowseProperties", iif( .F., { }, { @HBObject() } ), @DialogBrowseProperties() ) ) ;

   _HB_MEMBER { oSender } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSender"}, .F. )

   _HB_MEMBER { oContainer } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oContainer"}, .F. )
   _HB_MEMBER { oBrwProperties } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrwProperties"}, .F. )
   _HB_MEMBER { oGetUnidades } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetUnidades"}, .F. )

   _HB_MEMBER { oInstance } ; oClass:AddMultiClsData(,, nScope + iif( .F., 16, 0 ) + iif( .T., 32, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oInstance"}, .F. )

   _HB_MEMBER New( nView); oClass:AddMethod( "New", @DialogBrowseProperties_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER newInstance(); oClass:AddInline( "newInstance", {|Self, nView | ( ( Self ) ), ( ::endInstance(), ::GetInstance( nView ), ::oInstance ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getInstance(); oClass:AddInline( "getInstance", {|Self, nView | ( ( Self ) ), ( if( empty( ::oInstance ), ::oInstance := ::New( nView ), ::oInstance ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER endInstance(); oClass:AddInline( "endInstance", {|Self | ( ( Self ) ), ( if( !empty( ::oInstance ), ::oInstance := nil, ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getPropertiesTable(); oClass:AddInline( "getPropertiesTable", {|Self | ( ( Self ) ), ( ::oSender:aPropertiesTable ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Dialog(); oClass:AddMethod( "Dialog", @DialogBrowseProperties_Dialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER StartDialog(); oClass:AddMethod( "StartDialog", @DialogBrowseProperties_StartDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER SaveDialog(); oClass:AddInline( "SaveDialog", {|Self, oDlg | ( ( Self ) ), ( oDlg:end( 1 ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS DialogBrowseProperties ;



static FUNCTION DialogBrowseProperties_New( oSender ) ; local Self AS CLASS DialogBrowseProperties := QSelf() AS CLASS DialogBrowseProperties

   ::oSender   := oSender

Return ( Self )



static FUNCTION DialogBrowseProperties_Dialog( ) ; local Self AS CLASS DialogBrowseProperties := QSelf() AS CLASS DialogBrowseProperties

   local n
   local oDlg
   local oGetUnidades
   local nGetUnidades   := 0

   oDlg = TDialog():New(,,,,, "Propiedades",, .F.,,,,,, .F.,,,,,, .F.,, "oDlg", nil, )

      ::oBrwProperties  := BrowseProperties():new( 100, oDlg )

      ::oBrwProperties:setPropertiesTableToBrowse( ::getPropertiesTable() )






      oGetUnidades := TGetHlp():ReDefine( 110, { | u | If( PCount()==0, nGetUnidades, nGetUnidades:= u ) }, oDlg,, masUnd(),,,,,,, .F., {||           ( .F. )},, .F., .F.,,,,,, nil,,, )

      ::oBrwProperties:setBindingUnidades( oGetUnidades )




      TButton():ReDefine( 1, {||( ::SaveDialog( oDlg ) )}, oDlg,,, .F.,,,, .F. )





      TButton():ReDefine( 2, {||( oDlg:end() )}, oDlg,,, .F.,,,, .T. )

      oDlg:bStart       := {|| ::StartDialog() }

      oDlg:AddFastKey( 116, {|| ::SaveDialog( oDlg ) } )

   oDlg:Activate( oDlg:bLClicked, oDlg:bMoved, oDlg:bPainted, .T.,,,, oDlg:bRClicked,,, )

Return ( oDlg:nResult == 1 )



static FUNCTION DialogBrowseProperties_StartDialog( ) ; local Self AS CLASS DialogBrowseProperties := QSelf() AS CLASS DialogBrowseProperties

   ::oBrwProperties:setPropertiesTableToBrowse( ::getPropertiesTable() )

   ::oBrwProperties:nTotalProperties()

Return ( Self )
