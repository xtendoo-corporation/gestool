#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 5 ".\Prg\tablet\view\documentos\ventas\DailySummarySalesView.prg"
_HB_CLASS DailySummarySalesView ; function DailySummarySalesView ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "DailySummarySalesView", iif( .T., { @ViewBase() }, { @HBObject() } ), @DailySummarySalesView() ) ) ;

   _HB_MEMBER { oFecIni } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFecIni"}, .F. )
   _HB_MEMBER { dFecIni } ; oClass:AddMultiData(, GetSysDate(), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"dFecIni"}, .F. )
   _HB_MEMBER { oFecFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFecFin"}, .F. )
   _HB_MEMBER { dFecFin } ; oClass:AddMultiData(, GetSysDate(), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"dFecFin"}, .F. )
   _HB_MEMBER { oPedido } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPedido"}, .F. )
   _HB_MEMBER { oPedidoTotal } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPedidoTotal"}, .F. )
   _HB_MEMBER { nPedido } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPedido"}, .F. )
   _HB_MEMBER { nPedidoTotal } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPedidoTotal"}, .F. )
   _HB_MEMBER { oAlbaran } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAlbaran"}, .F. )
   _HB_MEMBER { oAlbaranTotal } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAlbaranTotal"}, .F. )
   _HB_MEMBER { nAlbaran } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nAlbaran"}, .F. )
   _HB_MEMBER { nAlbaranTotal } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nAlbaranTotal"}, .F. )
   _HB_MEMBER { oFactura } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFactura"}, .F. )
   _HB_MEMBER { oFacturaTotal } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacturaTotal"}, .F. )
   _HB_MEMBER { nFactura } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nFactura"}, .F. )
   _HB_MEMBER { nFacturaTotal } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nFacturaTotal"}, .F. )
   _HB_MEMBER { oTotal } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTotal"}, .F. )
   _HB_MEMBER { nTotal } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nTotal"}, .F. )

   _HB_MEMBER { oCbxRango } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oCbxRango"}, .F. )
   _HB_MEMBER { aCbxRango } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aCbxRango"}, .F. )
   _HB_MEMBER { cCbxRango } ; oClass:AddMultiData(, "Hoy", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCbxRango"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @DailySummarySalesView_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER insertControls(); oClass:AddMethod( "insertControls", @DailySummarySalesView_insertControls(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineAceptarCancelar(); oClass:AddMethod( "defineAceptarCancelar", @DailySummarySalesView_defineAceptarCancelar(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineFechas(); oClass:AddMethod( "defineFechas", @DailySummarySalesView_defineFechas(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineCabecera(); oClass:AddMethod( "defineCabecera", @DailySummarySalesView_defineCabecera(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER definePedidos(); oClass:AddMethod( "definePedidos", @DailySummarySalesView_definePedidos(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineAlbaranes(); oClass:AddMethod( "defineAlbaranes", @DailySummarySalesView_defineAlbaranes(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineFacturas(); oClass:AddMethod( "defineFacturas", @DailySummarySalesView_defineFacturas(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineTotal(); oClass:AddMethod( "defineTotal", @DailySummarySalesView_defineTotal(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER cargaPeriodo(); oClass:AddMethod( "cargaPeriodo", @DailySummarySalesView_cargaPeriodo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER changePeriodo(); oClass:AddMethod( "changePeriodo", @DailySummarySalesView_changePeriodo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getTitleTipoDocumento(); oClass:AddInline( "getTitleTipoDocumento", {|Self | ( ( Self ) ), ( ::getTextoTipoDocumento() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS DailySummarySalesView ;



static FUNCTION DailySummarySalesView_New( oSender ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView

   ::oSender   := oSender

Return ( self )



static FUNCTION DailySummarySalesView_insertControls( ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView

   ::cargaPeriodo()

   ::defineFechas()

   ::defineCabecera()

   ::definePedidos()

   ::defineAlbaranes()

   ::defineFacturas()

   ::defineTotal()

   ::oSender:CalculateGeneral()

Return( Self )



static FUNCTION DailySummarySalesView_defineAceptarCancelar( ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView







   TGridImage():Build(  {  "nTop"      => 5, "nLeft"     => {|| GridWidth( 10.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_ok_64", "bLClicked" => {|| ::oDlg:End() }, "oWnd"      => ::oDlg } )

Return ( self )



static FUNCTION DailySummarySalesView_defineFechas( ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView








   ::oCbxRango    := TGridComboBox():Build(  {  "nRow"      => 50, "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::cCbxRango, ::cCbxRango := u ) }, "oWnd"      => ::oDlg, "nWidth"    => {|| GridWidth( 3.5, ::oDlg ) }, "nHeight"   => 25, "aItems"    => ::aCbxRango, "bChange"   => {|| ::changePeriodo(), ::oSender:CalculateGeneral() } } )









   ::oFecIni      := TGridGet():Build( {        "nRow"      => 50, "nCol"      => {|| GridWidth( 5, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::dFecIni, ::dFecIni := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 2.5, ::oDlg ) }, "nHeight"   => 23, "bValid"    => {|| ::oSender:CalculateGeneral(), .T. }, "lRight"    => .T. } )









   ::oFecFin      := TGridGet():Build( {        "nRow"      => 50, "nCol"      => {|| GridWidth( 8, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::dFecFin, ::dFecFin := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 2.5, ::oDlg ) }, "nHeight"   => 23, "bValid"    => {|| ::oSender:CalculateGeneral(), .T. }, "lRight"    => .T. } )

Return ( Self )



static FUNCTION DailySummarySalesView_defineCabecera( ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView












   TGridSay():Build( {  "nRow"      => 87, "nCol"      => {|| GridWidth( 5, ::oDlg ) }, "bText"     => {|| "Documentos" }, "oWnd"      => ::oDlg, "oFont"     => oGridFontBold(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )












   TGridSay():Build( {  "nRow"      => 87, "nCol"      => {|| GridWidth( 8, ::oDlg ) }, "bText"     => {|| "Total" }, "oWnd"      => ::oDlg, "oFont"     => oGridFontBold(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 1.5, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )


Return ( self )



static FUNCTION DailySummarySalesView_definePedidos( ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView













   TGridSay():Build( {  "nRow"      => 120, "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Pedidos de clientes: " }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )









   ::oPedido         := TGridGet():Build( {  "nRow"      => 120, "nCol"      => {|| GridWidth( 5, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::nPedido, ::nPedido := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 2.5, ::oDlg ) }, "nHeight"   => 23, "lRight"    => .T., "bWhen"     => {|| .F. } } )










   ::oPedidoTotal    := TGridGet():Build( {  "nRow"      => 120, "nCol"      => {|| GridWidth( 8, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::nPedidoTotal, ::nPedidoTotal := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "cPict"     => cPorDiv(), "nWidth"    => {|| GridWidth( 2.5, ::oDlg ) }, "nHeight"   => 23, "lRight"    => .T., "bWhen"     => {|| .F. } } )


Return( Self )



static FUNCTION DailySummarySalesView_defineAlbaranes( ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView













   TGridSay():Build( {  "nRow"      => 148, "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Albaranes de clientes: " }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )









   ::oAlbaran        := TGridGet():Build( {  "nRow"      => 148, "nCol"      => {|| GridWidth( 5, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::nAlbaran, ::nAlbaran := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 2.5, ::oDlg ) }, "nHeight"   => 23, "lRight"    => .T., "bWhen"     => {|| .F. } } )










   ::oAlbaranTotal   := TGridGet():Build( {  "nRow"      => 148, "nCol"      => {|| GridWidth( 8, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::nAlbaranTotal, ::nAlbaranTotal := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "cPict"     => cPorDiv(), "nWidth"    => {|| GridWidth( 2.5, ::oDlg ) }, "nHeight"   => 23, "lRight"    => .T., "bWhen"     => {|| .F. } } )


Return( Self )



static FUNCTION DailySummarySalesView_defineFacturas( ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView













   TGridSay():Build( {  "nRow"      => 176, "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Facturas de clientes: " }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )









   ::oFactura           := TGridGet():Build( {  "nRow"      => 176, "nCol"      => {|| GridWidth( 5, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::nFactura, ::nFactura := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 2.5, ::oDlg ) }, "nHeight"   => 23, "lRight"    => .T., "bWhen"     => {|| .F. } } )










   ::oFacturaTotal      := TGridGet():Build( {  "nRow"      => 176, "nCol"      => {|| GridWidth( 8, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::nFacturaTotal, ::nFacturaTotal := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "cPict"     => cPorDiv(), "nWidth"    => {|| GridWidth( 2.5, ::oDlg ) }, "nHeight"   => 23, "lRight"    => .T., "bWhen"     => {|| .F. } } )


Return( Self )



static FUNCTION DailySummarySalesView_defineTotal( ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView













   TGridSay():Build(    {  "nRow"      => 204, "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Totales: " }, "oWnd"      => ::oDlg, "oFont"     => oGridFontBold(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )











   ::oTotal       := TGridGet():Build(   {   "nRow"      => 204, "nCol"      => {|| GridWidth( 8, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::nTotal, ::nTotal := u ) }, "oWnd"      => ::oDlg, "oFont"     => oGridFontBold(), "lPixels"   => .T., "cPict"     => cPorDiv(), "nWidth"    => {|| GridWidth( 2.5, ::oDlg ) }, "nHeight"   => 23, "lRight"    => .T., "bWhen"     => {|| .F. } } )

Return( Self )



static FUNCTION DailySummarySalesView_cargaPeriodo( ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView

   ::aCbxRango                 := {}

   aAdd( ::aCbxRango, "Hoy" )
   aAdd( ::aCbxRango, "Ayer" )
   aAdd( ::aCbxRango, "Mes en curso" )
   aAdd( ::aCbxRango, "Mes anterior" )
   aAdd( ::aCbxRango, "Primer trimestre" )
   aAdd( ::aCbxRango, "Segundo trimestre" )
   aAdd( ::aCbxRango, "Tercer trimestre" )
   aAdd( ::aCbxRango, "Cuatro trimestre" )
   aAdd( ::aCbxRango, "Doce últimos meses" )
   aAdd( ::aCbxRango, "Año en curso" )
   aAdd( ::aCbxRango, "Año anterior" )

RETURN ( Self )



static FUNCTION DailySummarySalesView_changePeriodo( ) ; local Self AS CLASS DailySummarySalesView := QSelf() AS CLASS DailySummarySalesView

   do case
      case ::cCbxRango == "Hoy"

         ::oFecIni:cText( GetSysDate() )
         ::oFecFin:cText( GetSysDate() )

      case ::cCbxRango == "Ayer"

         ::oFecIni:cText( GetSysDate() -1 )
         ::oFecFin:cText( GetSysDate() -1 )

      case ::cCbxRango == "Mes en curso"

         ::oFecIni:cText( CtoD( "01/" + Str( Month( GetSysDate() ) ) + "/" + Str( Year( GetSysDate() ) ) ) )
         ::oFecFin:cText( GetSysDate() )

      case ::cCbxRango == "Mes anterior"

         ::oFecIni:cText( BoM( addMonth( GetSysDate(), - 1 ) ) )
         ::oFecFin:cText( EoM( addMonth( GetSysDate(), - 1 ) ) )

      case ::cCbxRango == "Primer trimestre"

         ::oFecIni:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) ) ) )
         ::oFecFin:cText( CtoD( "31/03/" + Str( Year( GetSysDate() ) ) ) )

      case ::cCbxRango == "Segundo trimestre"

         ::oFecIni:cText( CtoD( "01/04/" + Str( Year( GetSysDate() ) ) ) )
         ::oFecFin:cText( CtoD( "30/06/" + Str( Year( GetSysDate() ) ) ) )

      case ::cCbxRango == "Tercer trimestre"

         ::oFecIni:cText( CtoD( "01/07/" + Str( Year( GetSysDate() ) ) ) )
         ::oFecFin:cText( CtoD( "30/09/" + Str( Year( GetSysDate() ) ) ) )

      case ::cCbxRango == "Cuatro trimestre"

         ::oFecIni:cText( CtoD( "01/10/" + Str( Year( GetSysDate() ) ) ) )
         ::oFecFin:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case ::cCbxRango == "Doce últimos meses"

         ::oFecIni:cText( BoY( GetSysDate() ) )
         ::oFecFin:cText( EoY( GetSysDate() ) )

      case ::cCbxRango == "Año en curso"

         ::oFecIni:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) ) ) )
         ::oFecFin:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case ::cCbxRango == "Año anterior"

         ::oFecIni:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) - 1 ) ) )
         ::oFecFin:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) - 1 ) ) )

   end

RETURN ( .T. )
