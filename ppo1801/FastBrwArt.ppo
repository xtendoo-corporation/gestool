#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 11 ".\.\Prg\FastBrwArt.prg"
Function FastBrwArt( oGetCodigo, oGetNombre )

   TFastBrwArt():Run( oGetCodigo, oGetNombre )

Return nil



_HB_CLASS TFastBrwArt ; function TFastBrwArt ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TFastBrwArt", iif( .F., { }, { @HBObject() } ), @TFastBrwArt() ) ) ;

   _HB_MEMBER { oDialog } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDialog"}, .F. )
   _HB_MEMBER { oBitmap } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBitmap"}, .F. )

   _HB_MEMBER { oGetCodigo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetCodigo"}, .F. )
   _HB_MEMBER { oGetNombre } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetNombre"}, .F. )

   _HB_MEMBER { oBusqueda } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBusqueda"}, .F. )
   _HB_MEMBER { cBusqueda } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cBusqueda"}, .F. )

   _HB_MEMBER { oOrden } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oOrden"}, .F. )
   _HB_MEMBER { cOrden } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cOrden"}, .F. )
   _HB_MEMBER { aOrden } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aOrden"}, .F. )
   _HB_MEMBER { aCampoOrden } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aCampoOrden"}, .F. )

   _HB_MEMBER { nLevel } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nLevel"}, .F. )

   _HB_MEMBER { oBtnBusqueda } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnBusqueda"}, .F. )

   _HB_MEMBER { oBrowseArticulo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrowseArticulo"}, .F. )
   _HB_MEMBER { oBrowseStock } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrowseStock"}, .F. )

   _HB_MEMBER Run( oGetCodigo, oGetNombre); oClass:AddMethod( "Run", @TFastBrwArt_Run(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER end(); oClass:AddMethod( "end", @TFastBrwArt_end(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @TFastBrwArt_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Search(); oClass:AddMethod( "Search", @TFastBrwArt_Search(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER prepareSentence(); oClass:AddMethod( "prepareSentence", @TFastBrwArt_prepareSentence(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER loadStock(); oClass:AddMethod( "loadStock", @TFastBrwArt_loadStock(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER addArticulo(); oClass:AddMethod( "addArticulo", @TFastBrwArt_addArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TFastBrwArt ;



static FUNCTION TFastBrwArt_Run( oGetCodigo, oGetNombre ) ; local Self AS CLASS TFastBrwArt := QSelf() AS CLASS TFastBrwArt

   ::oGetCodigo      := oGetCodigo
   ::oGetNombre      := oGetNombre

   ::cBusqueda       := Space( 200 )
   ::cOrden          := "Nombre"
   ::aOrden          := { "Código", "Nombre" }
   ::aCampoOrden     := { "CODIGO", "NOMBRE" }

   ::nLevel          := Auth():Level( "articulos" )

   ::Resource()

   ::end()

Return ( nil )



static FUNCTION TFastBrwArt_end( ) ; local Self AS CLASS TFastBrwArt := QSelf() AS CLASS TFastBrwArt

   if !Empty( ::oBitmap )
      ::oBitmap:End()
   end

Return ( nil )



static FUNCTION TFastBrwArt_Resource( ) ; local Self AS CLASS TFastBrwArt := QSelf() AS CLASS TFastBrwArt

   CursorWait()

   ::oDialog = TDialog():New(,,,, "Información artículo.", "FastBrwStock",, .F.,,,,,, .F.,,,,,, .F.,, "::oDialog", nil, )





      ::oBitmap := TBitmap():ReDefine( 600, "gc_object_cube_48",, ::oDialog,,, .F., .F.,,, .F.,,, .T. )




      ::oBusqueda := TGetHlp():ReDefine( 100, { | u | If( PCount()==0, ::cBusqueda, ::cBusqueda:= u ) }, ::oDialog,,, {||       ( msgRun( "Ejecutando busqueda", "Espere por favor...", {|| ::Search() } ), .T. )},,,,,, .F.,,, .F., .F.,,,,,, nil,,, )





      ::oOrden := TComboBox():ReDefine( 110, { | u | If( PCount()==0, ::cOrden, ::cOrden:= u ) }, ::aOrden, ::oDialog,,,,,,, .F.,,,,,,, "::oOrden",,,,,,, )

      ::oBrowseArticulo                   := IXBrowse():New( ::oDialog )

      ::oBrowseArticulo:bClrSel           := {|| { 0, ( 229 + ( 229 * 256 ) + ( 229 * 65536 ) ) } }
      ::oBrowseArticulo:bClrSelFocus      := {|| { 0, ( 167 + ( 205 * 256 ) + ( 240 * 65536 ) ) } }

      ::oBrowseArticulo:SetArray( {}, , , .F. )
      ::oBrowseArticulo:nMarqueeStyle     := 6
      ::oBrowseArticulo:cName             := "FastBrowse.Articulos"
      ::oBrowseArticulo:bLDblClick        := {|| ::oDialog:end( 1 ) }

      if !uFieldEmpresa( "lNStkAct" )
         ::oBrowseArticulo:bChange        := {|| ::loadStock() }
      end

      ::oBrowseArticulo:CreateFromResource( 200 )

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := "Código"
         :bEditValue                      := {|| if( !empty( ::oBrowseArticulo:aArrayData ), hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "Codigo" ), "" ) }
         :nWidth                          := 90
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := "Nombre"
         :bEditValue                      := {|| if( !empty( ::oBrowseArticulo:aArrayData ), hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "Nombre" ), "" ) }
         :nWidth                          := 260
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar1", "Precio 1" )
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVenta1" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar1", "Precio 1" ) + " " + cImp() + " inc."
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVtaIva1" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar2", "Precio 2" )
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVenta2" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar2", "Precio 2" ) + " " + cImp() + " inc."
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVtaIva2" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar3", "Precio 3" )
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVenta3" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar3", "Precio 3" ) + " " + cImp() + " inc."
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVtaIva3" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar4", "Precio 4" )
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVenta4" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar4", "Precio 4" ) + " " + cImp() + " inc."
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVtaIva4" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar5", "Precio 5" )
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVenta5" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar5", "Precio 5" ) + " " + cImp() + " inc."
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVtaIva5" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar6", "Precio 6" )
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVenta6" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := uFieldEmpresa( "cTxtTar6", "Precio 6" ) + " " + cImp() + " inc."
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pVtaIva6" ), cPorDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end

      with object ( ::oBrowseArticulo:AddCol() )
         :cHeader                         := "Costo"
         :bStrData                        := {|| if( !empty( ::oBrowseArticulo:aArrayData ), Trans( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "pCosto" ), cPirDiv() ), "" ) }
         :nWidth                          := 90
         :nDataStrAlign                   := 1
         :nHeadStrAlign                   := 1
         :lHide                           := .T.
      end





      ::oBrowseStock                   := IXBrowse():New( ::oDialog )

      ::oBrowseStock:SetArray( {}, , , .F. )
      ::oBrowseStock:nMarqueeStyle     := 6
      ::oBrowseStock:cName             := "FastBrowse.Stock"
      ::oBrowseStock:bClrStd           := {|| { if( (!empty( ::oBrowseStock:aArrayData ) .AND. hGet( ::oBrowseStock:aArrayData[ ::oBrowseStock:nArrayAt ], "unidades" ) > 0 ), 32768, 255 ), GetSysColor( 5 ) } }
      ::oBrowseStock:bClrSel           := {|| { if( (!empty( ::oBrowseStock:aArrayData ) .AND. hGet( ::oBrowseStock:aArrayData[ ::oBrowseStock:nArrayAt ], "unidades" ) > 0 ), 32768, 255 ), 16777215 } }
      ::oBrowseStock:bClrSelFocus      := {|| { if( (!empty( ::oBrowseStock:aArrayData ) .AND. hGet( ::oBrowseStock:aArrayData[ ::oBrowseStock:nArrayAt ], "unidades" ) > 0 ), 32768, 255 ), 16777215 } }

      ::oBrowseStock:CreateFromResource( 210 )

      with object ( ::oBrowseStock:AddCol() )
         :cHeader             := "Código"
         :nWidth              := 90
         :bStrData            := {|| if( !empty( ::oBrowseStock:aArrayData ), hGet( ::oBrowseStock:aArrayData[ ::oBrowseStock:nArrayAt ], "almacen" ), "" ) }
      end

      with object ( ::oBrowseStock:AddCol() )
         :cHeader             := "Almacén"
         :nWidth              := 240
         :bStrData            := {|| if( !empty( ::oBrowseStock:aArrayData ), RetAlmacen( hGet( ::oBrowseStock:aArrayData[ ::oBrowseStock:nArrayAt ], "almacen" ) ), "" ) }
      end

      with object ( ::oBrowseStock:AddCol() )
         :cHeader             := "Prop. 1"
         :nWidth              := 70
         :bStrData            := {|| if( !empty( ::oBrowseStock:aArrayData ), hGet( ::oBrowseStock:aArrayData[ ::oBrowseStock:nArrayAt ], "valor1" ), "" ) }
      end

      with object ( ::oBrowseStock:AddCol() )
         :cHeader             := "Prop. 2"
         :nWidth              := 70
         :bStrData            := {|| if( !empty( ::oBrowseStock:aArrayData ), hGet( ::oBrowseStock:aArrayData[ ::oBrowseStock:nArrayAt ], "valor2" ), "" ) }
      end

      with object ( ::oBrowseStock:AddCol() )
         :cHeader             := "Lote"
         :nWidth              := 90
         :bStrData            := {|| if( !empty( ::oBrowseStock:aArrayData ), hGet( ::oBrowseStock:aArrayData[ ::oBrowseStock:nArrayAt ], "lote" ), "" ) }
      end

      with object ( ::oBrowseStock:AddCol() )
         :cHeader             := "Unidades"
         :nWidth              := 90
         :bEditValue          := {|| if( !empty( ::oBrowseStock:aArrayData ), hGet( ::oBrowseStock:aArrayData[ ::oBrowseStock:nArrayAt ], "unidades" ), 0 ) }
         :cEditPicture        := MasUnd()
         :nFooterType         := 1
         :nDataStrAlign       := 1
         :nHeadStrAlign       := 1
         :nFootStrAlign       := 1
      end





      TButton():ReDefine( 510, {||( ::addArticulo() )}, ::oDialog,,, .F., {||     ( nAnd( ::nLevel, 2 ) <> 0 )},,, .F. )






      TButton():ReDefine( 520, {||( if( !empty( ::oBrowseArticulo:aArrayData ), ( EdtArticulo( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "Codigo" ) ), ::Search() ), ) )}, ::oDialog,,, .F., {||     ( nAnd( ::nLevel, 4 ) <> 0 )},,, .F. )






      TButton():ReDefine( 530, {||( if( !empty( ::oBrowseArticulo:aArrayData ), ( DupArticulo( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "Codigo" ) ), ::Search() ), ) )}, ::oDialog,,, .F., {||     ( nAnd( ::nLevel, 2 ) <> 0 )},,, .F. )




      TButton():ReDefine( 500, {||( ::oDialog:end( 1 ) )}, ::oDialog,,, .F.,,,, .F. )





      TButton():ReDefine( 550, {||( ::oDialog:end() )}, ::oDialog,,, .F.,,,, .T. )

      ::oDialog:AddFastKey( 113, {|| if( nAnd( ::nLevel, 2 ) <> 0, ::addArticulo(), Msginfo( "No tiene permiso para añadir" ) ) } )


      ::oDialog:AddFastKey( 114, {|| if( nAnd( ::nLevel, 4 ) <> 0, ( if( !empty( ::oBrowseArticulo:aArrayData ), EdtArticulo( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "Codigo" ) ), ), ::Search() ), Msginfo( "No tiene permiso para modificar" ) ) } )

      ::oDialog:AddFastKey( 116, {|| ::oDialog:end( 1 ) } )

      ::oDialog:bStart := {|| ::oBusqueda:SetFocus(), ::oBrowseArticulo:Load(), ::oBrowseStock:Load() }

   ::oDialog:Activate( ::oDialog:bLClicked, ::oDialog:bMoved, ::oDialog:bPainted, .T.,,,, ::oDialog:bRClicked,,, )

   if ::oDialog:nResult == 1

      if !empty( ::oBrowseArticulo:aArrayData )

         if !empty( ::oGetCodigo )
            ::oGetCodigo:cText( Padr( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "Codigo" ), 200 ) )
         end

      end

      if !empty( ::oBrowseArticulo:aArrayData )

         if !empty( ::oGetNombre )
            ::oGetNombre:cText( hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "Nombre" ) )
         end

      end

   end

   CursorWE()

return ( nil )



static FUNCTION TFastBrwArt_Search( ) ; local Self AS CLASS TFastBrwArt := QSelf() AS CLASS TFastBrwArt

   local cStm           := "cSearchArticulo"
   local cSql           := ""

   if Empty( ::cBusqueda )

      ::oBrowseArticulo:SetArray( {}, , , .F. )
      ::oBrowseArticulo:GoTop()
      ::oBrowseArticulo:Select(0)
      ::oBrowseArticulo:Select(1)
      ::oBrowseArticulo:Refresh()

      ::oBrowseStock:SetArray( {}, , , .F. )
      ::oBrowseStock:GoTop()
      ::oBrowseStock:Select(0)
      ::oBrowseStock:Select(1)
      ::oBrowseStock:Refresh()

      ::oBusqueda:SetFocus()
      return ( nil )

   end

   cSql                 += ::prepareSentence()

   if ADSBaseModel():ExecuteSqlStatement( cSql, cStm )

      if !empty( ::oBrowseArticulo )
         ::oBrowseArticulo:SetArray( DBHScatter( cStm ) )
         ::oBrowseArticulo:GoTop()
         ::oBrowseArticulo:Select(0)
         ::oBrowseArticulo:Select(1)
         ::oBrowseArticulo:Refresh()
         ::oBrowseArticulo:SetFocus()
      end

   end

return ( nil )



static FUNCTION TFastBrwArt_prepareSentence( ) ; local Self AS CLASS TFastBrwArt := QSelf() AS CLASS TFastBrwArt

   local cSentence   := ""

   cSentence         += "SELECT Codigo, Nombre, pCosto, pVenta1, pVenta2, pVenta3, pVenta4, pVenta5, pVenta6, pVtaIva1, pVtaIva2, pVtaIva3, pVtaIva4, pVtaIva5, pVtaIva6 FROM " + ArticulosModel():getTableName() + Space( 1 )
   cSentence         += "WHERE" + Space( 1 )
   cSentence         += "UPPER( " + ::aCampoOrden[ ::oOrden:nAt ] + " )" + Space( 1 )
   cSentence         += "LIKE" + Space( 1 )
   if ConfiguracionesEmpresaModel():getLogic( "lBusConte", .F. )
      cSentence      += quoted( "%" + AllTrim( UPPER( ::cBusqueda ) ) + "%" ) + Space( 1 )
   else
      cSentence      += quoted( AllTrim( UPPER( ::cBusqueda ) ) + "%" ) + Space( 1 )
   end
   cSentence         += "ORDER BY " + ::aCampoOrden[ ::oOrden:nAt ]

return ( cSentence )



static FUNCTION TFastBrwArt_loadStock( ) ; local Self AS CLASS TFastBrwArt := QSelf() AS CLASS TFastBrwArt

   local cCodArt     := ""
   local cAliasStock

   if !empty( ::oBrowseArticulo:aArrayData )
      cCodArt        := hGet( ::oBrowseArticulo:aArrayData[ ::oBrowseArticulo:nArrayAt ], "Codigo" )
   end

   if !Empty( cCodArt )

      cAliasStock                      := StocksModel():getSqlBrwArtStock( cCodArt )

      if !empty( ::oBrowseStock )
         ::oBrowseStock:SetArray( DBHScatter( cAliasStock ) )
      end

   else

     ::oBrowseStock:SetArray( {}, , , .F. )

   end

   if !empty( ::oBrowseStock )
      ::oBrowseStock:GoTop()
      ::oBrowseStock:Select(0)
      ::oBrowseStock:Select(1)
      ::oBrowseStock:Refresh()
   end

return ( nil )



static FUNCTION TFastBrwArt_addArticulo( ) ; local Self AS CLASS TFastBrwArt := QSelf() AS CLASS TFastBrwArt

   ::cBusqueda := AppArticulo()
   ::oBusqueda:Refresh()
   ::Search()

return ( nil )
