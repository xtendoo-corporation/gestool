#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 7 ".\.\Prg\Lenguajes.prg"
_HB_CLASS TLenguaje ; function TLenguaje ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TLenguaje", iif( .T., { @TMant() }, { @HBObject() } ), @TLenguaje() ) ) ;

   _HB_MEMBER { cMru } ; oClass:AddMultiData(, "gc_user_message_16", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cMru"}, .F. )

   _HB_MEMBER { oBrwDialog } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrwDialog"}, .F. )

   _HB_MEMBER { aLenguajesPrestashop } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aLenguajesPrestashop"}, .F. )

   _HB_MEMBER DefineFiles(); oClass:AddMethod( "DefineFiles", @TLenguaje_DefineFiles(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource( nMode); oClass:AddMethod( "Resource", @TLenguaje_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER lValidResource(); oClass:AddMethod( "lValidResource", @TLenguaje_lValidResource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Syncronize(); oClass:AddMethod( "Syncronize", @TLenguaje_Syncronize(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TLenguaje ;



static FUNCTION TLenguaje_DefineFiles( cPath, cDriver ) ; local Self AS CLASS TLenguaje := QSelf() AS CLASS TLenguaje

   If( cPath == nil, cPath := cPatDat(), ) ;
   If( cDriver == nil, cDriver := cDriver(), ) ;

   ::oDbf := DbfServer( "LENGUAJE.DBF", "LENGUAJE" ):New( "LENGUAJE.DBF",, ( cDriver ), "Lenguajes", ( cPath ) )

      ::oDbf:AddField( "cCodLen", "C", 4, 0,, Space( 4 ),,, "Código", .F., 80, .F., {} )
      ::oDbf:AddField( "cNomLen", "C", 50, 0,, Space( 200 ),,, "Nombre", .F., 200, .F., {} )
      ::oDbf:AddField( "uuid", "C", 40, 0,,,,, "Uuid", .F.,, .T., {} )

      ::oDbf:AddIndex( "CCODLEN", "LENGUAJE.CDX", "CCODLEN",,, .F., .F., "Código",,, .T., .F. )
      ::oDbf:AddIndex( "CNOMLEN", "LENGUAJE.CDX", "CNOMLEN",,, .F., .F., "Nombre",,, .T., .F. )



RETURN ( ::oDbf )



static FUNCTION TLenguaje_Resource( nMode ) ; local Self AS CLASS TLenguaje := QSelf() AS CLASS TLenguaje

   local oDlg
   local oGet

   oDlg = TDialog():New(,,,, LblTitle( nMode ) + "lenguajes", "Lenguajes",, .F.,,,,,, .F.,,,,,, .F.,, "oDlg", nil, )






      oGet := TGetHlp():ReDefine( 100, { | u | If( PCount()==0, ::oDbf:cCodLen, ::oDbf:cCodLen:= u ) }, oDlg,, "@!",,,,,,, .T., {||     ( nMode == 1 )},, .F., .F.,,,,,, nil,,, )




      TGetHlp():ReDefine( 110, { | u | If( PCount()==0, ::oDbf:cNomLen, ::oDbf:cNomLen:= u ) }, oDlg,,,,,,,,, .T., {||     ( nMode <> 3 )},, .F., .F.,,,,,, nil,,, )





      TButton():ReDefine( 1, {||( ::lValidResource( oGet, oDlg, nMode ) )}, oDlg,,, .F., {||     ( nMode <> 3 )},,, .F. )





      TButton():ReDefine( 2, {||( oDlg:end() )}, oDlg,,, .F.,,,, .T. )

   if nMode <> 3
      oDlg:AddFastKey( 116, {|| ::lValidResource( oGet, oDlg, nMode ) } )
   end

   oDlg:bStart    := {|| oGet:SetFocus() }

    oDlg:Activate( oDlg:bLClicked, oDlg:bMoved, oDlg:bPainted, .T.,,,, oDlg:bRClicked,,, )

RETURN ( oDlg:nResult == 1 )



static FUNCTION TLenguaje_lValidResource( oGet, oDlg, nMode ) ; local Self AS CLASS TLenguaje := QSelf() AS CLASS TLenguaje

   if nMode == 1 .OR. nMode == 4

      if ::oDbf:SeekInOrd( ::oDbf:cCodLen, "cCodLen" )
         msgStop( "Código ya existe " + Rtrim( ::oDbf:cCodLen ) )
         oGet:SetFocus()
         return .F.
      end

   end

   if empty( ::oDbf:cNomLen )
      msgStop( "La descripción del lenguaje no puede estar vacía." )
      Return .F.
   end

RETURN ( oDlg:end( 1 ) )



static FUNCTION TLenguaje_Syncronize( ) ; local Self AS CLASS TLenguaje := QSelf() AS CLASS TLenguaje

   if ::OpenService()

      while !::oDbf:Eof()

         if empty( ::oDbf:uuid )
            ::oDbf:FieldPutByName( "uuid", win_uuidcreatestring() )
         end

         ::oDbf:Skip()

      end

      ::CloseService()

   end

RETURN .T.
