#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 6 ".\Prg\Views\OfficeBarView.prg"
_HB_CLASS OfficeBarView ; function OfficeBarView ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "OfficeBarView", iif( .F., { }, { @HBObject() } ), @OfficeBarView() ) ) ;

   _HB_MEMBER { oSender } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSender"}, .F. )

   _HB_MEMBER { oOfficeBar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oOfficeBar"}, .F. )

   _HB_MEMBER { oOfficeBarFolder } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oOfficeBarFolder"}, .F. )

   _HB_MEMBER { oBtnOk } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnOk"}, .F. )
   _HB_MEMBER { oBtnOkAndNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnOkAndNew"}, .F. )
   _HB_MEMBER { oBtnCancel } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnCancel"}, .F. )

   _HB_MEMBER { oBtnEdit } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnEdit"}, .F. )
   _HB_MEMBER { oBtnZoom } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnZoom"}, .F. )
   _HB_MEMBER { oBtnAppend } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnAppend"}, .F. )
   _HB_MEMBER { oBtnDelete } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnDelete"}, .F. )

   _HB_MEMBER New( oSender); oClass:AddMethod( "New", @OfficeBarView_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER End(); oClass:AddMethod( "End", @OfficeBarView_End(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER createButtonImage(); oClass:AddMethod( "createButtonImage", @OfficeBarView_createButtonImage(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER createButtonsLine( oLineasController); oClass:AddMethod( "createButtonsLine", @OfficeBarView_createButtonsLine(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER createButtonsDialog(); oClass:AddMethod( "createButtonsDialog", @OfficeBarView_createButtonsDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getDialog(); oClass:AddInline( "getDialog", {|Self | ( ( Self ) ), ( ::oSender:oDialog ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getController(); oClass:AddInline( "getController", {|Self | ( ( Self ) ), ( ::oSender:oController ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS OfficeBarView ;



static FUNCTION OfficeBarView_New( oSender ) ; local Self AS CLASS OfficeBarView := QSelf() AS CLASS OfficeBarView

   ::oSender                  := oSender

   if empty( ::getDialog() )
      RETURN ( Self )
   end

   ::oOfficeBar               := TDotNetBar():New( 0, 0, 2020, 115, ::getDialog(), 1 )

   ::oOfficeBar:lPaintAll     := .F.
   ::oOfficeBar:lDisenio      := .F.

   ::oOfficeBar:SetStyle( 1 )

   ::getDialog():oTop         := ::oOfficeBar

   ::oOfficeBarFolder         := TCarpeta():New( ::oOfficeBar, ::getController():getTitle() )

RETURN ( Self )



static FUNCTION OfficeBarView_createButtonImage( bAction ) ; local Self AS CLASS OfficeBarView := QSelf() AS CLASS OfficeBarView

   local oGrupo

   If( bAction == nil, bAction := {|| msgInfo( "Información del registro, no disponible" ) }, ) ;

   if !empty( ::getController():getImage( "64" ) )
      oGrupo                  := TDotNetGroup():New( ::oOfficeBarFolder, 66, "", .F. )
         TDotNetButton():New( 60, oGrupo, ::getController():getImage( "64" ), "", 1, bAction, , , .F., .F., .F. )
   end

RETURN ( Self )



static FUNCTION OfficeBarView_createButtonsLine( oLineasController, oSQLBrowseView ) ; local Self AS CLASS OfficeBarView := QSelf() AS CLASS OfficeBarView

   local oGrupo

   if empty( ::getController():oLineasController )
      RETURN ( Self )
   end

   if ::getController():isNotZoomMode()

      oGrupo               := TDotNetGroup():New( ::oOfficeBarFolder, 306, "Líneas", .F. )

      ::oBtnAppend         := TDotNetButton():New( 60, oGrupo, "new32",             "Añadir [F2]",    1, {|| oLineasController:Append() }, , , .F., .F., .F. )
      ::oBtnEdit           := TDotNetButton():New( 60, oGrupo, "gc_pencil__32",     "Modificar [F3]", 2, {|| oLineasController:Edit() }  , , , .F., .F., .F. )
      ::oBtnZoom           := TDotNetButton():New( 60, oGrupo, "gc_lock2_32",       "Zoom",           3, {|| oLineasController:Zoom() }  , , , .F., .F., .F. )
      ::oBtnDelete         := TDotNetButton():New( 60, oGrupo, "del32",             "Eliminar [F4]",  4, {|| oLineasController:Delete() }, , , .F., .F., .F. )
                              TDotNetButton():New( 60, oGrupo, "gc_binocular_32",   "Buscar",         5, {|| oLineasController:Search() }, , , .F., .F., .F. )

      ::getDialog():addFastKey( 113, {|| ::oBtnAppend:Action() } )
      ::getDialog():addFastKey( 114, {|| ::oBtnEdit:Action() } )
      ::getDialog():addFastKey( 115, {|| ::oBtnDelete:Action() } )

   else

      oGrupo               := TDotNetGroup():New( ::oOfficeBarFolder, 126, "Líneas", .F. )

      ::oBtnZoom           := TDotNetButton():New( 60, oGrupo, "gc_lock2_32",       "Zoom",           1, {|| oLineasController:Zoom() }, , , .F., .F., .F. )
                              TDotNetButton():New( 60, oGrupo, "gc_binocular_32",   "Buscar",         2, {|| oLineasController:Search() }, , , .F., .F., .F. )

   end

RETURN ( Self )



static FUNCTION OfficeBarView_createButtonsDialog( ) ; local Self AS CLASS OfficeBarView := QSelf() AS CLASS OfficeBarView

   local oGrupo

   if ::getController():isAppendMode()
      oGrupo                  := TDotNetGroup():New( ::oOfficeBarFolder, 186, "Acciones", .F. )
         ::oBtnOk             := TDotNetButton():New( 60, oGrupo, "gc_floppy_disk_32", "Aceptar y cerrar [F5]", 1, {|| if( validateDialog( ::getDialog() ), ::getDialog():end( 1 ), ) }, , , .F., .F., .F. )

         ::oBtnOkAndNew       := TDotNetButton():New( 60, oGrupo, "gc_floppy_disk_plus_32", "Aceptar y nuevo [F6]", 2, {|| if( validateDialog( ::getDialog() ), ::getDialog():end( 3 ), ) }, , , .F., .F., .F. )
         ::oBtnCancel         := TDotNetButton():New( 60, oGrupo, "gc_door_open2_32", "Salir", 3, {|| ::getDialog():end() }, , , .F., .F., .F. )

         ::getDialog():addFastKey( 116, {|| ::oBtnOk:Action() } )
         ::getDialog():addFastKey( 117, {|| ::oBtnOkAndNew:Action() } )
   else
      oGrupo                  := TDotNetGroup():New( ::oOfficeBarFolder, 126, "Acciones", .F. )
         ::oBtnOk             := TDotNetButton():New( 60, oGrupo, "gc_floppy_disk_32", "Aceptar y cerrar [F5]", 1, {|| if( validateDialog( ::getDialog() ), ::getDialog():end( 1 ), ) }, , , .F., .F., .F. )
         ::oBtnCancel         := TDotNetButton():New( 60, oGrupo, "gc_door_open2_32",  "Salir", 2, {|| ::getDialog():end() }, , , .F., .F., .F. )

         ::getDialog():addFastKey( 116, {|| ::oBtnOk:Action() } )
   end


RETURN ( Self )



static FUNCTION OfficeBarView_End( ) ; local Self AS CLASS OfficeBarView := QSelf() AS CLASS OfficeBarView

   ::oOfficeBar:End()

RETURN ( nil )
