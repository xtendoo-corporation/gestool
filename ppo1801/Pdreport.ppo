#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 19 ".\.\Prg\Pdreport.prg"
STATIC aReports := {}


















FUNCTION RptBegin(        aTitle   ,    aHead    ,    aFoot    ,    aFont    ,    aPen     ,    lSummary ,    cRptfile ,    cResName ,    lPrint   ,    lScreen  ,    cFile    ,    oDevice  ,    cName    ,    cTFmt    ,    cHFmt    ,    cFFmt)

















   AAdd( aReports , { TReport():New(aTitle   , aHead    , aFoot    , aFont    , aPen     , lSummary , cRptfile , cResName , lPrint   , lScreen  , cFile    , oDevice  , cName    , cTFmt    , cHFmt    , cFFmt ), {}, {} } )

RETURN ATail( aReports )[ 1 ]



FUNCTION RptAddGroup(bGroup, bHeader, bFooter, bFont, lEject )

     LOCAL oGroup






     oGroup := TRGroup():New( bGroup     , bHeader    , bFooter    , bFont      , lEject     , Atail(aReports)[ 1 ] )

     AAdd( ATail( aReports )[ 3 ], oGroup )

RETURN (NIL)














FUNCTION RptAddColumn(aTitle     , nCol       , aData      , nSize      , aPicture   , uFont      , lTotal     , bTotalExpr , cColFmt    , lShadow    , lGrid      , nPen)

     LOCAL oColumn













     oColumn := TRColumn():New(aTitle     , nCol       , aData      , nSize      , aPicture   , uFont      , lTotal     , bTotalExpr , cColFmt    , lShadow    , lGrid      , nPen       , Atail(aReports)[ 1 ] )

     AAdd( ATail( aReports )[ 2 ], oColumn )

RETURN oColumn



FUNCTION RptEnd()

   LOCAL oReport  := ATail( aReports )[ 1 ]
   LOCAL aColumns := ATail( aReports )[ 2 ]
   LOCAL aGroups  := ATail( aReports )[ 3 ]

   AEval( aColumns, { | oColumn | oReport:AddColumn( oColumn ) } )
   AEval( aGroups, { | oGroup | oReport:AddGroup( oGroup ) } )

   ASize( aReports, Len( aReports ) - 1 )

RETURN oReport



















FUNCTION RptAddOColumn(aTitle    , nCol       , aData      , nSize      , aPicture   , oFont      , oTitleFont , oTotalFont , lTotal     , bTotalExpr , cColFmt    , lShadow    , lGrid      , lNewLine   , nPen       , nColor     , nHeight )

     LOCAL oColumn


















     oColumn := TROColumn():New(aTitle    , nCol       , aData      , nSize      , aPicture   , oFont      , oTitleFont , oTotalFont , lTotal     , bTotalExpr , cColFmt    , lShadow    , lGrid      , lNewLine   , nPen       , nColor     , nHeight    , Atail(aReports)[ 1 ] )

     AAdd( ATail( aReports )[ 2 ], oColumn )

RETURN oColumn
