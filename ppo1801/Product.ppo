#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 4 ".\Prg\tablet\presenter\terceros\Product.prg"
_HB_CLASS Product ; function Product ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "Product", iif( .T., { @Editable() }, { @HBObject() } ), @Product() ) ) ;

   _HB_MEMBER { oGridProduct } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGridProduct"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @Product_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Init( oSender); oClass:AddMethod( "Init", @Product_Init(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER OpenFiles(); oClass:AddMethod( "OpenFiles", @Product_OpenFiles(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CloseFiles(); oClass:AddInline( "CloseFiles", {|Self | ( ( Self ) ), ( D():DeleteView( ::nView ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setEnviroment(); oClass:AddInline( "setEnviroment", {|Self | ( ( Self ) ), ( ::setDataTable( "Articulo" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS Product ;



static FUNCTION Product_New( ) ; local Self AS CLASS Product := QSelf() AS CLASS Product

   if ::OpenFiles()
      ::setEnviroment()
   end

Return ( self )



static FUNCTION Product_Init( oSender ) ; local Self AS CLASS Product := QSelf() AS CLASS Product

   ::nView                               := oSender:nView

   ::oGridProduct                        := ProductViewSearchNavigator():New( self )
   ::oGridProduct:setSelectorMode()
   ::oGridProduct:setTitleDocumento( "Seleccione artículo" )
   ::oGridProduct:setDblClickBrowseGeneral( {|| ::oGridProduct:endView() } )

   ::setEnviroment()

Return ( self )



static FUNCTION Product_OpenFiles( ) ; local Self AS CLASS Product := QSelf() AS CLASS Product

   local oError
   local oBlock
   local lOpenFiles     := .T.

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

      ::nView           := D():CreateView()

      D():Articulos( ::nView )

   RECOVER USING oError

      lOpenFiles        := .F.

      ApoloMsgStop( "Imposible abrir todas las bases de datos" + Chr(13)+Chr(10) + ErrorMessage( oError ) )

   end

   ErrorBlock( oBlock )

   if !lOpenFiles
      ::CloseFiles( "" )
   end

Return ( lOpenFiles )
