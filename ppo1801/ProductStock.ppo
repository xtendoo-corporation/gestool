#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 4 ".\Prg\tablet\presenter\terceros\ProductStock.prg"
_HB_CLASS ProductStock ; function ProductStock ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ProductStock", iif( .T., { @Editable() }, { @HBObject() } ), @ProductStock() ) ) ;

   _HB_MEMBER { oSender } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSender"}, .F. )

   _HB_MEMBER { aStockArticulo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aStockArticulo"}, .F. )

   _HB_MEMBER { oGridProductStock } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGridProductStock"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @ProductStock_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Init( oSender); oClass:AddMethod( "Init", @ProductStock_Init(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setEnviroment( cCodArt, cCodAlm); oClass:AddMethod( "setEnviroment", @ProductStock_setEnviroment(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ClearArrayStock(); oClass:AddMethod( "ClearArrayStock", @ProductStock_ClearArrayStock(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ProductStock ;



static FUNCTION ProductStock_New( ) ; local Self AS CLASS ProductStock := QSelf() AS CLASS ProductStock

   ::aStockArticulo        := {}

Return ( self )



static FUNCTION ProductStock_Init( oSender ) ; local Self AS CLASS ProductStock := QSelf() AS CLASS ProductStock

   ::nView                                := oSender:nView
   ::oSender                              := oSender

   ::oGridProductStock                    := StockViewNavigator():New( self )
   ::oGridProductStock:setSelectorMode()
   ::oGridProductStock:setTitleDocumento( "Stock por lotes" )
   ::oGridProductStock:setDblClickBrowseGeneral( {|| ::oGridProductStock:endView() } )

Return ( self )



static FUNCTION ProductStock_setEnviroment( cCodArt, cCodAlm ) ; local Self AS CLASS ProductStock := QSelf() AS CLASS ProductStock

   ::aStockArticulo    := StocksModel():aStockArticulo( cCodArt, cCodAlm )

   if GetPvProfString( "Tablet", "OcultarStockLoteCero", ".F.", cIniAplication() ) == ".T."
      ::ClearArrayStock()
   end

   ::setDataArray( ::aStockArticulo )

Return ( self )



static FUNCTION ProductStock_ClearArrayStock( ) ; local Self AS CLASS ProductStock := QSelf() AS CLASS ProductStock

   local oStocks
   local aPuente  := {}

   for each oStocks in ::aStockArticulo

      if Round( hGet( oStocks, "unidades" ), 6 ) > 0.000000
         aAdd( aPuente, oStocks )
      end

   next

   ::aStockArticulo  := aPuente

Return ( self )
