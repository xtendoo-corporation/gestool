#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 17 ".\.\Prg\Rfile.prg"
_HB_CLASS TRFile ; function TRFile ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TRFile", iif( .F., { }, { @HBObject() } ), @TRFile() ) ) ;

     _HB_MEMBER { hDC } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"hDC"}, .F. )
     _HB_MEMBER { aRows } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aRows"}, .F. )
     _HB_MEMBER { cDocument } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cDocument"}, .F. )
     _HB_MEMBER { cPrnComp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPrnComp"}, .F. )
     _HB_MEMBER { nHeight } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nHeight"}, .F. )
     _HB_MEMBER { nWidth } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nWidth"}, .F. )
     _HB_MEMBER { lPrint } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lPrint"}, .F. )

     _HB_MEMBER New( cFile) AS CLASS TRFile; oClass:AddMethod( "New", @TRFile_New(), nScope + iif( .T., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER StartPage(); oClass:AddInline( "StartPage", {|Self | ( ( Self ) ), Afill(::aRows,"") }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
     _HB_MEMBER EndPage(); oClass:AddMethod( "EndPage", @TRFile_EndPage(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER End(); oClass:AddInline( "End", {|Self | ( ( Self ) ), fClose(::hDC) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER Say( nRow, nCol, cText, oFont); oClass:AddMethod( "Say", @TRFile_Say(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


     _HB_MEMBER SetHeight(); oClass:AddInline( "SetHeight", {|Self, nHeight | ( ( Self ) ), aSize(::aRows, nHeight) , ::StartPage() }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER GetTextWidth(); oClass:AddInline( "GetTextWidth", {|Self, cText | ( ( Self ) ), len(cText) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
     _HB_MEMBER GetTextHeight(); oClass:AddInline( "GetTextHeight", {|Self, cText | ( ( Self ) ), 1 }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )


     _HB_MEMBER SetSize(); oClass:AddInline( "SetSize", {|Self, nWidth, nHeight | ( ( Self ) ), (::nWidth  := nWidth , ::SetHeight(nHeight) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER GetPhySize(); oClass:AddInline( "GetPhySize", {|Self | ( ( Self ) ), ({::nWidth, ::nHeight}) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER CharWidth(); oClass:AddInline( "CharWidth", {|Self | ( ( Self ) ), 1 }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
     _HB_MEMBER CharHeight(); oClass:AddInline( "CharHeight", {|Self | ( ( Self ) ), 1 }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER nVertRes(); oClass:AddInline( "nVertRes", {|Self | ( ( Self ) ), ::nHeight }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
     _HB_MEMBER nHorzRes(); oClass:AddInline( "nHorzRes", {|Self | ( ( Self ) ), ::nWidth }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER nVertSize(); oClass:AddInline( "nVertSize", {|Self | ( ( Self ) ), (::nHeight * 25.4) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
     _HB_MEMBER nHorzSize(); oClass:AddInline( "nHorzSize", {|Self | ( ( Self ) ), (::nWidth  * 25.4) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER nLogPixelX(); oClass:AddInline( "nLogPixelX", {|Self | ( ( Self ) ), 1 }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
     _HB_MEMBER nLogPixelY(); oClass:AddInline( "nLogPixelY", {|Self | ( ( Self ) ), 1 }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER CharSay(); oClass:AddInline( "CharSay", {|Self, nRow, nCol, cText | ( ( Self ) ), ::Say(nRow, nCol, cText) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER GetOrientation(); oClass:AddInline( "GetOrientation", {|Self | ( ( Self ) ), 2 }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

     _HB_MEMBER SayBitmap() ; oClass:AddVirtual( "SayBitmap" )
     _HB_MEMBER SetPos() ; oClass:AddVirtual( "SetPos" )
     _HB_MEMBER Line() ; oClass:AddVirtual( "Line" )
     _HB_MEMBER Box() ; oClass:AddVirtual( "Box" )

     _HB_MEMBER SetPixelMode() ; oClass:AddVirtual( "SetPixelMode" )
     _HB_MEMBER SetTwipsMode() ; oClass:AddVirtual( "SetTwipsMode" )

     _HB_MEMBER SetLoInchMode() ; oClass:AddVirtual( "SetLoInchMode" )
     _HB_MEMBER SetHiInchMode() ; oClass:AddVirtual( "SetHiInchMode" )

     _HB_MEMBER SetLoMetricMode() ; oClass:AddVirtual( "SetLoMetricMode" )
     _HB_MEMBER SetHiMetricMode() ; oClass:AddVirtual( "SetHiMetricMode" )

     _HB_MEMBER SetIsotropicMode() ; oClass:AddVirtual( "SetIsotropicMode" )
     _HB_MEMBER SetAnisotropicMode() ; oClass:AddVirtual( "SetAnisotropicMode" )

     _HB_MEMBER SetWindowExt() ; oClass:AddVirtual( "SetWindowExt" )

     _HB_MEMBER SetViewPortExt() ; oClass:AddVirtual( "SetViewPortExt" )

     _HB_MEMBER FillRect() ; oClass:AddVirtual( "FillRect" )

     _HB_MEMBER SetLandscape() ; oClass:AddVirtual( "SetLandscape" )
     _HB_MEMBER SetPortrait() ; oClass:AddVirtual( "SetPortrait" )
     _HB_MEMBER SetCopies( nCopies) ; oClass:AddVirtual( "SetCopies" )
     _HB_MEMBER Setup() ; oClass:AddVirtual( "Setup" )
     _HB_MEMBER Rebuild() ; oClass:AddVirtual( "Rebuild" )
     _HB_MEMBER Font( oFont) ; oClass:AddVirtual( "Font" )

     _HB_MEMBER Inch2Pix() ; oClass:AddVirtual( "Inch2Pix" )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TRFile ;



static FUNCTION TRFile_New( cFile ) ; local Self AS CLASS TRFile := QSelf() AS CLASS TRFile

     ::cPrnComp := ""
     ::nHeight  := 1000
     ::nWidth   := 40

     ::hDC := fCreate(cFile)

     IF ::hDC < 0
          ::hDC := 0
     ENDIF

     ::aRows := Array(::nHeight)

RETURN NIL



static FUNCTION TRFile_EndPage( ) ; local Self AS CLASS TRFile := QSelf() AS CLASS TRFile

     LOCAL nFor

     IF ::lPrint
          FOR nFor := 1 TO ::nHeight
               IF len(::aRows[nFor]) > ::nWidth
                    fWrite(::hDC, ::cPrnComp)
                    EXIT
               ENDIF
          NEXT
     ENDIF

     FOR nFor := 1 TO ::nHeight
          fWrite(::hDC, ::aRows[nFor]+Chr(13)+Chr(10))
     NEXT

     IF ::lPrint
          fWrite(::hDC,Chr(12))
     ENDIF

RETURN NIL



static FUNCTION TRFile_Say( nRow, nCol, cText, oFont,nMaxSize ) ; local Self AS CLASS TRFile := QSelf() AS CLASS TRFile

     LOCAL cBefore, cAfter

     If( nMaxSize == nil, nMaxSize := len(cText), ) ;

     IF IsAnsi(cText)
          cText := AnsiToOem(cText)
     ENDIF

     nRow++

     IF nRow > len(::aRows) .OR. nRow < 1
          RETU NIL
     ENDIF

     IF len(::aRows[nRow]) < nCol
          cBefore := Padr(::aRows[nRow],nCol-1)
     ELSE
          cBefore := Substr(::aRows[nRow],1,nCol-1)
     ENDIF

     IF len(::aRows[nRow]) < (nCol+nMaxSize-1)
          cAfter := ""
     ELSE
          cAfter := Substr(::aRows[nRow],nCol+nMaxSize)
     ENDIF

     ::aRows[nRow] := cBefore + Padr(cText, nMaxSize) + cAfter

RETURN NIL
