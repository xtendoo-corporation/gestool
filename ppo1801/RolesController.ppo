#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 8 ".\Prg\Controllers\RolesController.prg"
_HB_CLASS RolesController ; function RolesController ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "RolesController", iif( .T., { @SQLNavigatorController() }, { @HBObject() } ), @RolesController() ) ) ;

   _HB_MEMBER { oAjustableController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAjustableController"}, .F. )

   _HB_MEMBER { oPermisosController } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPermisosController"}, .F. )

   _HB_MEMBER { cUuidRol } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cUuidRol"}, .F. )

   _HB_MEMBER { AS LOGIC lMostrarRentabilidad } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lMostrarRentabilidad"}, .F. )
   _HB_MEMBER { AS LOGIC lCambiarPrecios } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lCambiarPrecios"}, .F. )
   _HB_MEMBER { AS LOGIC lVerPreciosCosto } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lVerPreciosCosto"}, .F. )
   _HB_MEMBER { AS LOGIC lConfirmacionEliminacion } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lConfirmacionEliminacion"}, .F. )
   _HB_MEMBER { AS LOGIC lFiltrarVentas } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lFiltrarVentas"}, .F. )
   _HB_MEMBER { AS LOGIC lAbrirCajonPortamonedas } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAbrirCajonPortamonedas"}, .F. )
   _HB_MEMBER { AS LOGIC lCobrarEnTactil } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lCobrarEnTactil"}, .F. )
   _HB_MEMBER { AS LOGIC lAlbaranEntregado } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAlbaranEntregado"}, .F. )
   _HB_MEMBER { AS LOGIC lAsistenteGenerarFacturas } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAsistenteGenerarFacturas"}, .F. )
   _HB_MEMBER { AS LOGIC lCambiarEstado } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lCambiarEstado"}, .F. )
   _HB_MEMBER { AS LOGIC lCambiarCampos } ; oClass:AddMultiData( "LOGIC", .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lCambiarCampos"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @RolesController_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER End(); oClass:AddMethod( "End", @RolesController_End(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setConfig(); oClass:AddMethod( "setConfig", @RolesController_setConfig(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER loadConfig(); oClass:AddMethod( "loadConfig", @RolesController_loadConfig(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER saveConfig(); oClass:AddMethod( "saveConfig", @RolesController_saveConfig(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER startingActivate(); oClass:AddMethod( "startingActivate", @RolesController_startingActivate(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS RolesController ;



static FUNCTION RolesController_New( ) ; local Self AS CLASS RolesController := QSelf() AS CLASS RolesController

   ::Super:New()

   ::cTitle                := "Roles"

   ::setName( "Roles" )

   ::lTransactional        := .T.

   ::lConfig               := .T.

   ::hImage                := { "16" => "GC_ID_CARDS_16" }

   ::oModel                := SQLRolesModel():New( self )

   ::oRepository           := RolesRepository():New( self )

   ::oBrowseView           := RolesBrowseView():New( self )

   ::oDialogView           := RolesView():New( self )

   ::oValidator            := RolesValidator():New( self )

   ::oPermisosController   := PermisosController():New( self )

   ::oAjustableController  := AjustableController():New( self )

   ::oFilterController:setTableToFilter( ::getName() )

   ::setEvent( "openingDialog",  {|| ::oDialogView:openingDialog() } )
   ::setEvent( "closedDialog",   {|| ::oDialogView:closedDialog() } )

RETURN ( Self )



static FUNCTION RolesController_End( ) ; local Self AS CLASS RolesController := QSelf() AS CLASS RolesController

   if !empty( ::oModel )
      ::oModel:End()
   endif

   if !empty( ::oBrowseView )
      ::oBrowseView:End()
   endif

   if !empty( ::oDialogView )
      ::oDialogView:End()
   endif

   if !empty( ::oValidator )
      ::oValidator:End()
   endif

   ::Super:End()

RETURN ( nil )



static FUNCTION RolesController_setConfig( ) ; local Self AS CLASS RolesController := QSelf() AS CLASS RolesController


   if ::loadConfig() .AND.  ::oAjustableController:DialogViewActivate()

      ::saveConfig()

   end

RETURN ( self )



static FUNCTION RolesController_loadConfig( ) ; local Self AS CLASS RolesController := QSelf() AS CLASS RolesController

   ::cUuidRol                    := ::getRowSet():fieldGet( "uuid" )

   if empty( ::cUuidRol )
      RETURN ( .F. )
   end

   ::lMostrarRentabilidad        := ::oAjustableController:oModel:getRolMostrarRentabilidad( ::cUuidRol )

   ::lCambiarPrecios             := ::oAjustableController:oModel:getRolCambiarPrecios( ::cUuidRol )

   ::lVerPreciosCosto            := ::oAjustableController:oModel:getRolVerPreciosCosto( ::cUuidRol )

   ::lConfirmacionEliminacion    := ::oAjustableController:oModel:getRolConfirmacionEliminacion( ::cUuidRol )

   ::lFiltrarVentas              := ::oAjustableController:oModel:getRolFiltrarVentas( ::cUuidRol )

   ::lAbrirCajonPortamonedas     := ::oAjustableController:oModel:getRolAbrirCajonPortamonedas( ::cUuidRol )

   ::lCobrarEnTactil             := ::oAjustableController:oModel:getRolCobrarEnTactil( ::cUuidRol )

   ::lAlbaranEntregado           := ::oAjustableController:oModel:getRolAlbaranEntregado( ::cUuidRol )

   ::lAsistenteGenerarFacturas   := ::oAjustableController:oModel:GetRolAsistenteGenerarFacturas( ::cUuidRol )

   ::lCambiarEstado              := ::oAjustableController:oModel:GetRolCambiarEstado( ::cUuidRol )

   ::lCambiarCampos              := ::oAjustableController:oModel:GetRolCambiarCampos( ::cUuidRol )

RETURN ( .T. )



static FUNCTION RolesController_saveConfig( ) ; local Self AS CLASS RolesController := QSelf() AS CLASS RolesController


   ::oAjustableController:oModel:setRolMostrarRentabilidad( ::lMostrarRentabilidad, ::cUuidRol )

   ::oAjustableController:oModel:setRolCambiarPrecios( ::lCambiarPrecios, ::cUuidRol )

   ::oAjustableController:oModel:setRolVerPreciosCosto( ::lVerPreciosCosto, ::cUuidRol )

   ::oAjustableController:oModel:setRolConfirmacionEliminacion( ::lConfirmacionEliminacion, ::cUuidRol )

   ::oAjustableController:oModel:setRolFiltrarVentas( ::lFiltrarVentas, ::cUuidRol )

   ::oAjustableController:oModel:setRolAbrirCajonPortamonedas( ::lAbrirCajonPortamonedas, ::cUuidRol )

   ::oAjustableController:oModel:setRolCobrarEnTactil( ::lCobrarEnTactil, ::cUuidRol )

   ::oAjustableController:oModel:setRolAlbaranEntregado( ::lAlbaranEntregado, ::cUuidRol )

   ::oAjustableController:oModel:SetRolAsistenteGenerarFacturas( ::lAsistenteGenerarFacturas, ::cUuidRol )

   ::oAjustableController:oModel:SetRolCambiarEstado( ::lCambiarEstado, ::cUuidRol )

   ::oAjustableController:oModel:SetRolCambiarCampos( ::lCambiarCampos, ::cUuidRol )

RETURN ( self )



static FUNCTION RolesController_startingActivate( ) ; local Self AS CLASS RolesController := QSelf() AS CLASS RolesController

   local oPanel            := ::oAjustableController:oDialogView:oExplorerBar:AddPanel( "Propiedades roles", nil, 1 )

   oPanel:addCheckBox( "Mostrar rentabilidad", @::lMostrarRentabilidad )

   oPanel:addCheckBox( "Cambiar precios", @::lCambiarPrecios )

   oPanel:addCheckBox( "Ver precios de costo", @::lVerPreciosCosto )

   oPanel:addCheckBox( "Confirmar eliminación", @::lConfirmacionEliminacion )

   oPanel:addCheckBox( "Filtrar ventas por usuario", @::lFiltrarVentas )

   oPanel:addCheckBox( "Abrir cajón portamonedas", @::lAbrirCajonPortamonedas )

   oPanel:addCheckBox( "Cobrar en táctil", @::lCobrarEnTactil )

   oPanel:addCheckBox( "Estado albarán entregado", @::lAlbaranEntregado )

   oPanel:addCheckBox( "Asistente generar facturas", @::lAsistenteGenerarFacturas )

   oPanel:addCheckBox( "Cambiar estado", @::lCambiarEstado )

   oPanel:addCheckBox( "Cambiar campos", @::lCambiarCampos )

RETURN ( self )







_HB_CLASS SQLRolesModel ; function SQLRolesModel ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "SQLRolesModel", iif( .T., { @SQLBaseModel() }, { @HBObject() } ), @SQLRolesModel() ) ) ;

   _HB_MEMBER { cTableName } ; oClass:AddMultiData(, "Roles", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTableName"}, .F. )

   _HB_MEMBER { cConstraints } ; oClass:AddMultiData(, "PRIMARY KEY (id), KEY (uuid)", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cConstraints"}, .F. )

   _HB_MEMBER getColumns(); oClass:AddMethod( "getColumns", @SQLRolesModel_getColumns(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getInsertRolesSentence(); oClass:AddMethod( "getInsertRolesSentence", @SQLRolesModel_getInsertRolesSentence(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SeederToADS(); oClass:AddMethod( "SeederToADS", @SQLRolesModel_SeederToADS(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS SQLRolesModel ;



static FUNCTION SQLRolesModel_getColumns( ) ; local Self AS CLASS SQLRolesModel := QSelf() AS CLASS SQLRolesModel


   hset( ::hColumns, "id",             {  "create"    => "INTEGER AUTO_INCREMENT"                  , "default"   => {|| 0 } }                                 )


   hset( ::hColumns, "uuid",           {  "create"    => "VARCHAR( 40 ) NOT NULL UNIQUE"           , "default"   => {|| win_uuidcreatestring() } }            )


   hset( ::hColumns, "nombre",         {  "create"    => "VARCHAR ( 100 ) NOT NULL UNIQUE"         , "default"   => {|| space( 100 ) } }                      )


   hset( ::hColumns, "permiso_uuid",   {  "create"    => "VARCHAR( 40 )"                           , "default"   => {|| space( 40 ) } }                       )

   ::getTimeStampColumns()

RETURN ( ::hColumns )



static FUNCTION SQLRolesModel_getInsertRolesSentence( ) ; local Self AS CLASS SQLRolesModel := QSelf() AS CLASS SQLRolesModel

   local cStatement

   cStatement  := "INSERT IGNORE INTO " + ::cTableName + " "
   cStatement  +=    "( uuid, nombre ) "
   cStatement  += "VALUES "
   cStatement  +=    "( UUID(), 'Super administrador' ), "
   cStatement  +=    "( UUID(), 'Administrador' ), "
   cStatement  +=    "( UUID(), 'Usuario' )"

RETURN ( cStatement )



static FUNCTION SQLRolesModel_SeederToADS( ) ; local Self AS CLASS SQLRolesModel := QSelf() AS CLASS SQLRolesModel

   local cSql  := "SELECT * FROM " + ::getTableName()

RETURN ( getSQLDataBase():selectFetchHash( cSql ) )







_HB_CLASS RolesBrowseView ; function RolesBrowseView ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "RolesBrowseView", iif( .T., { @SQLBrowseView() }, { @HBObject() } ), @RolesBrowseView() ) ) ;

   _HB_MEMBER addColumns(); oClass:AddMethod( "addColumns", @RolesBrowseView_addColumns(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS RolesBrowseView ;



static FUNCTION RolesBrowseView_addColumns( ) ; local Self AS CLASS RolesBrowseView := QSelf() AS CLASS RolesBrowseView

   with object ( ::oBrowse:AddCol() )
      :cSortOrder          := "id"
      :cHeader             := "Id"
      :nWidth              := 80
      :bEditValue          := {|| ::getRowSet():fieldGet( "id" ) }
      :bLClickHeader       := {| row, col, flags, oColumn | ::onClickHeader( oColumn ) }
   end

   with object ( ::oBrowse:AddCol() )
      :cSortOrder          := "uuid"
      :cHeader             := "Uuid"
      :nWidth              := 180
      :bEditValue          := {|| ::getRowSet():fieldGet( "uuid" ) }
      :bLClickHeader       := {| row, col, flags, oColumn | ::onClickHeader( oColumn ) }
      :lHide               := .T.
   end

   with object ( ::oBrowse:AddCol() )
      :cSortOrder          := "nombre"
      :cHeader             := "Nombre"
      :nWidth              := 300
      :bEditValue          := {|| ::getRowSet():fieldGet( "nombre" ) }
      :bLClickHeader       := {| row, col, flags, oColumn | ::onClickHeader( oColumn ) }
   end

   with object ( ::oBrowse:AddCol() )
      :cSortOrder          := "creado"
      :cHeader             := "Creado"
      :cEditPicture        := "@DT"
      :nWidth              := 140
      :nHeadStrAlign       := 0
      :nDataStrAlign       := 0
      :lHide               := .T.
      :bEditValue          := {|| ::getRowSet():fieldGet( "created_at" ) }
      :bLClickHeader       := {| row, col, flags, oColumn | ::onClickHeader( oColumn ) }
   end

   with object ( ::oBrowse:AddCol() )
      :cSortOrder          := "modificado"
      :cHeader             := "Modificado"
      :cEditPicture        := "@DT"
      :nWidth              := 140
      :nHeadStrAlign       := 0
      :nDataStrAlign       := 0
      :lHide               := .T.
      :bEditValue          := {|| ::getRowSet():fieldGet( "updated_at" ) }
      :bLClickHeader       := {| row, col, flags, oColumn | ::onClickHeader( oColumn ) }
   end

RETURN ( self )







_HB_CLASS RolesView ; function RolesView ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "RolesView", iif( .T., { @SQLBaseView() }, { @HBObject() } ), @RolesView() ) ) ;

   _HB_MEMBER { cComboPermiso } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cComboPermiso"}, .F. )
   _HB_MEMBER { aComboPermisos } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aComboPermisos"}, .F. )

   _HB_MEMBER openingDialog(); oClass:AddMethod( "openingDialog", @RolesView_openingDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER closedDialog(); oClass:AddMethod( "closedDialog", @RolesView_closedDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Activate(); oClass:AddMethod( "Activate", @RolesView_Activate(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Save( oDlg); oClass:AddMethod( "Save", @RolesView_Save(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS RolesView ;



static FUNCTION RolesView_openingDialog( ) ; local Self AS CLASS RolesView := QSelf() AS CLASS RolesView

   ::cComboPermiso      := ::oController:oPermisosController:oRepository:getNombre( ::getModel():getBuffer( "permiso_uuid" ) )
   ::aComboPermisos     := ::oController:oPermisosController:oRepository:getNombres()

RETURN ( self )



static FUNCTION RolesView_closedDialog( ) ; local Self AS CLASS RolesView := QSelf() AS CLASS RolesView

   ::getModel():setBuffer( "permiso_uuid", ::oController:oPermisosController:oRepository:getUuid( ::cComboPermiso ) )

RETURN ( self )



static FUNCTION RolesView_Activate( ) ; local Self AS CLASS RolesView := QSelf() AS CLASS RolesView

   local oDlg
   local oBmpGeneral



   oDlg = TDialog():New(,,,, ::lblTitle() + "Rol", "ROL",, .F.,,,,,, .F.,,,,,, .F.,, "oDlg", nil, )





   oBmpGeneral := TBitmap():ReDefine( 900, "GC_ID_CARDS_48",, oDlg,,, .F., .F.,,, .F.,,, .T. )





   TGetHlp():ReDefine( 110, { | u | If( PCount()==0, ::getModel():hBuffer[ "nombre" ], ::getModel():hBuffer[ "nombre" ]:= u ) }, oDlg,,, {||       ( ::oController:validate( "nombre" ) )},,,,,, .F., {||        ( ::oController:isNotZoomMode() )},, .F., .F.,,,,,, nil,,, )





   TComboBox():ReDefine( 120, { | u | If( PCount()==0, ::cComboPermiso, ::cComboPermiso:= u ) }, ::aComboPermisos, oDlg,,,,,,, .F., {||        ( ::oController:isNotZoomMode() )},,,,,,,,,,,,, )





   TButton():ReDefine( 1, {||( ::Save( oDlg ) )}, oDlg,,, .F., {||        ( ::oController:isNotZoomMode() )},,, .F. )





   TButton():ReDefine( 2, {||( oDlg:end() )}, oDlg,,, .F.,,,, .T. )

   oDlg:AddFastKey( 116, {|| ::Save( oDlg ) } )

   oDlg:Activate( , , , .T. )

   oBmpGeneral:end()

RETURN ( oDlg:nResult )



static FUNCTION RolesView_Save( oDlg ) ; local Self AS CLASS RolesView := QSelf() AS CLASS RolesView

   if !( validateDialog( oDlg ) )
      RETURN ( .F. )
   end

   oDlg:end( 1 )

RETURN ( oDlg:nResult )







_HB_CLASS RolesValidator ; function RolesValidator ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "RolesValidator", iif( .T., { @SQLBaseValidator() }, { @HBObject() } ), @RolesValidator() ) ) ;

   _HB_MEMBER getValidators(); oClass:AddMethod( "getValidators", @RolesValidator_getValidators(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS RolesValidator ;



static FUNCTION RolesValidator_getValidators( ) ; local Self AS CLASS RolesValidator := QSelf() AS CLASS RolesValidator


   ::hValidators  := {  "nombre" => {  "required"  => "El nombre es un dato requerido", "unique"    => "El nombre ya existe" } }

RETURN ( ::hValidators )








_HB_CLASS RolesRepository ; function RolesRepository ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "RolesRepository", iif( .T., { @SQLBaseRepository() }, { @HBObject() } ), @RolesRepository() ) ) ;

   _HB_MEMBER getTableName(); oClass:AddInline( "getTableName", {|Self | ( ( Self ) ), ( SQLRolesModel():getTableName() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getNombres(); oClass:AddMethod( "getNombres", @RolesRepository_getNombres(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getNombre(); oClass:AddInline( "getNombre", {|Self, uuid | ( ( Self ) ), ( SQLRolesModel():getColumnWhereUuid( uuid, "nombre" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getUuid( nombre); oClass:AddMethod( "getUuid", @RolesRepository_getUuid(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getUuidWhereNombre(); oClass:AddInline( "getUuidWhereNombre", {|Self, nombre | ( ( Self ) ), ( ::getUuid( nombre ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS RolesRepository ;



static FUNCTION RolesRepository_getNombres( ) ; local Self AS CLASS RolesRepository := QSelf() AS CLASS RolesRepository

   local cSentence            := "SELECT nombre FROM " + ::getTableName()

RETURN ( ::getDatabase():selectFetchArrayOneColumn( cSentence ) )



static FUNCTION RolesRepository_getUuid( cNombre ) ; local Self AS CLASS RolesRepository := QSelf() AS CLASS RolesRepository


   local cSentence            := "SELECT uuid FROM " + ::getTableName() + " " +  "WHERE nombre = " + quoted( cNombre )

RETURN ( ::getDatabase():getValue( cSentence ) )
