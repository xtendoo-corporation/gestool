#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 6 ".\Prg\Controllers\SQLBrowseController.prg"
_HB_CLASS SQLBrowseController ; function SQLBrowseController ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "SQLBrowseController", iif( .T., { @SQLBaseController() }, { @HBObject() } ), @SQLBrowseController() ) ) ;

   _HB_MEMBER { oBrowseView } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrowseView"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @SQLBrowseController_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Activate(); oClass:AddMethod( "Activate", @SQLBrowseController_Activate(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER onChangeCombo( oColumn); oClass:AddMethod( "onChangeCombo", @SQLBrowseController_onChangeCombo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Delete(); oClass:AddMethod( "Delete", @SQLBrowseController_Delete(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS SQLBrowseController ;



static FUNCTION SQLBrowseController_New( oSenderController ) ; local Self AS CLASS SQLBrowseController := QSelf() AS CLASS SQLBrowseController

   ::Super:New( oSenderController )

RETURN ( self )



static FUNCTION SQLBrowseController_Activate( nId, oDialog ) ; local Self AS CLASS SQLBrowseController := QSelf() AS CLASS SQLBrowseController

   if empty( ::oBrowseView )
      RETURN ( Self )
   end

   ::fireEvent( "activating" )

   ::oRowSet:build( ::oModel:getSelectSentence() )

   ::fireEvent( "activated" )

   ::oBrowseView:ActivateDialog( oDialog, nId )

RETURN ( Self )



static FUNCTION SQLBrowseController_onChangeCombo( oColumn ) ; local Self AS CLASS SQLBrowseController := QSelf() AS CLASS SQLBrowseController

   ::changeModelOrderAndOrientation( oColumn:cSortOrder, oColumn:cOrder )

   ::oBrowseView:getBrowse():changeColumnOrder( oColumn )

   ::oBrowseView:getBrowse():refreshCurrent()

RETURN ( Self )



static FUNCTION SQLBrowseController_Delete( ) ; local Self AS CLASS SQLBrowseController := QSelf() AS CLASS SQLBrowseController

RETURN ( ::Super:Delete( ::oBrowseView:getBrowseSelected() ) )
