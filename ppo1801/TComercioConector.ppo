#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 12 ".\Prg\Comercio\TComercioConector.prg"
_HB_CLASS TComercioConector ; function TComercioConector ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TComercioConector", iif( .F., { }, { @HBObject() } ), @TComercioConector() ) ) ;

   _HB_MEMBER { TComercio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"TComercio"}, .F. )

   _HB_MEMBER New( TComercio) AS CLASS TComercioConector; oClass:AddMethod( "New", @TComercioConector_New(), nScope + iif( .T., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )



   _HB_MEMBER getView(); oClass:AddInline( "getView", {|Self | ( ( Self ) ), ( ::TComercio:nView ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER TPrestashopId(); oClass:AddInline( "TPrestashopId", {|Self | ( ( Self ) ), ( ::TComercio:TPrestashopId ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER TComercioConfig(); oClass:AddInline( "TComercioConfig", {|Self | ( ( Self ) ), ( ::TComercio:TComercioConfig ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER isSyncronizeAll(); oClass:AddInline( "isSyncronizeAll", {|Self | ( ( Self ) ), ( ::TComercio:lSyncAll ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getLanguage(); oClass:AddInline( "getLanguage", {|Self | ( ( Self ) ), ( ::TComercio:nLanguage ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER TComercioCustomer(); oClass:AddInline( "TComercioCustomer", {|Self | ( ( Self ) ), ( ::TComercio:TComercioCustomer ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER TComercioBudget(); oClass:AddInline( "TComercioBudget", {|Self | ( ( Self ) ), ( ::TComercio:TComercioBudget ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER TComercioOrder(); oClass:AddInline( "TComercioOrder", {|Self | ( ( Self ) ), ( ::TComercio:TComercioOrder ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER TComercioProduct(); oClass:AddInline( "TComercioProduct", {|Self | ( ( Self ) ), ( ::TComercio:TComercioProduct ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER TComercioCategory(); oClass:AddInline( "TComercioCategory", {|Self | ( ( Self ) ), ( ::TComercio:TComercioCategory ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER TComercioTax(); oClass:AddInline( "TComercioTax", {|Self | ( ( Self ) ), ( ::TComercio:TComercioTax ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER TComercioManufacturer(); oClass:AddInline( "TComercioManufacturer", {|Self | ( ( Self ) ), ( ::TComercio:TComercioManufacturer ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER TComercioProperty(); oClass:AddInline( "TComercioProperty", {|Self | ( ( Self ) ), ( ::TComercio:TComercioProperty ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getCurrentWebName(); oClass:AddInline( "getCurrentWebName", {|Self | ( ( Self ) ), ( ::TComercio:getCurrentWebName() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER writeText(); oClass:AddInline( "writeText", {|Self, cText | ( ( Self ) ), ( ::TComercio:writeText( cText ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER writeTextOk(); oClass:AddInline( "writeTextOk", {|Self, cValue, cTable | ( ( Self ) ), ( ::TComercio:writeTextOk( cValue, cTable ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER writeTextError(); oClass:AddInline( "writeTextError", {|Self, cValue, cTable | ( ( Self ) ), ( ::TComercio:writeTextError( cValue, cTable ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oStock(); oClass:AddInline( "oStock", {|Self | ( ( Self ) ), ( StocksModel() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oConexionMySQLDatabase(); oClass:AddInline( "oConexionMySQLDatabase", {|Self | ( ( Self ) ), ( ::TComercio:oCon ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER cPrefixtable(); oClass:AddInline( "cPrefixtable", {|Self, cTable | ( ( Self ) ), ( ::TComercio:cPrefixTable( cTable ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER meterTotalText(); oClass:AddInline( "meterTotalText", {|Self, cText | ( ( Self ) ), ( ::TComercio:meterTotalText( cText ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER meterTotalSetTotal(); oClass:AddInline( "meterTotalSetTotal", {|Self, nTotal | ( ( Self ) ), ( ::TComercio:meterTotalSetTotal( nTotal ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER meterProcesoText(); oClass:AddInline( "meterProcesoText", {|Self, cText | ( ( Self ) ), ( ::TComercio:meterProcesoText( cText ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER meterProcesoSetTotal(); oClass:AddInline( "meterProcesoSetTotal", {|Self, nTotal | ( ( Self ) ), ( ::TComercio:meterProcesoSetTotal( nTotal ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lProductIdColumnImageShop(); oClass:AddInline( "lProductIdColumnImageShop", {|Self | ( ( Self ) ), ( ::TComercio:lProductIdColumnImageShop ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER lProductIdColumnProductAttribute(); oClass:AddInline( "lProductIdColumnProductAttribute", {|Self | ( ( Self ) ), ( ::TComercio:lProductIdColumnProductAttribute ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER lProductIdColumnProductAttributeShop(); oClass:AddInline( "lProductIdColumnProductAttributeShop", {|Self | ( ( Self ) ), ( ::TComercio:lProductIdColumnProductAttributeShop ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER lSpecificPriceIdColumnReductionTax(); oClass:AddInline( "lSpecificPriceIdColumnReductionTax", {|Self | ( ( Self ) ), ( ::TComercio:lSpecificPriceIdColumnReductionTax ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER aTypeImagesPrestashop(); oClass:AddInline( "aTypeImagesPrestashop", {|Self | ( ( Self ) ), ( ::TComercio:aTypeImagesPrestashop ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oFtp(); oClass:AddInline( "oFtp", {|Self | ( ( Self ) ), ( ::TComercio:oFtp ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER cDirectoryProduct(); oClass:AddInline( "cDirectoryProduct", {|Self | ( ( Self ) ), ( ::TComercio:cDirectoryProduct() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER cDirectoryCategories(); oClass:AddInline( "cDirectoryCategories", {|Self | ( ( Self ) ), ( ::TComercio:cDirectoryCategories() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER cDirectoryManufacture(); oClass:AddInline( "cDirectoryManufacture", {|Self | ( ( Self ) ), ( ::TComercio:cDirectoryManufacture() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getRecursiveFolderPrestashop(); oClass:AddInline( "getRecursiveFolderPrestashop", {|Self, cCarpeta | ( ( Self ) ), ( ::TComercio:getRecursiveFolderPrestashop( cCarpeta ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER commandExecDirect( cCommand); oClass:AddMethod( "commandExecDirect", @TComercioConector_commandExecDirect(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER queryExecDirect(); oClass:AddInline( "queryExecDirect", {|Self, cQuery | ( ( Self ) ), ( TMSQuery():New( ::oConexionMySQLDatabase(), cQuery ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER truncateTable( cTable); oClass:AddMethod( "truncateTable", @TComercioConector_truncateTable(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER prestaShopConnect(); oClass:AddInline( "prestaShopConnect", {|Self | ( ( Self ) ), ( ::TComercio:prestaShopConnect() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER prestaShopDisConnect(); oClass:AddInline( "prestaShopDisConnect", {|Self | ( ( Self ) ), ( ::TComercio:prestaShopDisConnect() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER filesOpen(); oClass:AddInline( "filesOpen", {|Self | ( ( Self ) ), ( ::TComercio:filesOpen() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER filesClose(); oClass:AddInline( "filesClose", {|Self | ( ( Self ) ), ( ::TComercio:filesClose() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER saveLastInsertStock(); oClass:AddInline( "saveLastInsertStock", {|Self, idProduct | ( ( Self ) ), ( ::TComercio:saveLastInsertStock( idProduct ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getLastInsertstock(); oClass:AddInline( "getLastInsertstock", {|Self | ( ( Self ) ), ( ::TComercio:getLastInsertstock() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )



   _HB_MEMBER getDate(); oClass:AddInline( "getDate", {|Self, dDate | ( ( Self ) ), ( ::TComercio:getDate( dDate ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getTime(); oClass:AddInline( "getTime", {|Self, dTime | ( ( Self ) ), ( ::TComercio:getTime( dTime ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TComercioConector ;



static FUNCTION TComercioConector_New( TComercio ) ; local Self AS CLASS TComercioConector := QSelf() AS CLASS TComercioConector

   ::TComercio          := TComercio

Return ( Self )



static FUNCTION TComercioConector_truncateTable( cTable ) ; local Self AS CLASS TComercioConector := QSelf() AS CLASS TComercioConector

   if ::commandExecDirect( "TRUNCATE TABLE " + ::cPreFixtable( cTable ) )
      ::writeText( "Tabla " + ::cPreFixtable( cTable ) + " borrada correctamente" )
   else
      ::writeText( "Error al borrar la tabla " + ::cPreFixtable( cTable ) )
   end

Return ( Self )



static FUNCTION TComercioConector_commandExecDirect( cCommand ) ; local Self AS CLASS TComercioConector := QSelf() AS CLASS TComercioConector

   ::writeText( cCommand )

   if ::TComercio:isDebugMode()
      ::TComercio:addMegaCommand( cCommand )
      Return .T.
   end

Return ( TMSCommand():New( ::oConexionMySQLDatabase() ):ExecDirect( cCommand ) )
