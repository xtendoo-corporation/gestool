#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 11 ".\.\Prg\TDetCaptura.prg"
_HB_CLASS TDetCaptura ; function TDetCaptura ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TDetCaptura", iif( .T., { @TDet() }, { @HBObject() } ), @TDetCaptura() ) ) ;

   _HB_MEMBER DefineFiles(); oClass:AddMethod( "DefineFiles", @TDetCaptura_DefineFiles(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER OpenFiles( lExclusive); oClass:AddMethod( "OpenFiles", @TDetCaptura_OpenFiles(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER OpenService( lExclusive); oClass:AddMethod( "OpenService", @TDetCaptura_OpenService(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CheckDefault(); oClass:AddMethod( "CheckDefault", @TDetCaptura_CheckDefault(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CheckDefaultVir(); oClass:AddMethod( "CheckDefaultVir", @TDetCaptura_CheckDefaultVir(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SaveLines(); oClass:AddMethod( "SaveLines", @TDetCaptura_SaveLines(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TDetCaptura ;



static FUNCTION TDetCaptura_DefineFiles( cPath, cVia ) ; local Self AS CLASS TDetCaptura := QSelf() AS CLASS TDetCaptura

   local oDbf

   If( cPath == nil, cPath := ::cPath, ) ;
   If( cVia == nil, cVia := cDriver(), ) ;

   oDbf := DbfServer( "CapturaCampos.Dbf", "TCapCam" ):New( "CapturaCampos.Dbf", "CapCam", ( cVia ),, ( cPath ) )

      oDbf:AddField( "cCodigo", "C", 3, 0,,,,, "Código", .F.,, .F., {} )
      oDbf:AddField( "nNumero", "N", 2, 0,,,,, "Número", .F.,, .F., {} )
      oDbf:AddField( "cNombre", "C", 50, 0,,,,, "Nombre", .F.,, .F., {} )
      oDbf:AddField( "lEditable", "L", 1, 0,,,,, "Editable", .F.,, .F., {} )
      oDbf:AddField( "lVisible", "L", 1, 0,,,,, "Visble", .F.,, .F., {} )
      oDbf:AddField( "nCaptura", "N", 1, 0,,,,, "Captura", .F.,, .F., {} )
      oDbf:AddField( "cTitulo", "C", 50, 0,,,,, "Título", .F.,, .F., {} )
      oDbf:AddField( "lAlign", "L", 1, 0,,,,, "Align", .F.,, .F., {} )
      oDbf:AddField( "cPicture", "C", 50, 0,,,,, "Picture", .F.,, .F., {} )
      oDbf:AddField( "nAncho", "N", 3, 0,,,,, "Ancho", .F.,, .F., {} )
      oDbf:AddField( "lBitmap", "L", 1, 0,,,,, "Recurso", .F.,, .F., {} )

      oDbf:AddIndex( "cCodigo", "CapturaCampos.Cdx", "cCodigo",,, .F., .F., "Código",,, .T., .F. )



RETURN ( oDbf )



static FUNCTION TDetCaptura_OpenFiles( lExclusive, cPath ) ; local Self AS CLASS TDetCaptura := QSelf() AS CLASS TDetCaptura

   If( lExclusive == nil, lExclusive := .F., ) ;
   If( cPath == nil, cPath := ::cPath, ) ;

   if Empty( ::oDbf )
      ::oDbf            := ::DefineFiles( cPath )
   end

   ::oDbf:Activate( .F., !lExclusive )

   ::CheckDefault( "000", .F. )

   ::bOnPreSaveDetail   := {|| ::SaveLines() }
   ::bOnPreSaveDetail   := {|| ::SaveLines() }

RETURN ( Self )



static FUNCTION TDetCaptura_OpenService( lExclusive, cPath ) ; local Self AS CLASS TDetCaptura := QSelf() AS CLASS TDetCaptura

   local lOpen          := .T.
   local oBlock

   If( lExclusive == nil, lExclusive := .F., ) ;
   If( cPath == nil, cPath := ::cPath, ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

      if Empty( ::oDbf )
         ::oDbf         := ::DefineFiles( cPath )
      end

      ::oDbf:Activate( .F., !( lExclusive ) )

   RECOVER

      lOpen             := .F.

      ::CloseService()

      msgStop( "Imposible abrir todas las bases de datos de detalle de capturas" )

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TDetCaptura_SaveLines( ) ; local Self AS CLASS TDetCaptura := QSelf() AS CLASS TDetCaptura

   ::oDbfVir:cCodigo    := ::oParent:oDbf:cCodigo

RETURN ( Self )



static FUNCTION TDetCaptura_CheckDefault( cCod, lNew ) ; local Self AS CLASS TDetCaptura := QSelf() AS CLASS TDetCaptura

   If( cCod == nil, cCod := "000", ) ;
   If( lNew == nil, lNew := .F., ) ;

   if lNew
      while ::oDbf:Seek( cCod ) .AND. !::oDbf:Eof()
         ::oDbf:Delete( .F. )
      end
   end

   if empty( cCod ) .OR. !( ::oDbf:Seek( cCod ) )

      ::oDbf:cCodigo    := cCod
      ::oDbf:Append()
      ::oDbf:nNumero    := 1
      ::oDbf:cNombre    := "Código del artículo"
      ::oDbf:lEditable  := .F.
      ::oDbf:lVisible   := .T.
      ::oDbf:nCaptura   := 3
      ::oDbf:cTitulo    := "Código"
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 50 )
      ::oDbf:nAncho     := 100
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 2
      ::oDbf:cNombre    := "Unidades"
      ::oDbf:lEditable  := .F.
      ::oDbf:lVisible   := .T.
      ::oDbf:nCaptura   := 3
      ::oDbf:cTitulo    := "Und."
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := "cPicUnd"
      ::oDbf:nAncho     := 60
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 3
      ::oDbf:cNombre    := "Medición 1"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 1
      ::oDbf:cTitulo    := "Med. 1"
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := "cPicUnd"
      ::oDbf:nAncho     := 60
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 4
      ::oDbf:cNombre    := "Medición 2"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 1
      ::oDbf:cTitulo    := "Med. 2"
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := "cPicUnd"
      ::oDbf:nAncho     := 60
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 5
      ::oDbf:cNombre    := "Medición 3"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 1
      ::oDbf:cTitulo    := "Med. 3"
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := "cPicUnd"
      ::oDbf:nAncho     := 60
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 6
      ::oDbf:cNombre    := "Propiedad 1"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Prop. 1"
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 50 )
      ::oDbf:nAncho     := 40
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 7
      ::oDbf:cNombre    := "Propiedad 2"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Prop. 2"
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 50 )
      ::oDbf:nAncho     := 40
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 8
      ::oDbf:cNombre    := "Nombre propiedad 1"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Nombre prp. 1"
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 50 )
      ::oDbf:nAncho     := 40
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 9
      ::oDbf:cNombre    := "Nombre propiedad 2"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Nombre prp. 2"
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 50 )
      ::oDbf:nAncho     := 40
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 10
      ::oDbf:cNombre    := "Lote"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Lote"
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := "@Z 999999999"
      ::oDbf:nAncho     := 60
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 11
      ::oDbf:cNombre    := "Caducidad"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Caducidad"
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := ""
      ::oDbf:nAncho     := 75
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 12
      ::oDbf:cNombre    := "Detalle"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .T.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Detalle"
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 50 )
      ::oDbf:nAncho     := 200
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 13
      ::oDbf:cNombre    := "Importe"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .T.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Importe"
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := "cPouDiv"
      ::oDbf:nAncho     := 80
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 14
      ::oDbf:cNombre    := "Descuento lineal"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .T.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Dto. lin."
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := "cPouDiv"
      ::oDbf:nAncho     := 80
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 15
      ::oDbf:cNombre    := "Descuento porcentual"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .T.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "%Dto."
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := '"@E 99.99"'
      ::oDbf:nAncho     := 40
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 16
      ::oDbf:cNombre    := "Total"
      ::oDbf:lEditable  := .F.
      ::oDbf:lVisible   := .T.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Total"
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := "cPorDiv"
      ::oDbf:nAncho     := 80
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 17
      ::oDbf:cNombre    := "Número de serie"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Nº Serie"
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 50 )
      ::oDbf:nAncho     := 56
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 18
      ::oDbf:cNombre    := "Número de línea"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Nº Línea"
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := "9999"
      ::oDbf:nAncho     := 40
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 19
      ::oDbf:cNombre    := "Código de barras"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .T.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "C. barras"
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 50 )
      ::oDbf:nAncho     := 100
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 20
      ::oDbf:cNombre    := "Promoción"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Prm."
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 50 )
      ::oDbf:nAncho     := 20
      ::oDbf:lBitmap    := .T.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 21
      ::oDbf:cNombre    := "Oferta"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Ofe."
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 50 )
      ::oDbf:nAncho     := 20
      ::oDbf:lBitmap    := .T.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 22
      ::oDbf:cNombre    := "Ubicación"
      ::oDbf:lEditable  := .F.
      ::oDbf:lVisible   := .T.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "Ubi."
      ::oDbf:lAlign     := .F.
      ::oDbf:cPicture   := Space( 60 )
      ::oDbf:nAncho     := 100
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 23
      ::oDbf:cNombre    := "Factor"
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .F.
      ::oDbf:nCaptura   := 3
      ::oDbf:cTitulo    := "Factor"
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := "@E 999,999.999999"
      ::oDbf:nAncho     := 60
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

      ::oDbf:Append()
      ::oDbf:cCodigo    := cCod
      ::oDbf:nNumero    := 24
      ::oDbf:cNombre    := "Porcentaje I.V.A."
      ::oDbf:lEditable  := .T.
      ::oDbf:lVisible   := .T.
      ::oDbf:nCaptura   := 2
      ::oDbf:cTitulo    := "%IVA"
      ::oDbf:lAlign     := .T.
      ::oDbf:cPicture   := '"@E 99.99"'
      ::oDbf:nAncho     := 40
      ::oDbf:lBitmap    := .F.
      ::oDbf:Save()

   end

RETURN ( .T. )



static FUNCTION TDetCaptura_CheckDefaultVir( ) ; local Self AS CLASS TDetCaptura := QSelf() AS CLASS TDetCaptura

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 1
      ::oDbfVir:cNombre    := "Código del artículo"
      ::oDbfVir:lEditable  := .F.
      ::oDbfVir:lVisible   := .T.
      ::oDbfVir:nCaptura   := 3
      ::oDbfVir:cTitulo    := "Código"
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 50 )
      ::oDbfVir:nAncho     := 100
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 2
      ::oDbfVir:cNombre    := "Unidades"
      ::oDbfVir:lEditable  := .F.
      ::oDbfVir:lVisible   := .T.
      ::oDbfVir:nCaptura   := 3
      ::oDbfVir:cTitulo    := "Und."
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := "cPicUnd"
      ::oDbfVir:nAncho     := 60
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 3
      ::oDbfVir:cNombre    := "Medición 1"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 1
      ::oDbfVir:cTitulo    := "Med. 1"
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := "cPicUnd"
      ::oDbfVir:nAncho     := 60
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 4
      ::oDbfVir:cNombre    := "Medición 2"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 1
      ::oDbfVir:cTitulo    := "Med. 2"
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := "cPicUnd"
      ::oDbfVir:nAncho     := 60
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 5
      ::oDbfVir:cNombre    := "Medición 3"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 1
      ::oDbfVir:cTitulo    := "Med. 3"
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := "cPicUnd"
      ::oDbfVir:nAncho     := 60
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 6
      ::oDbfVir:cNombre    := "Propiedad 1"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Prop. 1"
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 50 )
      ::oDbfVir:nAncho     := 40
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 7
      ::oDbfVir:cNombre    := "Propiedad 2"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Prop. 2"
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 50 )
      ::oDbfVir:nAncho     := 40
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 8
      ::oDbfVir:cNombre    := "Nombre propiedad 1"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Nombre prp. 1"
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 50 )
      ::oDbfVir:nAncho     := 40
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 9
      ::oDbfVir:cNombre    := "Nombre propiedad 2"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Nombre prp. 2"
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 50 )
      ::oDbfVir:nAncho     := 40
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 10
      ::oDbfVir:cNombre    := "Lote"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Lote"
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := "@Z 999999999"
      ::oDbfVir:nAncho     := 60
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 11
      ::oDbfVir:cNombre    := "Caducidad"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Caducidad"
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := ""
      ::oDbfVir:nAncho     := 75
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 12
      ::oDbfVir:cNombre    := "Detalle"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .T.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Detalle"
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 50 )
      ::oDbfVir:nAncho     := 200
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 13
      ::oDbfVir:cNombre    := "Importe"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .T.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Importe"
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := "cPouDiv"
      ::oDbfVir:nAncho     := 80
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 14
      ::oDbfVir:cNombre    := "Descuento lineal"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .T.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Dto. lin."
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := "cPouDiv"
      ::oDbfVir:nAncho     := 80
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 15
      ::oDbfVir:cNombre    := "Descuento porcentual"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .T.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "%Dto."
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := '"@E 99.99"'
      ::oDbfVir:nAncho     := 40
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 16
      ::oDbfVir:cNombre    := "Total"
      ::oDbfVir:lEditable  := .F.
      ::oDbfVir:lVisible   := .T.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Total"
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := "cPorDiv"
      ::oDbfVir:nAncho     := 80
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 17
      ::oDbfVir:cNombre    := "Número de serie"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Nº Serie"
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 50 )
      ::oDbfVir:nAncho     := 56
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 18
      ::oDbfVir:cNombre    := "Número de línea"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Nº Línea"
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := "9999"
      ::oDbfVir:nAncho     := 40
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 19
      ::oDbfVir:cNombre    := "Código de barras"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .T.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "C. barras"
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 50 )
      ::oDbfVir:nAncho     := 100
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 20
      ::oDbfVir:cNombre    := "Promoción"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Prm."
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 50 )
      ::oDbfVir:nAncho     := 20
      ::oDbfVir:lBitmap    := .T.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 21
      ::oDbfVir:cNombre    := "Oferta"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Ofe."
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 50 )
      ::oDbfVir:nAncho     := 20
      ::oDbfVir:lBitmap    := .T.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 22
      ::oDbfVir:cNombre    := "Ubicación"
      ::oDbfVir:lEditable  := .F.
      ::oDbfVir:lVisible   := .T.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "Ubi."
      ::oDbfVir:lAlign     := .F.
      ::oDbfVir:cPicture   := Space( 60 )
      ::oDbfVir:nAncho     := 100
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 23
      ::oDbfVir:cNombre    := "Factor"
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .F.
      ::oDbfVir:nCaptura   := 3
      ::oDbfVir:cTitulo    := "Factor"
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := "@E 999,999.999999"
      ::oDbfVir:nAncho     := 60
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

      ::oDbfVir:Append()
      ::oDbfVir:cCodigo    := Space( 3 )
      ::oDbfVir:nNumero    := 24
      ::oDbfVir:cNombre    := "Porcentaje I.V.A."
      ::oDbfVir:lEditable  := .T.
      ::oDbfVir:lVisible   := .T.
      ::oDbfVir:nCaptura   := 2
      ::oDbfVir:cTitulo    := "%IVA"
      ::oDbfVir:lAlign     := .T.
      ::oDbfVir:cPicture   := '"@E 99.99"'
      ::oDbfVir:nAncho     := 40
      ::oDbfVir:lBitmap    := .F.
      ::oDbfVir:Save()

RETURN ( .T. )
