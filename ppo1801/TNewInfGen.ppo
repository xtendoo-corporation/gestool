#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 7 ".\.\Prg\TNewInfGen.prg"
memvar dFechaInicio
memvar dFechaFin
memvar cGrupoFabricanteDesde
memvar cGrupoFabricanteHasta
memvar cGrupoArticuloDesde
memvar cGrupoArticuloHasta
memvar cGrupoMateriaPrimaDesde
memvar cGrupoMateriaPrimaHasta
memvar cGrupoClienteDesde
memvar cGrupoClienteHasta
memvar cGrupoRutaDesde
memvar cGrupoRutaHasta
memvar cGrupoAgenteDesde
memvar cGrupoAgenteHasta
memvar cGrupoProveedorDesde
memvar cGrupoProveedorHasta
memvar cGrupoTemporadaDesde
memvar cGrupoTemporadaHasta
memvar cGrupoCategoriaDesde
memvar cGrupoCategoriaHasta
memvar cGrupoEstadoArticuloDesde
memvar cGrupoEstadoArticuloHasta
memvar cGrupoFamiliaDesde
memvar cGrupoFamiliaHasta
memvar cGrupoTArticuloDesde
memvar cGrupoTArticuloHasta
memvar cGrupoAlmacenDesde
memvar cGrupoAlmacenHasta
memvar cGrupoCentroCosteDesde
memvar cGrupoCentroCosteHasta
memvar cGrupoGClienteDesde
memvar cGrupoGClienteHasta
memvar cGrupoGClienteNombreDesde
memvar cGrupoGClienteNombreHasta
memvar cGrupoArticuloNombreDesde
memvar cGrupoArticuloNombreHasta
memvar cGrupoClienteNombreDesde
memvar cGrupoClienteNombreHasta
memvar cGrupoTransportistaDesde
memvar cGrupoTransportistaHasta
memvar cGrupoTransportistaNombreDesde
memvar cGrupoTransportistaNombreHasta
memvar cGrupoCCosteNombreDesde
memvar cGrupoCCosteNombreHasta



_HB_CLASS TNewInfGen ; function TNewInfGen ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TNewInfGen", iif( .T., { @TInfGen() }, { @HBObject() } ), @TNewInfGen() ) ) ;

   _HB_MEMBER { lDefEstadoUno } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDefEstadoUno"}, .F. )
   _HB_MEMBER { oEstadoUno } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oEstadoUno"}, .F. )
   _HB_MEMBER { cEstadoUno } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cEstadoUno"}, .F. )
   _HB_MEMBER { aEstadoUno } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aEstadoUno"}, .F. )

   _HB_MEMBER { lDefEstadoDos } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDefEstadoDos"}, .F. )
   _HB_MEMBER { oEstadoDos } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oEstadoDos"}, .F. )
   _HB_MEMBER { cEstadoDos } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cEstadoDos"}, .F. )
   _HB_MEMBER { aEstadoDos } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aEstadoDos"}, .F. )

   _HB_MEMBER { lDefCondiciones } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDefCondiciones"}, .F. )
   _HB_MEMBER { oGrupoCondiciones } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoCondiciones"}, .F. )
   _HB_MEMBER { oTreeCondiciones } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTreeCondiciones"}, .F. )

   _HB_MEMBER { oTreeRango } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTreeRango"}, .F. )
   _HB_MEMBER { oImageList } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oImageList"}, .F. )

   _HB_MEMBER { oDesde } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDesde"}, .F. )
   _HB_MEMBER { cDesde } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cDesde"}, .F. )
   _HB_MEMBER { oSayDesde } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayDesde"}, .F. )
   _HB_MEMBER { cSayDesde } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSayDesde"}, .F. )

   _HB_MEMBER { oHasta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oHasta"}, .F. )
   _HB_MEMBER { cHasta } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cHasta"}, .F. )
   _HB_MEMBER { oSayHasta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayHasta"}, .F. )
   _HB_MEMBER { cSayHasta } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSayHasta"}, .F. )

   _HB_MEMBER { oTodos } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTodos"}, .F. )
   _HB_MEMBER { lTodos } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lTodos"}, .F. )

   _HB_MEMBER { oDesglosar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDesglosar"}, .F. )
   _HB_MEMBER { lDesglosar } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDesglosar"}, .F. )
   _HB_MEMBER { oLinImporteCero } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oLinImporteCero"}, .F. )
   _HB_MEMBER { lLinImporteCero } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lLinImporteCero"}, .F. )
   _HB_MEMBER { oDocImporteCero } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDocImporteCero"}, .F. )
   _HB_MEMBER { lDocImporteCero } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDocImporteCero"}, .F. )

   _HB_MEMBER { oTipOpera } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTipOpera"}, .F. )

   _HB_MEMBER { oGrupoArticulo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoArticulo"}, .F. )
   _HB_MEMBER { oGrupoMateriaPrima } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoMateriaPrima"}, .F. )
   _HB_MEMBER { oGrupoCliente } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoCliente"}, .F. )
   _HB_MEMBER { oGrupoProveedor } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoProveedor"}, .F. )
   _HB_MEMBER { oGrupoOperacion } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoOperacion"}, .F. )
   _HB_MEMBER { oGrupoSeccion } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoSeccion"}, .F. )
   _HB_MEMBER { oGrupoAlmacen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoAlmacen"}, .F. )
   _HB_MEMBER { oGrupoAlmacenOrigen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoAlmacenOrigen"}, .F. )
   _HB_MEMBER { oGrupoMaquina } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoMaquina"}, .F. )
   _HB_MEMBER { oGrupoOperario } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoOperario"}, .F. )
   _HB_MEMBER { oGrupoFpago } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoFpago"}, .F. )
   _HB_MEMBER { oGrupoBanco } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoBanco"}, .F. )
   _HB_MEMBER { oGrupoAgente } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoAgente"}, .F. )
   _HB_MEMBER { oGrupoCaja } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoCaja"}, .F. )
   _HB_MEMBER { oGrupoCategoria } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoCategoria"}, .F. )
   _HB_MEMBER { oGrupoGCliente } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoGCliente"}, .F. )
   _HB_MEMBER { oGrupoGProveedor } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoGProveedor"}, .F. )
   _HB_MEMBER { oGrupoObra } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoObra"}, .F. )
   _HB_MEMBER { oGrupoFamilia } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoFamilia"}, .F. )
   _HB_MEMBER { oGrupoGFamilia } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoGFamilia"}, .F. )
   _HB_MEMBER { oGrupoTArticulo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoTArticulo"}, .F. )
   _HB_MEMBER { oGrupoFabricante } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoFabricante"}, .F. )
   _HB_MEMBER { oGrupoTOperacion } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoTOperacion"}, .F. )
   _HB_MEMBER { oGrupoEstadoArticulo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoEstadoArticulo"}, .F. )
   _HB_MEMBER { oGrupoRuta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoRuta"}, .F. )
   _HB_MEMBER { oGrupoFacturas } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoFacturas"}, .F. )
   _HB_MEMBER { oGrupoFacturasCompras } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoFacturasCompras"}, .F. )
   _HB_MEMBER { oGrupoTemporada } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoTemporada"}, .F. )
   _HB_MEMBER { oGrupoIVA } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoIVA"}, .F. )
   _HB_MEMBER { oGrupoSerie } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoSerie"}, .F. )
   _HB_MEMBER { oGrupoNumero } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoNumero"}, .F. )
   _HB_MEMBER { oGrupoSufijo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoSufijo"}, .F. )
   _HB_MEMBER { oGrupoRemesas } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoRemesas"}, .F. )

   _HB_MEMBER { oTipoExpediente } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTipoExpediente"}, .F. )
   _HB_MEMBER { oGrupoTipoExpediente } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoTipoExpediente"}, .F. )

   _HB_MEMBER { oEntidad } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oEntidad"}, .F. )
   _HB_MEMBER { oGrupoEntidad } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoEntidad"}, .F. )

   _HB_MEMBER { oColaborador } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oColaborador"}, .F. )
   _HB_MEMBER { oGrupoColaborador } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoColaborador"}, .F. )

   _HB_MEMBER { oCuentasBancarias } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oCuentasBancarias"}, .F. )
   _HB_MEMBER { oGrupoCuentasBancarias } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoCuentasBancarias"}, .F. )

   _HB_MEMBER { oColNombre } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oColNombre"}, .F. )

   _HB_MEMBER { oFastReport } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFastReport"}, .F. )

   _HB_MEMBER { oPeriodo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPeriodo"}, .F. )
   _HB_MEMBER { cPeriodo } ; oClass:AddMultiData(, "Mes en curso", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPeriodo"}, .F. )
   _HB_MEMBER { aPeriodo } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aPeriodo"}, .F. )

   _HB_MEMBER { oFacCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacCliT"}, .F. )
   _HB_MEMBER { oFacPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacPrvT"}, .F. )
   _HB_MEMBER { oFacPrvP } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacPrvP"}, .F. )

   _HB_MEMBER { oHoraInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oHoraInicio"}, .F. )
   _HB_MEMBER { cHoraInicio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cHoraInicio"}, .F. )
   _HB_MEMBER { oHoraFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oHoraFin"}, .F. )
   _HB_MEMBER { cHoraFin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cHoraFin"}, .F. )

   _HB_MEMBER { oDbfCentroCoste } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfCentroCoste"}, .F. )
   _HB_MEMBER { oGrupoCentroCoste } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrupoCentroCoste"}, .F. )

   _HB_MEMBER NewResource(); oClass:AddMethod( "NewResource", @TNewInfGen_NewResource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoArticulo( lInitGroup, lImp); oClass:AddMethod( "lGrupoArticulo", @TNewInfGen_lGrupoArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoMateriaPrima( lInitGroup, lImp); oClass:AddMethod( "lGrupoMateriaPrima", @TNewInfGen_lGrupoMateriaPrima(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoCliente( lInitGroup, lImp); oClass:AddMethod( "lGrupoCliente", @TNewInfGen_lGrupoCliente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoOperacion( lInitGroup, lImp); oClass:AddMethod( "lGrupoOperacion", @TNewInfGen_lGrupoOperacion(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoSeccion( lInitGroup, lImp); oClass:AddMethod( "lGrupoSeccion", @TNewInfGen_lGrupoSeccion(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoAlmacen( lInitGroup, lImp); oClass:AddMethod( "lGrupoAlmacen", @TNewInfGen_lGrupoAlmacen(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoAlmacenOrigen( lInitGroup, lImp); oClass:AddMethod( "lGrupoAlmacenOrigen", @TNewInfGen_lGrupoAlmacenOrigen(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoMaquina( lInitGroup, lImp); oClass:AddMethod( "lGrupoMaquina", @TNewInfGen_lGrupoMaquina(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoOperario( lInitGroup, lImp); oClass:AddMethod( "lGrupoOperario", @TNewInfGen_lGrupoOperario(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoFPago( lInitGroup, lImp); oClass:AddMethod( "lGrupoFPago", @TNewInfGen_lGrupoFPago(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoBanco( lInitGroup, lImp); oClass:AddMethod( "lGrupoBanco", @TNewInfGen_lGrupoBanco(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoAgente( lInitGroup, lImp); oClass:AddMethod( "lGrupoAgente", @TNewInfGen_lGrupoAgente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoCaja( lInitGroup, lImp); oClass:AddMethod( "lGrupoCaja", @TNewInfGen_lGrupoCaja(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoGrupoCliente( lInitGroup, lImp); oClass:AddMethod( "lGrupoGrupoCliente", @TNewInfGen_lGrupoGrupoCliente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoGProveedor( lInitGroup, lImp); oClass:AddMethod( "lGrupoGProveedor", @TNewInfGen_lGrupoGProveedor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoObra( lInitGroup, lImp); oClass:AddMethod( "lGrupoObra", @TNewInfGen_lGrupoObra(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoFamilia( lInitGroup, lImp); oClass:AddMethod( "lGrupoFamilia", @TNewInfGen_lGrupoFamilia(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoGFamilia( lInitGroup, lImp); oClass:AddMethod( "lGrupoGFamilia", @TNewInfGen_lGrupoGFamilia(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoCentroCoste( lInitGroup, lImp); oClass:AddMethod( "lGrupoCentroCoste", @TNewInfGen_lGrupoCentroCoste(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoTipoArticulo( lInitGroup, lImp); oClass:AddMethod( "lGrupoTipoArticulo", @TNewInfGen_lGrupoTipoArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoFabricante( lInitGroup, lImp); oClass:AddMethod( "lGrupoFabricante", @TNewInfGen_lGrupoFabricante(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoTOperacion( lInitGroup, lImp); oClass:AddMethod( "lGrupoTOperacion", @TNewInfGen_lGrupoTOperacion(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoProveedor( lInitGroup, lImp); oClass:AddMethod( "lGrupoProveedor", @TNewInfGen_lGrupoProveedor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoTipoExpediente( lInitGroup, lImp); oClass:AddMethod( "lGrupoTipoExpediente", @TNewInfGen_lGrupoTipoExpediente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoEntidad( lInitGroup, lImp); oClass:AddMethod( "lGrupoEntidad", @TNewInfGen_lGrupoEntidad(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoColaborador( lInitGroup, lImp); oClass:AddMethod( "lGrupoColaborador", @TNewInfGen_lGrupoColaborador(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoEstadoArticulo( lInitGroup, lImp); oClass:AddMethod( "lGrupoEstadoArticulo", @TNewInfGen_lGrupoEstadoArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoRuta( lInitGroup, lImp); oClass:AddMethod( "lGrupoRuta", @TNewInfGen_lGrupoRuta(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoFacturas( lInitGroup, lImp); oClass:AddMethod( "lGrupoFacturas", @TNewInfGen_lGrupoFacturas(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoFacturasCompras( lInitGroup, lImp); oClass:AddMethod( "lGrupoFacturasCompras", @TNewInfGen_lGrupoFacturasCompras(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoTemporada( lInitGroup, lImp); oClass:AddMethod( "lGrupoTemporada", @TNewInfGen_lGrupoTemporada(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoCategoria( lInitGroup, lImp); oClass:AddMethod( "lGrupoCategoria", @TNewInfGen_lGrupoCategoria(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoIva( lInitGroup, lImp); oClass:AddMethod( "lGrupoIva", @TNewInfGen_lGrupoIva(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoEntidadesBancarias( lInitGroup, lImp); oClass:AddMethod( "lGrupoEntidadesBancarias", @TNewInfGen_lGrupoEntidadesBancarias(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoSerie( lInitGroup, lImp); oClass:AddMethod( "lGrupoSerie", @TNewInfGen_lGrupoSerie(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoNumero( lInitGroup, lImp); oClass:AddMethod( "lGrupoNumero", @TNewInfGen_lGrupoNumero(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoSufijo( lInitGroup, lImp); oClass:AddMethod( "lGrupoSufijo", @TNewInfGen_lGrupoSufijo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGrupoRemesas( lInitGroup, lImp); oClass:AddMethod( "lGrupoRemesas", @TNewInfGen_lGrupoRemesas(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefEstados( nIdEstadoUno, nIdEstadoDos); oClass:AddMethod( "oDefEstados", @TNewInfGen_oDefEstados(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefDesde( nIdDesde, nIdSayDesde); oClass:AddMethod( "oDefDesde", @TNewInfGen_oDefDesde(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefHasta( nIdHasta, nIdSayHasta); oClass:AddMethod( "oDefHasta", @TNewInfGen_oDefHasta(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefTodos( nIdTodos); oClass:AddMethod( "oDefTodos", @TNewInfGen_oDefTodos(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER HideCondiciones(); oClass:AddMethod( "HideCondiciones", @TNewInfGen_HideCondiciones(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ChangeRango(); oClass:AddMethod( "ChangeRango", @TNewInfGen_ChangeRango(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ChangeValor(); oClass:AddMethod( "ChangeValor", @TNewInfGen_ChangeValor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetValor(); oClass:AddMethod( "SetValor", @TNewInfGen_SetValor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER InitDialog(); oClass:AddMethod( "InitDialog", @TNewInfGen_InitDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefDesglosar(); oClass:AddMethod( "oDefDesglosar", @TNewInfGen_oDefDesglosar(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefLinImporteCero(); oClass:AddMethod( "oDefLinImporteCero", @TNewInfGen_oDefLinImporteCero(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefDocImporteCero(); oClass:AddMethod( "oDefDocImporteCero", @TNewInfGen_oDefDocImporteCero(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lIgualCliente(); oClass:AddMethod( "lIgualCliente", @TNewInfGen_lIgualCliente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lPeriodoInforme( nId, oDlg); oClass:AddMethod( "lPeriodoInforme", @TNewInfGen_lPeriodoInforme(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lRecargaFecha(); oClass:AddMethod( "lRecargaFecha", @TNewInfGen_lRecargaFecha(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER lHideFecha(); oClass:AddMethod( "lHideFecha", @TNewInfGen_lHideFecha(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER lShowFecha(); oClass:AddMethod( "lShowFecha", @TNewInfGen_lShowFecha(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lCreaArrayPeriodos(); oClass:AddMethod( "lCreaArrayPeriodos", @TNewInfGen_lCreaArrayPeriodos(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FastReport() ; oClass:AddVirtual( "FastReport" )

   _HB_MEMBER DataReport() ; oClass:AddVirtual( "DataReport" )

   _HB_MEMBER oDefHoraInicio( nId, oDlg); oClass:AddMethod( "oDefHoraInicio", @TNewInfGen_oDefHoraInicio(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefHoraFin( nId, oDlg); oClass:AddMethod( "oDefHoraFin", @TNewInfGen_oDefHoraFin(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddVariable(); oClass:AddMethod( "AddVariable", @TNewInfGen_AddVariable(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SaveReport(); oClass:AddMethod( "SaveReport", @TNewInfGen_SaveReport(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER MoveReport(); oClass:AddMethod( "MoveReport", @TNewInfGen_MoveReport(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER End(); oClass:AddMethod( "End", @TNewInfGen_End(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetNombreDesdeGrupoCliente(); oClass:AddMethod( "SetNombreDesdeGrupoCliente", @TNewInfGen_SetNombreDesdeGrupoCliente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER SetNombreHastaGrupoCliente(); oClass:AddMethod( "SetNombreHastaGrupoCliente", @TNewInfGen_SetNombreHastaGrupoCliente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetNombreDesdeCliente(); oClass:AddMethod( "SetNombreDesdeCliente", @TNewInfGen_SetNombreDesdeCliente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER SetNombreHastaCliente(); oClass:AddMethod( "SetNombreHastaCliente", @TNewInfGen_SetNombreHastaCliente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetNombreDesdeArticulo(); oClass:AddMethod( "SetNombreDesdeArticulo", @TNewInfGen_SetNombreDesdeArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER SetNombreHastaArticulo(); oClass:AddMethod( "SetNombreHastaArticulo", @TNewInfGen_SetNombreHastaArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetNombreDesdeCentroCoste(); oClass:AddMethod( "SetNombreDesdeCentroCoste", @TNewInfGen_SetNombreDesdeCentroCoste(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER SetNombreHastaCentroCoste(); oClass:AddMethod( "SetNombreHastaCentroCoste", @TNewInfGen_SetNombreHastaCentroCoste(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TNewInfGen ;



static FUNCTION TNewInfGen_NewResource( cFldRes ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local n
   local oCellView
   local oImagen
   local oShadow
   local aoFont      := { , , }
   local aoSizes     := { , , }
   local aoEstilo    := { , , }
   local aSizes      := { "8", "10", "12", "14", "16", "18", "20", "22", "24", "26", "28", "36", "48", "72" }
   local aEstilo     := { "Normal", "Cursiva", "Negrita", "Negrita Cursiva" }
   local aPad        := { "Izquierda", "Derecha" }
   local oPrinter

   If( cFldRes == nil, cFldRes := "INF_GEN_01", ) ;





   if !::OpenData()
      Return .F.
   end





   ::oDbf:Activate( .F., .F. )





   for n := 1 to len( ::aIndex )











      ::oDbf:AddTmpIndex(  ::aIndex[n,1], ::cFileIndx, ::aIndex[n,2], ::aIndex[n,3], ::aIndex[n,4], ::aIndex[n,5], ::aIndex[n,6], , , , , .T. )
   next





   ::lCreaArrayPeriodos()





   if !::lBig
      ::oDlg = TDialog():New(,,,, ::cSubTitle, "INF_GEN",, .F.,,,,,, .F.,,,,,, .F.,, "::oDlg", nil, )
   else
      ::oDlg = TDialog():New(,,,, ::cSubTitle, "INF_GENBIG",, .F.,,,,,, .F.,,,,,, .F.,, "::oDlg", nil, )
   end






   if !::lNewInforme
      ::oFld := TFolder():ReDefine( 400, {"I&nforme", "&Columnas", "A&pariencia" }, { cFldRes, "INF_GEN_COL", "INF_GEN_PRN" }, ::oDlg )
   else
      ::oFld := TFolder():ReDefine( 400, {"I&nforme", "A&grupar...", "&Columnas", "A&pariencia" }, { cFldRes, "INF_GEN_AGRUPA", "INF_GEN_COL", "INF_GEN_PRN" }, ::oDlg )
   end





   ::CreateColumn()





   ::Default()





   ::oImageList            := TImageList():New( 16, 16 )
   ::oImageGroup           := TImageList():New( 16, 16 )





   if ::lDefDesHas
      ::oDefDesHas()
   end





   if ::lDefFecInf
      ::oDefIniInf()
      ::oDefFinInf()
      ::lPeriodoInforme()
   end





   ::oDefEstados()





   ::oTreeRango                     := TTreeView():Redefine( 100, ::oFld:aDialogs[ 1 ] )
   ::oTreeRango:bChanged            := {|| ::ChangeRango() }
   ::oTreeRango:bLostFocus          := {|| ::ChangeValor() }





   ::oDefTodos()
   ::oDefDesde()
   ::oDefHasta()





   ::oGrupoCondiciones := TGroup():ReDefine( 131,, ::oFld:aDialogs[ 1 ],,,, .T. )

   ::oTreeCondiciones               := TTreeView():Redefine( 130, ::oFld:aDialogs[1] )





   if ::lDefDivInf
      ::oDefDivInf()
   end





   if ::lDefTitInf
      ::oDefTitInf()
   end





   if ::lDefMetInf
      ::oDefMetInf()
   end





   if ::lDefSerInf
      ::oDefSerInf()
   end





   if ::lNewInforme

   ::oTreeGroups           := TTreeView():Redefine( 100, ::oFld:aDialogs[2]  )
   ::oTreeGroups:bLDblClick:= {|| ::AddSelectedGroup() }

   ::oTreeSelectedGroups   := TTreeView():Redefine( 110, ::oFld:aDialogs[2]  )




   TButton():ReDefine( 120, {||( ::AddSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 130, {||( ::DelSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 140, {||( ::UpSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 150, {||( ::DownSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 160, {||( ::BtnDefectoGrupo() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )

   end





   ::oBrwCol                        := IXBrowse():New( if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ) )

   ::oBrwCol:bClrSel                := {|| { 0, ( 229 + ( 229 * 256 ) + ( 229 * 65536 ) ) } }
   ::oBrwCol:bClrSelFocus           := {|| { 0, ( 167 + ( 205 * 256 ) + ( 240 * 65536 ) ) } }

   ::oBrwCol:SetArray( ::aoCols, , , .F. )

   ::oBrwCol:nMarqueeStyle          := 5
   ::oBrwCol:lHScroll               := .F.

   ::oBrwCol:bLDblClick := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lEditCol(), ::oBrwCol:Refresh() }
   ::oBrwCol:bRClicked  := {| nRow, nCol | ::oBrwCol:LButtonDown( nRow, nCol ), ::aoCols[ ::oBrwCol:nArrayAt ]:Toogle(), ::oBrwCol:Refresh() }

   ::oBrwCol:CreateFromResource( 200 )

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Se.Seleccionada"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lSelect }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Columna"
      :bStrData         := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:cDescrip }
      :nWidth           := 140
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Título"
      :bStrData         := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:cTitle }
      :nWidth           := 140
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Alineación"
      :bStrData         := {|| aPad[ Max( ::aoCols[ ::oBrwCol:nArrayAt ]:nPad, 1 ) ] }
      :nWidth           := 70
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "To.Totalizada"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lTotal }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Sp.Separación"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lSeparador }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "So.Sombra"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lSombra }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end




   TButton():ReDefine( 538, {||::UpColumn()}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 539, {||::DwColumn()}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 514, {||( ::aoCols[ ::oBrwCol:nArrayAt ]:Select(), ::oBrwCol:SetFocus(), ::oBrwCol:Refresh() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 540, {||( ::aoCols[ ::oBrwCol:nArrayAt ]:UnSelect(), ::oBrwCol:SetFocus(), ::oBrwCol:Refresh() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 501, {||( ::aoCols[ ::oBrwCol:nArrayAt ]:lEditCol(), ::oBrwCol:Refresh() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   ::oBtnOriginal := TButton():ReDefine( 517, {||( ::PutOriginal() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )








   aoFont[1] := TComboBox():ReDefine( 210, { | u | If( PCount()==0, ::acFont[1], ::acFont[1]:= u ) }, ::aFont, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoFont[1]",,,,,,, )




   aoSizes[1] := TComboBox():ReDefine( 220, { | u | If( PCount()==0, ::acSizes[1], ::acSizes[1]:= u ) }, aSizes, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoSizes[1]",,,,,,, )




   aoEstilo[1] := TComboBox():ReDefine( 230, { | u | If( PCount()==0, ::acEstilo[1], ::acEstilo[1]:= u ) }, aEstilo, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoEstilo[1]",,,,,,, )




   aoFont[2] := TComboBox():ReDefine( 240, { | u | If( PCount()==0, ::acFont[2], ::acFont[2]:= u ) }, ::aFont, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoFont[2]",,,,,,, )




   aoSizes[2] := TComboBox():ReDefine( 250, { | u | If( PCount()==0, ::acSizes[2], ::acSizes[2]:= u ) }, aSizes, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoSizes[2]",,,,,,, )




   aoEstilo[2] := TComboBox():ReDefine( 260, { | u | If( PCount()==0, ::acEstilo[2], ::acEstilo[2]:= u ) }, aEstilo, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoEstilo[2]",,,,,,, )




   aoFont[3] := TComboBox():ReDefine( 270, { | u | If( PCount()==0, ::acFont[3], ::acFont[3]:= u ) }, ::aFont, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoFont[3]",,,,,,, )




   aoSizes[3] := TComboBox():ReDefine( 280, { | u | If( PCount()==0, ::acSizes[3], ::acSizes[3]:= u ) }, aSizes, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoSizes[3]",,,,,,, )




   aoEstilo[3] := TComboBox():ReDefine( 290, { | u | If( PCount()==0, ::acEstilo[3], ::acEstilo[3]:= u ) }, aEstilo, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoEstilo[3]",,,,,,, )



   oCellView := TCheckBox():ReDefine( 300, { | u | If( PCount()==0, ::lCellView, ::lCellView:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,, .F. )



   oShadow := TCheckBox():ReDefine( 310, { | u | If( PCount()==0, ::lShadow, ::lShadow:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,, .F. )





   TGetHlp():ReDefine( 320, { | u | If( PCount()==0, ::nLenPage, ::nLenPage:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 330, { | u | If( PCount()==0, ::nWidthPage, ::nWidthPage:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )




   ::oOrientation := TComboBox():ReDefine( ( 420), { | u | If( PCount()==0, ::cOrientation, ::cOrientation:= u ) }, ::aOrientation, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "::oOrientation",,,,,,, )







   oImagen := TGetHlp():ReDefine( 340, { | u | If( PCount()==0, ::cImagen, ::cImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,,,, .F.,,, .F., .F.,,,,,, nil,,, )

   oImagen:cBmp   := "Folder"
   oImagen:bHelp  := {|| oImagen:cText( cGetFile( "*.bmp", "Selección de imagen" ) ), oImagen:lValid() }
   oImagen:bValid := {|| if( !Empty( Rtrim( ::cImagen ) ), ::oBmpImagen:LoadBmp( Rtrim( ::cImagen ) ), ), .T. }




   ::oBmpImagen := TBitmap():ReDefine( 400,, ::cImagen, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,, .F., .F.,,, .F.,,, .F. )





   TGetHlp():ReDefine( 360, { | u | If( PCount()==0, ::nFilaImagen, ::nFilaImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 370, { | u | If( PCount()==0, ::nColumnaImagen, ::nColumnaImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 380, { | u | If( PCount()==0, ::nAnchoImagen, ::nAnchoImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 390, { | u | If( PCount()==0, ::nAltoImagen, ::nAltoImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )








   oPrinter := TGetHlp():ReDefine( 350, { | u | If( PCount()==0, ::cPrinter, ::cPrinter:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,,,, .F., {||     ( .F. )},, .F., .F.,,,,,, nil,,, )

   TBtnBmp():ReDefine( 351, "gc_printer2_check_16",,,,,{|| PrinterPreferences( oPrinter ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ), .F., , .F.,  )







   TGetHlp():ReDefine( 410, { | u | If( PCount()==0, ::cFooter, ::cFooter:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,,,, .F.,,, .F., .F.,,,,,, nil,,, )








   ::oBtnFilter := TButton():ReDefine( 510, {||( ::DlgFilter(), if( !Empty( ::oFilter:bExpresionFilter ), SetWindowText( ::oBtnFilter:hWnd, "Filtro activo" ), SetWindowText( ::oBtnFilter:hWnd, "Filtrar" ) ) )}, ::oDlg,,, .F.,,,, .F. )




   ::oBtnAction := TButton():ReDefine( 560, {||( ::GenReport() )}, ::oDlg,,, .F.,,,, .F. )






   ::oCmbReport := TComboBox():ReDefine( 600, { | u | If( PCount()==0, ::cCmbReport, ::cCmbReport:= u ) }, ::aCmbReport, ::oDlg,,,,,,, .F.,, ::aBmpReport,,,,, "::oCmbReport",,,,,,, )





   ::oBtnCancel := TButton():ReDefine( 570, {||( ::lBreak := .T., ::End() )}, ::oDlg,,, .F.,,,, .T. )

RETURN .T.



static FUNCTION TNewInfGen_lGrupoArticulo( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   If( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   if ::oDbfArt == nil .OR. !::oDbfArt:Used()
      ::oDbfArt := DbfServer( "ARTICULO.DBF", ):NewOpen( "ARTICULO.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfArt:AddBag( "ARTICULO.CDX" ) ; ::oDbfArt:AddBag( ) ; ::oDbfArt:AutoIndex()
   end

   ::oGrupoArticulo                    := TRGroup():New( {|| ::oDbf:cCodArt }, {|| "Artículo : " + AllTrim( ::oDbf:cCodArt ) + " - " + AllTRim( ::oDbf:cNomArt ) }, {|| "Total artículo..." }, {|| 3 }, ::lSalto )

   ::oGrupoArticulo:Cargo              := TItemGroup()
   ::oGrupoArticulo:Cargo:Nombre       := "Artículo"
   ::oGrupoArticulo:Cargo:Expresion    := "cCodArt"
   ::oGrupoArticulo:Cargo:Todos        := .T.
   ::oGrupoArticulo:Cargo:Desde        := Space( 18 )
   ::oGrupoArticulo:Cargo:Hasta        := Replicate( "Z", 18 )
   ::oGrupoArticulo:Cargo:cPicDesde    := Replicate( "#", 18 )
   ::oGrupoArticulo:Cargo:cPicHasta    := Replicate( "#", 18 )
   ::oGrupoArticulo:Cargo:TextDesde    := {|| ::SetNombreDesdeArticulo() }
   ::oGrupoArticulo:Cargo:TextHasta    := {|| ::SetNombreHastaArticulo() }
   ::oGrupoArticulo:Cargo:HelpDesde    := {|| BrwSelArticulo( ::oDesde, ::oSayDesde, , .F. ) }
   ::oGrupoArticulo:Cargo:HelpHasta    := {|| BrwSelArticulo( ::oHasta, ::oSayHasta, , .F. ) }
   ::oGrupoArticulo:Cargo:ValidDesde   := {|oGet| if( cArticulo( if( !empty( oGet ), oGet, ::oDesde ), ::oDbfArt:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoArticulo:Cargo:ValidHasta   := {|oGet| if( cArticulo( if( !empty( oGet ), oGet, ::oHasta ), ::oDbfArt:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoArticulo:Cargo:lImprimir    := lImp
   ::oGrupoArticulo:Cargo:cBitmap      := "gc_object_cube_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_object_cube_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoArticulo )

      if !Empty( ::oImageGroup )

         ::oImageGroup:AddMasked( TBitmap():Define( "gc_object_cube_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

         ::oGrupoArticulo:Cargo:Imagen := len( ::oImageGroup:aBitmaps ) - 1

      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoArticulo:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoArticulo )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoArticulo )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfArt )
         ::oDbfArt:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoMateriaPrima( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   If( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   if ::oDbfArticuloMateriaPrima == nil .OR. !::oDbfArticuloMateriaPrima:Used()
      ::oDbfArticuloMateriaPrima := DbfServer( "ARTICULO.DBF", ):NewOpen( "ARTICULO.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfArticuloMateriaPrima:AddBag( "ARTICULO.CDX" ) ; ::oDbfArticuloMateriaPrima:AddBag( ) ; ::oDbfArticuloMateriaPrima:AutoIndex()
   end

   ::oGrupoMateriaPrima                    := TRGroup():New( {|| ::oDbf:cCodArt }, {|| "Materia prima : " + AllTrim( ::oDbf:cCodArt ) + " - " + AllTRim( ::oDbf:cNomArt ) }, {|| "Total artículo..." }, {|| 3 }, ::lSalto )

   ::oGrupoMateriaPrima:Cargo              := TItemGroup()
   ::oGrupoMateriaPrima:Cargo:Nombre       := "Materia prima"
   ::oGrupoMateriaPrima:Cargo:Expresion    := "cCodArt"
   ::oGrupoMateriaPrima:Cargo:Todos        := .T.
   ::oGrupoMateriaPrima:Cargo:Desde        := Space( 18 )
   ::oGrupoMateriaPrima:Cargo:Hasta        := Replicate( "Z", 18 )
   ::oGrupoMateriaPrima:Cargo:cPicDesde    := Replicate( "#", 18 )
   ::oGrupoMateriaPrima:Cargo:cPicHasta    := Replicate( "#", 18 )
   ::oGrupoMateriaPrima:Cargo:TextDesde    := {|| oRetFld( ::oGrupoMateriaPrima:Cargo:Desde, ::oDbfArticuloMateriaPrima, "Nombre", "Codigo" ) }
   ::oGrupoMateriaPrima:Cargo:TextHasta    := {|| oRetFld( ::oGrupoMateriaPrima:Cargo:Hasta, ::oDbfArticuloMateriaPrima, "Nombre", "Codigo" ) }
   ::oGrupoMateriaPrima:Cargo:HelpDesde    := {|| BrwArticulo( ::oDesde, ::oSayDesde, , .F. ) }
   ::oGrupoMateriaPrima:Cargo:HelpHasta    := {|| BrwArticulo( ::oHasta, ::oSayHasta, , .F. ) }
   ::oGrupoMateriaPrima:Cargo:ValidDesde   := {|oGet| if( cArticulo( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfArticuloMateriaPrima:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoMateriaPrima:Cargo:ValidHasta   := {|oGet| if( cArticulo( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfArticuloMateriaPrima:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoMateriaPrima:Cargo:lImprimir    := lImp
   ::oGrupoMateriaPrima:Cargo:cBitmap      := "gc_object_cube_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_object_cube_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoMateriaPrima )

      if !Empty( ::oImageGroup )

         ::oImageGroup:AddMasked( TBitmap():Define( "gc_object_cube_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

         ::oGrupoMateriaPrima:Cargo:Imagen := len( ::oImageGroup:aBitmaps ) - 1

      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoMateriaPrima:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoMateriaPrima )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoMateriaPrima )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfArticuloMateriaPrima )
         ::oDbfArticuloMateriaPrima:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoCliente( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfCli == nil .OR. !::oDbfCli:Used()
      ::oDbfCli := DbfServer( "CLIENT.DBF", ):NewOpen( "CLIENT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfCli:AddBag( "CLIENT.CDX" ) ; ::oDbfCli:AddBag( ) ; ::oDbfCli:AutoIndex()
   end

   ::oGrupoCliente                  := TRGroup():New( {|| ::oDbf:cCodCli }, {|| "Cliente : " + AllTrim( ::oDbf:cCodCli ) + " - " + AllTRim( ::oDbf:cNomCli ) }, {|| "Total cliente : " + ::oDbf:cCodCli }, {|| 3 }, ::lSalto )

   ::oGrupoCliente:Cargo            := TItemGroup()
   ::oGrupoCliente:Cargo:Nombre     := "Cliente"
   ::oGrupoCliente:Cargo:Expresion  := "cCodCli"
   ::oGrupoCliente:Cargo:Todos      := .T.
   ::oGrupoCliente:Cargo:Desde      := Space( RetNumCodCliEmp() )
   ::oGrupoCliente:Cargo:Hasta      := Replicate( "Z", RetNumCodCliEmp() )
   ::oGrupoCliente:Cargo:cPicDesde  := Replicate( "X", RetNumCodCliEmp() )
   ::oGrupoCliente:Cargo:cPicHasta  := Replicate( "X", RetNumCodCliEmp() )
   ::oGrupoCliente:Cargo:HelpDesde  := {|| BrwCli( ::oDesde, ::oSayDesde, ::oDbfCli:cAlias ) }
   ::oGrupoCliente:Cargo:HelpHasta  := {|| BrwCli( ::oHasta, ::oSayHasta, ::oDbfCli:cAlias ) }
   ::oGrupoCliente:Cargo:TextDesde  := {|| ::SetNombreDesdeCliente() }
   ::oGrupoCliente:Cargo:TextHasta  := {|| ::SetNombreHastaCliente() }
   ::oGrupoCliente:Cargo:ValidDesde := {|oGet| if( cClient( if( !Empty( oGet ), oGet, ::oDesde ), , ::oDbfCli:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCliente:Cargo:ValidHasta := {|oGet| if( cClient( if( !Empty( oGet ), oGet, ::oHasta ), , ::oDbfCli:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCliente:Cargo:lImprimir  := lImp
   ::oGrupoCliente:Cargo:cBitmap    := "gc_user_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoCliente:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoCliente )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoCliente:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoCliente:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoCliente:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoCliente )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoCliente )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfCli )
         ::oDbfCli:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoProveedor( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfPrv == nil .OR. !::oDbfPrv:Used()
      ::oDbfPrv := DbfServer( "PROVEE.DBF", ):NewOpen( "PROVEE.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPrv:AddBag( "PROVEE.CDX" ) ; ::oDbfPrv:AddBag( ) ; ::oDbfPrv:AutoIndex()
   end

   ::oGrupoProveedor                  := TRGroup():New( {|| ::oDbf:cCodPrv }, {|| "Proveedor : " + AllTrim( ::oDbf:cCodPrv ) + " - " + AllTRim( ::oDbf:cNomPrv ) }, {|| "Total proveedor..." }, {|| 3 }, ::lSalto )

   ::oGrupoProveedor:Cargo            := TItemGroup()
   ::oGrupoProveedor:Cargo:Nombre     := "Proveedor"
   ::oGrupoProveedor:Cargo:Expresion  := "cCodPrv"
   ::oGrupoProveedor:Cargo:Todos      := .T.
   ::oGrupoProveedor:Cargo:Desde      := Space( RetNumCodPrvEmp() )
   ::oGrupoProveedor:Cargo:Hasta      := Replicate( "Z", RetNumCodPrvEmp() )
   ::oGrupoProveedor:Cargo:cPicDesde  := Replicate( "X", RetNumCodPrvEmp() )
   ::oGrupoProveedor:Cargo:cPicHasta  := Replicate( "X", RetNumCodPrvEmp() )
   ::oGrupoProveedor:Cargo:TextDesde  := {|| oRetFld( ::oGrupoProveedor:Cargo:Desde, ::oDbfPrv, "Titulo", "Cod" ) }
   ::oGrupoProveedor:Cargo:TextHasta  := {|| oRetFld( ::oGrupoProveedor:Cargo:Hasta, ::oDbfPrv, "Titulo", "Cod" ) }
   ::oGrupoProveedor:Cargo:HelpDesde  := {|| BrwPrv( ::oDesde, , ::oDbfPrv:cAlias ) }
   ::oGrupoProveedor:Cargo:HelpHasta  := {|| BrwPrv( ::oHasta, , ::oDbfPrv:cAlias) }
   ::oGrupoProveedor:Cargo:ValidDesde := {|oGet| if( cProvee( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfPrv:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoProveedor:Cargo:ValidHasta := {|oGet| if( cProvee( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfPrv:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoProveedor:Cargo:lImprimir  := lImp
   ::oGrupoProveedor:Cargo:cBitmap     := "gc_businessman_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoProveedor:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoProveedor )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoProveedor:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoProveedor:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoProveedor:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoProveedor )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoProveedor )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfPrv )
         ::oDbfPrv:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoOperacion( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oOperacion         :=  TOperacion():CreateInit( cPatEmp() )
   ::oOperacion:Openfiles()

   ::oGrupoOperacion                  := TRGroup():New( {|| ::oDbf:cCodOpe }, {|| "Operación : " + AllTrim( ::oDbf:cCodOpe ) + " - " + AllTRim( ::oDbf:cNomOpe ) }, {|| "Total operación..." }, {|| 3 }, ::lSalto )

   ::oGrupoOperacion:Cargo            := TItemGroup()
   ::oGrupoOperacion:Cargo:Nombre     := "Operación"
   ::oGrupoOperacion:Cargo:Expresion  := "cCodOpe"
   ::oGrupoOperacion:Cargo:Todos      := .T.
   ::oGrupoOperacion:Cargo:Desde      := Space( 3 )
   ::oGrupoOperacion:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoOperacion:Cargo:cPicDesde  := "@!"
   ::oGrupoOperacion:Cargo:cPicHasta  := "@!"
   ::oGrupoOperacion:Cargo:TextDesde  := {|| oRetFld( ::oGrupoOperacion:Cargo:Desde, ::oOperacion:oDbf, "cDesOpe", "cCodOpe" ) }
   ::oGrupoOperacion:Cargo:TextHasta  := {|| oRetFld( ::oGrupoOperacion:Cargo:Hasta, ::oOperacion:oDbf, "cDesOpe", "cCodOpe" ) }
   ::oGrupoOperacion:Cargo:HelpDesde  := {|| ::oOperacion:Buscar( ::oDesde ) }
   ::oGrupoOperacion:Cargo:HelpHasta  := {|| ::oOperacion:Buscar( ::oHasta ) }
   ::oGrupoOperacion:Cargo:ValidDesde := {|oGet| if( ::oOperacion:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesOpe", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoOperacion:Cargo:ValidHasta := {|oGet| if( ::oOperacion:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesOpe", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoOperacion:Cargo:lImprimir  := lImp
   ::oGrupoOperacion:Cargo:cBitmap     := "gc_worker2_hammer_16"


   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_worker2_hammer_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoOperacion )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_worker2_hammer_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoOperacion:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoOperacion:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoOperacion )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoOperacion )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oOperacion )
         ::oOperacion:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoTOperacion( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oTipOpera                         := TTipOpera():Create( cPatEmp() )
   ::oTipOpera:Openfiles()

   ::oGrupoTOperacion                  := TRGroup():New( {|| ::oDbf:cCodTOpe }, {|| "Tip. operación: " + AllTrim( ::oDbf:cCodTOpe ) + " - " + AllTRim( ::oDbf:cNomTOpe ) }, {|| "Total tip. operación: " + AllTrim( ::oDbf:cCodTOpe ) }, {|| 3 }, ::lSalto )

   ::oGrupoTOperacion:Cargo            := TItemGroup()
   ::oGrupoTOperacion:Cargo:Nombre     := "Tipo operación"
   ::oGrupoTOperacion:Cargo:Expresion  := "cCodTOpe"
   ::oGrupoTOperacion:Cargo:Todos      := .T.
   ::oGrupoTOperacion:Cargo:Desde      := Space( 3 )
   ::oGrupoTOperacion:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoTOperacion:Cargo:cPicDesde  := "@!"
   ::oGrupoTOperacion:Cargo:cPicHasta  := "@!"
   ::oGrupoTOperacion:Cargo:TextDesde  := {|| oRetFld( ::oGrupoTOperacion:Cargo:Desde, ::oTipOpera:oDbf, "cDesTip", "cCodTip" ) }
   ::oGrupoTOperacion:Cargo:TextHasta  := {|| oRetFld( ::oGrupoTOperacion:Cargo:Hasta, ::oTipOpera:oDbf, "cDesTip", "cCodTip" ) }
   ::oGrupoTOperacion:Cargo:HelpDesde  := {|| ::oTipOpera:Buscar( ::oDesde ) }
   ::oGrupoTOperacion:Cargo:HelpHasta  := {|| ::oTipOpera:Buscar( ::oHasta ) }
   ::oGrupoTOperacion:Cargo:ValidDesde := {|oGet| if( ::oTipOpera:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTOperacion:Cargo:ValidHasta := {|oGet| if( ::oTipOpera:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTOperacion:Cargo:lImprimir  := lImp
   ::oGrupoTOperacion:Cargo:cBitmap    := "gc_folder_open_worker_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_folder_open_worker_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil


      aAdd( ::aSelectionGroup, ::oGrupoTOperacion )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_folder_open_worker_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoTOperacion:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoTOperacion:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoTOperacion )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoTOperacion )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oTipOpera )
         ::oTipOpera:End()
      end

      lOpen                            := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoSeccion( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oSeccion                       := TSeccion():Create( cPatEmp() )
   ::oSeccion:Openfiles()

   ::oGrupoSeccion                  := TRGroup():New( {|| ::oDbf:cCodSec }, {|| "Sección : " + ::oDbf:cCodSec + " - " + ::oDbf:cNomSec }, {|| "Total sección : " + ::oDbf:cCodSec }, {|| 3 }, ::lSalto )

   ::oGrupoSeccion:Cargo            := TItemGroup()
   ::oGrupoSeccion:Cargo:Nombre     := "Sección"
   ::oGrupoSeccion:Cargo:Expresion  := "cCodSec"
   ::oGrupoSeccion:Cargo:Todos      := .T.
   ::oGrupoSeccion:Cargo:Desde      := Space( 3 )
   ::oGrupoSeccion:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoSeccion:Cargo:cPicDesde  := "@!"
   ::oGrupoSeccion:Cargo:cPicHasta  := "@!"
   ::oGrupoSeccion:Cargo:TextDesde  := {|| oRetFld( ::oGrupoSeccion:Cargo:Desde, ::oSeccion:oDbf, "cDesSec", "cCodSec" ) }
   ::oGrupoSeccion:Cargo:TextHasta  := {|| oRetFld( ::oGrupoSeccion:Cargo:Hasta, ::oSeccion:oDbf, "cDesSec", "cCodSec" ) }
   ::oGrupoSeccion:Cargo:HelpDesde  := {|| ::oSeccion:Buscar( ::oDesde ) }
   ::oGrupoSeccion:Cargo:HelpHasta  := {|| ::oSeccion:Buscar( ::oHasta ) }
   ::oGrupoSeccion:Cargo:ValidDesde := {|oGet| if( ::oSeccion:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesSec", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoSeccion:Cargo:ValidHasta := {|oGet| if( ::oSeccion:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesSec", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoSeccion:Cargo:lImprimir  := lImp
   ::oGrupoSeccion:Cargo:cBitmap    := "gc_worker_group_16"


   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_worker_group_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoSeccion )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_worker_group_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoSeccion:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoSeccion:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoSeccion )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoSeccion )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oSeccion )
         ::oSeccion:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoAlmacen( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfAlm == nil .OR. !::oDbfAlm:Used()
      ::oDbfAlm := DbfServer( "ALMACEN.DBF", ):NewOpen( "ALMACEN.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAlm:AddBag( "ALMACEN.CDX" ) ; ::oDbfAlm:AddBag( ) ; ::oDbfAlm:AutoIndex()
   end

   ::oGrupoAlmacen                  := TRGroup():New( {|| ::oDbf:cCodAlm }, {|| "Almacén : " + AllTrim( ::oDbf:cCodAlm ) + " - " + AllTrim( ::oDbf:cNomAlm ) }, {|| "Total almacén : " + ::oDbf:cCodAlm }, {|| 3 }, ::lSalto )

   ::oGrupoAlmacen:Cargo            := TItemGroup()
   ::oGrupoAlmacen:Cargo:Nombre     := "Almacén"
   ::oGrupoAlmacen:Cargo:Expresion  := "cCodAlm"
   ::oGrupoAlmacen:Cargo:Todos      := .T.
   ::oGrupoAlmacen:Cargo:Desde      := Space( 16 )
   ::oGrupoAlmacen:Cargo:Hasta      := Replicate( "Z", 16 )
   ::oGrupoAlmacen:Cargo:cPicDesde  := Replicate( "#", 16 )
   ::oGrupoAlmacen:Cargo:cPicHasta  := Replicate( "#", 16 )
   ::oGrupoAlmacen:Cargo:TextDesde  := {|| oRetFld( ::oGrupoAlmacen:Cargo:Desde, ::oDbfAlm, "cNomAlm", "cCodAlm" ) }
   ::oGrupoAlmacen:Cargo:TextHasta  := {|| oRetFld( ::oGrupoAlmacen:Cargo:Hasta, ::oDbfAlm, "cNomAlm", "cCodAlm" ) }
   ::oGrupoAlmacen:Cargo:HelpDesde  := {|| BrwAlmacen( ::oDesde, ::oSayDesde ) }
   ::oGrupoAlmacen:Cargo:HelpHasta  := {|| BrwAlmacen( ::oHasta, ::oSayHasta ) }
   ::oGrupoAlmacen:Cargo:ValidDesde := {|oGet| if( cAlmacen( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfAlm:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoAlmacen:Cargo:ValidHasta := {|oGet| if( cAlmacen( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfAlm:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoAlmacen:Cargo:lImprimir  := lImp
   ::oGrupoAlmacen:Cargo:cBitmap    := "gc_package_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_package_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoAlmacen )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_package_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoAlmacen:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoAlmacen:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoAlmacen )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoAlmacen )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfAlm )
         ::oDbfAlm:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoAlmacenOrigen( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfAlmacenOrigen == nil .OR. !::oDbfAlmacenOrigen:Used()
      ::oDbfAlmacenOrigen := DbfServer( "ALMACEN.DBF", ):NewOpen( "ALMACEN.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAlmacenOrigen:AddBag( "ALMACEN.CDX" ) ; ::oDbfAlmacenOrigen:AddBag( ) ; ::oDbfAlmacenOrigen:AutoIndex()
   end

   ::oGrupoAlmacenOrigen                  := TRGroup():New( {|| ::oDbf:cCodAlm }, {|| "Almacén origen: " + AllTrim( ::oDbf:cCodAlm ) + " - " + AllTrim( ::oDbf:cNomAlm ) }, {|| "Total almacén : " + ::oDbf:cCodAlm }, {|| 3 }, ::lSalto )

   ::oGrupoAlmacenOrigen:Cargo            := TItemGroup()
   ::oGrupoAlmacenOrigen:Cargo:Nombre     := "Almacén origen"
   ::oGrupoAlmacenOrigen:Cargo:Expresion  := "cCodAlm"
   ::oGrupoAlmacenOrigen:Cargo:Todos      := .T.
   ::oGrupoAlmacenOrigen:Cargo:Desde      := Space( 16 )
   ::oGrupoAlmacenOrigen:Cargo:Hasta      := Replicate( "Z", 16 )
   ::oGrupoAlmacenOrigen:Cargo:cPicDesde  := Replicate( "#", 16 )
   ::oGrupoAlmacenOrigen:Cargo:cPicHasta  := Replicate( "#", 16 )
   ::oGrupoAlmacenOrigen:Cargo:TextDesde  := {|| oRetFld( ::oGrupoAlmacenOrigen:Cargo:Desde, ::oDbfAlmacenOrigen, "cNomAlm", "cCodAlm" ) }
   ::oGrupoAlmacenOrigen:Cargo:TextHasta  := {|| oRetFld( ::oGrupoAlmacenOrigen:Cargo:Hasta, ::oDbfAlmacenOrigen, "cNomAlm", "cCodAlm" ) }
   ::oGrupoAlmacenOrigen:Cargo:HelpDesde  := {|| BrwAlmacen( ::oDesde, ::oSayDesde ) }
   ::oGrupoAlmacenOrigen:Cargo:HelpHasta  := {|| BrwAlmacen( ::oHasta, ::oSayHasta ) }
   ::oGrupoAlmacenOrigen:Cargo:ValidDesde := {|oGet| if( cAlmacen( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfAlmacenOrigen:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoAlmacenOrigen:Cargo:ValidHasta := {|oGet| if( cAlmacen( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfAlmacenOrigen:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoAlmacenOrigen:Cargo:lImprimir  := lImp
   ::oGrupoAlmacenOrigen:Cargo:cBitmap    := "gc_package_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_package_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoAlmacenOrigen )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_package_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoAlmacenOrigen:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoAlmacenOrigen:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoAlmacenOrigen )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoAlmacenOrigen )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfAlmacenOrigen )
         ::oDbfAlmacenOrigen:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoMaquina( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oMaquina           :=  TMaquina():CreateInit( cPatEmp() )
   ::oMaquina:Openfiles()

   ::oGrupoMaquina                  := TRGroup():New( {|| ::oDbf:cCodMaq }, {|| "Máquina : " + ::oDbf:cCodMaq + " - " + ::oDbf:cNomMaq }, {|| "Total máquina : " + ::oDbf:cCodMaq }, {|| 3 }, ::lSalto )

   ::oGrupoMaquina:Cargo            := TItemGroup()
   ::oGrupoMaquina:Cargo:Nombre     := "Maquina"
   ::oGrupoMaquina:Cargo:Expresion  := "cCodMaq"
   ::oGrupoMaquina:Cargo:Todos      := .T.
   ::oGrupoMaquina:Cargo:Desde      := Space( 3 )
   ::oGrupoMaquina:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoMaquina:Cargo:cPicDesde  := "@!"
   ::oGrupoMaquina:Cargo:cPicHasta  := "@!"
   ::oGrupoMaquina:Cargo:TextDesde  := {|| oRetFld( ::oGrupoMaquina:Cargo:Desde, ::oMaquina:oDbf, "cDesMaq", "cCodMaq" ) }
   ::oGrupoMaquina:Cargo:TextHasta  := {|| oRetFld( ::oGrupoMaquina:Cargo:Hasta, ::oMaquina:oDbf, "cDesMaq", "cCodMaq" ) }
   ::oGrupoMaquina:Cargo:HelpDesde  := {|| ::oMaquina:Buscar( ::oDesde ) }
   ::oGrupoMaquina:Cargo:HelpHasta  := {|| ::oMaquina:Buscar( ::oHasta ) }
   ::oGrupoMaquina:Cargo:ValidDesde := {|oGet| if( ::oMaquina:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesMaq", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoMaquina:Cargo:ValidHasta := {|oGet| if( ::oMaquina:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesMaq", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoMaquina:Cargo:lImprimir  := lImp
   ::oGrupoMaquina:Cargo:cBitmap    := "gc_industrial_robot_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_industrial_robot_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoMaquina )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_industrial_robot_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoMaquina:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoMaquina:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoMaquina )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoMaquina )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oMaquina )
         ::oMaquina:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoOperario( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oOperario                       := TOperarios():Create( cPatEmp() )
   ::oOperario:Openfiles()

   ::oGrupoOperario                  := TRGroup():New( {|| ::oDbf:cCodTra }, {|| "Operario : " + ::oDbf:cCodTra + " - " + ::oDbf:cNomTra }, {|| "Total operario : " + ::oDbf:cCodTra }, {|| 3 }, ::lSalto )

   ::oGrupoOperario:Cargo            := TItemGroup()
   ::oGrupoOperario:Cargo:Nombre     := "Operario"
   ::oGrupoOperario:Cargo:Expresion  := "cCodTra"
   ::oGrupoOperario:Cargo:Todos      := .T.
   ::oGrupoOperario:Cargo:Desde      := Space( 5 )
   ::oGrupoOperario:Cargo:Hasta      := Replicate( "Z", 5 )
   ::oGrupoOperario:Cargo:cPicDesde  := "@!"
   ::oGrupoOperario:Cargo:cPicHasta  := "@!"
   ::oGrupoOperario:Cargo:TextDesde  := {|| oRetFld( ::oGrupoOperario:Cargo:Desde, ::oOperario:oDbf, "cNomTra", "cCodTra" ) }
   ::oGrupoOperario:Cargo:TextHasta  := {|| oRetFld( ::oGrupoOperario:Cargo:Hasta, ::oOperario:oDbf, "cNomTra", "cCodTra" ) }
   ::oGrupoOperario:Cargo:HelpDesde  := {|| ::oOperario:Buscar( ::oDesde ) }
   ::oGrupoOperario:Cargo:HelpHasta  := {|| ::oOperario:Buscar( ::oHasta ) }
   ::oGrupoOperario:Cargo:ValidDesde := {|oGet| if( ::oOperario:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomTra", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoOperario:Cargo:ValidHasta := {|oGet| if( ::oOperario:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomTra", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoOperario:Cargo:lImprimir  := lImp
   ::oGrupoOperario:Cargo:cBitmap    := "gc_worker2_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_worker2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoOperario )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_worker2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoOperario:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoOperario:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoOperario )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoOperario )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oOperario )
         ::oOperario:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoFPago( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   If( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

      if empty( ::oDbfFpg ) .OR. !::oDbfFpg:Used()
         ::oDbfFpg := DbfServer( "FPago.Dbf", ):NewOpen( "FPago.Dbf",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFpg:AddBag( "FPago.Cdx" ) ; ::oDbfFpg:AddBag( ) ; ::oDbfFpg:AutoIndex()
      end

      ::oGrupoFpago                   := TRGroup():New( {|| ::oDbf:cCodFpg }, {|| "F. pago : " + AllTrim( ::oDbf:cCodFpg ) + " - " + AllTRim( ::oDbf:cNomFpg ) }, {|| "Total forma de pago : " + ::oDbf:cCodFpg }, {|| 3 }, ::lSalto )

      ::oGrupoFpago:Cargo             := TItemGroup()
      ::oGrupoFpago:Cargo:Nombre      := "Forma pago"
      ::oGrupoFpago:Cargo:Expresion   := "cCodFpg"
      ::oGrupoFpago:Cargo:Todos       := .T.
      ::oGrupoFpago:Cargo:Desde       := Space( 2 )
      ::oGrupoFpago:Cargo:Hasta       := Replicate( "Z", 2 )
      ::oGrupoFpago:Cargo:cPicDesde   := "@!"
      ::oGrupoFpago:Cargo:cPicHasta   := "@!"
      ::oGrupoFpago:Cargo:TextDesde   := {|| oRetFld( ::oGrupoFpago:Cargo:Desde, ::oDbfFpg, "cDesPago", "cCodPago" ) }
      ::oGrupoFpago:Cargo:TextHasta   := {|| oRetFld( ::oGrupoFpago:Cargo:Hasta, ::oDbfFpg, "cDesPago", "cCodPago" ) }
      ::oGrupoFpago:Cargo:HelpDesde   := {|| BrwFPago( ::oDesde, ::oSayDesde ) }
      ::oGrupoFpago:Cargo:HelpHasta   := {|| BrwFPago( ::oHasta, ::oSayHasta ) }
      ::oGrupoFpago:Cargo:ValidDesde  := {|oGet| if( cFpago( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfFpg:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
      ::oGrupoFpago:Cargo:ValidHasta  := {|oGet| if( cFpago( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfFpg:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
      ::oGrupoFPago:Cargo:lImprimir   := lImp
      ::oGrupoFPago:Cargo:cBitmap     := "gc_credit_cards_16"

      if !Empty( ::oImageList )
         ::oImageList:AddMasked( TBitmap():Define( ::oGrupoFPago:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
      end

      if lInitGroup <> nil

         aAdd( ::aSelectionGroup, ::oGrupoFpago )

         if !Empty( ::oImageGroup )
            ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoFPago:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
            ::oGrupoFpago:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
         end

         if lInitGroup
            if !Empty( ::oColNombre )
               ::oColNombre:AddResource( ::oGrupoFPago:Cargo:cBitmap )
            end
            aAdd( ::aInitGroup, ::oGrupoFpago )
         end

      end

      aAdd( ::aSelectionRango, ::oGrupoFpago )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfFpg )
         ::oDbfFpg:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoBanco( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oBanco             := TBancos():Create( cPatEmp() )
   ::oBanco:OpenFiles()

   ::oGrupoBanco                    := TRGroup():New( {|| ::oDbf:cCodBnc }, {|| "Banco : " + AllTrim( ::oDbf:cCodBnc ) + " - " + AllTRim( ::oDbf:cNomBnc ) }, {|| "Total banco : " + ::oDbf:cCodBnc }, {|| 3 }, ::lSalto )

   ::oGrupoBanco:Cargo              := TItemGroup()
   ::oGrupoBanco:Cargo:Nombre       := "Banco"
   ::oGrupoBanco:Cargo:Expresion    := "cCodBnc"
   ::oGrupoBanco:Cargo:Todos        := .T.
   ::oGrupoBanco:Cargo:Desde        := Space( 4 )
   ::oGrupoBanco:Cargo:Hasta        := Replicate( "Z", 4 )
   ::oGrupoBanco:Cargo:cPicDesde    := "@!"
   ::oGrupoBanco:Cargo:cPicHasta    := "@!"
   ::oGrupoBanco:Cargo:HelpDesde    := {|| ::oBanco:Buscar( ::oDesde ) }
   ::oGrupoBanco:Cargo:HelpHasta    := {|| ::oBanco:Buscar( ::oHasta ) }
   ::oGrupoBanco:Cargo:ValidDesde   := {|oGet| if( ::oBanco:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomBnc", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoBanco:Cargo:ValidHasta   := {|oGet| if( ::oBanco:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomBnc", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoBanco:Cargo:lImprimir    := lImp

   ::oImageList:AddMasked( TBitmap():Define( "gc_office_building2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoBanco )

      ::oImageGroup:AddMasked( TBitmap():Define( "gc_office_building2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoBanco:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoBanco:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoBanco )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoBanco )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::Banco )
         ::oBanco:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoAgente( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   If( lImp == nil, lImp := .T., ) ;

   oBlock               :=  ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   if ::oDbfAge == nil .OR. !::oDbfAge:Used()
      ::oDbfAge := DbfServer( "AGENTES.DBF", ):NewOpen( "AGENTES.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAge:AddBag( "AGENTES.CDX" ) ; ::oDbfAge:AddBag( ) ; ::oDbfAge:AutoIndex()
   end

    ::oGrupoAgente                  := TRGroup():New( {|| ::oDbf:cCodAge }, {|| "Agente : " + AllTrim( ::oDbf:cCodAge ) + " - " + AllTrim( ::oDbf:cApeAge ) + "," + AllTRim( ::oDbf:cNomAge ) }, {|| "Total agente : " + ::oDbf:cCodAge }, {|| 3 }, ::lSalto )

   ::oGrupoAgente:Cargo            := TItemGroup()
   ::oGrupoAgente:Cargo:Nombre     := "Agente"
   ::oGrupoAgente:Cargo:Expresion  := "cCodAge"
   ::oGrupoAgente:Cargo:Todos      := .T.
   ::oGrupoAgente:Cargo:Desde      := Space( 3 )
   ::oGrupoAgente:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoAgente:Cargo:cPicDesde  := "@!"
   ::oGrupoAgente:Cargo:cPicHasta  := "@!"
   ::oGrupoAgente:Cargo:TextDesde  := {|| oRetFld( ::oGrupoAgente:Cargo:Desde, ::oDbfAge, "cNbrAge", "cCodAge" ) }
   ::oGrupoAgente:Cargo:TextHasta  := {|| oRetFld( ::oGrupoAgente:Cargo:Hasta, ::oDbfAge, "cNbrAge", "cCodAge" ) }
   ::oGrupoAgente:Cargo:HelpDesde  := {|| BrwAgentes( ::oDesde, ::oSayDesde ) }
   ::oGrupoAgente:Cargo:HelpHasta  := {|| BrwAgentes( ::oHasta, ::oSayHasta ) }
   ::oGrupoAgente:Cargo:ValidDesde := {|oGet| if( cAgentes( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfAge:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoAgente:Cargo:ValidHasta := {|oGet| if( cAgentes( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfAge:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoAgente:Cargo:lImprimir  := lImp
   ::oGrupoAgente:Cargo:cBitmap    := "gc_businessman2_16"

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoAgente )

      if !Empty( ::oImageGroup )

         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoAgente:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

         ::oGrupoAgente:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1

      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoAgente:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoAgente )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoAgente )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfAge )
         ::oDbfAge:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoCaja( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfCaj == nil .OR. !::oDbfCaj:Used()
      ::oDbfCaj := DbfServer( "CAJAS.DBF", ):NewOpen( "CAJAS.DBF",, ( cDriver() ),, ( cPatDat() ), .F., .T., .F., .F. ) ; ::oDbfCaj:AddBag( "CAJAS.CDX" ) ; ::oDbfCaj:AddBag( ) ; ::oDbfCaj:AutoIndex()
   end

   ::oGrupoCaja                  := TRGroup():New( {|| ::oDbf:cCodCaj }, {|| "Caja : " + AllTrim( ::oDbf:cCodCaj ) + " - " + AllTRim( ::oDbf:cNomCaj ) }, {|| "Total caja : " + ::oDbf:cCodCaj }, {|| 3 }, ::lSalto )

   ::oGrupoCaja:Cargo            := TItemGroup()
   ::oGrupoCaja:Cargo:Nombre     := "Caja"
   ::oGrupoCaja:Cargo:Expresion  := "cCodCaj"
   ::oGrupoCaja:Cargo:Todos      := .T.
   ::oGrupoCaja:Cargo:Desde      := Space( 3 )
   ::oGrupoCaja:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoCaja:Cargo:cPicDesde  := "@!"
   ::oGrupoCaja:Cargo:cPicHasta  := "@!"
   ::oGrupoCaja:Cargo:HelpDesde  := {|| BrwCajas( ::oDesde, ::oSayDesde ) }
   ::oGrupoCaja:Cargo:HelpHasta  := {|| BrwCajas( ::oHasta, ::oSayHasta ) }
   ::oGrupoCaja:Cargo:ValidDesde := {|oGet| if( cCajas( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfCaj:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCaja:Cargo:ValidHasta := {|oGet| if( cCajas( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfCaj:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCaja:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "gc_cash_register_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoCaja )

      ::oImageGroup:AddMasked( TBitmap():Define( "gc_cash_register_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoCaja:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoCaja:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoCaja )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoCaja )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfCaj )
         ::oDbfCaj:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoGrupoCliente( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   If( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   if empty(::oGrpCli)
      ::oGrpCli                      := TGrpCli():Create( cPatEmp() )
      ::oGrpCli:OpenService()
   end

   ::oGrupoGCliente                  := TRGroup():New( {|| ::oDbf:cCodGCli }, {|| "Grp. cliente : " + AllTrim( ::oDbf:cCodGCli ) + " - " + AllTRim( ::oDbf:cNomGCli ) }, {|| "Total grp. cliente : " + ::oDbf:cCodGCli }, {|| 3 }, ::lSalto )

   ::oGrupoGCliente:Cargo            := TItemGroup()
   ::oGrupoGCliente:Cargo:Nombre     := "Grp. cliente"
   ::oGrupoGCliente:Cargo:Expresion  := "cCodGCli"
   ::oGrupoGCliente:Cargo:Todos      := .T.
   ::oGrupoGCliente:Cargo:Desde      := Space( 4 )
   ::oGrupoGCliente:Cargo:Hasta      := Replicate( "Z", 4 )
   ::oGrupoGCliente:Cargo:cPicDesde  := "@!"
   ::oGrupoGCliente:Cargo:cPicHasta  := "@!"
   ::oGrupoGCliente:Cargo:HelpDesde  := {|| ::oGrpCli:Buscar( ::oDesde ) }
   ::oGrupoGCliente:Cargo:HelpHasta  := {|| ::oGrpCli:Buscar( ::oHasta ) }
   ::oGrupoGCliente:Cargo:TextDesde  := {|| ::SetNombreDesdeGrupoCliente() }
   ::oGrupoGCliente:Cargo:TextHasta  := {|| ::SetNombreHastaGrupoCliente() }
   ::oGrupoGCliente:Cargo:ValidDesde := {|oGet| if( ::oGrpCli:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomGrp", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGCliente:Cargo:ValidHasta := {|oGet| if( ::oGrpCli:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomGrp", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGCliente:Cargo:lImprimir  := lImp
   ::oGrupoGCliente:Cargo:cBitmap    := "gc_users3_16"

   ::oGrupoGCliente:Cargo:bValidMayorIgual := {|uVal, uDesde| ::oGrpCli:IsPadreMayor( uVal, uDesde ) }
   ::oGrupoGCliente:Cargo:bValidMenorIgual := {|uVal, uHasta| ::oGrpCli:IsPadreMenor( uVal, uHasta ) }

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoGCliente:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoGCliente )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoGCliente:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoGCliente:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoGCliente:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoGCliente )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoGCliente )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oGrpCli )
         ::oGrpCli:CloseService()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoGProveedor( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oGrpPrv            := TGrpPrv():Create( cPatEmp() )
   ::oGrpPrv:OpenFiles()

   ::oGrupoGProveedor                  := TRGroup():New( {|| ::oDbf:cCodGPrv }, {|| "Grp. proveedor : " + AllTrim( ::oDbf:cCodGPrv ) + " - " + AllTRim( ::oDbf:cNomGPrv ) }, {|| "Total grp. proveedor : " + ::oDbf:cCodGPrv }, {|| 3 }, ::lSalto )

   ::oGrupoGProveedor:Cargo            := TItemGroup()
   ::oGrupoGProveedor:Cargo:Nombre     := "Grp. proveedor"
   ::oGrupoGProveedor:Cargo:Expresion  := "cCodGPrv"
   ::oGrupoGProveedor:Cargo:Todos      := .T.
   ::oGrupoGProveedor:Cargo:Desde      := Space( 4 )
   ::oGrupoGProveedor:Cargo:Hasta      := Replicate( "Z", 4 )
   ::oGrupoGProveedor:Cargo:cPicDesde  := Replicate( "X", RetNumCodPrvEmp() )
   ::oGrupoGProveedor:Cargo:cPicHasta  := Replicate( "X", RetNumCodPrvEmp() )
   ::oGrupoGProveedor:Cargo:TextDesde  := {|| oRetFld( ::oGrupoGProveedor:Cargo:Desde, ::oGrpPrv:oDbf, "cNomGrp", "cCodGrp" ) }
   ::oGrupoGProveedor:Cargo:TextHasta  := {|| oRetFld( ::oGrupoGProveedor:Cargo:Hasta, ::oGrpPrv:oDbf, "cNomGrp", "cCodGrp" ) }
   ::oGrupoGProveedor:Cargo:HelpDesde  := {|| ::oGrpPrv:Buscar( ::oDesde ) }
   ::oGrupoGProveedor:Cargo:HelpHasta  := {|| ::oGrpPrv:Buscar( ::oHasta ) }
   ::oGrupoGProveedor:Cargo:ValidDesde := {|oGet| if( ::oGrpPrv:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomGrp", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGProveedor:Cargo:ValidHasta := {|oGet| if( ::oGrpPrv:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomGrp", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGProveedor:Cargo:lImprimir  := lImp
   ::oGrupoGProveedor:Cargo:cBitmap     := "gc_businessmen2_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoGProveedor:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoGProveedor )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoGProveedor:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoGProveedor:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoGProveedor:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoGProveedor )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoGProveedor )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oGrpPrv )
         ::oGrpPrv:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoObra( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfObr == nil .OR. !::oDbfObr:Used()
      ::oDbfObr := DbfServer( "OBRAST.DBF", ):NewOpen( "OBRAST.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfObr:AddBag( "OBRAST.CDX" ) ; ::oDbfObr:AddBag( ) ; ::oDbfObr:AutoIndex()
   end

   ::oGrupoObra                  := TRGroup():New( {|| ::oDbf:cCodObra }, {|| "Obra : " + AllTrim( ::oDbf:cCodObra ) + " - " + AllTRim( ::oDbf:cNomObra ) }, {|| "Total obra : " + ::oDbf:cCodObra }, {|| 3 }, ::lSalto )

   ::oGrupoObra:Cargo            := TItemGroup()
   ::oGrupoObra:Cargo:Nombre     := "Dirección"
   ::oGrupoObra:Cargo:Expresion  := "cCodObra"
   ::oGrupoObra:Cargo:Todos      := .T.
   ::oGrupoObra:Cargo:Desde      := Space( 10 )
   ::oGrupoObra:Cargo:Hasta      := Replicate( "Z", 10 )
   ::oGrupoObra:Cargo:cPicDesde  := "@!"
   ::oGrupoObra:Cargo:cPicHasta  := "@!"
   ::oGrupoObra:Cargo:HelpDesde  := {|| BrwObras( ::oDesde, ::oSayDesde, ::oGrupoCliente:Cargo:Desde, ::oDbfObr:cAlias ) }
   ::oGrupoObra:Cargo:HelpHasta  := {|| BrwObras( ::oHasta, ::oSayHasta, ::oGrupoCliente:Cargo:Desde, ::oDbfObr:cAlias ) }
   ::oGrupoObra:Cargo:ValidDesde := {|oGet| if( cObras( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, ::oGrupoCliente:Cargo:Desde, ::oDbfObr:cAlias ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoObra:Cargo:ValidHasta := {|oGet| if( cObras( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, ::oGrupoCliente:Cargo:Desde, ::oDbfObr:cAlias ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoObra:Cargo:bCondition := {|| ::lIgualCliente() }
   ::oGrupoObra:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "User1_Hammer_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoObra )

      ::oImageGroup:AddMasked( TBitmap():Define( "User1_Hammer_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoObra:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoObra:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoObra )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoObra )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfObr )
         ::oGrpObr:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoFamilia( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfFam == nil .OR. !::oDbfFam:Used()
      ::oDbfFam := DbfServer( "FAMILIAS.DBF", ):NewOpen( "FAMILIAS.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFam:AddBag( "FAMILIAS.CDX" ) ; ::oDbfFam:AddBag( ) ; ::oDbfFam:AutoIndex()
   end

   ::oGrupoFamilia                    := TRGroup():New( {|| ::oDbf:cCodFam }, {|| "Familia : " + AllTrim( ::oDbf:cCodFam ) + " - " + AllTRim( ::oDbf:cNomFam ) }, {|| "Total familia : " + ::oDbf:cCodFam }, {|| 3 }, ::lSalto )

   ::oGrupoFamilia:Cargo              := TItemGroup()
   ::oGrupoFamilia:Cargo:Nombre       := "Familia"
   ::oGrupoFamilia:Cargo:Expresion    := "cCodFam"
   ::oGrupoFamilia:Cargo:Todos        := .T.
   ::oGrupoFamilia:Cargo:Desde        := Space( 16 )
   ::oGrupoFamilia:Cargo:Hasta        := Replicate( "Z", 16 )
   ::oGrupoFamilia:Cargo:cPicDesde    := "@!"
   ::oGrupoFamilia:Cargo:cPicHasta    := "@!"
   ::oGrupoFamilia:Cargo:HelpDesde    := {|| BrwFamilia( ::oDesde, ::oSayDesde ) }
   ::oGrupoFamilia:Cargo:HelpHasta    := {|| BrwFamilia( ::oHasta, ::oSayHasta ) }
   ::oGrupoFamilia:Cargo:TextDesde    := {|| oRetFld( ::oGrupoFamilia:Cargo:Desde, ::oDbfFam, "cNomFam", "cCodFam" ) }
   ::oGrupoFamilia:Cargo:TextHasta    := {|| oRetFld( ::oGrupoFamilia:Cargo:Hasta, ::oDbfFam, "cNomFam", "cCodFam" ) }
   ::oGrupoFamilia:Cargo:ValidDesde   := {|oGet| if( cFamilia( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfFam:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFamilia:Cargo:ValidHasta   := {|oGet| if( cFamilia( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfFam:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFamilia:Cargo:lImprimir    := lImp
   ::oGrupoFamilia:Cargo:cBitmap      := "gc_cubes_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoFamilia:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoFamilia )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoFamilia:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoFamilia:Cargo:Imagen := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoFamilia:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoFamilia )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoFamilia )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfFam )
         ::oDbfFam:End()
      end

      lOpen                            := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoGFamilia( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oGruFam            := TGrpFam():Create( cPatEmp(), "GRPFAM" )
   ::oGruFam:OpenFiles()

   ::oGrupoGFamilia                  := TRGroup():New( {|| ::oDbf:cCodGFam }, {|| "Grp. familia : " + AllTrim( ::oDbf:cCodGFam ) + " - " + AllTRim( ::oDbf:cNomGFam ) }, {|| "Total grp. familia : " + ::oDbf:cCodGFam }, {|| 3 }, ::lSalto )

   ::oGrupoGFamilia:Cargo            := TItemGroup()
   ::oGrupoGFamilia:Cargo:Nombre     := "Grp. familia"
   ::oGrupoGFamilia:Cargo:Expresion  := "cCodGFam"
   ::oGrupoGFamilia:Cargo:Todos      := .T.
   ::oGrupoGFamilia:Cargo:Desde      := Space( 3 )
   ::oGrupoGFamilia:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoGFamilia:Cargo:cPicDesde  := "@!"
   ::oGrupoGFamilia:Cargo:cPicHasta  := "@!"
   ::oGrupoGFamilia:Cargo:HelpDesde  := {|| ::oGruFam:Buscar( ::oDesde ) }
   ::oGrupoGFamilia:Cargo:HelpHasta  := {|| ::oGruFam:Buscar( ::oHasta ) }
   ::oGrupoGFamilia:Cargo:TextDesde  := {|| oRetFld( ::oGrupoGFamilia:Cargo:Desde, ::oGruFam:oDbf, "cNomGrp", "cCodGrp" ) }
   ::oGrupoGFamilia:Cargo:TextHasta  := {|| oRetFld( ::oGrupoGFamilia:Cargo:Hasta, ::oGruFam:oDbf, "cNomGrp", "cCodGrp" ) }
   ::oGrupoGFamilia:Cargo:ValidDesde := {|oGet| if( ::oGruFam:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomGrp", .T. ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGFamilia:Cargo:ValidHasta := {|oGet| if( ::oGruFam:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomGrp", .T. ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGFamilia:Cargo:lImprimir  := lImp
   ::oGrupoGFamilia:Cargo:cBitmap    := "gc_folder_cubes_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_folder_cubes_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoGFamilia )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_folder_cubes_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoGFamilia:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoGFamilia:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoGFamilia )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoGFamilia )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oGruFam )
         ::oGruFam:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoCentroCoste( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   If( lImp == nil, lImp := .T., ) ;

   oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   ::oDbfCentroCoste := TCentroCoste():New( cPatDat() )
   ::oDbfCentroCoste:OpenFiles()

   ::oGrupoCentroCoste                    := TRGroup():New( {|| ::oDbf:cCtrCoste }, {|| "Centro de coste : " + AllTrim( ::oDbf:cCtrCoste ) }, {|| "Total Centro de coste : " + ::oDbf:cCtrCoste }, {|| 3 }, ::lSalto )

   ::oGrupoCentroCoste:Cargo              := TItemGroup()
   ::oGrupoCentroCoste:Cargo:Nombre       := "Ctr. de coste"
   ::oGrupoCentroCoste:Cargo:Expresion    := "cCodigo"
   ::oGrupoCentroCoste:Cargo:Todos        := .T.
   ::oGrupoCentroCoste:Cargo:Desde        := Space( 16 )
   ::oGrupoCentroCoste:Cargo:Hasta        := Replicate( "Z", 16 )
   ::oGrupoCentroCoste:Cargo:cPicDesde    := "@!"
   ::oGrupoCentroCoste:Cargo:cPicHasta    := "@!"
   ::oGrupoCentroCoste:Cargo:HelpDesde    := {|| ::oDbfCentroCoste:Buscar( ::oDesde ) }
   ::oGrupoCentroCoste:Cargo:HelpHasta    := {|| ::oDbfCentroCoste:Buscar( ::oHasta ) }
   ::oGrupoCentroCoste:Cargo:TextDesde    := {|| ::SetNombreDesdeCentroCoste() }
   ::oGrupoCentroCoste:Cargo:TextHasta    := {|| ::SetNombreHastaCentroCoste() }
   ::oGrupoCentroCoste:Cargo:ValidDesde   := {|oGet| if( ::oDbfCentroCoste:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNombre" ), ( ::ChangeValor(), .T. ), .F. )  }
   ::oGrupoCentroCoste:Cargo:ValidHasta   := {|oGet| if( ::oDbfCentroCoste:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNombre" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCentroCoste:Cargo:lImprimir    := lImp
   ::oGrupoCentroCoste:Cargo:cBitmap      := "gc_folder_open_money_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoCentroCoste:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoCentroCoste )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoCentroCoste:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoCentroCoste:Cargo:Imagen := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoCentroCoste:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoCentroCoste )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoCentroCoste )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfCentroCoste )
         ::oDbfCentroCoste:End()
      end

      lOpen                            := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoTipoArticulo( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oTipArt            := TTipArt():New( cPatEmp(), cDriver() )
   ::oTipArt:OpenFiles()

   ::oGrupoTArticulo                  := TRGroup():New( {|| ::oDbf:cCodTArt }, {|| "Tip. artículo : " + AllTrim( ::oDbf:cCodTArt ) + " - " + AllTRim( ::oDbf:cNomTArt ) }, {|| "Total tip. artículo : " + ::oDbf:cCodTArt }, {|| 3 }, ::lSalto )

   ::oGrupoTArticulo:Cargo            := TItemGroup()
   ::oGrupoTArticulo:Cargo:Nombre     := "Tipo artículo"
   ::oGrupoTArticulo:Cargo:Expresion  := "cCodTArt"
   ::oGrupoTArticulo:Cargo:Todos      := .T.
   ::oGrupoTArticulo:Cargo:Desde      := Space( 4 )
   ::oGrupoTArticulo:Cargo:Hasta      := Replicate( "Z", 4 )
   ::oGrupoTArticulo:Cargo:cPicDesde  := "@!"
   ::oGrupoTArticulo:Cargo:cPicHasta  := "@!"
   ::oGrupoTArticulo:Cargo:HelpDesde  := {|| ::oTipArt:Buscar( ::oDesde ) }
   ::oGrupoTArticulo:Cargo:HelpHasta  := {|| ::oTipArt:Buscar( ::oHasta ) }
   ::oGrupoTArticulo:Cargo:TextDesde  := {|| oRetFld( ::oGrupoTArticulo:Cargo:Desde, ::oTipArt:oDbf, "cNomTip", "cCodTip" ) }
   ::oGrupoTArticulo:Cargo:TextHasta  := {|| oRetFld( ::oGrupoTArticulo:Cargo:Hasta, ::oTipArt:oDbf, "cNomTip", "cCodTip" ) }
   ::oGrupoTArticulo:Cargo:ValidDesde := {|oGet| if( ::oTipArt:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTArticulo:Cargo:ValidHasta := {|oGet| if( ::oTipArt:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTArticulo:Cargo:lImprimir  := lImp
   ::oGrupoTArticulo:Cargo:cBitmap    := "gc_objects_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_objects_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoTArticulo )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_objects_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoTArticulo:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoTArticulo:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoTArticulo )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoTArticulo )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oTipArt )
         ::oTipArt:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoFabricante( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oDbfFab            := TFabricantes():New( cPatEmp() )
   ::oDbfFab:OpenFiles()

   ::oGrupoFabricante                  := TRGroup():New( {|| ::oDbf:cCodFab }, {|| "Fabricante : " + AllTrim( ::oDbf:cCodFab ) + " - " + AllTRim( ::oDbf:cNomFab ) }, {|| "Total fabricante : " + ::oDbf:cCodFab }, {|| 3 }, ::lSalto )

   ::oGrupoFabricante:Cargo            := TItemGroup()
   ::oGrupoFabricante:Cargo:Nombre     := "Fabricante"
   ::oGrupoFabricante:Cargo:Expresion  := "cCodFab"
   ::oGrupoFabricante:Cargo:Todos      := .T.
   ::oGrupoFabricante:Cargo:Desde      := Space( 3 )
   ::oGrupoFabricante:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoFabricante:Cargo:cPicDesde  := "@!"
   ::oGrupoFabricante:Cargo:cPicHasta  := "@!"
   ::oGrupoFabricante:Cargo:HelpDesde  := {|| ::oDbfFab:Buscar( ::oDesde ) }
   ::oGrupoFabricante:Cargo:HelpHasta  := {|| ::oDbfFab:Buscar( ::oHasta ) }
   ::oGrupoFabricante:Cargo:TextDesde  := {|| oRetFld( ::oGrupoFabricante:Cargo:Desde, ::oDbfFab:oDbf, "cNomFab", "cCodFab" ) }
   ::oGrupoFabricante:Cargo:TextHasta  := {|| oRetFld( ::oGrupoFabricante:Cargo:Hasta, ::oDbfFab:oDbf, "cNomFab", "cCodFab" ) }
   ::oGrupoFabricante:Cargo:ValidDesde := {|oGet| if( ::oDbfFab:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomFab", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFabricante:Cargo:ValidHasta := {|oGet| if( ::oDbfFab:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomFab", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFabricante:Cargo:lImprimir  := lImp
   ::oGrupoFabricante:Cargo:cBitmap    := "gc_bolt_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoFabricante:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoFabricante )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoFabricante:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoFabricante:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoFabricante:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoFabricante )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoFabricante )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfFab )
         ::oDbfFab:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoTipoExpediente( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oTipoExpediente    := TTipoExpediente():Create( cPatEmp() )
   ::oTipoExpediente:OpenFiles()

   ::oGrupoTipoExpediente                    := TRGroup():New( {|| ::oDbf:cCodTip }, {|| "Tipo expediente : " + AllTrim( ::oDbf:cCodTip ) + " - " + AllTRim( ::oDbf:cNomTip ) }, {|| "Total tipo expediente..." }, {|| 3 }, ::lSalto )

   ::oGrupoTipoExpediente:Cargo              := TItemGroup()
   ::oGrupoTipoExpediente:Cargo:Nombre       := "Tipo expediente"
   ::oGrupoTipoExpediente:Cargo:Expresion    := "cCodTip"
   ::oGrupoTipoExpediente:Cargo:Todos        := .T.
   ::oGrupoTipoExpediente:Cargo:Desde        := Space( 3 )
   ::oGrupoTipoExpediente:Cargo:Hasta        := Replicate( "Z", 3 )
   ::oGrupoTipoExpediente:Cargo:cPicDesde    := "@!"
   ::oGrupoTipoExpediente:Cargo:cPicHasta    := "@!"
   ::oGrupoTipoExpediente:Cargo:HelpDesde    := {|| ::oTipoExpediente:Buscar( ::oDesde ) }
   ::oGrupoTipoExpediente:Cargo:HelpHasta    := {|| ::oTipoExpediente:Buscar( ::oHasta ) }
   ::oGrupoTipoExpediente:Cargo:ValidDesde   := {|oGet| if( ::oTipoExpediente:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTipoExpediente:Cargo:ValidHasta   := {|oGet| if( ::oTipoExpediente:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTipoExpediente:Cargo:lImprimir    := lImp

   ::oImageList:AddMasked( TBitmap():Define( "gc_folders_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoTipoExpediente )

      ::oImageGroup:AddMasked( TBitmap():Define( "gc_folders_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoTipoExpediente:Cargo:Imagen    := len( ::oImageGroup:aBitmaps ) - 1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoTipoExpediente:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoTipoExpediente )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoTipoExpediente )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oTipoExpediente )
         ::oTipoExpediente:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoEntidad( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oEntidad           := TEntidades():Create( cPatEmp() )
   ::oEntidad:OpenFiles()

   ::oGrupoEntidad                    := TRGroup():New( {|| ::oDbf:cCodEnt }, {|| "Entidad : " + AllTrim( ::oDbf:cCodEnt ) + " - " + AllTrim( ::oDbf:cDesEnt ) }, {|| "Total entidad..." }, {|| 3 }, ::lSalto )

   ::oGrupoEntidad:Cargo              := TItemGroup()
   ::oGrupoEntidad:Cargo:Nombre       := "Entidad"
   ::oGrupoEntidad:Cargo:Expresion    := "cCodEnt"
   ::oGrupoEntidad:Cargo:Todos        := .T.
   ::oGrupoEntidad:Cargo:Desde        := Space( 3 )
   ::oGrupoEntidad:Cargo:Hasta        := Replicate( "Z", 3 )
   ::oGrupoEntidad:Cargo:cPicDesde    := "@!"
   ::oGrupoEntidad:Cargo:cPicHasta    := "@!"
   ::oGrupoEntidad:Cargo:HelpDesde    := {|| ::oEntidad:Buscar( ::oDesde ) }
   ::oGrupoEntidad:Cargo:HelpHasta    := {|| ::oEntidad:Buscar( ::oHasta ) }
   ::oGrupoEntidad:Cargo:ValidDesde   := {|oGet| if( ::oEntidad:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesEnt", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoEntidad:Cargo:ValidHasta   := {|oGet| if( ::oEntidad:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesEnt", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoEntidad:Cargo:lImprimir    := lImp

   ::oImageList:AddMasked( TBitmap():Define( "gc_office_building2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoEntidad )

      ::oImageGroup:AddMasked( TBitmap():Define( "gc_office_building2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoEntidad:Cargo:Imagen    := len( ::oImageGroup:aBitmaps ) - 1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoEntidad:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoEntidad )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoEntidad )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oEntidad )
         ::oEntidad:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoColaborador( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oColaborador       := TColaboradores():Create( cPatEmp() )
   ::oColaborador:OpenFiles()

   ::oGrupoColaborador                    := TRGroup():New( {|| ::oDbf:cCodCol }, {|| "Colaborador : " + AllTrim( ::oDbf:cCodCol ) + " - " + AllTrim( ::oDbf:cDesCol ) }, {|| "Total Colaborador..." }, {|| 3 }, ::lSalto )

   ::oGrupoColaborador:Cargo              := TItemGroup()
   ::oGrupoColaborador:Cargo:Nombre       := "Colaborador"
   ::oGrupoColaborador:Cargo:Expresion    := "cCodCol"
   ::oGrupoColaborador:Cargo:Todos        := .T.
   ::oGrupoColaborador:Cargo:Desde        := Space( 3 )
   ::oGrupoColaborador:Cargo:Hasta        := Replicate( "Z", 3 )
   ::oGrupoColaborador:Cargo:cPicDesde    := "@!"
   ::oGrupoColaborador:Cargo:cPicHasta    := "@!"
   ::oGrupoColaborador:Cargo:HelpDesde    := {|| ::oColaborador:Buscar( ::oDesde ) }
   ::oGrupoColaborador:Cargo:HelpHasta    := {|| ::oColaborador:Buscar( ::oHasta ) }
   ::oGrupoColaborador:Cargo:ValidDesde   := {|oGet| if( ::oColaborador:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesCol", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoColaborador:Cargo:ValidHasta   := {|oGet| if( ::oColaborador:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesCol", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoColaborador:Cargo:lImprimir    := lImp

   ::oImageList:AddMasked( TBitmap():Define( "gc_businessman2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoColaborador )

      ::oImageGroup:AddMasked( TBitmap():Define( "gc_businessman2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoColaborador:Cargo:Imagen    := len( ::oImageGroup:aBitmaps ) - 1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoColaborador:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoColaborador )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoColaborador )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oColaborador )
         ::oColaborador:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoEstadoArticulo( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   If( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   if ::oDbfEstArt == nil .OR. !::oDbfEstArt:Used()
      ::oDbfEstArt := DbfServer( "ESTADOSAT.DBF", ):NewOpen( "ESTADOSAT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfEstArt:AddBag( "ESTADOSAT.CDX" ) ; ::oDbfEstArt:AddBag( ) ; ::oDbfEstArt:AutoIndex()
   end

   ::oGrupoEstadoArticulo                   := TRGroup():New( {|| ::oDbf:cCodEst }, {|| "Estado : " + AllTrim( ::oDbf:cCodEst ) + " - " + AllTRim( ::oDbf:cNomEst ) }, {|| "Total estado : " + ::oDbf:cCodEst }, {|| 3 }, ::lSalto )

   ::oGrupoEstadoArticulo:Cargo             := TItemGroup()
   ::oGrupoEstadoArticulo:Cargo:Nombre      := "Estado"
   ::oGrupoEstadoArticulo:Cargo:Expresion   := "cCodEst"
   ::oGrupoEstadoArticulo:Cargo:Todos       := .T.
   ::oGrupoEstadoArticulo:Cargo:Desde       := Space( 3 )
   ::oGrupoEstadoArticulo:Cargo:Hasta       := Replicate( "Z", 3 )
   ::oGrupoEstadoArticulo:Cargo:cPicDesde   := "@!"
   ::oGrupoEstadoArticulo:Cargo:cPicHasta   := "@!"
   ::oGrupoEstadoArticulo:Cargo:HelpDesde   := {|| BrwEstadoArticulo( ::oDesde, ::oSayDesde ) }
   ::oGrupoEstadoArticulo:Cargo:HelpHasta   := {|| BrwEstadoArticulo( ::oHasta, ::oSayHasta ) }
   ::oGrupoEstadoArticulo:Cargo:TextDesde   := {|| oRetFld( ::oGrupoEstadoArticulo:Cargo:Desde, ::oDbfEstArt, "cNombre", "Codigo" ) }
   ::oGrupoEstadoArticulo:Cargo:TextHasta   := {|| oRetFld( ::oGrupoEstadoArticulo:Cargo:Hasta, ::oDbfEstArt, "cNombre", "Codigo" ) }
   ::oGrupoEstadoArticulo:Cargo:ValidDesde  := {|oGet| if( cEstadoArticulo( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfEstArt:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoEstadoArticulo:Cargo:ValidHasta  := {|oGet| if( cEstadoArticulo( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfEstArt:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoEstadoArticulo:Cargo:lImprimir   := lImp
   ::oGrupoEstadoArticulo:Cargo:cBitmap     := "gc_bookmarks_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_bookmarks_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoEstadoArticulo )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_bookmarks_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoEstadoArticulo:Cargo:Imagen   := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoEstadoArticulo:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoEstadoArticulo )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoEstadoArticulo )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfEstArt )
         ::oDbfEstArt:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoRuta( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   If( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   if ::oDbfRut == nil .OR. !::oDbfRut:Used()
      ::oDbfRut := DbfServer( "RUTA.DBF", ):NewOpen( "RUTA.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfRut:AddBag( "RUTA.CDX" ) ; ::oDbfRut:AddBag( ) ; ::oDbfRut:AutoIndex()
   end

   ::oGrupoRuta                  := TRGroup():New( {|| ::oDbf:cCodRut }, {|| "Ruta : " + AllTrim( ::oDbf:cCodRut ) + " - " + AllTRim( ::oDbf:cNomRut ) }, {|| "Total ruta..." }, {|| 3 }, ::lSalto )

   ::oGrupoRuta:Cargo            := TItemGroup()
   ::oGrupoRuta:Cargo:Nombre     := "Ruta"
   ::oGrupoRuta:Cargo:Expresion  := "cCodRut"
   ::oGrupoRuta:Cargo:Todos      := .T.
   ::oGrupoRuta:Cargo:Desde      := Space( 4 )
   ::oGrupoRuta:Cargo:Hasta      := Replicate( "Z", 4 )
   ::oGrupoRuta:Cargo:cPicDesde  := "@!"
   ::oGrupoRuta:Cargo:cPicHasta  := "@!"
   ::oGrupoRuta:Cargo:TextDesde  := {|| oRetFld( ::oGrupoRuta:Cargo:Desde, ::oDbfRut, "CDESRUT", "CCODRUT" ) }
   ::oGrupoRuta:Cargo:TextHasta  := {|| oRetFld( ::oGrupoRuta:Cargo:Hasta, ::oDbfRut, "CDESRUT", "CCODRUT" ) }
   ::oGrupoRuta:Cargo:HelpDesde  := {|| BrwRuta( ::oDesde, ::oDbfRut:cAlias, ::oSayDesde ) }
   ::oGrupoRuta:Cargo:HelpHasta  := {|| BrwRuta( ::oHasta, ::oDbfRut:cAlias, ::oSayHasta ) }
   ::oGrupoRuta:Cargo:ValidDesde := {|oGet| if( cRuta( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfRut:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoRuta:Cargo:ValidHasta := {|oGet| if( cRuta( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfRut:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoRuta:Cargo:lImprimir  := lImp

   ::oGrupoRuta:Cargo:cBitmap   := "gc_signpost2_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_signpost2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoRuta )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_signpost2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoRuta:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoRuta:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoRuta )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoRuta )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfRut )
         ::oDbfRut:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoFacturasCompras( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   local cDesde
   local cHasta

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oFacPrvT == nil .OR. !::oFacCliT:Used()
      ::oFacPrvT := DbfServer( "FACPRVT.DBF", ):NewOpen( "FACPRVT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oFacPrvT:AddBag( "FACPRVT.CDX" ) ; ::oFacPrvT:AddBag( ) ; ::oFacPrvT:AutoIndex()
      ::oFacPrvT:OrdSetFocus( "nNumFac" )
   end





   ::oFacPrvT:GoBottom()
   cHasta               := ::oFacPrvT:cSerFac + Str( ::oFacPrvT:nNumFac ) + ::oFacPrvT:cSufFac





   ::oFacPrvT:GoTop()
   cDesde               := ::oFacPrvT:cSerFac + Str( ::oFacPrvT:nNumFac ) + ::oFacPrvT:cSufFac

   ::oGrupoFacturasCompras                  := TRGroup():New( {|| ::oDbf:cFactura }, {|| "Factura : " + AllTrim( ::oDbf:cFactura ) }, {|| "Total factura..." }, {|| 3 }, ::lSalto )

   ::oGrupoFacturasCompras:Cargo            := TItemGroup()
   ::oGrupoFacturasCompras:Cargo:Nombre     := "Factura"
   ::oGrupoFacturasCompras:Cargo:Expresion  := "cFactura"
   ::oGrupoFacturasCompras:Cargo:Todos      := .T.
   ::oGrupoFacturasCompras:Cargo:Desde      := cDesde
   ::oGrupoFacturasCompras:Cargo:Hasta      := cHasta
   ::oGrupoFacturasCompras:Cargo:cPicDesde  := "@R A/999999999/##"
   ::oGrupoFacturasCompras:Cargo:cPicHasta  := "@R A/999999999/##"
   ::oGrupoFacturasCompras:Cargo:HelpDesde  := {|| BrowseInformesFacPrv( ::oDesde, ::oSayDesde ) }
   ::oGrupoFacturasCompras:Cargo:HelpHasta  := {|| BrowseInformesFacPrv( ::oHasta, ::oSayHasta ) }
   ::oGrupoFacturasCompras:Cargo:ValidDesde := {|oGet| if( lValidInformeFacPrv( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFacturasCompras:Cargo:ValidHasta := {|oGet| if( lValidInformeFacPrv( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFacturasCompras:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "gc_document_text_businessman_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoFacturasCompras )

      ::oImageGroup:AddMasked( TBitmap():Define( "gc_document_text_businessman_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoFacturas:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoFacturasCompra:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoFacturasCompras )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoFacturasCompras )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oFacPrvT )
         ::oFacPrvT:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoFacturas( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   local cDesde
   local cHasta

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oFacCliT == nil .OR. !::oFacCliT:Used()
      ::oFacCliT        := TDataCenter():oFacCliT()
      ::oFacCliT:OrdSetFocus( "nNumFac" )
   end





   ::oFacCliT:GoBottom()
   cHasta               := ::oFacCliT:cSerie + Str( ::oFacCliT:nNumFac ) + ::oFacCliT:cSufFac





   ::oFacCliT:GoTop()
   cDesde               := ::oFacCliT:cSerie + Str( ::oFacCliT:nNumFac ) + ::oFacCliT:cSufFac


   ::oGrupoFacturas                  := TRGroup():New( {|| ::oDbf:cFactura }, {|| "Factura : " + AllTrim( ::oDbf:cFactura ) }, {|| "Total factura..." }, {|| 3 }, ::lSalto )

   ::oGrupoFacturas:Cargo            := TItemGroup()
   ::oGrupoFacturas:Cargo:Nombre     := "Factura"
   ::oGrupoFacturas:Cargo:Expresion  := "cFactura"
   ::oGrupoFacturas:Cargo:Todos      := .T.
   ::oGrupoFacturas:Cargo:Desde      := cDesde
   ::oGrupoFacturas:Cargo:Hasta      := cHasta
   ::oGrupoFacturas:Cargo:cPicDesde  := "@R A/999999999/##"
   ::oGrupoFacturas:Cargo:cPicHasta  := "@R A/999999999/##"
   ::oGrupoFacturas:Cargo:HelpDesde  := {|| BrowseInformesFacCli( ::oDesde, ::oSayDesde ) }
   ::oGrupoFacturas:Cargo:HelpHasta  := {|| BrowseInformesFacCli( ::oHasta, ::oSayHasta ) }
   ::oGrupoFacturas:Cargo:ValidDesde := {|oGet| if( lValidInformeFacCli( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFacturas:Cargo:ValidHasta := {|oGet| if( lValidInformeFacCli( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFacturas:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "gc_document_text_businessman_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoFacturas )

      ::oImageGroup:AddMasked( TBitmap():Define( "gc_document_text_businessman_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoFacturas:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoFacturas:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoFacturas )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoFacturas )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oFacCliT )
         ::oFacCliT:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoTemporada( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfTmp == nil .OR. !::oDbfTmp:Used()
      ::oDbfTmp := DbfServer( "Temporadas.DBF", ):NewOpen( "Temporadas.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfTmp:AddBag( "Temporadas.Cdx" ) ; ::oDbfTmp:AddBag( ) ; ::oDbfTmp:AutoIndex()
   end

   ::oGrupoTemporada                   := TRGroup():New( {|| ::oDbf:cCodTmp }, {|| "Temporada : " + AllTrim( ::oDbf:cCodTmp ) + " - " + AllTRim( ::oDbf:cNomTmp ) }, {|| "Total temporada..." }, {|| 3 }, ::lSalto )

   ::oGrupoTemporada:Cargo             := TItemGroup()
   ::oGrupoTemporada:Cargo:Nombre      := getConfigTraslation( "Temporada" )
   ::oGrupoTemporada:Cargo:Expresion   := "cCodTmp"
   ::oGrupoTemporada:Cargo:Todos       := .T.
   ::oGrupoTemporada:Cargo:Desde       := Space( 10 )
   ::oGrupoTemporada:Cargo:Hasta       := Replicate( "Z", 10 )
   ::oGrupoTemporada:Cargo:cPicDesde   := "@!"
   ::oGrupoTemporada:Cargo:cPicHasta   := "@!"
   ::oGrupoTemporada:Cargo:TextDesde   := {|| oRetFld( ::oGrupoTemporada:Cargo:Desde, ::oDbfTmp, "cNombre", "Codigo", .T. ) }
   ::oGrupoTemporada:Cargo:TextHasta   := {|| oRetFld( ::oGrupoTemporada:Cargo:Hasta, ::oDbfTmp, "cNombre", "Codigo", .T. ) }
   ::oGrupoTemporada:Cargo:HelpDesde   := {|| BrwTemporada( ::oDesde, ::oSayDesde, , .F. ) }
   ::oGrupoTemporada:Cargo:HelpHasta   := {|| BrwTemporada( ::oHasta, ::oSayHasta, , .F. ) }
   ::oGrupoTemporada:Cargo:ValidDesde  := {|oGet| if( cTemporada( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfTmp:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTemporada:Cargo:ValidHasta  := {|oGet| if( cTemporada( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfTmp:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTemporada:Cargo:lImprimir   := lImp
   ::oGrupoTemporada:Cargo:cBitmap     := "gc_cloud_sun_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_cloud_sun_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoTemporada )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_cloud_sun_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoTemporada:Cargo:Imagen    := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoTemporada:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoTemporada )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoTemporada )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfTmp )
         ::oDbfTmp:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoCategoria( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfCat == nil .OR. !::oDbfCat:Used()
      ::oDbfCat := DbfServer( "Categorias.DBF", ):NewOpen( "Categorias.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfCat:AddBag( "Categorias.Cdx" ) ; ::oDbfCat:AddBag( ) ; ::oDbfCat:AutoIndex()
   end

   ::oGrupoCategoria                   := TRGroup():New( {|| ::oDbf:cCodCate }, {|| "Categoría : " + AllTrim( ::oDbf:cCodCate ) }, {|| "Total categoría..." }, {|| 3 }, ::lSalto )

   ::oGrupoCategoria:Cargo             := TItemGroup()
   ::oGrupoCategoria:Cargo:Nombre      := "Categoría"
   ::oGrupoCategoria:Cargo:Expresion   := "cCodCate"
   ::oGrupoCategoria:Cargo:Todos       := .T.
   ::oGrupoCategoria:Cargo:Desde       := Space( 10 )
   ::oGrupoCategoria:Cargo:Hasta       := Replicate( "Z", 10 )
   ::oGrupoCategoria:Cargo:cPicDesde   := "@!"
   ::oGrupoCategoria:Cargo:cPicHasta   := "@!"
   ::oGrupoCategoria:Cargo:TextDesde   := {|| oRetFld( ::oGrupoCategoria:Cargo:Desde, ::oDbfCat, "cNombre", "Codigo", .T. ) }
   ::oGrupoCategoria:Cargo:TextHasta   := {|| oRetFld( ::oGrupoCategoria:Cargo:Hasta, ::oDbfCat, "cNombre", "Codigo", .T. ) }
   ::oGrupoCategoria:Cargo:HelpDesde   := {|| BrwCategoria( ::oDesde, ::oSayDesde, , .F. ) }
   ::oGrupoCategoria:Cargo:HelpHasta   := {|| BrwCategoria( ::oHasta, ::oSayHasta, , .F. ) }
   ::oGrupoCategoria:Cargo:ValidDesde  := {|oGet| if( cCategoria( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCategoria:Cargo:ValidHasta  := {|oGet| if( cCategoria( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCategoria:Cargo:lImprimir   := lImp
   ::oGrupoCategoria:Cargo:cBitmap     := "gc_photographic_filters_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_photographic_filters_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoCategoria )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_photographic_filters_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoCategoria:Cargo:Imagen    := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoCategoria:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoCategoria )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoCategoria )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfCat )
         ::oDbfTmp:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoIva( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfIva == nil .OR. !::oDbfIva:Used()
      ::oDbfIva := DbfServer( "TIva.Dbf", ):NewOpen( "TIva.Dbf",, ( cDriver() ),, ( cPatDat() ), .F., .T., .F., .F. ) ; ::oDbfIva:AddBag( "TIva.Cdx" ) ; ::oDbfIva:AddBag( ) ; ::oDbfIva:AutoIndex()
   end

   ::oGrupoIva                  := TRGroup():New( {|| ::oDbf:cCodIva }, {|| "Impuesto : " + AllTrim( ::oDbf:cCodIva ) }, {|| "Total " + cImp() + " : " + ::oDbf:cCodIva }, {|| 3 }, ::lSalto )

   ::oGrupoIva:Cargo            := TItemGroup()
   ::oGrupoIva:Cargo:Nombre     := "Impuesto"
   ::oGrupoIva:Cargo:Expresion  := "cCodIva"
   ::oGrupoIva:Cargo:Todos      := .T.
   ::oGrupoIva:Cargo:Desde      := Space( 1 )
   ::oGrupoIva:Cargo:Hasta      := Replicate( "Z", 1 )
   ::oGrupoIva:Cargo:cPicDesde  := "@!"
   ::oGrupoIva:Cargo:cPicHasta  := "@!"
   ::oGrupoIva:Cargo:HelpDesde  := {|| BrwIva( ::oDesde, ::oDbfIva:cAlias ) }
   ::oGrupoIva:Cargo:HelpHasta  := {|| BrwIva( ::oHasta, ::oDbfIva:cAlias ) }
   ::oGrupoIva:Cargo:TextDesde  := {|| oRetFld( ::oGrupoIva:Cargo:Desde, ::oDbfIva, "DescIva", "Tipo" ) }
   ::oGrupoIva:Cargo:TextHasta  := {|| oRetFld( ::oGrupoIva:Cargo:Hasta, ::oDbfIva, "DescIva", "Tipo" ) }
   ::oGrupoIva:Cargo:ValidDesde := {|oGet| if( cTIva( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfIva:cAlias ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoIva:Cargo:ValidHasta := {|oGet| if( cTIva( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfIva:cAlias ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoIva:Cargo:lImprimir  := lImp
   ::oGrupoIva:Cargo:cBitmap    := "gc_moneybag_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoIva:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoIva )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoIva:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoIva:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoIva:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoIva )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoIva )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfIva )
         ::oDbfIva:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoEntidadesBancarias( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   If( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   ::oCuentasBancarias  := TCuentasBancarias():Create( cPatEmp() )
   ::oCuentasBancarias:OpenFiles()

   ::oGrupoCuentasBancarias                    := TRGroup():New( {|| ::oDbf:cCodBnc }, {|| "Cuenta bancaria : " + AllTrim( ::oDbf:cCodBnc ) + " - " + AllTrim( ::oDbf:cNomBnc ) }, {|| "Total cuenta bancaria..." }, {|| 3 }, ::lSalto )

   ::oGrupoCuentasBancarias:Cargo              := TItemGroup()
   ::oGrupoCuentasBancarias:Cargo:Nombre       := "Cta. bancaria"
   ::oGrupoCuentasBancarias:Cargo:Expresion    := "cCodBnc"
   ::oGrupoCuentasBancarias:Cargo:Todos        := .T.
   ::oGrupoCuentasBancarias:Cargo:Desde        := Space( 3 )
   ::oGrupoCuentasBancarias:Cargo:Hasta        := Replicate( "Z", 3 )
   ::oGrupoCuentasBancarias:Cargo:cPicDesde    := "@!"
   ::oGrupoCuentasBancarias:Cargo:cPicHasta    := "@!"
   ::oGrupoCuentasBancarias:Cargo:HelpDesde    := {|| ::oCuentasBancarias:Buscar( ::oDesde ) }
   ::oGrupoCuentasBancarias:Cargo:HelpHasta    := {|| ::oCuentasBancarias:Buscar( ::oHasta ) }
   ::oGrupoCuentasBancarias:Cargo:TextDesde    := {|| oRetFld( ::oGrupoCuentasBancarias:Cargo:Desde, ::oCuentasBancarias:oDbf, "cNomBnc", "cCodBnc" ) }
   ::oGrupoCuentasBancarias:Cargo:TextHasta    := {|| oRetFld( ::oGrupoCuentasBancarias:Cargo:Hasta, ::oCuentasBancarias:oDbf, "cNomBnc", "cCodBnc" ) }
   ::oGrupoCuentasBancarias:Cargo:ValidDesde   := {|oGet| if( ::oCuentasBancarias:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomBnc", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCuentasBancarias:Cargo:ValidHasta   := {|oGet| if( ::oCuentasBancarias:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomBnc", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCuentasBancarias:Cargo:lImprimir    := lImp
   ::oGrupoCuentasBancarias:Cargo:cBitmap      := "gc_office_building2_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoCuentasBancarias:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoCuentasBancarias )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoCuentasBancarias:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoCuentasBancarias:Cargo:Imagen := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoCuentasBancarias:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoCuentasBancarias )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoCuentasBancarias )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oCuentasBancarias )
         ::oCuentasBancarias:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoNumero( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oGrupoNumero                 := TRGroup():New( {|| ::oDbf:cNumDoc }, {|| "Número : "  }, {|| "Total número : " + ::oDbf:cNumDoc }, {|| 3 }, ::lSalto )

   ::oGrupoNumero:Cargo            := TItemGroup()
   ::oGrupoNumero:Cargo:Nombre     := "Número"
   ::oGrupoNumero:Cargo:Expresion  := "cNumDoc"
   ::oGrupoNumero:Cargo:Todos      := .T.
   ::oGrupoNumero:Cargo:Desde      := Space( 10 )
   ::oGrupoNumero:Cargo:Hasta      := "9999999999"
   ::oGrupoNumero:Cargo:cPicDesde  := "9999999999"
   ::oGrupoNumero:Cargo:cPicHasta  := "9999999999"
   ::oGrupoNumero:Cargo:HelpDesde  := {|| nil }
   ::oGrupoNumero:Cargo:HelpHasta  := {|| nil }
   ::oGrupoNumero:Cargo:TextDesde  := {|| "" }
   ::oGrupoNumero:Cargo:TextHasta  := {|| "" }
   ::oGrupoNumero:Cargo:ValidDesde := {| oGet | if( oGet:VarGet() >= "0" , .T., ( msgStop( "No existe numeración negativa" ), .F. ) ) }
   ::oGrupoNumero:Cargo:ValidHasta := {| oGet | if( oGet:VarGet() >= "0" , .T., ( msgStop( "No existe numeración negativa" ), .F. ) ) }
   ::oGrupoNumero:Cargo:lImprimir  := lImp
   ::oGrupoNumero:Cargo:cBitmap    := "gc_keyboard_key_n_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoNumero:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoNumero )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoNumero:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoNumero:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoNumero:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoNumero )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoNumero )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoSerie( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oGrupoSerie                  := TRGroup():New( {|| ::oDbf:cSerDoc }, {|| "Serie : "  }, {|| "Total serie : " + ::oDbf:cSerDoc }, {|| 3 }, ::lSalto )

   ::oGrupoSerie:Cargo            := TItemGroup()
   ::oGrupoSerie:Cargo:Nombre     := "Serie"
   ::oGrupoSerie:Cargo:Expresion  := "cSerDoc"
   ::oGrupoSerie:Cargo:Todos      := .T.
   ::oGrupoSerie:Cargo:Desde      := "A"
   ::oGrupoSerie:Cargo:Hasta      := "Z"
   ::oGrupoSerie:Cargo:cPicDesde  := "@!"
   ::oGrupoSerie:Cargo:cPicHasta  := "@!"
   ::oGrupoSerie:Cargo:HelpDesde  := {|| nil }
   ::oGrupoSerie:Cargo:HelpHasta  := {|| nil }
   ::oGrupoSerie:Cargo:TextDesde  := {|| "" }
   ::oGrupoSerie:Cargo:TextHasta  := {|| "" }
   ::oGrupoSerie:Cargo:ValidDesde := {| oGet | if( oGet:VarGet() >= "A" .AND. oGet:VarGet() <= "Z", .T., ( msgStop( "Las series desde deben de estar comprendidas entre la A y la Z" ), .F. ) ) }
   ::oGrupoSerie:Cargo:ValidHasta := {| oGet | if( oGet:VarGet() >= "A" .AND. oGet:VarGet() <= "Z", .T., ( msgStop( "Las series hasta deben de estar comprendidas entre la A y la Z" ), .F. ) ) }
   ::oGrupoSerie:Cargo:lImprimir  := lImp
   ::oGrupoSerie:Cargo:cBitmap    := "gc_sort_az_descending_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoSerie:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoSerie )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoSerie:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoSerie:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoSerie:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoSerie )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoSerie )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoSufijo( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oGrupoSufijo                  := TRGroup():New( {|| ::oDbf:cSufDoc }, {|| "Delegación : "  }, {|| "Total delegación : " + ::oDbf:cSufDoc }, {|| 3 }, ::lSalto )

   ::oGrupoSufijo:Cargo            := TItemGroup()
   ::oGrupoSufijo:Cargo:Nombre     := "Delegación"
   ::oGrupoSufijo:Cargo:Expresion  := "cSufDoc"
   ::oGrupoSufijo:Cargo:Todos      := .T.
   ::oGrupoSufijo:Cargo:Desde      := Space( 2 )
   ::oGrupoSufijo:Cargo:Hasta      := "ZZ"
   ::oGrupoSufijo:Cargo:cPicDesde  := "@!"
   ::oGrupoSufijo:Cargo:cPicHasta  := "@!"
   ::oGrupoSufijo:Cargo:HelpDesde  := {|| nil }
   ::oGrupoSufijo:Cargo:HelpHasta  := {|| nil }
   ::oGrupoSufijo:Cargo:TextDesde  := {|| "" }
   ::oGrupoSufijo:Cargo:TextHasta  := {|| "" }
   ::oGrupoSufijo:Cargo:ValidDesde := {|| .T. }
   ::oGrupoSufijo:Cargo:ValidHasta := {|| .T. }
   ::oGrupoSufijo:Cargo:lImprimir  := lImp
   ::oGrupoSufijo:Cargo:cBitmap    := "gc_bags_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoSufijo:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoSufijo )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoSufijo:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoSufijo:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoSufijo:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoSufijo )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoSufijo )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_lGrupoRemesas( lInitGroup, lImp ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   If( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfRemCli == nil .OR. !::oDbfRemCli:Used()
      ::oDbfRemCli := DbfServer( "RemCliT.Dbf", ):NewOpen( "RemCliT.Dbf",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfRemCli:AddBag( "RemCliT.Cdx" ) ; ::oDbfRemCli:AddBag( ) ; ::oDbfRemCli:AutoIndex()
   end

   ::oGrupoRemesas                   := TRGroup():New( {|| ::oDbf:cCodTmp }, {|| "Remesas : " + alltrim( str( ::oDbf:nNumRem ) ) + " - " + alltrim( ::oDbf:cSufRem ) }, {|| "Total remesa..." }, {|| 3  }, ::lSalto )

   ::oGrupoRemesas:Cargo             := TItemGroup()
   ::oGrupoRemesas:Cargo:Nombre      := getConfigTraslation( "Remesas" )
   ::oGrupoRemesas:Cargo:Expresion   := "nNumRem"
   ::oGrupoRemesas:Cargo:Todos       := .T.

   ::oDbfRemCli:GoTop()
   ::oGrupoRemesas:Cargo:Desde       := ::oDbfRemCli:nNumRem

   ::oDbfRemCli:GoBottom()
   ::oGrupoRemesas:Cargo:Hasta       := ::oDbfRemCli:nNumRem

   ::oGrupoRemesas:Cargo:cPicDesde   := "999999999"
   ::oGrupoRemesas:Cargo:cPicHasta   := "999999999"
   ::oGrupoRemesas:Cargo:HelpDesde   := {|| nil }
   ::oGrupoRemesas:Cargo:HelpHasta   := {|| nil }
   ::oGrupoRemesas:Cargo:ValidDesde  := {|oGet| lValidRemesaCliente( oGet, ::oDbfRemCli ) }
   ::oGrupoRemesas:Cargo:ValidHasta  := {|oGet| lValidRemesaCliente( oGet, ::oDbfRemCli ) }
   ::oGrupoRemesas:Cargo:lImprimir   := lImp
   ::oGrupoRemesas:Cargo:cBitmap     := "gc_briefcase2_document_16"

   if !empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "gc_briefcase2_document_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoRemesas )

      if !empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_briefcase2_document_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoRemesas:Cargo:Imagen    := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoRemesas:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoRemesas )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoRemesas )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !empty( ::oDbfRemCli )
         ::oDbfRemCli:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TNewInfGen_oDefEstados( nIdEstadoUno, nIdEstadoDos, oDlg ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   If( nIdEstadoUno == nil, nIdEstadoUno := 218, ) ;
   If( nIdEstadoDos == nil, nIdEstadoDos := 219, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oEstadoUno := TComboBox():ReDefine( nIdEstadoUno, { | u | If( PCount()==0, ::cEstadoUno, ::cEstadoUno:= u ) }, ::aEstadoUno, oDlg,,,,,,, .F.,,,,,,, "::oEstadoUno",,,,,,, )





   ::oEstadoDos := TComboBox():ReDefine( nIdEstadoDos, { | u | If( PCount()==0, ::cEstadoDos, ::cEstadoDos:= u ) }, ::aEstadoDos, oDlg,,,,,,, .F.,,,,,,, "::oEstadoDos",,,,,,, )

Return( Self )



static FUNCTION TNewInfGen_HideCondiciones( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if !::lDefEstadoUno .AND. ValType( ::oEstadoUno ) == "O"
      ::oEstadoUno:Hide()
   end

   if !::lDefEstadoDos .AND. ValType( ::oEstadoDos ) == "O"
      ::oEstadoDos:Hide()
   end

   if !::lDefCondiciones .AND. Valtype( ::oTreeCondiciones ) == "O"
      ::oTreeCondiciones:Hide()
   end

Return ( Self )



static FUNCTION TNewInfGen_oDefDesde( nIdDesde, nIdSayDesde, oDlg ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   If( nIdDesde == nil, nIdDesde := 110, ) ;
   If( nIdSayDesde == nil, nIdSayDesde := 111, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oDesde := TGetHlp():ReDefine( ( nIdDesde ), { | u | If( PCount()==0, ::cDesde, ::cDesde:= u ) }, oDlg,,,,,,,,, .F., {||     ( !::lTodos )},, .F., .F.,,,,,, nil, "LUPA",, )




   ::oSayDesde := TGetHlp():ReDefine( ( nIdSayDesde ), { | u | If( PCount()==0, ::cSayDesde, ::cSayDesde:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

Return ( Self )



static FUNCTION TNewInfGen_oDefHasta( nIdHasta, nIdSayHasta, oDlg ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   If( nIdHasta == nil, nIdHasta := 120, ) ;
   If( nIdSayHasta == nil, nIdSayHasta := 121, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oHasta := TGetHlp():ReDefine( ( nIdHasta ), { | u | If( PCount()==0, ::cHasta, ::cHasta:= u ) }, oDlg,,,,,,,,, .F., {||     ( !::lTodos )},, .F., .F.,,,,,, nil, "LUPA",, )




   ::oSayHasta := TGetHlp():ReDefine( ( nIdSayHasta ), { | u | If( PCount()==0, ::cSayHasta, ::cSayHasta:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

Return ( Self )



static FUNCTION TNewInfGen_oDefTodos( nIdTodos, oDlg ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   If( nIdTodos == nil, nIdTodos := 140, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oTodos := TCheckBox():ReDefine( ( nIdTodos ), { | u | If( PCount()==0, ::lTodos, ::lTodos:= u ) }, oDlg,, {||         ( ::ChangeValor() )},,,,, .F.,, .F. )

return ( self )



static FUNCTION TNewInfGen_ChangeRango( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local oItemSelect

   if Empty( ::oTreeRango )
      Return ( Self )
   end

   oItemSelect          := ::oTreeRango:GetSelected()

   if oItemSelect <> nil .AND. oItemSelect:ClassName() == "TTVITEM"

      ::lTodos          := ( oItemSelect:Cargo:Cargo:Todos )
      ::cDesde          := ( oItemSelect:Cargo:Cargo:Desde )
      ::cHasta          := ( oItemSelect:Cargo:Cargo:Hasta )

      if !Empty( oItemSelect:Cargo:Cargo:bCondition )

         if !Eval( oItemSelect:Cargo:Cargo:bCondition )

            ::oTodos:Disable()
            ::oDesde:Disable()
            ::oHasta:Disable()

         else

            ::oTodos:Enable()
            ::oDesde:Enable()
            ::oHasta:Enable()

         end

         ::oDesde:bHelp    := oItemSelect:Cargo:Cargo:HelpDesde
         ::oDesde:bValid   := oItemSelect:Cargo:Cargo:ValidDesde

         ::oHasta:bHelp    := oItemSelect:Cargo:Cargo:HelpHasta
         ::oHasta:bValid   := oItemSelect:Cargo:Cargo:ValidHasta

      else

         ::oTodos:Enable()

         ::oDesde:bHelp             := oItemSelect:Cargo:Cargo:HelpDesde
         ::oDesde:bValid            := oItemSelect:Cargo:Cargo:ValidDesde
         ::oDesde:oGet:Picture      := oItemSelect:Cargo:Cargo:cPicDesde

         ::oHasta:bHelp             := oItemSelect:Cargo:Cargo:HelpHasta
         ::oHasta:bValid            := oItemSelect:Cargo:Cargo:ValidHasta
         ::oHasta:oGet:Picture      := oItemSelect:Cargo:Cargo:cPicHasta

      end

      ::oTodos:Click( ::lTodos )

      ::oDesde:cText( ::cDesde )
      ::oHasta:cText( ::cHasta )

      ::oDesde:lValid()
      ::oHasta:lValid()

   end

Return( Self )



static FUNCTION TNewInfGen_SetValor( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

Return ( self )



static FUNCTION TNewInfGen_ChangeValor( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local oItemSelect

   if Empty( ::oTreeRango )
      Return ( self )
   end

   oItemSelect       := ::oTreeRango:GetSelected()

   if oItemSelect <> nil .AND. oItemSelect:ClassName() == "TTVITEM"
      oItemSelect:Cargo:Cargo:Todos  := ::lTodos
      oItemSelect:Cargo:Cargo:Desde  := ::oDesde:VarGet()
      oItemSelect:Cargo:Cargo:Hasta  := ::oHasta:VarGet()
   end

Return ( self )



static FUNCTION TNewInfGen_InitDialog( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local n
   local nPos

   ::HideCondiciones()

   if !Empty( ::aSelectionRango )

      for n := 1 to len( ::aSelectionRango )
         with object ( ::oTreeRango:Add( ::aSelectionRango[ n ]:Cargo:Nombre, n - 1 ) )
            :Cargo := ::aSelectionRango[ n ]
         end
      next





      if len( ::oTreeRango:aItems ) > 0
         ::oTreeRango:Select( ::oTreeRango:aItems[ 1 ] )
         ::ChangeRango()
      end

   end

   ::oTreeRango:SetImagelist( ::oImageList )

   if !Empty( ::oTreeGroups )
      ::oTreeGroups:SetImagelist( ::oImageGroup )
   end

   if !Empty( ::oTreeSelectedGroups )
      ::oTreeSelectedGroups:SetImagelist( ::oImageGroup )
   end





   SysRefresh()

   if ::lDesglosar
      ::oDefDesglosar()
   end

   if ::lLinImporteCero
      ::oDefLinImporteCero()
   end

   if ::lDocImporteCero
      ::oDefDocImporteCero()
   end





   if !Empty( ::aSelectionGroup )
      for n := 1 to len( ::aSelectionGroup )
         with object ( ::oTreeGroups:Add( ::aSelectionGroup[ n ]:Cargo:Nombre, n - 1 ) )
            :Cargo := ::aSelectionGroup[ n ]
         end
      next
   end

   if ::oDbfGrp:Seek( Auth():Codigo() + ::cSubTitle )

      while Rtrim( Auth():Codigo() + ::cSubTitle ) == Rtrim( ::oDbfGrp:cCodUse + ::oDbfGrp:cNomInf ) .AND. !::oDbfGrp:eof()

         nPos     := aScan( ::aSelectionGroup, {|o| Rtrim( o:Cargo:Nombre ) == Rtrim( ::oDbfGrp:cNomGrp ) } )
         if nPos  <> 0
            aAdd( ::aSelectedGroup, ::aSelectionGroup[ nPos ] )
         end

         ::oDbfGrp:Skip()

      end

   else

      if !Empty( ::aInitGroup )
         aEval( ::aInitGroup, {| oGroup | aAdd( ::aSelectedGroup, oGroup ) } )
      end

   end

   ::ReLoadGroup()

RETURN ( Self )



static FUNCTION TNewInfGen_oDefDesglosar( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::oDesglosar      := ::oTreeCondiciones:Add( "Desglosar por propiedades y lotes", 0 )



   ::oTreeCondiciones:SetCheck( ::oDesglosar, .F. )

RETURN ( Self )



static FUNCTION TNewInfGen_oDefLinImporteCero( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::oLinImporteCero    := ::oTreeCondiciones:Add( "Excluir líneas con importe 0", 0 )



   ::oTreeCondiciones:SetCheck( ::oLinImporteCero, .T. )

RETURN ( Self )



static FUNCTION TNewInfGen_oDefDocImporteCero( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::oDocImporteCero    := ::oTreeCondiciones:Add( "Excluir documentos con importe 0", 0 )



   ::oTreeCondiciones:SetCheck( ::oDocImporteCero, .T. )

RETURN ( Self )



static FUNCTION TNewInfGen_lIgualCliente( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

RETURN ( ::oGrupoCliente:Cargo:Desde == ::oGrupoCliente:Cargo:Hasta )



static FUNCTION TNewInfGen_lPeriodoInforme( nId, oDlg ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   If( nId == nil, nId := 220, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oPeriodo := TComboBox():ReDefine( nId, { | u | If( PCount()==0, ::cPeriodo, ::cPeriodo:= u ) }, ::aPeriodo, oDlg,,,,,,, .F.,,,,,,, "::oPeriodo",,,,,,, )

   ::oPeriodo:bChange   := {|| ::lRecargaFecha() }

RETURN ( .T. )



static FUNCTION TNewInfGen_lRecargaFecha( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

    if empty( ::oIniInf ) .OR. empty( ::oFinInf )
        return ( .T. )
    end

   do case
      case ::cPeriodo == "Hoy"

         ::oIniInf:cText( GetSysDate() )
         ::oFinInf:cText( GetSysDate() )

      case ::cPeriodo == "Ayer"

         ::oIniInf:cText( GetSysDate() -1 )
         ::oFinInf:cText( GetSysDate() -1 )

      case ::cPeriodo == "Mes en curso"

         ::oIniInf:cText( CtoD( "01/" + Str( Month( GetSysDate() ) ) + "/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( GetSysDate() )

      case ::cPeriodo == "Mes anterior"

         ::oIniInf:cText( BoM( addMonth( GetSysDate(), -1 ) ) )
         ::oFinInf:cText( EoM( addMonth( GetSysDate(), -1 ) ) )

      case ::cPeriodo == "Primer trimestre"

         ::oIniInf:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "31/03/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Segundo trimestre"

         ::oIniInf:cText( CtoD( "01/04/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "30/06/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Tercer trimestre"

         ::oIniInf:cText( CtoD( "01/07/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "30/09/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Cuatro trimestre"

         ::oIniInf:cText( CtoD( "01/10/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Doce últimos meses"

         ::oIniInf:cText( CtoD( Str( Day( GetSysDate() ) ) + "/" + Str( Month( GetSysDate() ) ) + "/" + Str( Year( GetSysDate() ) -1 ) ) )
         ::oFinInf:cText( GetSysDate() )

      case ::cPeriodo == "Año en curso"

         ::oIniInf:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Año anterior"

         ::oIniInf:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) - 1 ) ) )
         ::oFinInf:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) - 1 ) ) )

   end

RETURN ( .T. )



static FUNCTION TNewInfGen_lCreaArrayPeriodos( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   aAdd( ::aPeriodo, "Hoy" )

   aAdd( ::aPeriodo, "Ayer" )

   aAdd( ::aPeriodo, "Mes en curso" )

   aAdd( ::aPeriodo, "Mes anterior" )

   do case
      case Month( GetSysDate() ) <= 3
         aAdd( ::aPeriodo, "Primer trimestre" )

      case Month( GetSysDate() ) > 3 .AND. Month( GetSysDate() ) <= 6
         aAdd( ::aPeriodo, "Primer trimestre" )
         aAdd( ::aPeriodo, "Segundo trimestre" )

      case Month( GetSysDate() ) > 6 .AND. Month( GetSysDate() ) <= 9
         aAdd( ::aPeriodo, "Primer trimestre" )
         aAdd( ::aPeriodo, "Segundo trimestre" )
         aAdd( ::aPeriodo, "Tercer trimestre" )

      case Month( GetSysDate() ) > 9 .AND. Month( GetSysDate() ) <= 12
         aAdd( ::aPeriodo, "Primer trimestre" )
         aAdd( ::aPeriodo, "Segundo trimestre" )
         aAdd( ::aPeriodo, "Tercer trimestre" )
         aAdd( ::aPeriodo, "Cuatro trimestre" )

   end

   aAdd( ::aPeriodo, "Doce últimos meses" )

   aAdd( ::aPeriodo, "Año en curso" )

   aAdd( ::aPeriodo, "Año anterior" )

RETURN ( .T. )



static FUNCTION TNewInfGen_oDefHoraInicio( nId, oDlg ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   If( nId == nil, nId := 1111, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   if Empty( ::cHoraInicio )
      ::cHoraInicio  := uFieldEmpresa( "cIniJor" )
   end









   ::oHoraInicio := TGetHlp():ReDefine( nId, { | u | If( PCount()==0, ::cHoraInicio, ::cHoraInicio:= u ) }, oDlg,, "@R 99:99", {||          ( validHourMinutes( ::oHoraInicio, .T. ) )},,,,,, .F.,,, .F., .T., {||          ( UpTime( ::oHoraInicio ) )}, {||        ( DwTime( ::oHoraInicio ) )},,,, nil,,, )

RETURN ( ::oHoraInicio )



static FUNCTION TNewInfGen_oDefHoraFin( nId, oDlg ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   If( nId == nil, nId := 1121, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   if Empty( ::cHoraFin )
      ::cHoraFin  := "2359"
   end









   ::oHoraFin := TGetHlp():ReDefine( nId, { | u | If( PCount()==0, ::cHoraFin, ::cHoraFin:= u ) }, oDlg,, "@R 99:99", {||       ( validHourMinutes( ::oHoraFin, .T. ) )},,,,,, .F.,,, .F., .T., {||       ( UpTime( ::oHoraFin ) )}, {||     ( DwTime( ::oHoraFin ) )},,,, nil,,, )

RETURN ( ::oHoraFin )



static FUNCTION TNewInfGen_AddVariable( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   public dFechaInicio                 := Dtos( ::dIniInf )
   public dFechaFin                    := Dtos( ::dFinInf )

   ::oFastReport:AddVariable(          "Informe",  "Desde fecha",                   "GetHbVar('dFechaInicio')" )
   ::oFastReport:AddVariable(          "Informe",  "Hasta fecha",                   "GetHbVar('dFechaFin')" )

   if !Empty( ::oGrupoFabricante )
      public cGrupoFabricanteDesde     := ::oGrupoFabricante:Cargo:Desde
      public cGrupoFabricanteHasta     := ::oGrupoFabricante:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de fabricante",     "GetHbVar('cGrupoFabricanteDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de fabricante",     "GetHbVar('cGrupoFabricanteHasta')" )
   end

   if !Empty( ::oGrupoArticulo )
      public cGrupoArticuloDesde       := ::oGrupoArticulo:Cargo:Desde
      public cGrupoArticuloHasta       := ::oGrupoArticulo:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de artículo",       "GetHbVar('cGrupoArticuloDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de artículo",       "GetHbVar('cGrupoArticuloHasta')" )
      ::oFastReport:AddVariable(       "Informe", "Desde nombre de artículo",       "GetHbVar('cGrupoArticuloNombreDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta nombre de artículo",       "GetHbVar('cGrupoArticuloNombreHasta')" )
   end

   if !Empty( ::oGrupoMateriaPrima )
      public cGrupoMateriaPrimaDesde   := ::oGrupoMateriaPrima:Cargo:Desde
      public cGrupoMateriaPrimaHasta   := ::oGrupoMateriaPrima:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de materia prima",  "GetHbVar('cGrupoMateriaPrimaDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de materia prima",  "GetHbVar('cGrupoMateriaPrimaHasta')" )
   end

   if !Empty( ::oGrupoCliente )
      public cGrupoClienteDesde        := ::oGrupoCliente:Cargo:Desde
      public cGrupoClienteHasta        := ::oGrupoCliente:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de cliente",        "GetHbVar('cGrupoClienteDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de cliente",        "GetHbVar('cGrupoClienteHasta')" )
      ::oFastReport:AddVariable(       "Informe", "Desde nombre de cliente",        "GetHbVar('cGrupoClienteNombreDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta nombre de cliente",        "GetHbVar('cGrupoClienteNombreHasta')" )
   end

   if !Empty( ::oGrupoProveedor )

      public cGrupoProveedorDesde      := ::oGrupoProveedor:Cargo:Desde
      public cGrupoProveedorHasta      := ::oGrupoProveedor:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de proveedor",      "GetHbVar('cGrupoProveedorDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de proveedor",      "GetHbVar('cGrupoProveedorHasta')" )

   end

   if !Empty( ::oGrupoOperacion )
   end

   if !Empty( ::oGrupoSeccion )
   end

   if !Empty( ::oGrupoAlmacen )

      public cGrupoAlmacenDesde        := ::oGrupoAlmacen:Cargo:Desde
      public cGrupoAlmacenHasta        := ::oGrupoAlmacen:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde almacen",                  "GetHbVar('cGrupoAlmacenDesde')")
      ::oFastReport:AddVariable(       "Informe", "Hasta almacen",                  "GetHbVar('cGrupoAlmacenHasta')")

   end

   if !Empty( ::oGrupoMaquina )
   end

   if !Empty( ::oGrupoOperario )
   end

   if !Empty( ::oGrupoFpago )
   end

   if !Empty( ::oGrupoBanco )
   end

   if !Empty( ::oGrupoAgente )

      public cGrupoAgenteDesde         := ::oGrupoAgente:Cargo:Desde
      public cGrupoAgenteHasta         := ::oGrupoAgente:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de agente",  "GetHbVar('cGrupoAgenteDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de agente",  "GetHbVar('cGrupoAgenteHasta')" )

   end

   if !Empty( ::oGrupoCaja )
   end

   if !Empty( ::oGrupoGCliente )

      public cGrupoGClienteDesde        := ::oGrupoGCliente:Cargo:Desde
      public cGrupoGClienteHasta        := ::oGrupoGCliente:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código grupo de cliente",        "GetHbVar('cGrupoGClienteDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código grupo de cliente",        "GetHbVar('cGrupoGClienteHasta')" )

      ::oFastReport:AddVariable(       "Informe", "Desde nombre grupo de cliente",        "GetHbVar('cGrupoGClienteNombreDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta nombre grupo de cliente",        "GetHbVar('cGrupoGClienteNombreHasta')" )

   end

   if !Empty( ::oGrupoGProveedor )
   end

   if !Empty( ::oGrupoObra )
   end

   if !Empty( ::oGrupoFamilia )

      public cGrupoFamiliaDesde           := ::oGrupoFamilia:Cargo:Desde
      public cGrupoFamiliaHasta           := ::oGrupoFamilia:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de familia",  "GetHbVar('cGrupoFamiliaDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de familia",  "GetHbVar('cGrupoFamiliaHasta')" )

   end

   if !Empty( ::oGrupoGFamilia )
   end

   if !Empty( ::oGrupoTArticulo )

      public cGrupoTArticuloDesde           := ::oGrupoTArticulo:Cargo:Desde
      public cGrupoTArticuloHasta           := ::oGrupoTArticulo:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de tipo de artículo",  "GetHbVar('cGrupoTArticuloDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de tipo de artículo",  "GetHbVar('cGrupoTArticuloHasta')" )

   end

   if !Empty( ::oGrupoCentroCoste )

      public cGrupoCentroCosteDesde          := ::oGrupoCentroCoste:Cargo:Desde
      public cGrupoCentroCosteHasta          := ::oGrupoCentroCoste:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de centro de coste",  "GetHbVar('cGrupoCentroCosteDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de centro de coste",  "GetHbVar('cGrupoCentroCosteHasta')" )

      ::oFastReport:AddVariable(       "Informe", "Desde nombre de centro de coste",  "GetHbVar('cGrupoCCosteNombreDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta nombre de centro de coste",  "GetHbVar('cGrupoCCosteNombreHasta')" )

   end

   if !Empty( ::oGrupoFabricante )
   end

   if !Empty( ::oGrupoTOperacion )
   end

   if !Empty( ::oGrupoEstadoArticulo )

      public cGrupoEstadoArticuloDesde           := ::oGrupoEstadoArticulo:Cargo:Desde
      public cGrupoEstadoArticuloHasta           := ::oGrupoEstadoArticulo:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de estado artículo",  "GetHbVar('cGrupoEstadoArticuloDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de estado artículo",  "GetHbVar('cGrupoEstadoArticuloHasta')" )

   end

   if !Empty( ::oGrupoRuta )

      public cGrupoRutaDesde           := ::oGrupoRuta:Cargo:Desde
      public cGrupoRutaHasta           := ::oGrupoRuta:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de ruta",  "GetHbVar('cGrupoRutaDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de ruta",  "GetHbVar('cGrupoRutaHasta')" )

   end

   if !Empty( ::oGrupoFacturas )
   end

   if !Empty( ::oGrupoFacturasCompras )
   end

   if !Empty( ::oGrupoTemporada )
      public cGrupoTemporadaDesde           := ::oGrupoTemporada:Cargo:Desde
      public cGrupoTemporadaHasta           := ::oGrupoTemporada:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de temporada",  "GetHbVar('cGrupoTemporadaDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de temporada",  "GetHbVar('cGrupoTemporadaHasta')" )
   end

   if !Empty( ::oGrupoCategoria )
      public cGrupoCategoriaDesde           := ::oGrupoCategoria:Cargo:Desde
      public cGrupoCategoriaHasta           := ::oGrupoCategoria:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de categoría",  "GetHbVar('cGrupoCategoriaDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de Categoría",  "GetHbVar('cGrupoCategoriaHasta')" )
   end

   if !Empty( ::oGrupoIVA )
   end

   if !Empty( ::oGrupoSerie )
   end

Return ( Self )



static FUNCTION TNewInfGen_SaveReport( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if ::oDbfInf:Seek( Auth():Codigo() + Upper( ::cSubTitle ) )
      ::oDbfInf:Load()
      ::oDbfInf:cCodUse := Auth():Codigo()
      ::oDbfInf:cNomInf := ::cSubTitle
      ::oDbfInf:Save()
   else
      ::oDbfInf:Append()
      ::oDbfInf:cCodUse := Auth():Codigo()
      ::oDbfInf:cNomInf := ::cSubTitle
      ::oDbfInf:Save()
   end

RETURN ( ::oFastReport:SaveToBlob( ::oDbfInf:nArea, "mModInf" ) )



static FUNCTION TNewInfGen_MoveReport( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if ::oDbfInf:Seek( Auth():Codigo() + Upper( ::cSubTitle ) )

      ::oDbfInf:Load()

      ::oDbfInf:mOrgInf := ::oDbfInf:mModInf
      ::oDbfInf:Save()

      msgInfo( "El informe ha sido movido al original" )

   else

      msgStop( Auth():Codigo() + Upper( ::cSubTitle ), "No encontrado" )

   end

RETURN ( Self )



static FUNCTION TNewInfGen_lHideFecha( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::oPeriodo:Hide()

   ::oIniInf:Hide()
   ::oFinInf:Hide()

   if IsObject( ::oIniText )
      ::oIniText:Hide()
   end

   if IsObject( ::oFinText )
      ::oFinText:Hide()
   end

RETURN ( Self )



static FUNCTION TNewInfGen_lShowFecha( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::oPeriodo:Show()

   ::oIniInf:Show()
   ::oFinInf:Show()

   if IsObject( ::oIniText )
      ::oIniText:Show()
   end

   if IsObject( ::oFinText )
      ::oFinText:Show()
   end

RETURN ( Self )



static FUNCTION TNewInfGen_End( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::Super:End()

   if ::oGrpCli <> nil
      ::oGrpCli:CloseService()
   end

RETURN ( Self )



static FUNCTION TNewInfGen_SetNombreDesdeGrupoCliente( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if !Empty( ::oGrupoGCliente:Cargo:Desde )
      public cGrupoGClienteNombreDesde  := oRetFld( ::oGrupoGCliente:Cargo:Desde, ::oGrpCli:oDbf, "CNOMGRP", "CCODGRP" )
   else
      public cGrupoGClienteNombreDesde  := ""
   end

Return ( cGrupoGClienteNombreDesde )



static FUNCTION TNewInfGen_SetNombreHastaGrupoCliente( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if !Empty( ::oGrupoGCliente:Cargo:Hasta )
      public cGrupoGClienteNombreHasta  := oRetFld( ::oGrupoGCliente:Cargo:Hasta, ::oGrpCli:oDbf, "CNOMGRP", "CCODGRP" )
   else
      public cGrupoGClienteNombreHasta  := ""
   end

Return ( cGrupoGClienteNombreHasta )



static FUNCTION TNewInfGen_SetNombreDesdeCentroCoste( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if !Empty( ::oGrupoCentroCoste:Cargo:Desde )
      public cGrupoCCosteNombreDesde  := oRetFld( ::oGrupoCentroCoste:Cargo:Desde, ::oDbfCentroCoste:oDbf, "cNombre", "cCodigo" )
   else
      public cGrupoCCosteNombreDesde  := ""
   end

Return ( cGrupoCCosteNombreDesde )



static FUNCTION TNewInfGen_SetNombreHastaCentroCoste( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if !Empty( ::oGrupoCentroCoste:Cargo:Hasta )
      public cGrupoCCosteNombreHasta  := oRetFld( ::oGrupoCentroCoste:Cargo:Hasta, ::oDbfCentroCoste:oDbf, "cNombre", "cCodigo" )
   else
      public cGrupoCCosteNombreHasta  := ""
   end

Return ( cGrupoCCosteNombreHasta )



static FUNCTION TNewInfGen_SetNombreDesdeCliente( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if !Empty( ::oGrupoCliente:Cargo:Desde )
      public cGrupoClienteNombreDesde  := oRetFld( ::oGrupoCliente:Cargo:Desde, ::oDbfCli, "TITULO", "COD" )
   else
      public cGrupoClienteNombreDesde  := ""
   end

Return ( cGrupoClienteNombreDesde )



static FUNCTION TNewInfGen_SetNombreHastaCliente( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if !Empty( ::oGrupoCliente:Cargo:Hasta )
      public cGrupoClienteNombreHasta  := oRetFld( ::oGrupoCliente:Cargo:Hasta, ::oDbfCli, "TITULO", "COD" )
   else
      public cGrupoClienteNombreHasta  := ""
   end

Return ( cGrupoClienteNombreHasta )



static FUNCTION TNewInfGen_SetNombreDesdeArticulo( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if !Empty( ::oGrupoArticulo:Cargo:Desde )
      public cGrupoArticuloNombreDesde  := oRetFld( ::oGrupoArticulo:Cargo:Desde, ::oDbfArt, "Nombre", "Codigo" )
   else
      public cGrupoArticuloNombreDesde  := ""
   end

Return ( cGrupoArticuloNombreDesde )



static FUNCTION TNewInfGen_SetNombreHastaArticulo( ) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if !Empty( ::oGrupoArticulo:Cargo:Hasta )
      public cGrupoArticuloNombreHasta  := oRetFld( ::oGrupoArticulo:Cargo:Hasta, ::oDbfArt, "Nombre", "Codigo" )
   else
      public cGrupoArticuloNombreHasta  := ""
   end

Return ( cGrupoArticuloNombreHasta )
