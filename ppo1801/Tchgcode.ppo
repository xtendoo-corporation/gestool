#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 8 ".\.\Prg\Tchgcode.prg"
_HB_CLASS TChgCode ; function TChgCode ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TChgCode", iif( .F., { }, { @HBObject() } ), @TChgCode() ) ) ;

   _HB_MEMBER { oDlg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDlg"}, .F. )
   _HB_MEMBER { oDbfArt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfArt"}, .F. )
   _HB_MEMBER { oDbfFam } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFam"}, .F. )
   _HB_MEMBER { oDbfPrv } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPrv"}, .F. )
   _HB_MEMBER { oDbfPrc } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPrc"}, .F. )
   _HB_MEMBER { oDbfTar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfTar"}, .F. )
   _HB_MEMBER { oDbfOfe } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfOfe"}, .F. )
   _HB_MEMBER { oDbfArd } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfArd"}, .F. )
   _HB_MEMBER { oDbfKit } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfKit"}, .F. )
   _HB_MEMBER { oDbfPedPrv } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPedPrv"}, .F. )
   _HB_MEMBER { oDbfAlbPrv } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfAlbPrv"}, .F. )
   _HB_MEMBER { oDbfFacPrv } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFacPrv"}, .F. )
   _HB_MEMBER { oDbfPro } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPro"}, .F. )



   _HB_MEMBER { oDbfExtAge } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfExtAge"}, .F. )
   _HB_MEMBER { oDbfPreCli } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPreCli"}, .F. )
   _HB_MEMBER { oDbfPedCli } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPedCli"}, .F. )
   _HB_MEMBER { oDbfAlbCli } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfAlbCli"}, .F. )
   _HB_MEMBER { oDbfFacCli } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFacCli"}, .F. )
   _HB_MEMBER { oDbfPreCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPreCliT"}, .F. )
   _HB_MEMBER { oDbfPedCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPedCliT"}, .F. )
   _HB_MEMBER { oDbfAlbCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfAlbCliT"}, .F. )
   _HB_MEMBER { oDbfFacCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFacCliT"}, .F. )
   _HB_MEMBER { oDbfFacCliP } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFacCliP"}, .F. )
   _HB_MEMBER { oDbfTpvCli } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfTpvCli"}, .F. )
   _HB_MEMBER { oDbfCliAtp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfCliAtp"}, .F. )
   _HB_MEMBER { oDbfTblPro } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfTblPro"}, .F. )
   _HB_MEMBER { oDbfArtKit } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfArtKit"}, .F. )
   _HB_MEMBER { oDbfAgentes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfAgentes"}, .F. )
   _HB_MEMBER { oDbfClient } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfClient"}, .F. )
   _HB_MEMBER { oDbfTpvCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfTpvCliT"}, .F. )
   _HB_MEMBER { oDbfEmpresa } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfEmpresa"}, .F. )
   _HB_MEMBER { oDbfPedPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPedPrvT"}, .F. )
   _HB_MEMBER { oDbfAlbPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfAlbPrvT"}, .F. )
   _HB_MEMBER { oDbfFacPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFacPrvT"}, .F. )
   _HB_MEMBER { oDbfMatProd } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfMatProd"}, .F. )
   _HB_MEMBER { oDbfMatPrima } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfMatPrima"}, .F. )
   _HB_MEMBER { oDbfPago } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPago"}, .F. )
   _HB_MEMBER { oPrcArt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPrcArt"}, .F. )
   _HB_MEMBER { oRadCod } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oRadCod"}, .F. )
   _HB_MEMBER { AS NUMERIC nRadCod } ; oClass:AddMultiData( "NUMERIC", 1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nRadCod"}, .F. )
   _HB_MEMBER { oMtrInf } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oMtrInf"}, .F. )
   _HB_MEMBER { AS NUMERIC nMtrInf } ; oClass:AddMultiData( "NUMERIC", 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nMtrInf"}, .F. )
   _HB_MEMBER { oGrpFam } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrpFam"}, .F. )
   _HB_MEMBER { cGetGrfOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetGrfOld"}, .F. )
   _HB_MEMBER { cGetGrfNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetGrfNew"}, .F. )
   _HB_MEMBER { cGetFamOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetFamOld"}, .F. )
   _HB_MEMBER { cGetFamNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetFamNew"}, .F. )
   _HB_MEMBER { cGetArtOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetArtOld"}, .F. )
   _HB_MEMBER { cGetArtNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetArtNew"}, .F. )
   _HB_MEMBER { oGetGrfOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetGrfOld"}, .F. )
   _HB_MEMBER { oGetGrfNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetGrfNew"}, .F. )
   _HB_MEMBER { oGetFamOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetFamOld"}, .F. )
   _HB_MEMBER { oGetFamNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetFamNew"}, .F. )
   _HB_MEMBER { oGetArtOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetArtOld"}, .F. )
   _HB_MEMBER { oGetArtNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetArtNew"}, .F. )
   _HB_MEMBER { oSayGrfOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayGrfOld"}, .F. )
   _HB_MEMBER { oSayGrfNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayGrfNew"}, .F. )
   _HB_MEMBER { oSayFamOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayFamOld"}, .F. )
   _HB_MEMBER { oSayFamNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayFamNew"}, .F. )
   _HB_MEMBER { oSayArtOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayArtOld"}, .F. )
   _HB_MEMBER { oSayArtNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayArtNew"}, .F. )
   _HB_MEMBER { cAgenteNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cAgenteNew"}, .F. )
   _HB_MEMBER { cAgenteOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cAgenteOld"}, .F. )
   _HB_MEMBER { oAgenteNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAgenteNew"}, .F. )
   _HB_MEMBER { oAgenteOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAgenteOld"}, .F. )
   _HB_MEMBER { cSayAgenteNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSayAgenteNew"}, .F. )
   _HB_MEMBER { cSayAgenteOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSayAgenteOld"}, .F. )
   _HB_MEMBER { oSayAgenteNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayAgenteNew"}, .F. )
   _HB_MEMBER { oSayAgenteOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayAgenteOld"}, .F. )
   _HB_MEMBER { cPagoNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPagoNew"}, .F. )
   _HB_MEMBER { cPagoOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPagoOld"}, .F. )
   _HB_MEMBER { oPagoNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPagoNew"}, .F. )
   _HB_MEMBER { oPagoOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPagoOld"}, .F. )
   _HB_MEMBER { cSayPagoNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSayPagoNew"}, .F. )
   _HB_MEMBER { cSayPagoOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSayPagoOld"}, .F. )
   _HB_MEMBER { oSayPagoNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayPagoNew"}, .F. )
   _HB_MEMBER { oSayPagoOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayPagoOld"}, .F. )

   _HB_MEMBER { oGetEscOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetEscOld"}, .F. )
   _HB_MEMBER { cGetEscOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetEscOld"}, .F. )
   _HB_MEMBER { oGetEscNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetEscNew"}, .F. )
   _HB_MEMBER { cGetEscNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetEscNew"}, .F. )
   _HB_MEMBER { oSayEscOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayEscOld"}, .F. )
   _HB_MEMBER { cSayEscOld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSayEscOld"}, .F. )
   _HB_MEMBER { oSayEscNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayEscNew"}, .F. )
   _HB_MEMBER { cSayEscNew } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSayEscNew"}, .F. )





   _HB_MEMBER { oTxtPr1Old } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTxtPr1Old"}, .F. )
   _HB_MEMBER { oSayPr1Old } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayPr1Old"}, .F. )
   _HB_MEMBER { oGetPr1Old } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetPr1Old"}, .F. )
   _HB_MEMBER { cGetPr1Old } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetPr1Old"}, .F. )
   _HB_MEMBER { cCodPr1Old } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCodPr1Old"}, .F. )

   _HB_MEMBER { oTxtPr2Old } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTxtPr2Old"}, .F. )
   _HB_MEMBER { oSayPr2Old } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayPr2Old"}, .F. )
   _HB_MEMBER { oGetPr2Old } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetPr2Old"}, .F. )
   _HB_MEMBER { cGetPr2Old } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetPr2Old"}, .F. )
   _HB_MEMBER { cCodPr2Old } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCodPr2Old"}, .F. )

   _HB_MEMBER { oTxtPr1New } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTxtPr1New"}, .F. )
   _HB_MEMBER { oSayPr1New } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayPr1New"}, .F. )
   _HB_MEMBER { oGetPr1New } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetPr1New"}, .F. )
   _HB_MEMBER { cGetPr1New } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetPr1New"}, .F. )
   _HB_MEMBER { cCodPr1New } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCodPr1New"}, .F. )

   _HB_MEMBER { oTxtPr2New } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTxtPr2New"}, .F. )
   _HB_MEMBER { oSayPr2New } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayPr2New"}, .F. )
   _HB_MEMBER { oGetPr2New } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetPr2New"}, .F. )
   _HB_MEMBER { cGetPr2New } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGetPr2New"}, .F. )
   _HB_MEMBER { cCodPr2New } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCodPr2New"}, .F. )

   _HB_MEMBER { AS LOGIC lStabilize } ; oClass:AddMultiData( "LOGIC", .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lStabilize"}, .F. )
   _HB_MEMBER { AS NUMERIC nRecChanged } ; oClass:AddMultiData( "NUMERIC", 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nRecChanged"}, .F. )

   _HB_MEMBER New( oMenuItem, oWnd) AS CLASS TChgCode; oClass:AddMethod( "New", @TChgCode_New(), nScope + iif( .T., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER End(); oClass:AddMethod( "End", @TChgCode_End(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER OpenFiles(); oClass:AddMethod( "OpenFiles", @TChgCode_OpenFiles(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CloseFiles(); oClass:AddMethod( "CloseFiles", @TChgCode_CloseFiles(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @TChgCode_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ChgCode(); oClass:AddMethod( "ChgCode", @TChgCode_ChgCode(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER loaArtOld(); oClass:AddMethod( "loaArtOld", @TChgCode_loaArtOld(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER loaArtNew(); oClass:AddMethod( "loaArtNew", @TChgCode_loaArtNew(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER changeSecondPropertie(); oClass:AddMethod( "changeSecondPropertie", @TChgCode_changeSecondPropertie(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TChgCode ;



static FUNCTION TChgCode_New( oMenuItem, oWnd ) ; local Self AS CLASS TChgCode := QSelf() AS CLASS TChgCode

   local nLevel

   If( oMenuItem == nil, oMenuItem := "01080", ) ;
   If( oWnd == nil, oWnd := oWnd(), ) ;

   nLevel               := Auth():Level( oMenuItem )
   if nAnd( nLevel, 1 ) == 0
      msgStop( "Acceso no permitido." )
      return ( Self )
   end

   if !oUser():lAdministrador()
      msgStop( "Solo puede cambiar codigos los administradores." )
      return ( Self )
   end





   if oWnd <> nil
      SysRefresh(); oWnd:CloseAll(); SysRefresh()
   end

   ::cGetGrfOld         := Space( 3 )
   ::cGetGrfNew         := Space( 3 )
   ::cGetFamOld         := Space( 8 )
   ::cGetFamNew         := Space( 8 )
   ::cGetArtOld         := Space( 18 )
   ::cGetArtNew         := Space( 18 )
   ::cGetEscOld         := Space( 18 )
   ::cGetEscNew         := Space( 18 )
   ::cGetPr1Old         := Space( 40 )
   ::cGetPr2Old         := Space( 40 )

   ::oGrpFam            := TGrpFam():Create( cPatEmp() )

   ::OpenFiles()

   ::lStabilize         := .T.

RETURN Self



static FUNCTION TChgCode_OpenFiles( ) ; local Self AS CLASS TChgCode := QSelf() AS CLASS TChgCode

  local oBlock
  local oError
  local lOpen     := .T.





   oBlock      := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   ::oDbfFam := DbfServer( "FAMILIAS.DBF", ):NewOpen( "FAMILIAS.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFam:AddBag( "FAMILIAS.CDX" ) ; ::oDbfFam:AddBag( ) ; ::oDbfFam:AutoIndex()

   ::oDbfArt := DbfServer( "ARTICULO.DBF", ):NewOpen( "ARTICULO.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfArt:AddBag( "ARTICULO.CDX" ) ; ::oDbfArt:AddBag( ) ; ::oDbfArt:AutoIndex()

   ::oDbfArtKit := DbfServer( "ArtKit.Dbf", ):NewOpen( "ArtKit.Dbf",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfArtKit:AddBag( "ArtKit.Cdx" ) ; ::oDbfArtKit:AddBag( ) ; ::oDbfArtKit:AutoIndex()

   ::oDbfPrv := DbfServer( "PROVART.DBF", ):NewOpen( "PROVART.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPrv:AddBag( "PROVART.CDX" ) ; ::oDbfPrv:AddBag( ) ; ::oDbfPrv:AutoIndex()

   ::oDbfTar := DbfServer( "TARPREL.DBF", ):NewOpen( "TARPREL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfTar:AddBag( "TARPREL.CDX" ) ; ::oDbfTar:AddBag( ) ; ::oDbfTar:AutoIndex()

   ::oDbfOfe := DbfServer( "OFERTA.DBF", ):NewOpen( "OFERTA.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfOfe:AddBag( "OFERTA.CDX" ) ; ::oDbfOfe:AddBag( ) ; ::oDbfOfe:AutoIndex()

   ::oDbfArd := DbfServer( "ARTDIV.DBF", ):NewOpen( "ARTDIV.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfArd:AddBag( "ARTDIV.CDX" ) ; ::oDbfArd:AddBag( ) ; ::oDbfArd:AutoIndex()

   ::oDbfKit := DbfServer( "ARTKIT.DBF", ):NewOpen( "ARTKIT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfKit:AddBag( "ARTKIT.CDX" ) ; ::oDbfKit:AddBag( ) ; ::oDbfKit:AutoIndex()

   ::oDbfCliAtp := DbfServer( "CLIATP.DBF", ):NewOpen( "CLIATP.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfCliAtp:AddBag( "CLIATP.CDX" ) ; ::oDbfCliAtp:AddBag( ) ; ::oDbfCliAtp:AutoIndex()

   ::oDbfPedPrv := DbfServer( "PEDPROVL.DBF", ):NewOpen( "PEDPROVL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPedPrv:AddBag( "PEDPROVL.CDX" ) ; ::oDbfPedPrv:AddBag( ) ; ::oDbfPedPrv:AutoIndex()

   ::oDbfAlbPrv := DbfServer( "ALBPROVL.DBF", ):NewOpen( "ALBPROVL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAlbPrv:AddBag( "ALBPROVL.CDX" ) ; ::oDbfAlbPrv:AddBag( ) ; ::oDbfAlbPrv:AutoIndex()

   ::oDbfFacPrv := DbfServer( "FACPRVL.DBF", ):NewOpen( "FACPRVL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFacPrv:AddBag( "FACPRVL.CDX" ) ; ::oDbfFacPrv:AddBag( ) ; ::oDbfFacPrv:AutoIndex()





   ::oDbfPreCli := DbfServer( "PRECLIL.DBF", ):NewOpen( "PRECLIL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPreCli:AddBag( "PRECLIL.CDX" ) ; ::oDbfPreCli:AddBag( ) ; ::oDbfPreCli:AutoIndex()

   ::oDbfPedCli := DbfServer( "PEDCLIL.DBF", ):NewOpen( "PEDCLIL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPedCli:AddBag( "PEDCLIL.CDX" ) ; ::oDbfPedCli:AddBag( ) ; ::oDbfPedCli:AutoIndex()

   ::oDbfAlbCli := DbfServer( "ALBCLIL.DBF", ):NewOpen( "ALBCLIL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAlbCli:AddBag( "ALBCLIL.CDX" ) ; ::oDbfAlbCli:AddBag( ) ; ::oDbfAlbCli:AutoIndex()

   ::oDbfFacCli := DbfServer( "FACCLIL.DBF", ):NewOpen( "FACCLIL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFacCli:AddBag( "FACCLIL.CDX" ) ; ::oDbfFacCli:AddBag( ) ; ::oDbfFacCli:AutoIndex()

   ::oDbfTpvCli := DbfServer( "TIKEL.DBF", ):NewOpen( "TIKEL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfTpvCli:AddBag( "TIKEL.CDX" ) ; ::oDbfTpvCli:AddBag( ) ; ::oDbfTpvCli:AutoIndex()

   ::oDbfTpvCliT := DbfServer( "TIKET.DBF", ):NewOpen( "TIKET.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfTpvCliT:AddBag( "TIKET.CDX" ) ; ::oDbfTpvCliT:AddBag( ) ; ::oDbfTpvCliT:AutoIndex()

   ::oDbfTblPro := DbfServer( "TBLPRO.DBF", ):NewOpen( "TBLPRO.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfTblPro:AddBag( "TBLPRO.CDX" ) ; ::oDbfTblPro:AddBag( ) ; ::oDbfTblPro:AutoIndex()

   ::oDbfAgentes := DbfServer( "AGENTES.DBF", ):NewOpen( "AGENTES.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAgentes:AddBag( "AGENTES.CDX" ) ; ::oDbfAgentes:AddBag( ) ; ::oDbfAgentes:AutoIndex()

   ::oDbfPreCliT := DbfServer( "PRECLIT.DBF", ):NewOpen( "PRECLIT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPreCliT:AddBag( "PRECLIT.CDX" ) ; ::oDbfPreCliT:AddBag( ) ; ::oDbfPreCliT:AutoIndex()

   ::oDbfPedCliT := DbfServer( "PEDCLIT.DBF", ):NewOpen( "PEDCLIT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPedCliT:AddBag( "PEDCLIT.CDX" ) ; ::oDbfPedCliT:AddBag( ) ; ::oDbfPedCliT:AutoIndex()

   ::oDbfAlbCliT := DbfServer( "ALBCLIT.DBF", ):NewOpen( "ALBCLIT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAlbCliT:AddBag( "ALBCLIT.CDX" ) ; ::oDbfAlbCliT:AddBag( ) ; ::oDbfAlbCliT:AutoIndex()

   ::oDbfFacCliT := DbfServer( "FacCLIT.DBF", ):NewOpen( "FacCLIT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFacCliT:AddBag( "FacCLIT.CDX" ) ; ::oDbfFacCliT:AddBag( ) ; ::oDbfFacCliT:AutoIndex()

   ::oDbfFacCliP := DbfServer( "FACCLIP.DBF", ):NewOpen( "FACCLIP.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFacCliP:AddBag( "FACCLIP.CDX" ) ; ::oDbfFacCliP:AddBag( ) ; ::oDbfFacCliP:AutoIndex()

   ::oDbfPago := DbfServer( "FPAGO.DBF", ):NewOpen( "FPAGO.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPago:AddBag( "FPAGO.CDX" ) ; ::oDbfPago:AddBag( ) ; ::oDbfPago:AutoIndex()

   ::oDbfEmpresa := DbfServer( "EMPRESA.DBF", ):NewOpen( "EMPRESA.DBF",, ( cDriver() ),, ( cPatDat() ), .F., .T., .F., .F. ) ; ::oDbfEmpresa:AddBag( "EMPRESA.CDX" ) ; ::oDbfEmpresa:AddBag( ) ; ::oDbfEmpresa:AutoIndex()

   ::oDbfPedPrvT := DbfServer( "PEDPROVT.DBF", ):NewOpen( "PEDPROVT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPedPrvT:AddBag( "PEDPROVT.CDX" ) ; ::oDbfPedPrvT:AddBag( ) ; ::oDbfPedPrvT:AutoIndex()

   ::oDbfAlbPrvT := DbfServer( "ALBPROVT.DBF", ):NewOpen( "ALBPROVT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAlbPrvT:AddBag( "ALBPROVT.CDX" ) ; ::oDbfAlbPrvT:AddBag( ) ; ::oDbfAlbPrvT:AutoIndex()

   ::oDbfFacPrvT := DbfServer( "FACPRVT.DBF", ):NewOpen( "FACPRVT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFacPrvT:AddBag( "FACPRVT.CDX" ) ; ::oDbfFacPrvT:AddBag( ) ; ::oDbfFacPrvT:AutoIndex()

   ::oDbfClient := DbfServer( "CLIENT.DBF", ):NewOpen( "CLIENT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfClient:AddBag( "CLIENT.CDX" ) ; ::oDbfClient:AddBag( ) ; ::oDbfClient:AutoIndex()

   ::oDbfMatProd := DbfServer( "PROLIN.DBF", ):NewOpen( "PROLIN.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfMatProd:AddBag( "PROLIN.CDX" ) ; ::oDbfMatProd:AddBag( ) ; ::oDbfMatProd:AutoIndex()

   ::oDbfMatPrima := DbfServer( "PROMAT.DBF", ):NewOpen( "PROMAT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfMatPrima:AddBag( "PROMAT.CDX" ) ; ::oDbfMatPrima:AddBag( ) ; ::oDbfMatPrima:AutoIndex()

   ::oGrpFam:OpenFiles()

   RECOVER USING oError

      lOpen    := .F.

      msgStop( "Imposible abrir todas las bases de datos" )
      ::CloseFiles()

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TChgCode_CloseFiles( ) ; local Self AS CLASS TChgCode := QSelf() AS CLASS TChgCode

   if !Empty( ::oDbfFam ) .AND. ::oDbfFam:Used()
      ::oDbfFam:End()
   end

   if !Empty( ::oDbfArt ) .AND. ::oDbfArt:Used()
      ::oDbfArt:End()
   end

   if !Empty( ::oDbfArtKit ) .AND. ::oDbfArtKit:Used()
      ::oDbfArtKit:End()
   end

   if !Empty( ::oDbfPrv ) .AND. ::oDbfPrv:Used()
      ::oDbfPrv:End()
   end

   if !Empty( ::oDbfTar ) .AND. ::oDbfTar:Used()
      ::oDbfTar:End()
   end

   if !Empty( ::oDbfOfe ) .AND. ::oDbfOfe:Used()
      ::oDbfOfe:End()
   end

   if !Empty( ::oDbfArd ) .AND. ::oDbfArd:Used()
      ::oDbfArd:End()
   end

   if !Empty( ::oDbfKit ) .AND. ::oDbfKit:Used()
      ::oDbfKit:End()
   end

   if !Empty( ::oDbfCliAtp ) .AND. ::oDbfCliAtp:Used()
      ::oDbfCliAtp:End()
   end

   if !Empty( ::oDbfPedPrv ) .AND. ::oDbfPedPrv:Used()
      ::oDbfPedPrv:End()
   end

   if !Empty( ::oDbfAlbPrv ) .AND. ::oDbfAlbPrv:Used()
      ::oDbfAlbPrv:End()
   end

   if !Empty( ::oDbfFacPrv ) .AND. ::oDbfFacPrv:Used()
      ::oDbfFacPrv:End()
   end









  if !Empty( ::oDbfPreCli ) .AND. ::oDbfPreCli:Used()
      ::oDbfPreCli:End()
   end

  if !Empty( ::oDbfPedCli ) .AND. ::oDbfPedCli:Used()
      ::oDbfPedCli:End()
   end

   if !Empty( ::oDbfAlbCli ) .AND. ::oDbfAlbCli:Used()
      ::oDbfAlbCli:End()
   end

   if !Empty( ::oDbfFacCli ) .AND. ::oDbfFacCli:Used()
      ::oDbfFacCli:End()
   end

   if !Empty( ::oDbfTpvCli ) .AND. ::oDbfTpvCli:Used()
      ::oDbfTpvCli:End()
   end

   if !Empty( ::oDbfTblPro ) .AND. ::oDbfTblPro:Used()
      ::oDbfTblPro:End()
   end

   if !Empty( ::oDbfAgentes ) .AND. ::oDbfAgentes:Used()
      ::oDbfAgentes:End()
   end

   if !Empty( ::oDbfClient ) .AND. ::oDbfClient:Used()
      ::oDbfClient:End()
   end

   if !Empty( ::oDbfTpvCliT ) .AND. ::oDbfTpvCliT:Used()
      ::oDbfTpvCliT:End()
   end

   if !Empty( ::oDbfPreCliT ) .AND. ::oDbfPreCliT:Used()
      ::oDbfPreCliT:End()
   end

   if !Empty( ::oDbfPedCliT ) .AND. ::oDbfPedCliT:Used()
      ::oDbfPedCliT:End()
   end

   if !Empty( ::oDbfAlbCliT ) .AND. ::oDbfAlbCliT:Used()
      ::oDbfAlbCliT:End()
   end

  if !Empty( ::oDbfFacCliT ) .AND. ::oDbfFacCliT:Used()
      ::oDbfFacCliT:End()
   end

  if !Empty( ::oDbfFacCliP ) .AND. ::oDbfFacCliP:Used()
      ::oDbfFacCliP:End()
   end

  if !Empty( ::oDbfPago ) .AND. ::oDbfPago:Used()
      ::oDbfPago:End()
   end

  if !Empty( ::oDbfPedPrvT ) .AND. ::oDbfPedPrvT:Used()
      ::oDbfPedPrvt:End()
   end

  if !Empty( ::oDbfAlbPrvT ) .AND. ::oDbfAlbPrvT:Used()
      ::oDbfAlbPrvT:End()
   end

  if !Empty( ::oDbfFacPrvT ) .AND. ::oDbfFacPrvT:Used()
      ::oDbfFacPrvT:End()
   end

   if !Empty( ::oDbfEmpresa ) .AND. ::oDbfEmpresa:Used()
      ::oDbfEmpresa:End()
   end

   if !Empty( ::oDbfMatProd ) .AND. ::oDbfMatProd:Used()
      ::oDbfMatProd:End()
   end

   if !Empty( ::oDbfMatPrima ) .AND. ::oDbfMatPrima:Used()
      ::oDbfMatPrima:End()
   end

  if !Empty( ::oGrpFam )
      ::oGrpFam:End()
   end

RETURN ( Self )



static FUNCTION TChgCode_Resource( cFldRes ) ; local Self AS CLASS TChgCode := QSelf() AS CLASS TChgCode

   local oThis       := Self
   local cSayGrfOld  := ""
   local cSayGrfNew  := ""
   local cSayFamOld  := ""
   local cSayFamNew  := ""
   local cSayArtOld  := ""
   local cTxtPr1Old  := ""
   local cSayPr1Old  := ""
   local cTxtPr2Old  := ""
   local cSayPr2Old  := ""
   local cSayEscOld  := ""
   local cSayArtNew  := ""
   local cTxtPr1New  := ""
   local cSayPr1New  := ""
   local cTxtPr2New  := ""
   local cSayPr2New  := ""
   local oBmpEscandallos

   if !::lStabilize
      RETURN ( Self )
   end





   ::oDlg = TDialog():New(,,,,, "CHGCODE",, .F.,,,,, oWnd(), .F.,,,,,, .F.,, "::oDlg", nil, )





   oBmpEscandallos := TBitmap():ReDefine( 600, "gc_pieces_48",, ::oDlg,,, .F., .F.,,, .F.,,, .T. )








































































































































































   ::oGetEscOld := TGetHlp():ReDefine( 210, { | u | If( PCount()==0, ::cGetEscOld, ::cGetEscOld:= u ) }, ::oDlg,,, {||    ( cArticulo( oThis:oGetEscOld, ::oDbfArt:cAlias, oThis:oSayEscOld ) )},,,,,, .F.,,, .F., .F.,,,,, {|Self|BrwArticulo( oThis:oGetEscOld, oThis:oSayEscOld )}, nil, "LUPA",, )




   ::oSayEscOld := TGetHlp():ReDefine( 211, { | u | If( PCount()==0, cSayEscOld, cSayEscOld:= u ) }, ::oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )






   ::oGetEscNew := TGetHlp():ReDefine( 220, { | u | If( PCount()==0, ::cGetEscNew, ::cGetEscNew:= u ) }, ::oDlg,,, {||    ( cArticulo( oThis:oGetEscNew, ::oDbfArt:cAlias, oThis:oSayEscNew ), .T. )},,,,,, .F.,,, .F., .F.,,,,, {|Self|BrwArticulo( oThis:oGetEscNew, oThis:oSayEscNew )}, nil, "LUPA",, )




   ::oSayEscNew := TGetHlp():ReDefine( 221, { | u | If( PCount()==0, ::cSayEscNew, ::cSayEscNew:= u ) }, ::oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )































































 ::oMtrInf := TApoloMeter():ReDefine( 1160, { | u | If( PCount()==0, ::nMtrInf, ::nMtrInf:= u ) }, 100, ::oDlg, .F.,, "Procesando", .F.,,,, )




   TButton():ReDefine( 1, {||( oThis:ChgCode() )}, ::oDlg,,, .F.,,,, .F. )




   TButton():ReDefine( 2, {||( oThis:End()  )}, ::oDlg,,, .F.,,,, .F. )

   ::oDlg:AddFastKey( 116, {|| oThis:ChgCode() } )

   ::oDlg:Activate( ::oDlg:bLClicked, ::oDlg:bMoved, ::oDlg:bPainted, .T.,,,, ::oDlg:bRClicked,,, )


   if !Empty( oBmpEscandallos )
      oBmpEscandallos:End()
   end

RETURN ( Self )



static FUNCTION TChgCode_ChgCode( ) ; local Self AS CLASS TChgCode := QSelf() AS CLASS TChgCode













   local lErrors  := .F.

   ::oDlg:Disable()

   ::nRecChanged  := 0































































































































































































































































































































































































































































































































































































































         if Empty( ::cGetEscOld )
            MsgStop( "Artículo actual no válido" )
            lErrors  := .T.
         end

         if !lErrors .AND. Empty( ::cGetEscNew )
            MsgStop( "Artículo nuevo no válido" )
            lErrors  := .T.
         end

         if !lErrors .AND. ::cGetEscOld == ::cGetEscNew
            MsgStop( "Artículo actual y nuevo son iguales" )
            lErrors  := .T.
         end

         if !lErrors

         ::oMtrInf:nTotal           := ::oDbfArtKit:Lastrec()

         ::oDbfArtKit:OrdSetFocus( 0 )
         ::oDbfArtKit:GoTop()
         while !::oDbfArtKit:Eof()
            if ::oDbfArtKit:cRefKit == ::cGetEscOld
               ::oDbfArtKit:Load()
               ::oDbfArtKit:cRefKit := ::cGetEscNew
               if !Empty( ::cSayEscNew )
                  ::oDbfArtKit:cDesKit := ::cSayEscNew
               end
               ::oDbfArtKit:Save()
               ::nRecChanged++
            end
            ::oDbfArtKit:Skip()
            ::oMtrInf:AutoInc( ::oDbfArtKit:Recno() )
         end

         MsgInfo( "Total de registros cambiados : " + Str( ::nRecChanged ) )

         ::oGetEscOld:cText( Space( 18 ) )
         ::oGetEscNew:cText( Space( 18 ) )
         ::oSayEscOld:cText( "" )
         ::oSayEscNew:cText( "" )

         ::oGetEscOld:SetFocus()

         end
































































































































































































































































































































































   ::oDlg:Enable()
   ::oDlg:End()

RETURN ( Self )



static FUNCTION TChgCode_End( ) ; local Self AS CLASS TChgCode := QSelf() AS CLASS TChgCode

   ::oDlg:End()

   ::CloseFiles()

   Self           := nil

RETURN .T.



static FUNCTION TChgCode_loaArtOld( ) ; local Self AS CLASS TChgCode := QSelf() AS CLASS TChgCode

   if ::oDbfArt:Seek( ::cGetArtOld )

      ::oSayArtOld:cText( ::oDbfArt:Nombre )

      if ::oDbfFam:Seek( ::oDbfArt:Familia )
         ::cCodPr1Old      := ::oDbfFam:cCodPrp1
         ::cCodPr2Old      := ::oDbfFam:cCodPrp2
      else
         ::cCodPr1Old      := ""
         ::cCodPr2Old      := ""
      end

      if !empty( ::cCodPr1Old )
         ::oGetPr1Old:show()
         ::oSayPr1Old:show()
         ::oTxtPr1Old:show()
         ::oTxtPr1Old:SetText( retProp( ::cCodPr1Old ) )
      else
         ::oTxtPr1Old:hide()
         ::oGetPr1Old:hide()
         ::oSayPr1Old:hide()
      end

      if !empty( ::cCodPr2Old )
         ::oGetPr2Old:show()
         ::oSayPr2Old:show()
         ::oTxtPr2Old:show()
         ::oTxtPr2Old:SetText( retProp( ::cCodPr2Old ) )
      else
         ::oTxtPr2Old:hide()
         ::oGetPr2Old:hide()
         ::oSayPr2Old:hide()
      end

   end

return .T.



static FUNCTION TChgCode_loaArtNew( ) ; local Self AS CLASS TChgCode := QSelf() AS CLASS TChgCode

return .T.



static FUNCTION TChgCode_changeSecondPropertie( oDbf ) ; local Self AS CLASS TChgCode := QSelf() AS CLASS TChgCode

   if alltrim( oDbf:cValPr2 ) == alltrim( ::cGetPr2Old )
      oDbf:load()
      oDbf:cValPr2 := ::cGetPr2New
      oDbf:save()
      ::nRecChanged++
   end

return .T.
