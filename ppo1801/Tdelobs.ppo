#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 8 ".\.\Prg\Tdelobs.prg"
_HB_CLASS TDeleleteObsoletos ; function TDeleleteObsoletos ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TDeleleteObsoletos", iif( .F., { }, { @HBObject() } ), @TDeleleteObsoletos() ) ) ;

   _HB_MEMBER { oDialog } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDialog"}, .F. )
   _HB_MEMBER { oPages } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPages"}, .F. )
   _HB_MEMBER { oBtnSiguiente } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnSiguiente"}, .F. )
   _HB_MEMBER { oBtnPrevio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnPrevio"}, .F. )
   _HB_MEMBER { oMtrProceso } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oMtrProceso"}, .F. )
   _HB_MEMBER { nMtrProceso } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nMtrProceso"}, .F. )
   _HB_MEMBER { oBrwArticulos } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrwArticulos"}, .F. )

   _HB_MEMBER { lNoCom } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lNoCom"}, .F. )
   _HB_MEMBER { lNoPre } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lNoPre"}, .F. )
   _HB_MEMBER { lNoVta } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lNoVta"}, .F. )
   _HB_MEMBER { lNoMov } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lNoMov"}, .F. )
   _HB_MEMBER { lNoPro } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lNoPro"}, .F. )

   _HB_MEMBER { nAction } ; oClass:AddMultiData(, 1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nAction"}, .F. )

   _HB_MEMBER { nBmp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nBmp"}, .F. )

   _HB_MEMBER { aArticulos } ; oClass:AddMultiData(, { { .F., "", "", "", "" } }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aArticulos"}, .F. )

   _HB_MEMBER { dFechaInicial } ; oClass:AddMultiData(, CtoD( "01/01/" + Str( Year( Date() ) ) ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"dFechaInicial"}, .F. )
   _HB_MEMBER { dFechaFinal } ; oClass:AddMultiData(, Date(), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"dFechaFinal"}, .F. )

   _HB_MEMBER { lTodasFamilias } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lTodasFamilias"}, .F. )
   _HB_MEMBER { cFamiliaOrigen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFamiliaOrigen"}, .F. )
   _HB_MEMBER { cFamiliaDestino } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFamiliaDestino"}, .F. )

   _HB_MEMBER { lTodosArticulos } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lTodosArticulos"}, .F. )
   _HB_MEMBER { cArticuloOrigen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cArticuloOrigen"}, .F. )
   _HB_MEMBER { cArticuloDestino } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cArticuloDestino"}, .F. )

   _HB_MEMBER { oPedPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPedPrvT"}, .F. )
   _HB_MEMBER { oPedPrvL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPedPrvL"}, .F. )
   _HB_MEMBER { oAlbPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAlbPrvT"}, .F. )
   _HB_MEMBER { oAlbPrvL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAlbPrvL"}, .F. )
   _HB_MEMBER { oFacPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacPrvT"}, .F. )
   _HB_MEMBER { oFacPrvL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacPrvL"}, .F. )
   _HB_MEMBER { oPreCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPreCliT"}, .F. )
   _HB_MEMBER { oPreCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPreCliL"}, .F. )
   _HB_MEMBER { oPedCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPedCliT"}, .F. )
   _HB_MEMBER { oPedCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPedCliL"}, .F. )
   _HB_MEMBER { oAlbCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAlbCliT"}, .F. )
   _HB_MEMBER { oAlbCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAlbCliL"}, .F. )
   _HB_MEMBER { oFacCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacCliT"}, .F. )
   _HB_MEMBER { oFacCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacCliL"}, .F. )
   _HB_MEMBER { oFacRecT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacRecT"}, .F. )
   _HB_MEMBER { oFacRecL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacRecL"}, .F. )
   _HB_MEMBER { oTikCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTikCliT"}, .F. )
   _HB_MEMBER { oTikCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTikCliL"}, .F. )
   _HB_MEMBER { oDbfFam } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFam"}, .F. )
   _HB_MEMBER { oDbfArt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfArt"}, .F. )
   _HB_MEMBER { oPrvArt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPrvArt"}, .F. )
   _HB_MEMBER { oArtDiv } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArtDiv"}, .F. )
   _HB_MEMBER { oArtKit } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArtKit"}, .F. )
   _HB_MEMBER { oCodeBar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oCodeBar"}, .F. )
   _HB_MEMBER { oProLin } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oProLin"}, .F. )
   _HB_MEMBER { oProMat } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oProMat"}, .F. )
   _HB_MEMBER { oRctPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oRctPrvT"}, .F. )
   _HB_MEMBER { oRctPrvL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oRctPrvL"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @TDeleleteObsoletos_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER OpenFiles(); oClass:AddMethod( "OpenFiles", @TDeleleteObsoletos_OpenFiles(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CloseFiles(); oClass:AddMethod( "CloseFiles", @TDeleleteObsoletos_CloseFiles(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @TDeleleteObsoletos_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER BtnPrevio(); oClass:AddMethod( "BtnPrevio", @TDeleleteObsoletos_BtnPrevio(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER BtnSiguiente(); oClass:AddMethod( "BtnSiguiente", @TDeleleteObsoletos_BtnSiguiente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Search(); oClass:AddMethod( "Search", @TDeleleteObsoletos_Search(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lNoHayMovimientos(); oClass:AddMethod( "lNoHayMovimientos", @TDeleleteObsoletos_lNoHayMovimientos(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER BorraSeleccionados(); oClass:AddMethod( "BorraSeleccionados", @TDeleleteObsoletos_BorraSeleccionados(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SelDel(); oClass:AddMethod( "SelDel", @TDeleleteObsoletos_SelDel(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SelAllDel( lOpcion); oClass:AddMethod( "SelAllDel", @TDeleleteObsoletos_SelAllDel(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TDeleleteObsoletos ;



static FUNCTION TDeleleteObsoletos_New( ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   ::OpenFiles()

   ::Resource()

   ::CloseFiles()

Return ( Self )



static FUNCTION TDeleleteObsoletos_OpenFiles( ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   ::oPedPrvT := DbfServer( "PEDPROVT.DBF", ):NewOpen( "PEDPROVT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oPedPrvT:AddBag( "PEDPROVT.CDX" ) ; ::oPedPrvT:AddBag( ) ; ::oPedPrvT:AutoIndex()
   ::oPedPrvL := DbfServer( "PEDPROVL.DBF", ):NewOpen( "PEDPROVL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oPedPrvL:AddBag( "PEDPROVL.CDX" ) ; ::oPedPrvL:AddBag( ) ; ::oPedPrvL:AutoIndex()
   ::oPedPrvL:OrdSetFocus( "cRef" )

   ::oAlbPrvT := DbfServer( "ALBPROVT.DBF", ):NewOpen( "ALBPROVT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oAlbPrvT:AddBag( "ALBPROVT.CDX" ) ; ::oAlbPrvT:AddBag( ) ; ::oAlbPrvT:AutoIndex()
   ::oAlbPrvL := DbfServer( "ALBPROVL.DBF", ):NewOpen( "ALBPROVL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oAlbPrvL:AddBag( "ALBPROVL.CDX" ) ; ::oAlbPrvL:AddBag( ) ; ::oAlbPrvL:AutoIndex()
   ::oAlbPrvL:OrdSetFocus( "cRef" )

   ::oFacPrvT := DbfServer( "FACPRVT.DBF", ):NewOpen( "FACPRVT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oFacPrvT:AddBag( "FACPRVT.CDX" ) ; ::oFacPrvT:AddBag( ) ; ::oFacPrvT:AutoIndex()
   ::oFacPrvL := DbfServer( "FACPRVL.DBF", ):NewOpen( "FACPRVL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oFacPrvL:AddBag( "FACPRVL.CDX" ) ; ::oFacPrvL:AddBag( ) ; ::oFacPrvL:AutoIndex()
   ::oFacPrvL:OrdSetFocus( "cRef" )

   ::oRctPrvT := DbfServer( "RCTPRVT.DBF", ):NewOpen( "RCTPRVT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oRctPrvT:AddBag( "RCTPRVT.CDX" ) ; ::oRctPrvT:AddBag( ) ; ::oRctPrvT:AutoIndex()
   ::oRctPrvL := DbfServer( "RCTPRVL.DBF", ):NewOpen( "RCTPRVL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oRctPrvL:AddBag( "RCTPRVL.CDX" ) ; ::oRctPrvL:AddBag( ) ; ::oRctPrvL:AutoIndex()
   ::oRctPrvL:OrdSetFocus( "cRef" )

   ::oPreCliT  := TDataCenter():oPreCliT()
   ::oPreCliL := DbfServer( "PRECLIL.DBF", ):NewOpen( "PRECLIL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oPreCliL:AddBag( "PRECLIL.CDX" ) ; ::oPreCliL:AddBag( ) ; ::oPreCliL:AutoIndex()
   ::oPreCliL:OrdSetFocus( "cRef" )

   ::oPedCliT := TDataCenter():oPedCliT()
   ::oPedCliL := DbfServer( "PEDCLIL.DBF", ):NewOpen( "PEDCLIL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oPedCliL:AddBag( "PEDCLIL.CDX" ) ; ::oPedCliL:AddBag( ) ; ::oPedCliL:AutoIndex()
   ::oPedCliL:OrdSetFocus( "cRef" )

   ::oAlbCliT := TDataCenter():oAlbCliT()
   ::oAlbCliL := DbfServer( "ALBCLIL.DBF", ):NewOpen( "ALBCLIL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oAlbCliL:AddBag( "ALBCLIL.CDX" ) ; ::oAlbCliL:AddBag( ) ; ::oAlbCliL:AutoIndex()
   ::oAlbCliL:OrdSetFocus( "cRef" )

   ::oFacCliT := TDataCenter():oFacCliT()
   ::oFacCliL := DbfServer( "FACCLIL.DBF", ):NewOpen( "FACCLIL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oFacCliL:AddBag( "FACCLIL.CDX" ) ; ::oFacCliL:AddBag( ) ; ::oFacCliL:AutoIndex()
   ::oFacCliL:OrdSetFocus( "cRef" )

   ::oFacRecT := DbfServer( "FACRECT.DBF", ):NewOpen( "FACRECT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oFacRecT:AddBag( "FACRECT.CDX" ) ; ::oFacRecT:AddBag( ) ; ::oFacRecT:AutoIndex()
   ::oFacRecL := DbfServer( "FACRECL.DBF", ):NewOpen( "FACRECL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oFacRecL:AddBag( "FACRECL.CDX" ) ; ::oFacRecL:AddBag( ) ; ::oFacRecL:AutoIndex()
   ::oFacRecL:OrdSetFocus( "cRef" )

   ::oTikCliT := DbfServer( "TIKET.DBF", ):NewOpen( "TIKET.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oTikCliT:AddBag( "TIKET.CDX" ) ; ::oTikCliT:AddBag( ) ; ::oTikCliT:AutoIndex()
   ::oTikCliL := DbfServer( "TIKEL.DBF", ):NewOpen( "TIKEL.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oTikCliL:AddBag( "TIKEL.CDX" ) ; ::oTikCliL:AddBag( ) ; ::oTikCliL:AutoIndex()
   ::oTikCliL:OrdSetFocus( "cCbaTil" )

   ::oDbfFam := DbfServer( "FAMILIAS.DBF", ):NewOpen( "FAMILIAS.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFam:AddBag( "FAMILIAS.CDX" ) ; ::oDbfFam:AddBag( ) ; ::oDbfFam:AutoIndex()

   ::oDbfArt := DbfServer( "ARTICULO.DBF", ):NewOpen( "ARTICULO.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfArt:AddBag( "ARTICULO.CDX" ) ; ::oDbfArt:AddBag( ) ; ::oDbfArt:AutoIndex()

   ::oPrvArt := DbfServer( "PROVART.DBF", ):NewOpen( "PROVART.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oPrvArt:AddBag( "PROVART.CDX" ) ; ::oPrvArt:AddBag( ) ; ::oPrvArt:AutoIndex()
   ::oPrvArt:OrdSetFocus( "cCodArt" )

   ::oArtDiv := DbfServer( "ARTDIV.DBF", ):NewOpen( "ARTDIV.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oArtDiv:AddBag( "ARTDIV.CDX" ) ; ::oArtDiv:AddBag( ) ; ::oArtDiv:AutoIndex()
   ::oArtDiv:OrdSetFocus( "cCodArt" )

   ::oArtKit := DbfServer( "ARTKIT.DBF", ):NewOpen( "ARTKIT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oArtKit:AddBag( "ARTKIT.CDX" ) ; ::oArtKit:AddBag( ) ; ::oArtKit:AutoIndex()
   ::oArtKit:OrdSetFocus( "cCodKit" )

   ::oCodeBar := DbfServer( "ARTCODEBAR.DBF", ):NewOpen( "ARTCODEBAR.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oCodeBar:AddBag( "ARTCODEBAR.CDX" ) ; ::oCodeBar:AddBag( ) ; ::oCodeBar:AutoIndex()
   ::oCodeBar:OrdSetFocus( "cCodArt" )

   ::oProLin := DbfServer( "PROLIN.DBF", ):NewOpen( "PROLIN.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oProLin:AddBag( "PROLIN.CDX" ) ; ::oProLin:AddBag( ) ; ::oProLin:AutoIndex()
   ::oProLin:OrdSetFocus( "cCodArt" )

   ::oProMat := DbfServer( "PROMAT.DBF", ):NewOpen( "PROMAT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oProMat:AddBag( "PROMAT.CDX" ) ; ::oProMat:AddBag( ) ; ::oProMat:AutoIndex()
   ::oProMat:OrdSetFocus( "cCodArt" )

   ::nBmp               := LoadBitmap( 0, 32760 )

Return ( Self )



static FUNCTION TDeleleteObsoletos_CloseFiles( ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   ::oPedPrvT:End()
   ::oPedPrvL:End()
   ::oAlbPrvT:End()
   ::oAlbPrvL:End()
   ::oFacPrvT:End()
   ::oFacPrvL:End()
   ::oRctPrvT:End()
   ::oRctPrvL:End()
   ::oPreCliT:End()
   ::oPreCliL:End()
   ::oPedCliT:End()
   ::oPedCliL:End()
   ::oAlbCliT:End()
   ::oAlbCliL:End()
   ::oFacCliT:End()
   ::oFacCliL:End()
   ::oFacRecT:End()
   ::oFacRecL:End()
   ::oTikCliT:End()
   ::oTikCliL:End()
   ::oDbfFam:End()
   ::oDbfArt:End()
   ::oPrvArt:End()
   ::oArtDiv:End()
   ::oArtKit:End()
   ::oCodeBar:End()
   ::oProLin:End()
   ::oProMat:End()

   DeleteObject( ::nBmp )

Return ( Self )



static FUNCTION TDeleleteObsoletos_Resource( ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   local oFamiliaOrigen
   local oFamiliaDestino

   local oSayFamiliaOrigen
   local oSayFamiliaDestino
   local cSayFamiliaOrigen
   local cSayFamiliaDestino

   local oArticuloOrigen
   local oArticuloDestino

   local oSayArticuloOrigen
   local oSayArticuloDestino
   local cSayArticuloOrigen
   local cSayArticuloDestino

   local oBmp

   ::cFamiliaOrigen     := dbFirst( ::oDbfFam, 1 )
   ::cFamiliaDestino    := dbLast ( ::oDbfFam, 1 )
   cSayFamiliaOrigen    := dbFirst( ::oDbfFam, 2 )
   cSayFamiliaDestino   := dbLast ( ::oDbfFam, 2 )

   ::cArticuloOrigen     := dbFirst( ::oDbfArt, 1 )
   ::cArticuloDestino    := dbLast ( ::oDbfArt, 1 )
   cSayArticuloOrigen    := dbFirst( ::oDbfArt, 2 )
   cSayArticuloDestino   := dbLast ( ::oDbfArt, 2 )





   ::oDialog = TDialog():New(,,,,, "ASS_EURO",, .F.,,,,,, .F.,,,,,, .F.,, "::oDialog", nil, )

   oBmp := TBitmap():ReDefine( 500, "gc_delete_48",, ::oDialog,,, .F., .F.,,, .F.,,, .T. )


   ::oPages := TPages():Redefine( 110, ::oDialog, {"ASS_EURO01", "ASS_EURO02"},,,, )




   TGetHlp():ReDefine( 100, { | u | If( PCount()==0, ::dFechaInicial, ::dFechaInicial:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )




   TGetHlp():ReDefine( 110, { | u | If( PCount()==0, ::dFechaFinal, ::dFechaFinal:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )



   TRadMenu():Redefine( { | u | If( PCount()==0, ::nAction, ::nAction:= u ) }, ::oPages:aDialogs[ 1 ],, { 200, 210 },,,,, .F.,, )



   TCheckBox():ReDefine( 120, { | u | If( PCount()==0, ::lTodasFamilias, ::lTodasFamilias:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,, .F.,, .F. )







   oFamiliaOrigen := TGetHlp():ReDefine( 130, { | u | If( PCount()==0, ::cFamiliaOrigen, ::cFamiliaOrigen:= u ) }, ::oPages:aDialogs[ 1 ],,, {||    cFamilia( oFamiliaOrigen, ::oDbfFam:cAlias, oSayFamiliaOrigen )},,,,,, .F., {||     !::lTodasFamilias},, .F., .F.,,,,, {|Self|BrwFamilia( oFamiliaOrigen, oSayFamiliaDestino )}, nil, "LUPA",, )




   oSayFamiliaOrigen := TGetHlp():ReDefine( 131, { | u | If( PCount()==0, cSayFamiliaOrigen, cSayFamiliaOrigen:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )







   oFamiliaDestino := TGetHlp():ReDefine( 140, { | u | If( PCount()==0, ::cFamiliaDestino, ::cFamiliaDestino:= u ) }, ::oPages:aDialogs[ 1 ],,, {||    cFamilia( oFamiliaDestino, ::oDbfFam:cAlias, oSayFamiliaDestino )},,,,,, .F., {||     !::lTodasFamilias},, .F., .F.,,,,, {|Self|BrwFamilia( oFamiliaDestino, oSayFamiliaDestino )}, nil, "LUPA",, )




   oSayFamiliaDestino := TGetHlp():ReDefine( 141, { | u | If( PCount()==0, cSayFamiliaDestino, cSayFamiliaDestino:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )



   TCheckBox():ReDefine( 250, { | u | If( PCount()==0, ::lTodosArticulos, ::lTodosArticulos:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,, .F.,, .F. )







   oArticuloOrigen := TGetHlp():ReDefine( 260, { | u | If( PCount()==0, ::cArticuloOrigen, ::cArticuloOrigen:= u ) }, ::oPages:aDialogs[ 1 ],,, {||    cArticulo( oArticuloOrigen, ::oDbfArt:cAlias, oSayArticuloOrigen )},,,,,, .F., {||     !::lTodosArticulos},, .F., .F.,,,,, {|Self|BrwArticulo( oArticuloOrigen, oSayArticuloDestino )}, nil, "LUPA",, )




   oSayArticuloOrigen := TGetHlp():ReDefine( 261, { | u | If( PCount()==0, cSayArticuloOrigen, cSayArticuloOrigen:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )







   oArticuloDestino := TGetHlp():ReDefine( 270, { | u | If( PCount()==0, ::cArticuloDestino, ::cArticuloDestino:= u ) }, ::oPages:aDialogs[ 1 ],,, {||    cArticulo( oArticuloDestino, ::oDbfArt:cAlias, oSayArticuloDestino )},,,,,, .F., {||     !::lTodosArticulos},, .F., .F.,,,,, {|Self|BrwArticulo( oArticuloDestino, oSayArticuloDestino )}, nil, "LUPA",, )




   oSayArticuloDestino := TGetHlp():ReDefine( 271, { | u | If( PCount()==0, cSayArticuloDestino, cSayArticuloDestino:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )



   TCheckBox():ReDefine( 160, { | u | If( PCount()==0, ::lNoCom, ::lNoCom:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,, .F.,, .F. )



   TCheckBox():ReDefine( 170, { | u | If( PCount()==0, ::lNoPre, ::lNoPre:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,, .F.,, .F. )



   TCheckBox():ReDefine( 180, { | u | If( PCount()==0, ::lNoVta, ::lNoVta:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,, .F.,, .F. )



   TCheckBox():ReDefine( 190, { | u | If( PCount()==0, ::lNoMov, ::lNoMov:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,, .F.,, .F. )



   TCheckBox():ReDefine( 220, { | u | If( PCount()==0, ::lNoPro, ::lNoPro:= u ) }, ::oPages:aDialogs[ 1 ],,,,,,, .F.,, .F. )






 ::oMtrProceso := TApoloMeter():ReDefine( 150, { | u | If( PCount()==0, ::nMtrProceso, ::nMtrProceso:= u ) }, 100, ::oPages:aDialogs[ 1 ], .F.,, "Procesando", .F.,,,, )

   ::oBrwArticulos                        := IXBrowse():New( ::oPages:aDialogs[ 2 ] )

   ::oBrwArticulos:bClrSel                := {|| { 0, ( 229 + ( 229 * 256 ) + ( 229 * 65536 ) ) } }
   ::oBrwArticulos:bClrSelFocus           := {|| { 0, ( 167 + ( 205 * 256 ) + ( 240 * 65536 ) ) } }

   ::oBrwArticulos:SetArray( ::aArticulos, , , .F. )

   ::oBrwArticulos:nMarqueeStyle          := 5
   ::oBrwArticulos:lRecordSelector        := .F.
   ::oBrwArticulos:lHScroll               := .F.
   ::oBrwArticulos:cName                  := "Eliminar artículos sin movimientos"
   ::oBrwArticulos:bLDblClick             := {|| ::SelDel(), ::oBrwArticulos:Refresh() }

   ::oBrwArticulos:CreateFromResource( 100 )

   with object ( ::oBrwArticulos:AddCol() )
      :cHeader          := "Se. seleccionado"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aArticulos[ ::oBrwArticulos:nArrayAt, 1 ] }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end

   with object ( ::oBrwArticulos:AddCol() )
      :cHeader          := "Código"
      :bStrData         := {|| ::aArticulos[ ::oBrwArticulos:nArrayAt, 2 ] }
      :nWidth           := 80
   end

   with object ( ::oBrwArticulos:AddCol() )
      :cHeader          := "Nombre"
      :bStrData         := {|| ::aArticulos[ ::oBrwArticulos:nArrayAt, 3 ] }
      :nWidth           := 400
   end

   with object ( ::oBrwArticulos:AddCol() )
      :cHeader          := "Cod. Fam."
      :bStrData         := {|| ::aArticulos[ ::oBrwArticulos:nArrayAt, 4 ] }
      :nWidth           := 80
      :lHide            := .T.
   end

   with object ( ::oBrwArticulos:AddCol() )
      :cHeader          := "Familia"
      :bStrData         := {|| ::aArticulos[ ::oBrwArticulos:nArrayAt, 5 ] }
      :nWidth           := 400
      :lHide            := .T.
   end




   TButton():ReDefine( 130, {||( ::SelDel(), ::oBrwArticulos:Refresh() )}, ::oPages:aDialogs[ 2 ],,, .F.,,,, .F. )




   TButton():ReDefine( 110, {||( ::SelAllDel( .T. ), ::oBrwArticulos:Refresh() )}, ::oPages:aDialogs[ 2 ],,, .F.,,,, .F. )




   TButton():ReDefine( 120, {||( ::SelAllDel( .F. ), ::oBrwArticulos:Refresh() )}, ::oPages:aDialogs[ 2 ],,, .F.,,,, .F. )




   ::oBtnPrevio := TButton():ReDefine( 401, {||( ::BtnPrevio() )}, ::oDialog,,, .F.,,,, .F. )




   ::oBtnSiguiente := TButton():ReDefine( 402, {||( ::BtnSiguiente() )}, ::oDialog,,, .F.,,,, .F. )




   TButton():ReDefine( 403, {||( ::oDialog:end() )}, ::oDialog,,, .F.,,,, .F. )

   ::oDialog:bStart  := {|| ::oBtnPrevio:Hide(), ::oBrwArticulos:Load() }

   ::oDialog:Activate( ::oDialog:bLClicked, ::oDialog:bMoved, ::oDialog:bPainted, .T.,,,, ::oDialog:bRClicked,,, )

   oBmp:End()

RETURN ( Self )



static FUNCTION TDeleleteObsoletos_BtnPrevio( ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   if ::oPages:nOption == 2
      ::oPages:GoPrev()
      SetWindowText( ::oBtnSiguiente:hWnd, "Siguien&te >" )
      ::oBtnPrevio:Hide()
   end

RETURN ( Self )



static FUNCTION TDeleleteObsoletos_BtnSiguiente( ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   do case
      case ::oPages:nOption == 1
         if !::lNoCom .AND. !::lNoPre .AND. !::lNoVta .AND. !::lNoMov
            MsgStop( "Tienes que seleccionar alguna de las opciones a incluir en la búsqueda" )
            Return .F.
         end
         ::Search()
         ::oPages:GoNext()
         SetWindowText( ::oBtnSiguiente:hWnd, "&Proceder" )
         ::oBtnPrevio:Show()

      case ::oPages:nOption == 2
         ::BorraSeleccionados()
         ::oDialog:End()
   end

RETURN ( Self )



static FUNCTION TDeleleteObsoletos_Search( ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   ::oDialog:Disable()

   ::aArticulos               := {}

   aEval( ::oBrwArticulos:aArrayData, {|a,n| hb_ADel( ::oBrwArticulos:aArrayData, n, .T. ), ::oBrwArticulos:Refresh() } )

   ::oMtrProceso:SetTotal( ::oDbfArt:Lastrec() )

   ::oDbfArt:GoTop()
   while !::oDbfArt:Eof()


      if ::lTodosArticulos  .OR. ( ::oDbfArt:Codigo >= ::cArticuloOrigen .AND. ::oDbfArt:Codigo <= ::cArticuloDestino )


         if ::lTodasFamilias  .OR. ( ::oDbfArt:Familia >= ::cFamiliaOrigen .AND. ::oDbfArt:Familia <= ::cFamiliaDestino )

            if ::lNoHayMovimientos()
               aAdd( ::aArticulos, { .T., ::oDbfArt:Codigo, ::oDbfArt:Nombre, ::oDbfArt:Familia, retFld( ::oDbfArt:Familia, ::oDbfFam:cAlias ) } )
            end

         end

      end

      ::oMtrProceso:Set( ::oDbfArt:OrdKeyNo() )

      ::oDbfArt:Skip()

   end

   ::oMtrProceso:Set( ::oDbfArt:LastRec() )

   aEval( ::aArticulos, {|a| aAdd( ::oBrwArticulos:aArrayData, a ), ::oBrwArticulos:Refresh() } )

   ::oDialog:Enable()

Return ( Self )



static FUNCTION TDeleleteObsoletos_lNoHayMovimientos( ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   local dFecha
   local cCodArt     := ::oDbfArt:Codigo

   if ::lNoCom

      if ::oPedPrvL:Seek( cCodArt )

         while ::oPedPrvL:cRef == cCodArt .AND. !::oPedPrvL:Eof()

            dFecha   := dFecPedPrv( ::oPedPrvL:cSerPed + Str( ::oPedPrvL:nNumPed ) + ::oPedPrvL:cSufPed, ::oPedPrvT:cAlias )

            if dFecha >= ::dFechaInicial .AND. dFecha <= ::dFechaFinal

               Return .F.

            end

            ::oPedPrvL:Skip()

         end

      end

      if ::oAlbPrvL:Seek( cCodArt )

         while ::oAlbPrvL:cRef == cCodArt .AND. !::oAlbPrvL:Eof()

            dFecha   := dFecAlbPrv( ::oAlbPrvL:cSerAlb + Str( ::oAlbPrvL:nNumAlb ) + ::oAlbPrvL:cSufAlb, ::oAlbPrvT:cAlias )

            if dFecha >= ::dFechaInicial .AND. dFecha <= ::dFechaFinal

               Return .F.

            end

            ::oAlbPrvL:Skip()

         end

      end

      if ::oFacPrvL:Seek( cCodArt )

         while ::oFacPrvL:cRef == cCodArt .AND. !::oFacPrvL:Eof()

            dFecha   := dFecFacPrv( ::oFacPrvL:cSerFac + Str( ::oFacPrvL:nNumFac ) + ::oFacPrvL:cSufFac, ::oFacPrvT:cAlias )

            if dFecha >= ::dFechaInicial .AND. dFecha <= ::dFechaFinal

               Return .F.

            end

            ::oFacPrvL:Skip()

         end

      end

      if ::oRctPrvL:Seek( cCodArt )

         while ::oRctPrvL:cRef == cCodArt .AND. !::oRctPrvL:Eof()

            dFecha   := dFecRctPrv( ::oRctPrvL:cSerFac + Str( ::oRctPrvL:nNumFac ) + ::oRctPrvL:cSufFac, ::oRctPrvT:cAlias )

            if dFecha >= ::dFechaInicial .AND. dFecha <= ::dFechaFinal

               Return .F.

            end

            ::oRctPrvL:Skip()

         end

      end

   end

   if ::lNoPre

      if ::oPreCliL:Seek( cCodArt )

         while ::oPreCliL:cRef == cCodArt .AND. !::oPreCliL:Eof()

            dFecha   := dFecPreCli( ::oPreCliL:cSerPre + Str( ::oPreCliL:nNumPre ) + ::oPreCliL:cSufPre, ::oPreCliT:cAlias )

            if dFecha >= ::dFechaInicial .AND. dFecha <= ::dFechaFinal

               Return .F.

            end

            ::oPreCliL:Skip()

         end

      end

   end

   if ::lNoVta

      if ::oPedCliL:Seek( cCodArt )

         while ::oPedCliL:cRef == cCodArt .AND. !::oPedCliL:Eof()

            dFecha   := dFecPedCli( ::oPedCliL:cSerPed + Str( ::oPedCliL:nNumPed ) + ::oPedCliL:cSufPed, ::oPedCliT:cAlias )

            if dFecha >= ::dFechaInicial .AND. dFecha <= ::dFechaFinal

               Return .F.

            end

            ::oPedCliL:Skip()

         end

      end

      if ::oAlbCliL:Seek( cCodArt )

         while ::oAlbCliL:cRef == cCodArt .AND. !::oAlbCliL:Eof()

            dFecha   := dFecAlbCli( ::oAlbCliL:cSerAlb + Str( ::oAlbCliL:nNumAlb ) + ::oAlbCliL:cSufAlb, ::oAlbCliT:cAlias )

            if dFecha >= ::dFechaInicial .AND. dFecha <= ::dFechaFinal

               Return .F.

            end

            ::oAlbCliL:Skip()

         end

      end

      if ::oFacCliL:Seek( cCodArt )

         while ::oFacCliL:cRef == cCodArt .AND. !::oFacCliL:Eof()

            dFecha   := dFecFacCli( ::oFacCliL:cSerie + Str( ::oFacCliL:nNumFac ) + ::oFacCliL:cSufFac, ::oFacCliT:cAlias )

            if dFecha >= ::dFechaInicial .AND. dFecha <= ::dFechaFinal

               Return .F.

            end

            ::oFacCliL:Skip()

         end

      end

      if ::oFacRecL:Seek( cCodArt )

         while ::oFacRecL:cRef == cCodArt .AND. !::oFacRecL:Eof()

            dFecha   := dFecFacRec( ::oFacRecL:cSerie + Str( ::oFacRecL:nNumFac ) + ::oFacRecL:cSufFac, ::oFacRecT:cAlias )

            if dFecha >= ::dFechaInicial .AND. dFecha <= ::dFechaFinal

               Return .F.

            end

            ::oFacRecL:Skip()

         end

      end

      if ::oTikCliL:Seek( cCodArt )

         while ::oTikCliL:cCbaTil == cCodArt .AND. !::oTikCliL:Eof()

            dFecha   := dFecTik( ::oTikCliL:cSerTil + ::oTikCliL:cNumTil + ::oTikCliL:cSufTil, ::oTikCliT:cAlias )

            if dFecha >= ::dFechaInicial .AND. dFecha <= ::dFechaFinal

               Return .F.

            end

            ::oTikCliL:Skip()

         end

      end

   end

   if ::lNoPro

      if ::oProMat:Seek( cCodArt )

         while ::oProMat:cCodArt == cCodArt .AND. !::oProMat:Eof()

            if ::oProMat:dFecOrd >= ::dFechaInicial .AND. ::oProMat:dFecOrd <= ::dFechaFinal

               Return .F.

            end

            ::oProMat:Skip()

         end

      end

      if ::oProLin:Seek( cCodArt )

         while ::oProLin:cCodArt == cCodArt .AND. !::oProLin:Eof()

            if ::oProLin:dFecOrd >= ::dFechaInicial .AND. ::oProLin:dFecOrd <= ::dFechaFinal

               Return .F.

            end

            ::oProLin:Skip()

         end

      end

   end

RETURN .T.



static FUNCTION TDeleleteObsoletos_BorraSeleccionados( ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   local n
   local cText       := "¡Atención!" + Chr(13)+Chr(10)
   local nBorrados   := 0

   for n := 1 to len( ::aArticulos )

      if ::aArticulos[ n, 1 ]
         nBorrados++
      end

   next

   if nBorrados > 0
      if ::nAction == 1
         cText       += "Se van a eliminar " + Alltrim( Str( nBorrados ) ) + " árticulos." + Chr(13)+Chr(10)
      else
         cText       += "Se van a marcar como obsoletos " + Alltrim( Str( nBorrados ) ) + " árticulos." + Chr(13)+Chr(10)
      end
   end

   if !ApoloMsgNoYes(cText, "Confirme proceso" )
      Return ( Self )
   end

   for n := 1 to len( ::aArticulos )

      do case

         case ::nAction == 1 .AND. ::aArticulos[ n, 1 ]

            while ::oPrvArt:Seek( ::aArticulos[ n, 2 ] )
               ::oPrvArt:Delete(.F.)
            end

            while ::oArtDiv:Seek( ::aArticulos[ n, 2 ] )
               ::oArtDiv:Delete(.F.)
            end

            while ::oArtKit:Seek( ::aArticulos[ n, 2 ] )
               ::oArtKit:Delete(.F.)
            end

            while ::oCodeBar:Seek( ::aArticulos[ n, 2 ] )
               ::oCodeBar:Delete(.F.)
            end

            while ::oDbfArt:Seek( ::aArticulos[ n, 2 ] )
               ::oDbfArt:Delete(.F.)
            end

         case ::nAction == 2 .AND. ::aArticulos[ n, 1 ]

            if ::oDbfArt:Seek( ::aArticulos[ n, 2 ] )
               ::oDbfArt:Load()
               ::oDbfArt:lObs := .T.
               ::oDbfArt:Save()
            end

      end

   next

RETURN ( Self )



static FUNCTION TDeleleteObsoletos_SelDel( ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   if len( ::aArticulos ) <> 0
      ::aArticulos[ ::oBrwArticulos:nArrayAt, 1 ] := !::aArticulos[ ::oBrwArticulos:nArrayAt, 1 ]
   end

RETURN ( Self )



static FUNCTION TDeleleteObsoletos_SelAllDel( lOpcion ) ; local Self AS CLASS TDeleleteObsoletos := QSelf() AS CLASS TDeleleteObsoletos

   aEval( ::aArticulos, {|a| a[ 1 ] := lOpcion } )

RETURN ( Self )
