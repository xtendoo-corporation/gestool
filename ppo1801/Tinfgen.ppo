#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 6 ".\.\Prg\Tinfgen.prg"
static lThouSep        := .F.
static cNumFormat      := "A"
static lExcelInstl
static lCalcInstl
static nxlLangID, cxlTrue := "=(1=1)", cxlFalse := "=(1=0)", cxlSum, cxlSubTotal, lxlEnglish := .F., hLib

static oThis



Function setFastReportObject( self )

   oThis  := self

Return ( oThis )



Function getFastReportObject()

Return ( oThis )



_HB_CLASS TInfGen ; function TInfGen ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TInfGen", iif( .F., { }, { @HBObject() } ), @TInfGen() ) ) ;

   _HB_MEMBER { aFont } ; oClass:AddMultiClsData(,, nScope + iif( .F., 16, 0 ) + iif( .T., 32, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aFont"}, .F. )
   _HB_MEMBER { acSizes } ; oClass:AddMultiClsData(,, nScope + iif( .F., 16, 0 ) + iif( .T., 32, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"acSizes"}, .F. )
   _HB_MEMBER { acEstilo } ; oClass:AddMultiClsData(,, nScope + iif( .F., 16, 0 ) + iif( .T., 32, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"acEstilo"}, .F. )
   _HB_MEMBER { acFont } ; oClass:AddMultiClsData(,, nScope + iif( .F., 16, 0 ) + iif( .T., 32, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"acFont"}, .F. )

   _HB_MEMBER { oDlg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDlg"}, .F. )
   _HB_MEMBER { oFld } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFld"}, .F. )
   _HB_MEMBER { oReport } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oReport"}, .F. )
   _HB_MEMBER { oBmpImagen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBmpImagen"}, .F. )
   _HB_MEMBER { cFileName } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFileName"}, .F. )
   _HB_MEMBER { cFileIndx } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFileIndx"}, .F. )
   _HB_MEMBER { nDevice } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nDevice"}, .F. )
   _HB_MEMBER { cTitle } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTitle"}, .F. )
   _HB_MEMBER { cSubTitle } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSubTitle"}, .F. )
   _HB_MEMBER { cAliasTitle } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cAliasTitle"}, .F. )
   _HB_MEMBER { cFooter } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFooter"}, .F. )
   _HB_MEMBER { aDbfTmp } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aDbfTmp"}, .F. )
   _HB_MEMBER { cIndex } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cIndex"}, .F. )
   _HB_MEMBER { aStru } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aStru"}, .F. )
   _HB_MEMBER { bRedefine } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bRedefine"}, .F. )
   _HB_MEMBER { aCols } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aCols"}, .F. )
   _HB_MEMBER { bFilter } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bFilter"}, .F. )
   _HB_MEMBER { uFrom } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"uFrom"}, .F. )
   _HB_MEMBER { uTo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"uTo"}, .F. )
   _HB_MEMBER { nSize } ; oClass:AddMultiData(, 10, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nSize"}, .F. )
   _HB_MEMBER { aOrd } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aOrd"}, .F. )
   _HB_MEMBER { cAlias } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cAlias"}, .F. )
   _HB_MEMBER { lOpenFiles } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lOpenFiles"}, .F. )
   _HB_MEMBER { aoCols } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aoCols"}, .F. )
   _HB_MEMBER { aoGroup } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aoGroup"}, .F. )
   _HB_MEMBER { cHelp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cHelp"}, .F. )
   _HB_MEMBER { lSave2Exit } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lSave2Exit"}, .F. )
   _HB_MEMBER { nYeaInf } ; oClass:AddMultiData(, Year( Date() ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nYeaInf"}, .F. )
   _HB_MEMBER { dIniInf } ; oClass:AddMultiData(, CtoD( "01/01/" + Str( Year( Date() ) ) ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"dIniInf"}, .F. )
   _HB_MEMBER { dFinInf } ; oClass:AddMultiData(, Date(), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"dFinInf"}, .F. )
   _HB_MEMBER { oIniInf } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oIniInf"}, .F. )
   _HB_MEMBER { oIniText } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oIniText"}, .F. )
   _HB_MEMBER { oFinInf } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFinInf"}, .F. )
   _HB_MEMBER { oFinText } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFinText"}, .F. )
   _HB_MEMBER { oSer } ; oClass:AddMultiData(, Array( 26 ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSer"}, .F. )
   _HB_MEMBER { aSer } ; oClass:AddMultiData(, Afill( Array( 26 ), .T. ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aSer"}, .F. )
   _HB_MEMBER { oBandera } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBandera"}, .F. )
   _HB_MEMBER { oDivInf } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDivInf"}, .F. )
   _HB_MEMBER { cDivInf } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cDivInf"}, .F. )
   _HB_MEMBER { cPicImp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPicImp"}, .F. )
   _HB_MEMBER { cPicOut } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPicOut"}, .F. )
   _HB_MEMBER { nDecOut } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nDecOut"}, .F. )
   _HB_MEMBER { cPicOut } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPicOut"}, .F. )
   _HB_MEMBER { nDecOut } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nDecOut"}, .F. )
   _HB_MEMBER { nDerOut } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nDerOut"}, .F. )
   _HB_MEMBER { cPicCom } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPicCom"}, .F. )
   _HB_MEMBER { cPicIn } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPicIn"}, .F. )
   _HB_MEMBER { nDecIn } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nDecIn"}, .F. )
   _HB_MEMBER { nDerIn } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nDerIn"}, .F. )
   _HB_MEMBER { cPicPnt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPicPnt"}, .F. )
   _HB_MEMBER { nDecPnt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nDecPnt"}, .F. )
   _HB_MEMBER { nDerPnt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nDerPnt"}, .F. )
   _HB_MEMBER { nValDiv } ; oClass:AddMultiData(, 1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nValDiv"}, .F. )
   _HB_MEMBER { cAlmOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cAlmOrg"}, .F. )
   _HB_MEMBER { cAlmDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cAlmDes"}, .F. )
   _HB_MEMBER { lAgeAll } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAgeAll"}, .F. )
   _HB_MEMBER { lShadowLine } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lShadowLine"}, .F. )
   _HB_MEMBER { cAgeOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cAgeOrg"}, .F. )
   _HB_MEMBER { cAgeDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cAgeDes"}, .F. )
   _HB_MEMBER { cRutOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cRutOrg"}, .F. )
   _HB_MEMBER { cRutDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cRutDes"}, .F. )
   _HB_MEMBER { cArtOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cArtOrg"}, .F. )
   _HB_MEMBER { cArtDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cArtDes"}, .F. )
   _HB_MEMBER { cCliOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCliOrg"}, .F. )
   _HB_MEMBER { cCliDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCliDes"}, .F. )
   _HB_MEMBER { cTmpOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTmpOrg"}, .F. )
   _HB_MEMBER { cTmpDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTmpDes"}, .F. )
   _HB_MEMBER { cTrnOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTrnOrg"}, .F. )
   _HB_MEMBER { cTrnDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTrnDes"}, .F. )
   _HB_MEMBER { cObrOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cObrOrg"}, .F. )
   _HB_MEMBER { cCodEmp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCodEmp"}, .F. )
   _HB_MEMBER { cObrDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cObrDes"}, .F. )
   _HB_MEMBER { oBmpDiv } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBmpDiv"}, .F. )
   _HB_MEMBER { oBrwCol } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrwCol"}, .F. )

   _HB_MEMBER { oOperacion } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oOperacion"}, .F. )
   _HB_MEMBER { oSeccion } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSeccion"}, .F. )
   _HB_MEMBER { oOperario } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oOperario"}, .F. )
   _HB_MEMBER { oMaquina } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oMaquina"}, .F. )

   _HB_MEMBER { oDbfDiv } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfDiv"}, .F. )
   _HB_MEMBER { cSupTitle } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cSupTitle"}, .F. )
   _HB_MEMBER { oMtrInf } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oMtrInf"}, .F. )
   _HB_MEMBER { nMtrInf } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nMtrInf"}, .F. )
   _HB_MEMBER { oDbf } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbf"}, .F. )
   _HB_MEMBER { oDbfMai } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfMai"}, .F. )
   _HB_MEMBER { oDbfDet } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfDet"}, .F. )
   _HB_MEMBER { oParent } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oParent"}, .F. )
   _HB_MEMBER { oDetail } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDetail"}, .F. )
   _HB_MEMBER { oDbfAlm } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfAlm"}, .F. )
   _HB_MEMBER { oDbfAlmacenOrigen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfAlmacenOrigen"}, .F. )
   _HB_MEMBER { oDbfAge } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfAge"}, .F. )
   _HB_MEMBER { oDbfRut } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfRut"}, .F. )
   _HB_MEMBER { oDbfArt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfArt"}, .F. )
   _HB_MEMBER { oDbfArticuloMateriaPrima } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfArticuloMateriaPrima"}, .F. )
   _HB_MEMBER { oArtImg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArtImg"}, .F. )
   _HB_MEMBER { oArtKit } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArtKit"}, .F. )
   _HB_MEMBER { oArtCod } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oArtCod"}, .F. )
   _HB_MEMBER { oDbfCli } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfCli"}, .F. )
   _HB_MEMBER { oDbfTmp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfTmp"}, .F. )
   _HB_MEMBER { oDbfPrv } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfPrv"}, .F. )
   _HB_MEMBER { oDbfObr } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfObr"}, .F. )
   _HB_MEMBER { oDbfFpg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFpg"}, .F. )
   _HB_MEMBER { oGruFam } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGruFam"}, .F. )
   _HB_MEMBER { oDbfTur } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfTur"}, .F. )
   _HB_MEMBER { oDbfTrn } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfTrn"}, .F. )
   _HB_MEMBER { oDbfCaj } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfCaj"}, .F. )
   _HB_MEMBER { oDbfRemCli } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfRemCli"}, .F. )
   _HB_MEMBER { oResumen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oResumen"}, .F. )
   _HB_MEMBER { lResumen } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lResumen"}, .F. )
   _HB_MEMBER { lExcCero } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lExcCero"}, .F. )
   _HB_MEMBER { lExcImp } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lExcImp"}, .F. )
   _HB_MEMBER { lSalto } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lSalto"}, .F. )
   _HB_MEMBER { cPrvOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPrvOrg"}, .F. )
   _HB_MEMBER { cPrvDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPrvDes"}, .F. )
   _HB_MEMBER { oDbfFam } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFam"}, .F. )
   _HB_MEMBER { oDbfCat } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfCat"}, .F. )
   _HB_MEMBER { oDbfEstArt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfEstArt"}, .F. )
   _HB_MEMBER { oTipArt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTipArt"}, .F. )
   _HB_MEMBER { oDbfFab } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFab"}, .F. )
   _HB_MEMBER { oDbfIva } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfIva"}, .F. )
   _HB_MEMBER { oTipAct } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTipAct"}, .F. )
   _HB_MEMBER { oDbfEmp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfEmp"}, .F. )
   _HB_MEMBER { cFamOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFamOrg"}, .F. )
   _HB_MEMBER { cFamDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFamDes"}, .F. )
   _HB_MEMBER { cTipOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTipOrg"}, .F. )
   _HB_MEMBER { cTipDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTipDes"}, .F. )
   _HB_MEMBER { cTipActOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTipActOrg"}, .F. )
   _HB_MEMBER { cTipActDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTipActDes"}, .F. )
   _HB_MEMBER { oBanco } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBanco"}, .F. )
   _HB_MEMBER { oGrpCli } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrpCli"}, .F. )
   _HB_MEMBER { cGrpOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGrpOrg"}, .F. )
   _HB_MEMBER { cGrpDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGrpDes"}, .F. )
   _HB_MEMBER { lGrpAll } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lGrpAll"}, .F. )
   _HB_MEMBER { oGrpPrv } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGrpPrv"}, .F. )
   _HB_MEMBER { cGrpPrvOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGrpPrvOrg"}, .F. )
   _HB_MEMBER { cGrpPrvDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGrpPrvDes"}, .F. )
   _HB_MEMBER { lGrpPrvAll } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lGrpPrvAll"}, .F. )
   _HB_MEMBER { lAllFab } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllFab"}, .F. )
   _HB_MEMBER { lAllPrv } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllPrv"}, .F. )
   _HB_MEMBER { lAllCli } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllCli"}, .F. )
   _HB_MEMBER { lAllTmp } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllTmp"}, .F. )
   _HB_MEMBER { lAllAlm } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllAlm"}, .F. )
   _HB_MEMBER { lAllArt } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllArt"}, .F. )
   _HB_MEMBER { lAllGrp } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllGrp"}, .F. )
   _HB_MEMBER { lAllFam } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllFam"}, .F. )
   _HB_MEMBER { lAllCat } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllCat"}, .F. )
   _HB_MEMBER { lAllFpg } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllFpg"}, .F. )
   _HB_MEMBER { lAllTip } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllTip"}, .F. )
   _HB_MEMBER { lAllRut } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllRut"}, .F. )
   _HB_MEMBER { lAllTrn } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllTrn"}, .F. )
   _HB_MEMBER { lAllUsr } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllUsr"}, .F. )
   _HB_MEMBER { lAllCaj } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllCaj"}, .F. )
   _HB_MEMBER { lAllTipAct } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllTipAct"}, .F. )

   _HB_MEMBER { cGruFamOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGruFamOrg"}, .F. )
   _HB_MEMBER { cGruFamDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cGruFamDes"}, .F. )
   _HB_MEMBER { cTurOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTurOrg"}, .F. )
   _HB_MEMBER { cTurDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTurDes"}, .F. )
   _HB_MEMBER { cFpgDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFpgDes"}, .F. )
   _HB_MEMBER { cFpgHas } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cFpgHas"}, .F. )

   _HB_MEMBER { oAlbPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAlbPrvT"}, .F. )
   _HB_MEMBER { oAlbPrvL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAlbPrvL"}, .F. )
   _HB_MEMBER { oFacPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacPrvT"}, .F. )
   _HB_MEMBER { oFacPrvL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacPrvL"}, .F. )
   _HB_MEMBER { oFacRecL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacRecL"}, .F. )
   _HB_MEMBER { oFacRecT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacRecT"}, .F. )
   _HB_MEMBER { oFacCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacCliL"}, .F. )
   _HB_MEMBER { oFacCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacCliT"}, .F. )
   _HB_MEMBER { oFacCliP } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFacCliP"}, .F. )
   _HB_MEMBER { oAntCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAntCliT"}, .F. )
   _HB_MEMBER { oSatCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSatCliT"}, .F. )
   _HB_MEMBER { oSatCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSatCliL"}, .F. )
   _HB_MEMBER { oPreCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPreCliT"}, .F. )
   _HB_MEMBER { oPreCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPreCliL"}, .F. )
   _HB_MEMBER { oPedCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPedCliL"}, .F. )
   _HB_MEMBER { oPedCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPedCliT"}, .F. )
   _HB_MEMBER { oPedPrvL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPedPrvL"}, .F. )
   _HB_MEMBER { oPedPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oPedPrvT"}, .F. )
   _HB_MEMBER { oAlbCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAlbCliL"}, .F. )
   _HB_MEMBER { oAlbCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oAlbCliT"}, .F. )
   _HB_MEMBER { oTikCliT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTikCliT"}, .F. )
   _HB_MEMBER { oTikCliL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTikCliL"}, .F. )
   _HB_MEMBER { oRctPrvT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oRctPrvT"}, .F. )
   _HB_MEMBER { oRctPrvL } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oRctPrvL"}, .F. )
   _HB_MEMBER { oRemAgeT } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oRemAgeT"}, .F. )
   _HB_MEMBER { oCnfFlt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oCnfFlt"}, .F. )

   _HB_MEMBER { aFields } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aFields"}, .F. )
   _HB_MEMBER { aIniCli } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aIniCli"}, .F. )
   _HB_MEMBER { aIniPrv } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aIniPrv"}, .F. )

   _HB_MEMBER { oBtnOriginal } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnOriginal"}, .F. )
   _HB_MEMBER { oBtnFilter } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnFilter"}, .F. )
   _HB_MEMBER { oBtnAction } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnAction"}, .F. )
   _HB_MEMBER { oBtnCancel } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnCancel"}, .F. )
   _HB_MEMBER { oBtnExportar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnExportar"}, .F. )
   _HB_MEMBER { oBtnImportar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnImportar"}, .F. )
   _HB_MEMBER { oBtnXml } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnXml"}, .F. )

   _HB_MEMBER { aHeader } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aHeader"}, .F. )
   _HB_MEMBER { aFooter } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aFooter"}, .F. )
   _HB_MEMBER { lDefSerInf } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDefSerInf"}, .F. )
   _HB_MEMBER { lDefFecInf } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDefFecInf"}, .F. )
   _HB_MEMBER { lGrpFecInf } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lGrpFecInf"}, .F. )
   _HB_MEMBER { lDefDivInf } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDefDivInf"}, .F. )
   _HB_MEMBER { lDefTitInf } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDefTitInf"}, .F. )
   _HB_MEMBER { lDefMetInf } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDefMetInf"}, .F. )
   _HB_MEMBER { lDefGraph } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDefGraph"}, .F. )
   _HB_MEMBER { lCellView } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lCellView"}, .F. )
   _HB_MEMBER { lShadow } ; oClass:AddMultiData(, .T., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lShadow"}, .F. )
   _HB_MEMBER { lBreak } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lBreak"}, .F. )
   _HB_MEMBER { lNoCancel } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lNoCancel"}, .F. )
   _HB_MEMBER { oDbfInf } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfInf"}, .F. )
   _HB_MEMBER { oDbfFnt } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfFnt"}, .F. )
   _HB_MEMBER { oDbfGrp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfGrp"}, .F. )
   _HB_MEMBER { nBmp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nBmp"}, .F. )
   _HB_MEMBER { aIndex } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aIndex"}, .F. )
   _HB_MEMBER { lNoGroup } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lNoGroup"}, .F. )
   _HB_MEMBER { oWndGraph } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oWndGraph"}, .F. )
   _HB_MEMBER { nEvery } ; oClass:AddMultiData(, 1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nEvery"}, .F. )
   _HB_MEMBER { oFilter } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oFilter"}, .F. )
   _HB_MEMBER { lFilterHeader } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lFilterHeader"}, .F. )
   _HB_MEMBER { xOthers } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"xOthers"}, .F. )
   _HB_MEMBER { cPrinter } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPrinter"}, .F. )
   _HB_MEMBER { cImagen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cImagen"}, .F. )
   _HB_MEMBER { nFilaImagen } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nFilaImagen"}, .F. )
   _HB_MEMBER { nColumnaImagen } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nColumnaImagen"}, .F. )
   _HB_MEMBER { nAnchoImagen } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nAnchoImagen"}, .F. )
   _HB_MEMBER { nAltoImagen } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nAltoImagen"}, .F. )
   _HB_MEMBER { cUsrOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cUsrOrg"}, .F. )
   _HB_MEMBER { cUsrDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cUsrDes"}, .F. )
   _HB_MEMBER { cCajOrg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCajOrg"}, .F. )
   _HB_MEMBER { cCajDes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCajDes"}, .F. )

   _HB_MEMBER { oTreeGroups } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTreeGroups"}, .F. )
   _HB_MEMBER { oTreeSelectedGroups } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTreeSelectedGroups"}, .F. )
   _HB_MEMBER { oImageGroup } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oImageGroup"}, .F. )

   _HB_MEMBER { oOrientation } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oOrientation"}, .F. )
   _HB_MEMBER { nOrientation } ; oClass:AddMultiData(, 1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nOrientation"}, .F. )
   _HB_MEMBER { cOrientation } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cOrientation"}, .F. )
   _HB_MEMBER { aOrientation } ; oClass:AddMultiData(, { "Automática", "Vertical", "Horizontal" }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aOrientation"}, .F. )

   _HB_MEMBER { oCmbReport } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oCmbReport"}, .F. )
   _HB_MEMBER { cCmbReport } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCmbReport"}, .F. )
   _HB_MEMBER { aCmbReport } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aCmbReport"}, .F. )
   _HB_MEMBER { aBmpReport } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aBmpReport"}, .F. )
   _HB_MEMBER { nCmbReport } ; oClass:AddMultiData(, 1, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nCmbReport"}, .F. )

   _HB_MEMBER { nWidthPage } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nWidthPage"}, .F. )
   _HB_MEMBER { nLenPage } ; oClass:AddMultiData(, 0, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nLenPage"}, .F. )

   _HB_MEMBER { bForReport } ; oClass:AddMultiData(, {|| .T. }, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bForReport"}, .F. )
   _HB_MEMBER { bStartGroup } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bStartGroup"}, .F. )
   _HB_MEMBER { bEndGroup } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bEndGroup"}, .F. )
   _HB_MEMBER { bPostGroup } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bPostGroup"}, .F. )

   _HB_MEMBER { bPreGenerate } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bPreGenerate"}, .F. )
   _HB_MEMBER { bPostGenerate } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bPostGenerate"}, .F. )

   _HB_MEMBER { lDefDesHas } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDefDesHas"}, .F. )

   _HB_MEMBER { uDesInf } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"uDesInf"}, .F. )
   _HB_MEMBER { uHasInf } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"uHasInf"}, .F. )

   _HB_MEMBER { hFile } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"hFile"}, .F. )

   _HB_MEMBER { lAllObr } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lAllObr"}, .F. )

   _HB_MEMBER { lBig } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lBig"}, .F. )
   _HB_MEMBER { oBrwCondiciones } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrwCondiciones"}, .F. )
   _HB_MEMBER { aCondiciones } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aCondiciones"}, .F. )

   _HB_MEMBER { aSelectionGroup } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aSelectionGroup"}, .F. )
   _HB_MEMBER { aSelectedGroup } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aSelectedGroup"}, .F. )
   _HB_MEMBER { aInitGroup } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aInitGroup"}, .F. )
   _HB_MEMBER { aSelectionRango } ; oClass:AddMultiData(, {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aSelectionRango"}, .F. )

   _HB_MEMBER { lNewInforme } ; oClass:AddMultiData(, .F., nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lNewInforme"}, .F. )

   _HB_MEMBER { cPrefijoIndice } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cPrefijoIndice"}, .F. )

   _HB_MEMBER { cEmptyIndex } ; oClass:AddMultiData(, "cNumDoc", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cEmptyIndex"}, .F. )

   _HB_MEMBER { uParam } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"uParam"}, .F. )

   _HB_MEMBER { oBtnOptions } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnOptions"}, .F. )

   _HB_MEMBER { oTFastReportOptions } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTFastReportOptions"}, .F. )

   _HB_MEMBER New( cSubTitle, aFields, oMenuItem, oWnd) AS CLASS TInfGen; oClass:AddMethod( "New", @TInfGen_New(), nScope + iif( .T., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Activate(); oClass:AddMethod( "Activate", @TInfGen_Activate(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lGenerate(); oClass:AddMethod( "lGenerate", @TInfGen_lGenerate(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Create() ; oClass:AddVirtual( "Create" )

   _HB_MEMBER Reindexa(); oClass:AddMethod( "Reindexa", @TInfGen_Reindexa(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER DefineConfigUser( cPath); oClass:AddMethod( "DefineConfigUser", @TInfGen_DefineConfigUser(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER DefineFont( cPath); oClass:AddMethod( "DefineFont", @TInfGen_DefineFont(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER DefineGroup( cPath); oClass:AddMethod( "DefineGroup", @TInfGen_DefineGroup(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Play(); oClass:AddMethod( "Play", @TInfGen_Play(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Print( nDevice); oClass:AddMethod( "Print", @TInfGen_Print(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER StdResource(); oClass:AddMethod( "StdResource", @TInfGen_StdResource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ChgIndex(); oClass:AddInline( "ChgIndex", {|Self, oCmb | ( ( Self ) ), ( ::cAlias )->( OrdSetFocus( oCmb:nAt ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Redefine(); oClass:AddInline( "Redefine", {|Self | ( ( Self ) ), Eval( ::bRedefine, self ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddField( cNomCol, cTypCol, nSizCol, nDecCol, cPicCol, cHeaCol); oClass:AddMethod( "AddField", @TInfGen_AddField(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddTmpIndex( cName, cKey, cFor, bWhile, lUniq, lDes, cComment, bOption, nStep, lNoDel, lFocus); oClass:AddMethod( "AddTmpIndex", @TInfGen_AddTmpIndex(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddGroup( bGroup , bHeader, bFooter, bFont, lEject); oClass:AddMethod( "AddGroup", @TInfGen_AddGroup(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER DelGroup( nGroup); oClass:AddMethod( "DelGroup", @TInfGen_DelGroup(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER UpColumn( oBrw); oClass:AddMethod( "UpColumn", @TInfGen_UpColumn(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER DwColumn( oBrw); oClass:AddMethod( "DwColumn", @TInfGen_DwColumn(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Default(); oClass:AddMethod( "Default", @TInfGen_Default(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Save(); oClass:AddMethod( "Save", @TInfGen_Save(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefYea( nId); oClass:AddMethod( "oDefYea", @TInfGen_oDefYea(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefIniInf( nId); oClass:AddMethod( "oDefIniInf", @TInfGen_oDefIniInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefFinInf( nId); oClass:AddMethod( "oDefFinInf", @TInfGen_oDefFinInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefDivInf( nId, nIdBmp); oClass:AddMethod( "oDefDivInf", @TInfGen_oDefDivInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefTitInf( nIdTitle, nIdSubTitle); oClass:AddMethod( "oDefTitInf", @TInfGen_oDefTitInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefAlmInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllAlm, lInitGroup); oClass:AddMethod( "oDefAlmInf", @TInfGen_oDefAlmInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oBrwAlmInf(); oClass:AddMethod( "oBrwAlmInf", @TInfGen_oBrwAlmInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefAgeInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, oDbfAge); oClass:AddMethod( "oDefAgeInf", @TInfGen_oDefAgeInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefRutInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllRut); oClass:AddMethod( "oDefRutInf", @TInfGen_oDefRutInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefUsrInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllUsr); oClass:AddMethod( "oDefUsrInf", @TInfGen_oDefUsrInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefCajInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllCaj); oClass:AddMethod( "oDefCajInf", @TInfGen_oDefCajInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lDefArtInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllArt, lInitGroup); oClass:AddMethod( "lDefArtInf", @TInfGen_lDefArtInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lIntArtInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllArt, dbfArticulo, dbfDiv, dbfArtKit, dbfIva); oClass:AddMethod( "lIntArtInf", @TInfGen_lIntArtInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefPrvInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllPrv); oClass:AddMethod( "oDefPrvInf", @TInfGen_oDefPrvInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lDefFamInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllFam); oClass:AddMethod( "lDefFamInf", @TInfGen_lDefFamInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefTipInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllTip); oClass:AddMethod( "oDefTipInf", @TInfGen_oDefTipInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefCliInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, oDbfCli); oClass:AddMethod( "oDefCliInf", @TInfGen_oDefCliInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefTmpInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllArt); oClass:AddMethod( "oDefTmpInf", @TInfGen_oDefTmpInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefFabInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllFab); oClass:AddMethod( "oDefFabInf", @TInfGen_oDefFabInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddTemporada( cCodTmp, oDbfTmp); oClass:AddMethod( "AddTemporada", @TInfGen_AddTemporada(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefObrInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllObr); oClass:AddMethod( "oDefObrInf", @TInfGen_oDefObrInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefTurInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, oDbfArt); oClass:AddMethod( "oDefTurInf", @TInfGen_oDefTurInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefGrfInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllGrp); oClass:AddMethod( "oDefGrfInf", @TInfGen_oDefGrfInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefFpgInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllFpg); oClass:AddMethod( "oDefFpgInf", @TInfGen_oDefFpgInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefGrpCli( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAll, oDlg); oClass:AddMethod( "oDefGrpCli", @TInfGen_oDefGrpCli(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefGrpPrv( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAll, oDlg); oClass:AddMethod( "oDefGrpPrv", @TInfGen_oDefGrpPrv(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefTipActInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllAct); oClass:AddMethod( "oDefTipActInf", @TInfGen_oDefTipActInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefMetInf( nId); oClass:AddMethod( "oDefMetInf", @TInfGen_oDefMetInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefSerInf(); oClass:AddMethod( "oDefSerInf", @TInfGen_oDefSerInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefExcInf( nId); oClass:AddMethod( "oDefExcInf", @TInfGen_oDefExcInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefExcImp( nId); oClass:AddMethod( "oDefExcImp", @TInfGen_oDefExcImp(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefSalInf( nId); oClass:AddMethod( "oDefSalInf", @TInfGen_oDefSalInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefResInf( nId); oClass:AddMethod( "oDefResInf", @TInfGen_oDefResInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefEmpInf( nIdOrg, nIdSayOrg, oDlg); oClass:AddMethod( "oDefEmpInf", @TInfGen_oDefEmpInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CreateColumn(); oClass:AddMethod( "CreateColumn", @TInfGen_CreateColumn(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER OpenFiles() ; oClass:AddVirtual( "OpenFiles" )

   _HB_MEMBER CloseFiles() ; oClass:AddVirtual( "CloseFiles" )

   _HB_MEMBER End(); oClass:AddMethod( "End", @TInfGen_End(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lLoadDivisa(); oClass:AddMethod( "lLoadDivisa", @TInfGen_lLoadDivisa(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Destroy() ; oClass:AddVirtual( "Destroy" )

   _HB_MEMBER PutOriginal(); oClass:AddMethod( "PutOriginal", @TInfGen_PutOriginal(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER PrnTiket(); oClass:AddMethod( "PrnTiket", @TInfGen_PrnTiket(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FldCliente(); oClass:AddMethod( "FldCliente", @TInfGen_FldCliente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FldPropiedades(); oClass:AddMethod( "FldPropiedades", @TInfGen_FldPropiedades(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddArticulo(); oClass:AddMethod( "AddArticulo", @TInfGen_AddArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FldArticulo( lVisible, lPropiedades, lLote); oClass:AddMethod( "FldArticulo", @TInfGen_FldArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FldDiario(); oClass:AddMethod( "FldDiario", @TInfGen_FldDiario(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FldDiaPrv(); oClass:AddMethod( "FldDiaPrv", @TInfGen_FldDiaPrv(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CreateFldAnu(); oClass:AddMethod( "CreateFldAnu", @TInfGen_CreateFldAnu(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER GrupoAnuCreateFld(); oClass:AddMethod( "GrupoAnuCreateFld", @TInfGen_GrupoAnuCreateFld(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FamAnuCreateFld(); oClass:AddMethod( "FamAnuCreateFld", @TInfGen_FamAnuCreateFld(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER TipAnuCreateFld(); oClass:AddMethod( "TipAnuCreateFld", @TInfGen_TipAnuCreateFld(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ArtAnuCreateFld(); oClass:AddMethod( "ArtAnuCreateFld", @TInfGen_ArtAnuCreateFld(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CliAnuCreateFld(); oClass:AddMethod( "CliAnuCreateFld", @TInfGen_CliAnuCreateFld(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AgeAnuCreateFld(); oClass:AddMethod( "AgeAnuCreateFld", @TInfGen_AgeAnuCreateFld(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CreateFldRut(); oClass:AddMethod( "CreateFldRut", @TInfGen_CreateFldRut(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddCliente( cCodCli, oDbfDocT, lTiket); oClass:AddMethod( "AddCliente", @TInfGen_AddCliente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FldProveedor(); oClass:AddMethod( "FldProveedor", @TInfGen_FldProveedor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddProveedor( cCodPrv); oClass:AddMethod( "AddProveedor", @TInfGen_AddProveedor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AcuPesVol( cCodArt, nTotUni, nImporte); oClass:AddMethod( "AcuPesVol", @TInfGen_AcuPesVol(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Grafico(); oClass:AddMethod( "Grafico", @TInfGen_Grafico(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Xml(); oClass:AddMethod( "Xml", @TInfGen_Xml(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddImporte( dFecDoc, nImpDoc); oClass:AddMethod( "AddImporte", @TInfGen_AddImporte(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER nMediaMes( nAnno); oClass:AddMethod( "nMediaMes", @TInfGen_nMediaMes(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetMetInf( oDbf); oClass:AddMethod( "SetMetInf", @TInfGen_SetMetInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER RefMetInf( nPos); oClass:AddMethod( "RefMetInf", @TInfGen_RefMetInf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER OpenData(); oClass:AddMethod( "OpenData", @TInfGen_OpenData(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CloseData(); oClass:AddMethod( "CloseData", @TInfGen_CloseData(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SyncAllDbf(); oClass:AddMethod( "SyncAllDbf", @TInfGen_SyncAllDbf(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CreateFilter( aTField, oDbf); oClass:AddMethod( "CreateFilter", @TInfGen_CreateFilter(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER DlgFilter(); oClass:AddInline( "DlgFilter", {|Self | ( ( Self ) ), ( if( !Empty( ::oFilter ), ::oFilter:Dialog(), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER EvalFilter( oDbf); oClass:AddMethod( "EvalFilter", @TInfGen_EvalFilter(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )



   _HB_MEMBER AplyFilter(); oClass:AddInline( "AplyFilter", {|Self, oDbf | ( ( Self ) ), ( if(   !Empty( ::oFilter ) .AND. !Empty( ::oFilter:cExpresionFilter ), ::oDbf:SetFilter( ::oFilter:cExpresionFilter ), ::oDbf:SetFilter() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDefDesHas(); oClass:AddMethod( "oDefDesHas", @TInfGen_oDefDesHas(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER MakeVisor(); oClass:AddMethod( "MakeVisor", @TInfGen_MakeVisor(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER GenReport( nOption); oClass:AddMethod( "GenReport", @TInfGen_GenReport(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lValArt(); oClass:AddInline( "lValArt", {|Self, cRef | ( ( Self ) ), ( cRef >= ::cArtOrg .AND. cRef <= ::cArtDes ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lValFam(); oClass:AddInline( "lValFam", {|Self, cFam | ( ( Self ) ), ( cFam >= ::cFamOrg .AND. cFam <= ::cFamDes  ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lValGrpFam(); oClass:AddInline( "lValGrpFam", {|Self, cGrpFam | ( ( Self ) ), ( cGrpFam >= ::cGrpFamOrg .AND. cGrpFam <= ::cGrpFamDes ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Shadows(); oClass:AddMethod( "Shadows", @TInfGen_Shadows(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER nTotAlbPrv( cCodArt); oClass:AddMethod( "nTotAlbPrv", @TInfGen_nTotAlbPrv(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER nTotFacPrv( cCodArt); oClass:AddMethod( "nTotFacPrv", @TInfGen_nTotFacPrv(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER nTotAlbCli( cCodArt); oClass:AddMethod( "nTotAlbCli", @TInfGen_nTotAlbCli(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER nTotFacCli( cCodArt); oClass:AddMethod( "nTotFacCli", @TInfGen_nTotFacCli(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER nTotTikCli( cCodArt); oClass:AddMethod( "nTotTikCli", @TInfGen_nTotTikCli(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER nStkTotal( cCodArt); oClass:AddMethod( "nStkTotal", @TInfGen_nStkTotal(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddSelectedGroup(); oClass:AddMethod( "AddSelectedGroup", @TInfGen_AddSelectedGroup(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER DelSelectedGroup(); oClass:AddMethod( "DelSelectedGroup", @TInfGen_DelSelectedGroup(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER UpSelectedGroup(); oClass:AddMethod( "UpSelectedGroup", @TInfGen_UpSelectedGroup(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER DownSelectedGroup(); oClass:AddMethod( "DownSelectedGroup", @TInfGen_DownSelectedGroup(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER ReLoadGroup(); oClass:AddMethod( "ReLoadGroup", @TInfGen_ReLoadGroup(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CreaGrupos(); oClass:AddMethod( "CreaGrupos", @TInfGen_CreaGrupos(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER BtnDefectoGrupo(); oClass:AddMethod( "BtnDefectoGrupo", @TInfGen_BtnDefectoGrupo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lSeekInAcumulado( cExpresion); oClass:AddMethod( "lSeekInAcumulado", @TInfGen_lSeekInAcumulado(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SetValorGrupo( cNombre, cValor); oClass:AddMethod( "SetValorGrupo", @TInfGen_SetValorGrupo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDbfOrdSetFocus(); oClass:AddInline( "oDbfOrdSetFocus", {|Self, cTag | ( ( Self ) ), ( ::oDbf:OrdSetFocus( cTag ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oDbfSetFilter(); oClass:AddInline( "oDbfSetFilter", {|Self, cExp | ( ( Self ) ), ( ( ::oDbf:nArea )->( dbsetfilter( c2Block( cExp ), cExp ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oTiketSetFilter(); oClass:AddInline( "oTiketSetFilter", {|Self, cExp | ( ( Self ) ), ( ( ::oTikCliT:nArea )->( dbsetfilter( c2Block( cExp ), cExp ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER oTiketQuitFilter(); oClass:AddInline( "oTiketQuitFilter", {|Self | ( ( Self ) ), ( ( ::oTikCliT:nArea )->( dbclearfilter() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oTiketLineaSetFilter(); oClass:AddInline( "oTiketLineaSetFilter", {|Self, cExp | ( ( Self ) ), ( ( ::oTikCliL:nArea )->( dbsetfilter( c2Block( cExp ), cExp ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER oTiketLineaQuitFilter(); oClass:AddInline( "oTiketLineaQuitFilter", {|Self | ( ( Self ) ), ( ( ::oTikCliL:nArea )->( dbclearfilter() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TInfGen ;



static FUNCTION TInfGen_New( cSubTitle, aFields, aIndex, oMenuItem, oWnd, cHelp, xOthers ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local n
   local nLevel
   local cFileObject := substr( strtran( alltrim( str( seconds() ) ), ".", "" ), -6 )

   If( cSubTitle == nil, cSubTitle := Padr( "Generador de informes", 50 ), ) ;
   If( aFields == nil, aFields := {}, ) ;
   If( aIndex == nil, aIndex := {}, ) ;
   If( oMenuItem == nil, oMenuItem := "00000", ) ;
   If( oWnd == nil, oWnd := oWnd(), ) ;
   If( cHelp == nil, cHelp := "", ) ;

   ::cSubTitle       := cSubTitle
   ::aFields         := aFields
   ::cHelp           := cHelp
   ::aHeader         := { {|| Padr( "Fecha", 13 ) + ": " + Dtoc( Date() ) + " - " + Time() } }
   ::aFooter         := { {|| "Página : " + str( ::oReport:nPage, 3 ) } }
   ::aIndex          := aEval( aIndex, {|a| aSize( a, 6 ) } )
   ::cTitle          := Padr( cCodEmp() + " - " + cNbrEmp(), 100 )
   ::cFooter         := Space( 100 )
   ::cDivInf         := cDivEmp()
   ::xOthers         := xOthers

   ::bStartGroup     := {|oGrp| ::oReport:NewLine() }
   ::bEndGroup       := {|| .T. }
   ::bPostGroup      := {|| .T. }

   ::aSelectionGroup := {}
   ::aSelectionRango := {}





   ::aoCols                   := {}
   ::aoGroup                  := {}
   ::aInitGroup               := {}
   ::aSelectedGroup           := {}
   ::oDbf                     := nil
   ::oDbfAlm                  := nil
   ::oDbfAlmacenOrigen        := nil
   ::oDbfAge                  := nil
   ::oDbfArt                  := nil
   ::oDbfArticuloMateriaPrima := nil
   ::lDefGraph                := .F.
   ::lExcCero                 := .T.





   ::cCmbReport      := "Visualizar"
   ::aCmbReport      := {}
   ::aBmpReport      := {}

   aAdd( ::aCmbReport, "Visualizar" )
   aAdd( ::aBmpReport, "PREV116"    )

   aAdd( ::aCmbReport, "Imprimir"   )
   aAdd( ::aBmpReport, "gc_printer2_16"  )

   aAdd( ::aCmbReport, "Excel"      )
   aAdd( ::aBmpReport, "TABLE"      )

   aAdd( ::aCmbReport, "HTML"       )
   aAdd( ::aBmpReport, "gc_earth_16"   )

   aAdd( ::aCmbReport, "Adobe PDF"  )
   aAdd( ::aBmpReport, "DOCLOCK"    )

   ::cCmbReport            := "Visualizar"

   ::oTFastReportOptions   := TFastreportOptions():New()





   ::cFileName             := cGetNewFileName( cPatTmp() + trimedSeconds(), "Dbf", .T. )
   ::cFileIndx             := cGetNewFileName( cPatTmp() + trimedSeconds(), "Cdx", .T. )

   if file( ::cFileName )
      fErase( ::cFileName )
   end

   if file( ::cFileIndx )
      fErase( ::cFileIndx )
   end

   ::oDbf                  := TDbf():New( ::cFileName, "InfMov", ( cLocalDriver() ), , ( cPatTmp() ) )

   for n := 1 to len( aFields )

      if len( aFields[n] ) < 10
         aSize( aFields[n], 10 )
      end











      ::oDbf:AddField(     aFields[ n, 1 ], aFields[ n, 2 ], aFields[ n, 3 ], aFields[ n, 4 ], aFields[ n, 5 ], aFields[ n, 7 ], nil, nil, aFields[ n, 6 ], aFields[ n, 8 ], if( aFields[ n, 9 ] == nil, aFields[ n, 3 ] + aFields[ n, 4 ], aFields[ n, 9 ] ) )

   next





   ::nBmp               := LoadBitmap( 0, 32760 )





   ::lOpenFiles         := ::OpenFiles()

   if ValType( ::lOpenFiles ) <> "L"
      ::lOpenFiles      := .T.
   end

   setFastReportObject( self )

RETURN Self



static FUNCTION TInfGen_End( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   if ::lSave2Exit .AND. ::lOpenFiles
      ::Save()
   end

   if ::oDbfDiv <> nil .AND. ::oDbfDiv:Used()
      ::oDbfDiv:end()
   end

   if ::oBmpDiv <> nil
      ::oBmpDiv:end()
   end

   if ::oBandera <> nil
      ::oBandera:end()
   end

   ::CloseData()





   ::CloseFiles()

   if ::oDbfArt <> nil .AND. ::oDbfArt:Used()
      ::oDbfArt:End()
   end

   if ::oDbfArticuloMateriaPrima <> nil .AND. ::oDbfArticuloMateriaPrima:Used()
      ::oDbfArticuloMateriaPrima:End()
   end

   if ::oDbfAlm <> nil .AND. ::oDbfAlm:Used()
      ::oDbfAlm:End()
   end

   if ::oDbfAlmacenOrigen <> nil .AND. ::oDbfAlmacenOrigen:Used()
      ::oDbfAlmacenOrigen:End()
   end

   if ::oDbfAge <> nil .AND. ::oDbfAge:Used()
      ::oDbfAge:End()
   end

   if ::oDbfFam <> nil .AND. ::oDbfFam:Used()
      ::oDbfFam:End()
   end

   if ::oDbfCat <> nil .AND. ::oDbfCat:Used()
      ::oDbfCat:End()
   end

   if ::oDbfEstArt <> nil .AND. ::oDbfEstArt:Used()
      ::oDbfEstArt:End()
   end

   if ::oDbfPrv <> nil .AND. ::oDbfPrv:Used()
      ::oDbfPrv:End()
   end

   if ::oDbfCli <> nil .AND. ::oDbfCli:Used()
      ::oDbfCli:End()
   end

   if ::oDbfTmp <> nil .AND. ::oDbfTmp:Used()
      ::oDbfTmp:End()
   end

   if ::oDbfCat <> nil .AND. ::oDbfCat:Used()
      ::oDbfCat:End()
   end

   if ::oDbfRemCli <> nil .AND. ::oDbfRemCli:Used()
      ::oDbfRemCli:End()
   end

   if ::oDbfEmp <> nil .AND. ::oDbfEmp:Used()
      ::oDbfEmp:End()
   end

   if ::oGruFam <> nil
      ::oGruFam:End()
   end

   if ::oDbfFpg <> nil .AND. ::oDbfFpg:Used()
      ::oDbfFpg:End()
   end

   if ::oDbfTur <> nil .AND. ::oDbfTur:Used()
      ::oDbfTur:End()
   end

   if ::oTipArt <> nil
      ::oTipArt:End()
   end

   if ::oDbfFab <> nil
      ::oDbfFab:End()
   end

   if ::oGrpCli <> nil
      ::oGrpCli:End()
      ::oGrpCli := nil
   end

   if ::oGrpPrv <> nil
      ::oGrpPrv:End()
   end

   if ::oDbfTrn <> nil
      ::oDbfTrn:End()
   end

   if ::oSeccion <> nil
      ::oSeccion:End()
   end

   if ::oOperacion <> nil
      ::oOperacion:End()
   end

   if ::oDbf <> nil .AND. ::oDbf:Used()
      ::oDbf:Zap()
      ::oDbf:End()
   end

   ::oDbf      := nil





   if file( ::cFileName )
      fErase( ::cFileName )
   end

   if file( ::cFileIndx )
      fErase( ::cFileIndx )
   end

   if !Empty( ::nBmp )
      DeleteObject( ::nBmp )
   end

   if !Empty( ::oBmpImagen )
      ::oBmpImagen:End()
   end

   if !Empty( ::oDlg )
      ::oDlg:End()
   end

   Self        := nil

Return .T.



static FUNCTION TInfGen_StdResource( cFldRes ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local n
   local oCellView
   local oImagen
   local oShadow
   local aoFont      := { , , }
   local aoSizes     := { , , }
   local aoEstilo    := { , , }
   local aSizes      := { "8", "10", "12", "14", "16", "18", "20", "22", "24", "26", "28", "36", "48", "72" }
   local aEstilo     := { "Normal", "Cursiva", "Negrita", "Negrita Cursiva" }
   local aPad        := { "Izquierda", "Derecha" }
   local oPrinter

   If( cFldRes == nil, cFldRes := "INF_GEN01", ) ;





   if !::OpenData()
      Return .F.
   end





   ::oDbf:Activate( .F., .F. )





   for n := 1 to len( ::aIndex )












      ::oDbf:AddTmpIndex(  ::aIndex[n,1], ::cFileIndx, ::aIndex[n,2], ::aIndex[n,3], ::aIndex[n,4], ::aIndex[n,5], ::aIndex[n,6], , , , , .T. )
   next





   if !::lBig
      ::oDlg = TDialog():New(,,,, ::cSubTitle, "INF_GEN",, .F.,,,,,, .F.,,,,,, .F.,, "::oDlg", nil, )
   else
      ::oDlg = TDialog():New(,,,, ::cSubTitle, "INF_GENBIG",, .F.,,,,,, .F.,,,,,, .F.,, "::oDlg", nil, )
   end






   if !::lNewInforme
      ::oFld := TFolder():ReDefine( 400, {"I&nforme", "&Columnas", "A&pariencia" }, { cFldRes, "INF_GEN_COL", "INF_GEN_PRN" }, ::oDlg )
   else
      ::oFld := TFolder():ReDefine( 400, {"I&nforme", "A&grupar...", "&Columnas", "A&pariencia" }, { cFldRes, "INF_GEN_AGRUPA", "INF_GEN_COL", "INF_GEN_PRN" }, ::oDlg )
   end





   ::CreateColumn()





   ::Default()





   if ::lDefDesHas
      ::oDefDesHas()
   end





   if ::lDefFecInf
      ::oDefIniInf()
      ::oDefFinInf()
   end





   if ::lDefDivInf
      ::oDefDivInf()
   end





   if ::lDefTitInf
      ::oDefTitInf()
   end





   if ::lDefMetInf
      ::oDefMetInf()
   end





   if ::lDefSerInf
      ::oDefSerInf()
   end





   if ::lNewInforme

   ::oTreeGroups           := TTreeView():Redefine( 100, ::oFld:aDialogs[2]  )
   ::oTreeGroups:bLDblClick:= {|| ::AddSelectedGroup() }

   ::oTreeSelectedGroups   := TTreeView():Redefine( 110, ::oFld:aDialogs[2]  )




   TButton():ReDefine( 120, {||( ::AddSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 130, {||( ::DelSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 140, {||( ::UpSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 150, {||( ::DownSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 160, {||( ::BtnDefectoGrupo() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )

   end





   ::oBrwCol                        := IXBrowse():New( if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ) )

   ::oBrwCol:bClrSel                := {|| { 0, ( 229 + ( 229 * 256 ) + ( 229 * 65536 ) ) } }
   ::oBrwCol:bClrSelFocus           := {|| { 0, ( 167 + ( 205 * 256 ) + ( 240 * 65536 ) ) } }

   ::oBrwCol:SetArray( ::aoCols, , , .F. )

   ::oBrwCol:nMarqueeStyle          := 6
   ::oBrwCol:cName                  := "GaleriaInformeColumnas"
   ::oBrwCol:lHScroll               := .F.
   ::oBrwCol:lRecordSelector        := .F.
   ::oBrwCol:lFooter                := .T.

   ::oBrwCol:bLDblClick := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lEditCol(), ::oBrwCol:Refresh() }
   ::oBrwCol:bRClicked  := {| nRow, nCol | ::oBrwCol:LButtonDown( nRow, nCol ), ::aoCols[ ::oBrwCol:nArrayAt ]:Toogle(), ::oBrwCol:Refresh() }

   ::oBrwCol:CreateFromResource( 200 )

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Se."
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lSelect }
      :nWidth           := 24
      :SetCheck( { "Sel16", "Nil16" } )
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Columna"
      :bStrData         := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:cDescrip }
      :nWidth           := 140
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Título"
      :bStrData         := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:cTitle }
      :nWidth           := 140
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Alineación"
      :bStrData         := {|| aPad[ Max( ::aoCols[ ::oBrwCol:nArrayAt ]:nPad, 1 ) ] }
      :nWidth           := 70
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "To.Totalizada"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lTotal }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Sp.Separación"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lSeparador }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "So.Sombra"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lSombra }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end




   TButton():ReDefine( 538, {||::UpColumn()}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 539, {||::DwColumn()}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 514, {||( ::aoCols[ ::oBrwCol:nArrayAt ]:Select(), ::oBrwCol:SetFocus(), ::oBrwCol:Refresh() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 540, {||( ::aoCols[ ::oBrwCol:nArrayAt ]:UnSelect(), ::oBrwCol:SetFocus(), ::oBrwCol:Refresh() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 501, {||( ::aoCols[ ::oBrwCol:nArrayAt ]:lEditCol(), ::oBrwCol:Refresh() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   ::oBtnOriginal := TButton():ReDefine( 517, {||( ::PutOriginal() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )








   aoFont[1] := TComboBox():ReDefine( 210, { | u | If( PCount()==0, ::acFont[1], ::acFont[1]:= u ) }, ::aFont, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoFont[1]",,,,,,, )




   aoSizes[1] := TComboBox():ReDefine( 220, { | u | If( PCount()==0, ::acSizes[1], ::acSizes[1]:= u ) }, aSizes, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoSizes[1]",,,,,,, )




   aoEstilo[1] := TComboBox():ReDefine( 230, { | u | If( PCount()==0, ::acEstilo[1], ::acEstilo[1]:= u ) }, aEstilo, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoEstilo[1]",,,,,,, )




   aoFont[2] := TComboBox():ReDefine( 240, { | u | If( PCount()==0, ::acFont[2], ::acFont[2]:= u ) }, ::aFont, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoFont[2]",,,,,,, )




   aoSizes[2] := TComboBox():ReDefine( 250, { | u | If( PCount()==0, ::acSizes[2], ::acSizes[2]:= u ) }, aSizes, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoSizes[2]",,,,,,, )




   aoEstilo[2] := TComboBox():ReDefine( 260, { | u | If( PCount()==0, ::acEstilo[2], ::acEstilo[2]:= u ) }, aEstilo, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoEstilo[2]",,,,,,, )




   aoFont[3] := TComboBox():ReDefine( 270, { | u | If( PCount()==0, ::acFont[3], ::acFont[3]:= u ) }, ::aFont, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoFont[3]",,,,,,, )




   aoSizes[3] := TComboBox():ReDefine( 280, { | u | If( PCount()==0, ::acSizes[3], ::acSizes[3]:= u ) }, aSizes, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoSizes[3]",,,,,,, )




   aoEstilo[3] := TComboBox():ReDefine( 290, { | u | If( PCount()==0, ::acEstilo[3], ::acEstilo[3]:= u ) }, aEstilo, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "aoEstilo[3]",,,,,,, )



   oCellView := TCheckBox():ReDefine( 300, { | u | If( PCount()==0, ::lCellView, ::lCellView:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,, .F. )



   oShadow := TCheckBox():ReDefine( 310, { | u | If( PCount()==0, ::lShadow, ::lShadow:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,, .F. )





   TGetHlp():ReDefine( 320, { | u | If( PCount()==0, ::nLenPage, ::nLenPage:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 330, { | u | If( PCount()==0, ::nWidthPage, ::nWidthPage:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )




   ::oOrientation := TComboBox():ReDefine( ( 420), { | u | If( PCount()==0, ::cOrientation, ::cOrientation:= u ) }, ::aOrientation, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,,, "::oOrientation",,,,,,, )







   oImagen := TGetHlp():ReDefine( 340, { | u | If( PCount()==0, ::cImagen, ::cImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,,,, .F.,,, .F., .F.,,,,,, nil,,, )

   oImagen:cBmp   := "Folder"
   oImagen:bHelp  := {|| oImagen:cText( cGetFile( "*.bmp", "Selección de imagen" ) ), oImagen:lValid() }
   oImagen:bValid := {|| if( !Empty( Rtrim( ::cImagen ) ), ::oBmpImagen:LoadBmp( Rtrim( ::cImagen ) ), ), .T. }




   ::oBmpImagen := TBitmap():ReDefine( 400,, ::cImagen, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,, .F., .F.,,, .F.,,, .F. )





   TGetHlp():ReDefine( 360, { | u | If( PCount()==0, ::nFilaImagen, ::nFilaImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 370, { | u | If( PCount()==0, ::nColumnaImagen, ::nColumnaImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 380, { | u | If( PCount()==0, ::nAnchoImagen, ::nAnchoImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 390, { | u | If( PCount()==0, ::nAltoImagen, ::nAltoImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )








   oPrinter := TGetHlp():ReDefine( 350, { | u | If( PCount()==0, ::cPrinter, ::cPrinter:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,,,, .F., {||     ( .F. )},, .F., .F.,,,,,, nil,,, )

   TBtnBmp():ReDefine( 351, "gc_printer2_check_16",,,,,{|| PrinterPreferences( oPrinter ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ), .F., , .F.,  )







   TGetHlp():ReDefine( 410, { | u | If( PCount()==0, ::cFooter, ::cFooter:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,,,, .F.,,, .F., .F.,,,,,, nil,,, )








   ::oBtnFilter := TButton():ReDefine( 510, {||( ::DlgFilter(), if( !Empty( ::oFilter:bExpresionFilter ), SetWindowText( ::oBtnFilter:hWnd, "Filtro activo" ), SetWindowText( ::oBtnFilter:hWnd, "Filtrar" ) ) )}, ::oDlg,,, .F.,,,, .F. )


























   ::oBtnAction := TButton():ReDefine( 560, {||( ::GenReport() )}, ::oDlg,,, .F.,,,, .F. )






   ::oCmbReport := TComboBox():ReDefine( 600, { | u | If( PCount()==0, ::cCmbReport, ::cCmbReport:= u ) }, ::aCmbReport, ::oDlg,,,,,,, .F.,, ::aBmpReport,,,,, "::oCmbReport",,,,,,, )





   ::oBtnCancel := TButton():ReDefine( 570, {||( ::lBreak := .T., ::End() )}, ::oDlg,,, .F.,,,, .T. )

RETURN .T.



static FUNCTION TInfGen_Activate( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local lActivate

   if !Empty( ::oTreeGroups )
      ::oFld:aDialogs[2]:AddFastKey( 113, {|| ::AddSelectedGroup() } )
      ::oFld:aDialogs[2]:AddFastKey( 115, {|| ::DelSelectedGroup() } )
   end

   if !Empty( ::oDlg )

      ::oDlg:AddFastKey( 116, {|| ::GenReport() } )

      if ::lNewInforme
         ::oDlg:bStart  := {|| ::InitDialog(), ::lRecargaFecha() }
      else
         ::oDlg:bStart  := {|| ::oBrwCol:Load() }
      end

      ::oDlg:Activate( , , , .T. )

      lActivate         := ( ::oDlg:nResult == 1 )

   end

RETURN ( lActivate )



Static Function lRetFld( uSearch, Alias, oSay, nFld )

   local lReturn  := .T.

   If( nFld == nil, nFld := 2, ) ;

   if valtype( uSearch ) == "C"
      uSearch     := Upper( uSearch )
   end

   if ( Alias )->( dbSeek( uSearch ) )
      oSay:cText( ( Alias )->( fieldGet( nFld ) ) )
   else
      msgStop( "Registro no encontrado" )
      lReturn     := .F.
   end

Return lReturn






static FUNCTION TInfGen_Print( nDevice ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local n
   local nFor
   local oCol
   local aFnt     := {}
   local oRptWnd
   local oDevice

   ::oDbf:GoTop()

   for n := 1 to len( ::acFont )
      aAdd( aFnt, TFont():New( Rtrim( ::acFont[ n ] ), 0, Val( ::acSizes[ n ] ),,( "Negrita" $ ::acEstilo[ n ] ),,,,( "Cursiva" $ ::acEstilo[ n ] ),,,,,,, ) )
   next

   if !Empty( ::oFilter ) .AND. !Empty( ::oFilter:cExpresionFilter )
      aAdd( ::aHeader, {|| Padr( "Filtro", 13 ) + ": " + cValToChar( ::oFilter:cExpresionFilter ) } )
   end

   if !Empty( ::cFooter )
      aSize( ::aFooter, Len( ::aFooter ) + 1 )
      aIns( ::aFooter, 1 )
      ::aFooter[ 1 ]    := {|| RTrim( ::cFooter ) }
   end

   do case
   case nDevice == 1






















      ::oReport   := RptBegin({ {|| Rtrim( ::cTitle ) }, {|| Rtrim( ::cAliasTitle ) } }, ::aHeader , ::aFooter, aFnt, {}, .F., nil, nil, .F., .T., nil, oDevice, Rtrim( ::cTitle ), "CENTERED", "LEFT", "CENTERED" )

   case nDevice == 2




















      ::oReport   := RptBegin({ {|| Rtrim( ::cTitle ) }, {|| Rtrim( ::cAliasTitle ) } }, ::aHeader , ::aFooter, aFnt, {}, .F., nil, nil, .T., .F., nil, oDevice, Rtrim( ::cTitle ), "CENTERED", "LEFT", "CENTERED" )

   case nDevice == 5
















      ::oReport   := RptBegin({ {|| Rtrim( ::cTitle ) }, {|| Rtrim( ::cAliasTitle ) } }, ::aHeader , ::aFooter, aFnt, {}, .F., nil, nil, .F., .T., nil, oDevice, Rtrim( ::cTitle ), "CENTERED", "LEFT", "CENTERED" )

   case nDevice == 3

      oRptWnd = TDialog():New(,,,, Rtrim( ::cTitle ), "PREVIEW_PROC",, .F.,,,,,, .F.,,,,,, .F.,, "oRptWnd", nil, )





      TButton():ReDefine( 2, {||( ::lBreak := .T. )}, oRptWnd,,, .F., {||     ( !::lNoCancel )},,, .F. )

      oRptWnd:bStart := {|| ::Xml(), oRptWnd:End()}

      oRptWnd:Activate( oRptWnd:bLClicked, oRptWnd:bMoved, oRptWnd:bPainted, .T.,,,, oRptWnd:bRClicked,,, )

      GoWeb( cPatTmp() + "Report.Xls" )

   case nDevice == 4

      oDevice     := TRCcs():New( cPatHtml() + "Rep" )
















      ::oReport   := RptBegin({ {|| Rtrim( ::cTitle ) }, {|| Rtrim( ::cAliasTitle ) } }, ::aHeader , ::aFooter, aFnt, {}, .F., nil, nil, .F., .F., nil, oDevice, Rtrim( ::cTitle ), "CENTERED", "LEFT", "CENTERED" )

   end

   if ( nDevice <> 3 )

      for nFor := 1 to len( ::aoCols )

         if ::aoCols[ nFor ] <> nil .AND. ::aoCols[ nFor ]:lSelect












            oCol  := RptAddColumn(  { bHeaders( nFor, Self ) } , , { bFlds( nFor, Self ) } , ::aoCols[ nFor ]:nSize , { cPicture( nFor, Self ) } , ::aoCols[ nFor ]:bFont , ::aoCols[ nFor ]:lTotal , nil , nil , ::aoCols[ nFor ]:lSombra , ::aoCols[ nFor ]:lSeparador , nil )

            if ::aoCols[ nFor ]:Cargo <> nil
               oCol:Cargo  := ::aoCols[ nFor ]:Cargo
            end

         end

      next

      if !::lNoGroup

         for nFor := 1 to len( ::aoGroup )





            RptAddGroup( ::aoGroup[ nFor ]:bGroup, ::aoGroup[ nFor ]:bHeader, ::aoGroup[ nFor ]:bFooter, ::aoGroup[ nFor ]:bHeadFont, ::aoGroup[ nFor ]:lEject )
         next

      end

      RptEnd()

      if !Empty( ::oReport ) .AND. ::oReport:lCreated

         ::oReport:SetTxtColor( 16711680, 3 )

         ::oReport:Margin( 0, 2, 2)
         ::oReport:Margin( 0, 1, 2)

         ::oReport:lSummary         := if( ::lResumen <> nil, ::lResumen, .F. )
         ::oReport:bSkip            := {|| ::oDbf:Skip( 1 ) }

         if !Empty( ::nWidthPage ) .AND. !Empty( ::nLenPage )
            ::oReport:oDevice:SetSize( ::nLenPage * 100, ::nWidthPage * 100 )
         end

         ::oReport:oDevice:lPrvModal   := .T.

         do case
            case ::oOrientation:nAt == 1
               ::oReport:lAutoLand  := .T.
               ::oReport:lIsNarrow  := .F.

            case ::oOrientation:nAt == 2
               ::oReport:lAutoLand  := .F.
               ::oReport:lIsNarrow  := .F.

            case ::oOrientation:nAt == 3
               ::oReport:lAutoLand  := .F.
               ::oReport:lIsNarrow  := .T.

         end

         if ::lShadow
            ::oReport:lShadow       := .T.
            ::oReport:bStartRecord  := {|| ::Shadows() }
            ::oReport:bEndRecord    := {|| ( aEval( ::oReport:aColumns, {|o| o:lShadow  := .F. } ) ) }
         end

         if !Empty( ::cImagen )
            ::oReport:bStartPage    := {|| ::oReport:SayBitmap( ::nFilaImagen, ::nColumnaImagen, Rtrim( ::cImagen ), ::nAnchoImagen, ::nAltoImagen, 2 ) }
         end

         if ::lCellView
            ::oReport:CellView()
         end

      end

      if !Empty( ::oReport )
         ::oReport:Activate( ::bForReport, {|| !::oDbf:eof() }, , , , , ::bStartGroup, ::bEndGroup, , , , , , ::bPostGroup )
      end

   end

   aEval( aFnt, {|oFnt| oFnt:end() } )



   if nDevice == 4
      ::MakeVisor()
   end

RETURN NIL



static FUNCTION TInfGen_Shadows( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local n
   local lValor   := !::lShadowLine

   for n := 1 to Len( ::oReport:aColumns )
      ::oReport:aColumns[ n ]:lShadow  := lValor
   next

   ::lShadowLine  := lValor

RETURN NIL



static function bHeaders( nFor, Self )

return {|| ::aoCols[ nFor ]:cTitle }



static function bFlds( nFor, Self )

return ( ::aoCols[ nFor ]:bFld )



static function cPicture( nFor, Self )

   if valType( ::aoCols[ nFor ]:bPict ) == "C"
      return ::aoCols[ nFor ]:bPict
   end

return ( Eval( ::aoCols[ nFor ]:bPict ) )



static FUNCTION TInfGen_UpColumn( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nPos  := ::oBrwCol:nArrayAt

   if nPos <= len( ::aoCols ) .AND. nPos > 1

      SwapUpArray( ::aoCols, nPos )

      ::oBrwCol:GoUp()
      ::oBrwCol:Refresh()
      ::oBrwCol:SetFocus()

   end

return nil



static FUNCTION TInfGen_DwColumn( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nPos  := ::oBrwCol:nArrayAt

   if nPos < len( ::aoCols ) .AND. nPos > 0

      SwapDwArray( ::aoCols, nPos )

      ::oBrwCol:GoDown()
      ::oBrwCol:Refresh()
      ::oBrwCol:SetFocus()

   end

return nil






static FUNCTION TInfGen_Default( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local n        := 0
   local nPos
   local nCols    := len( ::aoCols )
   local atCols   := Array( nCols )

   ::cSupTitle    := Padr( cCodEmp() + " - " + cNbrEmp(), 50 )





   if ::oDbfInf:Seek( Auth():Codigo() + ::cSubTitle )

      while Rtrim( Auth():Codigo() + ::cSubTitle ) == Rtrim( ::oDbfInf:cCodUse + ::oDbfInf:cNomInf ) .AND. !::oDbfInf:eof()

         ++n

         nPos                       := ::oDbfInf:nPosInf

         if nPos <= nCols .AND. n <= nCols
            atCols[ n ]             := ::aoCols[ nPos ]
            atCols[ n ]:lSelect     := ::oDbfInf:lSelInf
            atCols[ n ]:cTitle      := Rtrim( ::oDbfInf:cTitInf )
            atCols[ n ]:nSize       := ::oDbfInf:nSizInf
            atCols[ n ]:nPad        := if( ::oDbfInf:lAlnInf, 2, 1 )
            atCols[ n ]:lTotal      := ::oDbfInf:lTotInf
            atCols[ n ]:lSombra     := ::oDbfInf:lSomInf
            atCols[ n ]:lSeparador  := ::oDbfInf:lSepInf
         end

         ::oDbfInf:Skip()

      end

      if nCols == n
         ::aoCols                   := atCols
      end

   end





   if ::oDbfFnt:Seek( Auth():Codigo() + ::cSubTitle )
      ::acFont  [ 1 ]            := ::oDbfFnt:cFntIn1
      ::acSizes [ 1 ]            := Str( ::oDbfFnt:nSizIn1, 3 )
      ::acEstilo[ 1 ]            := ::oDbfFnt:cStyIn1
      ::acFont  [ 2 ]            := ::oDbfFnt:cFntIn2
      ::acSizes [ 2 ]            := Str( ::oDbfFnt:nSizIn2, 3 )
      ::acEstilo[ 2 ]            := ::oDbfFnt:cStyIn2
      ::acFont  [ 3 ]            := ::oDbfFnt:cFntIn3
      ::acSizes [ 3 ]            := Str( ::oDbfFnt:nSizIn3, 3 )
      ::acEstilo[ 3 ]            := ::oDbfFnt:cStyIn3
      ::lCellView                := ::oDbfFnt:lCelVie
      ::lShadow                  := ::oDbfFnt:lShadow
      ::nWidthPage               := ::oDbfFnt:nWidPag
      ::nLenPage                 := ::oDbfFnt:nLenPag
      ::cPrinter                 := ImpresoraDefectoUsuario()
      ::cImagen                  := ::oDbfFnt:cImgInf
      ::nFilaImagen              := ::oDbfFnt:nRowImg
      ::nColumnaImagen           := ::oDbfFnt:nColImg
      ::nAnchoImagen             := ::oDbfFnt:nWidImg
      ::nAltoImagen              := ::oDbfFnt:nHeiImg
      ::nCmbReport               := ::oDbfFnt:nDisInf
      ::nOrientation             := ::oDbfFnt:nOrnInf
      ::cAliasTitle              := ::oDbfFnt:cAliInf
   end

   if Empty( ::nCmbReport )
      ::nCmbReport               := 1
   end

   if Empty( ::nOrientation )
      ::nOrientation             := 1
   end

   ::cCmbReport                  := ::aCmbReport[ Min( Max( ::nCmbReport, 1 ), len( ::aCmbReport ) ) ]
   ::cOrientation                := ::aOrientation[ Min( Max( ::nOrientation, 1 ), len( ::aOrientation ) ) ]

   if Empty( ::cAliasTitle )
      ::cAliasTitle              := Padr( ::cSubTitle, 100 )
   else
      ::cAliasTitle              := Padr( ::cAliasTitle, 100 )
   end

Return nil



static FUNCTION TInfGen_Save( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local n
   local nCols
   local cCurUsr        := Auth():Codigo()

   if !Empty( ::oDbfInf ) .AND. ::oDbfInf:Used()

      if !Empty( ::oMtrInf )
         ::oMtrInf:cText   := "Guardando configuración"
      end

      while ::oDbfInf:Seek( cCurUsr + ::cSubTitle )
         ::oDbfInf:Delete( .F. )
      end

      nCols             := len( ::aoCols )

      if !Empty( ::oMtrInf )
         ::oMtrInf:SetTotal( nCols )
      end





      for n := 1 to nCols

         if ::aoCols[ n ] <> nil

            ::oDbfInf:Append()

            ::oDbfInf:cCodUse := cCurUsr
            ::oDbfInf:cNomInf := ::cSubTitle
            ::oDbfInf:lSelInf := ::aoCols[ n ]:lSelect
            ::oDbfInf:cTitInf := ::aoCols[ n ]:cTitle
            ::oDbfInf:nPosInf := ::aoCols[ n ]:nPos
            ::oDbfInf:nSizInf := ::aoCols[ n ]:nSize
            ::oDbfInf:lTotInf := ::aoCols[ n ]:lTotal
            ::oDbfInf:lSomInf := ::aoCols[ n ]:lSombra
            ::oDbfInf:lSepInf := ::aoCols[ n ]:lSeparador
            ::oDbfInf:lAlnInf := ( ::aoCols[ n ]:nPad == 2 )

            ::oDbfInf:Save()

         end

         if !Empty( ::oMtrInf )
            ::oMtrInf:AutoInc( n )
         end

      next

      if !Empty( ::oMtrInf )
         ::oMtrInf:SetTotal( nCols )
      end

   end





   if !Empty( ::oDbfFnt ) .AND. ::oDbfFnt:Used()

      while ::oDbfFnt:Seek( cCurUsr + ::cSubTitle )
         ::oDbfFnt:Delete( .F. )
      end

      ::oDbfFnt:Append()

      ::oDbfFnt:cCodUse := cCurUsr
      ::oDbfFnt:cNomInf := ::cSubTitle
      ::oDbfFnt:cFntIn1 := ::acFont[ 1 ]
      ::oDbfFnt:nSizIn1 := Val( ::acSizes [ 1 ] )
      ::oDbfFnt:cStyIn1 := ::acEstilo[ 1 ]
      ::oDbfFnt:cFntIn2 := ::acFont[ 2 ]
      ::oDbfFnt:nSizIn2 := Val( ::acSizes [ 2 ] )
      ::oDbfFnt:cStyIn2 := ::acEstilo[ 2 ]
      ::oDbfFnt:cFntIn3 := ::acFont[ 3 ]
      ::oDbfFnt:nSizIn3 := Val( ::acSizes [ 3 ] )
      ::oDbfFnt:cStyIn3 := ::acEstilo[ 3 ]
      ::oDbfFnt:lCelVie := ::lCellView
      ::oDbfFnt:lShadow := ::lShadow
      ::oDbfFnt:nWidPag := ::nWidthPage
      ::oDbfFnt:nLenPag := ::nLenPage
      ::oDbfFnt:cImgInf := ::cImagen
      ::oDbfFnt:nRowImg := ::nFilaImagen
      ::oDbfFnt:nColImg := ::nColumnaImagen
      ::oDbfFnt:nWidImg := ::nAnchoImagen
      ::oDbfFnt:nHeiImg := ::nAltoImagen
      ::oDbfFnt:nDisInf := ::oCmbReport:nAt
      ::oDbfFnt:nOrnInf := ::oOrientation:nAt
      ::oDbfFnt:cAliInf := ::cAliasTitle

      ::oDbfFnt:Save()

   end





   if !Empty( ::oDbfGrp ) .AND. ::oDbfGrp:Used()

      while ::oDbfGrp:Seek( cCurUsr + ::cSubTitle )
         ::oDbfGrp:Delete( .F. )
      end

      nCols             := len( ::aSelectedGroup )

      for n := 1 to nCols

         ::oDbfGrp:Append()

         ::oDbfGrp:cCodUse := cCurUsr
         ::oDbfGrp:cNomInf := ::cSubTitle
         ::oDbfGrp:cNomGrp := ::aSelectedGroup[ n ]:Cargo:Nombre

         ::oDbfGrp:Save()

      next

   end

RETURN .T.



static FUNCTION TInfGen_oDefYea( nId ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oGet

   If( nId == nil, nId := 1110, ) ;




   oGet := TGetHlp():ReDefine( nId, { | u | If( PCount()==0, ::nYeaInf, ::nYeaInf:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )

RETURN ( oGet )



static FUNCTION TInfGen_oDefIniInf( nId, oDlg, nIdSay ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen


   local oGroup

   If( nId == nil, nId := 1110, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oIniInf := TGetHlp():ReDefine( nId, { | u | If( PCount()==0, ::dIniInf, ::dIniInf:= u ) }, oDlg,,,,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )

   ::oIniInf:bHelp   := {|| ::oIniInf:cText( Calendario( ::dIniInf ) ) }

   if IsNum( nIdSay )




   ::oIniText := TSay():ReDefine( nIdSay, {||         "Desde"}, oDlg,,,, .F.,, .F., .F., )

   end

   if ::lGrpFecInf

      oGroup         := TRGroup():New( {|| ::oDbf:dFecMov }, {|| "Fecha : " + Dtoc( ::oDbf:dFecMov ) }, {|| "Total fecha..." }, {|| 3 }, ::lSalto )

      oGroup:Cargo            := TItemGroup()
      oGroup:Cargo:Nombre     := "Fecha"
      oGroup:Cargo:Expresion  := "Dtos( dFecMov )"

      aAdd( ::aSelectionGroup, oGroup )

      if ::oImageGroup <> nil
         ::oImageGroup:AddMasked( TBitmap():Define( "gc_calendar_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         oGroup:Cargo:Imagen     := len( ::oImageGroup:aBitmaps ) -1
      end

   end

RETURN ( ::oIniInf )



static FUNCTION TInfGen_oDefFinInf( nId, oDlg, nIdSay ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen



   If( nId == nil, nId := 1120, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oFinInf := TGetHlp():ReDefine( nId, { | u | If( PCount()==0, ::dFinInf, ::dFinInf:= u ) }, oDlg,,,,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )

   ::oFinInf:bHelp   := {|| ::oFinInf:cText( Calendario( ::dFinInf ) ) }

   if IsNum( nIdSay )




   ::oFinText := TSay():ReDefine( nIdSay, {||      "Hasta"}, oDlg,,,, .F.,, .F., .F., )

   end

RETURN ( ::oFinInf )



static FUNCTION TInfGen_oDefDivInf( nId, nIdBmp, oDlg ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local This     := Self

   If( nId == nil, nId := 1130, ) ;
   If( nIdBmp == nil, nIdBmp := 1131, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   ::oDbfDiv := DbfServer( "DIVISAS.DBF", ):NewOpen( "DIVISAS.DBF",, ( cDriver() ),, ( cPatDat() ), .F., .T., .F., .F. ) ; ::oDbfDiv:AddBag( "DIVISAS.CDX" ) ; ::oDbfDiv:AddBag( ) ; ::oDbfDiv:AutoIndex()

   ::oBandera     := TBandera():New()







   ::oDivInf := TGetHlp():ReDefine( nId, { | u | If( PCount()==0, ::cDivInf, ::cDivInf:= u ) }, oDlg,, "@!", {||       ( ::lLoadDivisa() )},,,,,, .F.,,, .F., .F.,,,,, {|Self|( BrwDiv( This:oDivInf, This:oBmpDiv, nil, This:oDbfDiv:cAlias, This:oBandera ), This:lLoadDivisa() )}, nil, "LUPA",, )




   ::oBmpDiv := TBitmap():ReDefine( nIdBmp, "BAN_EURO",, oDlg,,, .F., .F.,,, .F.,,, .F. )

   ::lLoadDivisa()

RETURN ( Self )



static FUNCTION TInfGen_oDefTitInf( nIdTitle, nIdSubTitle ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( nIdTitle == nil, nIdTitle := 1140, ) ;
   If( nIdSubTitle == nil, nIdSubTitle := 1150, ) ;



   TGetHlp():ReDefine( nIdTitle, { | u | If( PCount()==0, ::cTitle, ::cTitle:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F.,,, .F., .F.,,,,,, nil,,, )



   TGetHlp():ReDefine( nIdSubTitle, { | u | If( PCount()==0, ::cAliasTitle, ::cAliasTitle:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F.,,, .F., .F.,,,,,, nil,,, )

RETURN ( Self )



static FUNCTION TInfGen_oDefPrvInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllPrv ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oPrvDesde
   local oPrvHasta
   local oSayPrvDes
   local cSayPrvDes
   local oSayPrvHas
   local cSayPrvHas
   local lOpen       := .T.
   local oError
   local oBlock      := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   If( nIdOrg == nil, nIdOrg := 100, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 101, ) ;
   If( nIdDes == nil, nIdDes := 110, ) ;
   If( nIdSayDes == nil, nIdSayDes := 111, ) ;

   ::oDbfPrv := DbfServer( "PROVEE.DBF", ):NewOpen( "PROVEE.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPrv:AddBag( "PROVEE.CDX" ) ; ::oDbfPrv:AddBag( ) ; ::oDbfPrv:AutoIndex()





   ::cPrvOrg   := dbFirst ( ::oDbfPrv, 1 )
   ::cPrvDes   := dbLast  ( ::oDbfPrv, 1 )
   cSayPrvDes  := dbFirst ( ::oDbfPrv, 2 )
   cSayPrvHas  := dbLast  ( ::oDbfPrv, 2 )

   if !Empty( nIdAllPrv )
   ::lAllPrv      := .T.


   TCheckBox():ReDefine( ( nIdAllPrv ), { | u | If( PCount()==0, ::lAllPrv, ::lAllPrv:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )
   else
      ::lAllPrv   := .F.
   end








   oPrvDesde := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cPrvOrg, ::cPrvOrg:= u ) }, ::oFld:aDialogs[1],,, {||    cProvee( oPrvDesde, ::oDbfPrv:cAlias, oSayPrvDes )}, "N/W*",,,,, .F., {||     ( !::lAllPrv )},, .F., .F.,,,,, {|Self|BrwProvee( oPrvDesde, oSayPrvDes )}, nil, "LUPA",, )





   oSayPrvDes := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayPrvDes, cSayPrvDes:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )








   oPrvHasta := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cPrvDes, ::cPrvDes:= u ) }, ::oFld:aDialogs[1],,, {||    cProvee( oPrvHasta, ::oDbfPrv:cAlias, oSayPrvHas )}, "N/W*",,,,, .F., {||     ( !::lAllPrv )},, .F., .F.,,,,, {|Self|BrwProvee( oPrvHasta, oSayPrvHas )}, nil, "LUPA",, )





   oSayPrvHas := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayPrvHas, cSayPrvHas:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfPrv )
         ::oDbfPrv:End()
      end
      lOpen          := .F.

   end
   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefMetInf( nId, oDlg ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( nId == nil, nId := 1160, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;






 ::oMtrInf := TApoloMeter():ReDefine( nId, { | u | If( PCount()==0, ::nMtrInf, ::nMtrInf:= u ) }, 100, oDlg, .F.,, "Procesando", .F.,,,, )

RETURN ( Self )



static FUNCTION TInfGen_oDefSerInf( oDlg ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   TWebBtn():Redefine(1170,,,,, {|This| ( aEval( ::oSer, {|o| Eval( o:bSetGet, .T. ), o:refresh() } ) ) }, oDlg,,,,, "LEFT",,,,, ( 0 + ( 0 * 256 ) + ( 255 * 65536 ) ), ( 0 + ( 0 * 256 ) + ( 255 * 65536 ) ) ):SetTransparent()

   TWebBtn():Redefine(1180,,,,, {|This| ( aEval( ::oSer, {|o| Eval( o:bSetGet, .F. ), o:refresh() } ) ) }, oDlg,,,,, "LEFT",,,,, ( 0 + ( 0 * 256 ) + ( 255 * 65536 ) ), ( 0 + ( 0 * 256 ) + ( 255 * 65536 ) ) ):SetTransparent()

   ::oSer[  1 ] := TCheckBox():ReDefine( 1190, { | u | If( PCount()==0, ::aSer[  1 ], ::aSer[  1 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[  2 ] := TCheckBox():ReDefine( 1200, { | u | If( PCount()==0, ::aSer[  2 ], ::aSer[  2 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[  3 ] := TCheckBox():ReDefine( 1210, { | u | If( PCount()==0, ::aSer[  3 ], ::aSer[  3 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[  4 ] := TCheckBox():ReDefine( 1220, { | u | If( PCount()==0, ::aSer[  4 ], ::aSer[  4 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[  5 ] := TCheckBox():ReDefine( 1230, { | u | If( PCount()==0, ::aSer[  5 ], ::aSer[  5 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[  6 ] := TCheckBox():ReDefine( 1240, { | u | If( PCount()==0, ::aSer[  6 ], ::aSer[  6 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[  7 ] := TCheckBox():ReDefine( 1250, { | u | If( PCount()==0, ::aSer[  7 ], ::aSer[  7 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[  8 ] := TCheckBox():ReDefine( 1260, { | u | If( PCount()==0, ::aSer[  8 ], ::aSer[  8 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[  9 ] := TCheckBox():ReDefine( 1270, { | u | If( PCount()==0, ::aSer[  9 ], ::aSer[  9 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 10 ] := TCheckBox():ReDefine( 1280, { | u | If( PCount()==0, ::aSer[ 10 ], ::aSer[ 10 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 11 ] := TCheckBox():ReDefine( 1290, { | u | If( PCount()==0, ::aSer[ 11 ], ::aSer[ 11 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 12 ] := TCheckBox():ReDefine( 1300, { | u | If( PCount()==0, ::aSer[ 12 ], ::aSer[ 12 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 13 ] := TCheckBox():ReDefine( 1310, { | u | If( PCount()==0, ::aSer[ 13 ], ::aSer[ 13 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 14 ] := TCheckBox():ReDefine( 1320, { | u | If( PCount()==0, ::aSer[ 14 ], ::aSer[ 14 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 15 ] := TCheckBox():ReDefine( 1330, { | u | If( PCount()==0, ::aSer[ 15 ], ::aSer[ 15 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 16 ] := TCheckBox():ReDefine( 1340, { | u | If( PCount()==0, ::aSer[ 16 ], ::aSer[ 16 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 17 ] := TCheckBox():ReDefine( 1350, { | u | If( PCount()==0, ::aSer[ 17 ], ::aSer[ 17 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 18 ] := TCheckBox():ReDefine( 1360, { | u | If( PCount()==0, ::aSer[ 18 ], ::aSer[ 18 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 19 ] := TCheckBox():ReDefine( 1370, { | u | If( PCount()==0, ::aSer[ 19 ], ::aSer[ 19 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 20 ] := TCheckBox():ReDefine( 1380, { | u | If( PCount()==0, ::aSer[ 20 ], ::aSer[ 20 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 21 ] := TCheckBox():ReDefine( 1390, { | u | If( PCount()==0, ::aSer[ 21 ], ::aSer[ 21 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 22 ] := TCheckBox():ReDefine( 1400, { | u | If( PCount()==0, ::aSer[ 22 ], ::aSer[ 22 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 23 ] := TCheckBox():ReDefine( 1410, { | u | If( PCount()==0, ::aSer[ 23 ], ::aSer[ 23 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 24 ] := TCheckBox():ReDefine( 1420, { | u | If( PCount()==0, ::aSer[ 24 ], ::aSer[ 24 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 25 ] := TCheckBox():ReDefine( 1430, { | u | If( PCount()==0, ::aSer[ 25 ], ::aSer[ 25 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )
   ::oSer[ 26 ] := TCheckBox():ReDefine( 1440, { | u | If( PCount()==0, ::aSer[ 26 ], ::aSer[ 26 ]:= u ) }, oDlg,,,,,,, .F.,, .F. )

Return ( Self )



static FUNCTION TInfGen_AddField( cNomCol, cType, nSize, nDec, bPicCol, cHeaCol, lSelect, cComment, nColSize, lTotal, bFont, bStartTotal ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( cNomCol == nil, cNomCol := "NomCol", ) ;
   If( cType == nil, cType := "C", ) ;
   If( nSize == nil, nSize := 10, ) ;
   If( nDec == nil, nDec := 0, ) ;
   If( bPicCol == nil, bPicCol := {|| "@!" }, ) ;
   If( cHeaCol == nil, cHeaCol := "Nombre", ) ;
   If( lSelect == nil, lSelect := .F., ) ;
   If( nColSize == nil, nColSize := ( nSize + nDec ), ) ;
   If( lTotal == nil, lTotal := ( cType == "N" ), ) ;
   If( bFont == nil, bFont := {|| 2 }, ) ;

   aAdd( ::aFields, { cNomCol, cType, nSize, nDec, bPicCol, cHeaCol, lSelect, cComment, nColSize, lTotal, bFont, bStartTotal } )

   ::oDbf:AddField( cNomCol, cType, nSize, nDec, bPicCol, lSelect, nil, nil, cHeaCol, cComment, nColSize )

Return ( Self )



static FUNCTION TInfGen_AddTmpIndex( cName, cKey, cFor, bWhile, lUniq, lDes ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( cName == nil, cName := "cIndex", ) ;
   If( cKey == nil, cKey := "cIndex", ) ;

   aAdd( ::aIndex, { cName, cKey, cFor, bWhile, lUniq, lDes } )

return ( self )



static FUNCTION TInfGen_CreateColumn( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local n
   local oCol
   local bFld
   local cTitCol
   local bPict
   local lSelect
   local nAlign
   local lTotal
   local lSepLin
   local lSombra
   local nSize
   local cComment
   local Cargo
   local bFont





   ::aFont     := aGetFont()
   ::acSizes   := { "10", "10", "10", "40", "60", "70" }
   ::acEstilo  := { "Normal", "Normal", "Negrita", "Normal", "Normal", "Normal" }
   ::acFont    := { "Courier New", "Courier New", "Courier New", "UPCHeightA", "Code 39", "Code128B" }
   ::aoCols    := {}





   for n := 1 to len( ::aFields )

      bFld     := gfBlock( ::aFields[ n, 1 ], ::oDbf:nArea )
      cTitCol  := if( ValType( ::aFields[ n, 6 ] ) == "B", Eval( ::aFields[ n, 6 ] ), ::aFields[ n, 6 ] )
      bPict    := ::aFields[ n, 5 ]
      lSelect  := ::aFields[ n, 7 ]
      nAlign   := if( ::aFields[ n, 2 ] <> "N", 1, 2 )
      lTotal   := if( ::aFields[ n, 10 ] == nil, ::aFields[ n, 2 ] == "N", ::aFields[ n, 10 ] )
      lSepLin  := .F.
      lSombra  := .F.
      nSize    := if( len( ::aFields[n] ) < 9, ::aFields[ n, 3 ] + ::aFields[ n, 4 ], ::aFields[ n, 9 ] )
      cComment := if( ValType( ::aFields[ n, 8 ] ) == "B", Eval( ::aFields[ n, 8 ] ), ::aFields[ n, 8 ] )
      bFont    := if( len( ::aFields[n] ) >= 11, ::aFields[ n, 11 ], {|| 2 } )














      oCol     := TInfCols():New(   bFld, cTitCol, bPict, lSelect, nAlign, lTotal, lSepLin, lSombra, n, nSize, cComment, bFont, Cargo, Self )

      if len( ::aFields[n] ) >= 12
         oCol:bStartTotal  := ::aFields[ n, 12 ]
      end

      aAdd( ::aoCols, oCol )

   next

RETURN NIL



static FUNCTION TInfGen_AddGroup( bGroup , bHeader, bFooter, bFont, lEject ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oGrp

   If( bGroup == nil, bGroup := {|| ""}, ) ;
   If( bHeader == nil, bHeader := {|| ""}, ) ;
   If( bFooter == nil, bFooter := {|| "Total..."}, ) ;
   If( bFont == nil, bFont := {|| 3 }, ) ;
   If( lEject == nil, lEject := ::lSalto, ) ;

   oGrp              := TRGroup():New( bGroup, bHeader, bFooter, bFont, lEject )

   aAdd( ::aoGroup, oGrp )

RETURN ( Self )



static FUNCTION TInfGen_DelGroup( nGroup ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( nGroup == nil, nGroup := len( ::aoGroup ), ) ;

   aDel( ::aoGroup, nGroup )
   aSize( ::aoGroup, len( ::aoGroup ) - 1 )

RETURN ( Self )



static FUNCTION TInfGen_lDefArtInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllArt, lInitGroup ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oGroup
   local oArtOrg
   local oArtDes
   local oSayArtOrg
   local oSayArtDes
   local cSayArtOrg
   local cSayArtDes
   local lOpen          := .T.
   local oError
   local oBlock

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   if ::oDbfArt == nil .OR. !::oDbfArt:Used()
      ::oDbfArt := DbfServer( "ARTICULO.DBF", ):NewOpen( "ARTICULO.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfArt:AddBag( "ARTICULO.CDX" ) ; ::oDbfArt:AddBag( ) ; ::oDbfArt:AutoIndex()
   end





   ::cArtOrg   := dbFirst( ::oDbfArt, 1 )
   ::cArtDes   := dbLast(  ::oDbfArt, 1 )
   cSayArtOrg  := dbFirst( ::oDbfArt, 2 )
   cSayArtDes  := dbLast(  ::oDbfArt, 2 )

   if !Empty( nIdAllArt )

   ::lAllArt   := .T.



   TCheckBox():ReDefine( ( nIdAllArt ), { | u | If( PCount()==0, ::lAllArt, ::lAllArt:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

   else

   ::lAllArt   := .F.

   end







   oArtOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cArtOrg, ::cArtOrg:= u ) }, ::oFld:aDialogs[1],,, {||    cArticulo( oArtOrg, ::oDbfArt:cAlias, oSayArtOrg )},,,,,, .F., {||     ( !::lAllArt )},, .F., .F.,,,,, {|Self|BrwArticulo( oArtOrg, oSayArtOrg, , .F. )}, nil, "LUPA",, )




   oSayArtOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayArtOrg, cSayArtOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||         .F.},, .F., .F.,,,,,, nil,,, )







   oArtDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cArtDes, ::cArtDes:= u ) }, ::oFld:aDialogs[1],,, {||    cArticulo( oArtDes, ::oDbfArt:cAlias, oSayArtDes )},,,,,, .F., {||     ( !::lAllArt )},, .F., .F.,,,,, {|Self|BrwArticulo( oArtDes, oSayArtDes, , .F. )}, nil, "LUPA",, )




   oSayArtDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayArtDes, cSayArtDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||         .F.},, .F., .F.,,,,,, nil,,, )

   if lInitGroup <> nil

      oGroup         := TRGroup():New( {|| ::oDbf:cCodArt }, {|| "Artículo : " + AllTrim( ::oDbf:cCodArt ) + " - " + AllTRim( ::oDbf:cNomArt ) }, {|| "Total artículo..." }, {|| 3 }, ::lSalto )

      oGroup:Cargo            := TItemGroup()
      oGroup:Cargo:Nombre     := "Artículo"
      oGroup:Cargo:Expresion  := "cCodArt"

      aAdd( ::aSelectionGroup, oGroup )

      if lInitGroup
         aAdd( ::aInitGroup, oGroup )
      end

   end

   aAdd( ::aHeader, {|| Padr( "Artículos", 12 ) + ": " + if( ::lAllArt, "Todos", AllTrim( ::cArtOrg ) + " > " + AllTrim( ::cArtDes ) ) } )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfArt )
         ::oDbfArt:End()
      end

      lOpen          := .F.

   end
   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_lIntArtInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllArt, dbfArticulo, dbfDiv, dbfArtKit, dbfIva ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oArtOrg
   local oArtDes
   local oSayArtOrg
   local oSayArtDes
   local cSayArtOrg
   local cSayArtDes
   local oError
   local oBlock
   local lOpen       := .T.

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   oBlock            := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE





   ::cArtOrg         := dbFirst( dbfArticulo, 1 )
   ::cArtDes         := dbLast(  dbfArticulo, 1 )
   cSayArtOrg        := dbFirst( dbfArticulo, 2 )
   cSayArtDes        := dbLast(  dbfArticulo, 2 )

   if !Empty( nIdAllArt )

      ::lAllArt      := .T.



      TCheckBox():ReDefine( ( nIdAllArt ), { | u | If( PCount()==0, ::lAllArt, ::lAllArt:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

   else

      ::lAllArt      := .F.

   end







   oArtOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cArtOrg, ::cArtOrg:= u ) }, ::oFld:aDialogs[1],,, {||    cArticulo( oArtOrg, dbfArticulo, oSayArtOrg )},,,,,, .F., {||     ( !::lAllArt )},, .F., .F.,,,,, {|Self|BrwSelArticulo( oArtOrg, oSayArtOrg, , .F., .F., .F. )}, nil, "LUPA",, )




   oSayArtOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayArtOrg, cSayArtOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )







   oArtDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cArtDes, ::cArtDes:= u ) }, ::oFld:aDialogs[1],,, {||    cArticulo( oArtDes, dbfArticulo, oSayArtDes )},,,,,, .F., {||     ( !::lAllArt )},, .F., .F.,,,,, {|Self|BrwSelArticulo( oArtDes, oSayArtDes, , .F., .F., .F. )}, nil, "LUPA",, )




   oSayArtDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayArtDes, cSayArtDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      lOpen          := .F.

   end
   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_lLoadDivisa( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local lRet

   if Empty( ::oDbfDiv ) .OR. !::oDbfDiv:Used()
      ::oDbfDiv := DbfServer( "DIVISAS.DBF", ):NewOpen( "DIVISAS.DBF",, ( cDriver() ),, ( cPatDat() ), .F., .T., .F., .F. ) ; ::oDbfDiv:AddBag( "DIVISAS.CDX" ) ; ::oDbfDiv:AddBag( ) ; ::oDbfDiv:AutoIndex()
   end

   if ::oDbfDiv:Seek( ::cDivInf )

      ::cPicImp            := RetPic( ::oDbfDiv:nNouDiv, ::oDbfDiv:nDouDiv )
      ::cPicOut            := RetPic( ::oDbfDiv:nNouDiv, ::oDbfDiv:nRouDiv )
      ::nDecOut            := ::oDbfDiv:nDouDiv
      ::nDerOut            := ::oDbfDiv:nRouDiv
      ::cPicCom            := RetPic( ::oDbfDiv:nNinDiv, ::oDbfDiv:nDinDiv )
      ::cPicIn             := cPinDiv( ::cDivInf, ::oDbfDiv:cAlias )
      ::nDecIn             := ::oDbfDiv:nDinDiv
      ::nDerIn             := ::oDbfDiv:nRinDiv
      ::cPicPnt            := RetPic( ::oDbfDiv:nNpvDiv, ::oDbfDiv:nDpvDiv )
      ::nDecPnt            := ::oDbfDiv:nDpvDiv
      ::nDerPnt            := ::oDbfDiv:nRpvDiv
      ::nValDiv            := nDiv2Div( cDivEmp(), ::cDivInf, ::oDbfDiv:cAlias )

      lRet                 := .T.

   else

      MsgStop( "Divisa no encontrada " + ::cDivInf )
      lRet                 := .F.

   end

return ( lRet )



static FUNCTION TInfGen_oDefExcInf( nId ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( nId == nil, nId := 200, ) ;



   TCheckBox():ReDefine( ( nId ), { | u | If( PCount()==0, ::lExcCero, ::lExcCero:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

RETURN NIL



static FUNCTION TInfGen_oDefExcImp( nId ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( nId == nil, nId := 210, ) ;



   TCheckBox():ReDefine( ( nId ), { | u | If( PCount()==0, ::lExcImp, ::lExcImp:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

RETURN NIL



static FUNCTION TInfGen_oDefSalInf( nId ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( nId == nil, nId := 250, ) ;



   TCheckBox():ReDefine( ( nId ), { | u | If( PCount()==0, ::lSalto, ::lSalto:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

RETURN NIL



static FUNCTION TInfGen_oDefResInf( nId ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( nId == nil, nId := 190, ) ;



   ::oResumen := TCheckBox():ReDefine( ( nId ), { | u | If( PCount()==0, ::lResumen, ::lResumen:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

RETURN NIL



static function gfBlock( cName, nArea )

return ( fieldWBlock( cName, nArea ) )



static FUNCTION TInfGen_oDefAlmInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllAlm, lInitGroup ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oGroup
   local oAlmOrg
   local oAlmDes
   local oSayAlmOrg
   local cSayAlmOrg
   local oSayAlmDes
   local cSayAlmDes
   local lOpen          := .T.
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   ::oDbfAlm := DbfServer( "ALMACEN.DBF", ):NewOpen( "ALMACEN.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAlm:AddBag( "ALMACEN.CDX" ) ; ::oDbfAlm:AddBag( ) ; ::oDbfAlm:AutoIndex()





   ::cAlmOrg         := dbFirst( ::oDbfAlm, 1 )
   ::cAlmDes         := dbLast( ::oDbfAlm, 1 )
   cSayAlmOrg        := dbFirst( ::oDbfAlm, 2 )
   cSayAlmDes        := dbLast( ::oDbfAlm, 2 )

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   if !Empty( nIdAllAlm )

   ::lAllAlm         := .T.



   TCheckBox():ReDefine( ( nIdAllAlm ), { | u | If( PCount()==0, ::lAllAlm, ::lAllAlm:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

   else

      ::lAllAlm      := .F.

   end








   oAlmOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cAlmOrg, ::cAlmOrg:= u ) }, ::oFld:aDialogs[1],,, {||    cAlmacen( oAlmOrg, ::oDbfAlm:cAlias, oSayAlmOrg )}, "N/W*",,,,, .F., {||     ( !::lAllAlm )},, .F., .F.,,,,, {|Self|BrwAlmacen( oAlmOrg, oSayAlmOrg )}, nil, "LUPA",, )





   oSayAlmOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayAlmOrg, cSayAlmOrg:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )








   oAlmDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cAlmDes, ::cAlmDes:= u ) }, ::oFld:aDialogs[1],,, {||    cAlmacen( oAlmDes, ::oDbfAlm:cAlias, oSayAlmDes )}, "N/W*",,,,, .F., {||     ( !::lAllAlm )},, .F., .F.,,,,, {|Self|BrwAlmacen( oAlmDes, oSayAlmDes )}, nil, "LUPA",, )




   oSayAlmDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayAlmDes, cSayAlmDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   if lInitGroup <> nil

      oGroup         := TRGroup():New( {|| ::oDbf:cCodAlm }, {|| "Almacén : " + AllTrim( ::oDbf:cCodAlm ) + " - " + AllTrim( ::oDbf:cNomAlm ) }, {|| "Total almacén..." }, {|| 3 }, ::lSalto )

      oGroup:Cargo            := TItemGroup()
      oGroup:Cargo:Nombre     := "Almacén"
      oGroup:Cargo:Expresion  := "cCodAlm"

      aAdd( ::aSelectionGroup, oGroup )

      if lInitGroup
         aAdd( ::aInitGroup, oGroup )
      end

   end

   aAdd( ::aHeader, {|| Padr( "Almacenes", 12 ) + ": " + if( ::lAllAlm, "Todos", AllTrim( ::cAlmOrg ) + " > " + AllTrim( ::cAlmDes ) ) } )

   RECOVER

      msgStop( "Imposible las bases de datos de almacenes" )

      if !Empty( ::oDbfAlm )
         ::oDbfAlm:End()
      end

      lOpen    := .F.

   end
   ErrorBlock( oBlock )

RETURN ( lOpen )




static FUNCTION TInfGen_oBrwAlmInf( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local lOpen    := .T.
   local oError
   local oBlock   := ErrorBlock( {| oError | ApoloBreak( oError ) } )



   BEGIN SEQUENCE

   ::oDbfAlm := DbfServer( "ALMACEN.DBF", ):NewOpen( "ALMACEN.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAlm:AddBag( "ALMACEN.CDX" ) ; ::oDbfAlm:AddBag( ) ; ::oDbfAlm:AutoIndex()




   aAdd( ::aCondiciones, { "Almacén", .T., dbFirst( ::oDbfAlm, 1 ), dbFirst( ::oDbfAlm, 2 ), dbLast(  ::oDbfAlm, 1 ), dbLast(  ::oDbfAlm, 2 ) } )



   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfAlm )
         ::oDbfAlm:End()
      end

      lOpen          := .F.

   end
   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefAgeInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAll ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oAgeOrg
   local oAgeDes
   local oSayAgeOrg
   local cSayAgeOrg
   local oSayAgeDes
   local cSayAgeDes
   local This        := Self
   local lOpen       := .T.
   local oError
   local oBlock      := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   ::oDbfAge := DbfServer( "AGENTES.DBF", ):NewOpen( "AGENTES.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfAge:AddBag( "AGENTES.CDX" ) ; ::oDbfAge:AddBag( ) ; ::oDbfAge:AutoIndex()





   ::cAgeOrg         := dbFirst( ::oDbfAge, 1 )
   ::cAgeDes         := dbLast(  ::oDbfAge, 1 )
   cSayAgeOrg        := RTrim( dbFirst( ::oDbfAge, 2 ) ) + ", " + dbFirst( ::oDbfAge, 3 )
   cSayAgeDes        := RTrim( dbLast(  ::oDbfAge, 2 ) ) + ", " + dbLast( ::oDbfAge, 3 )

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   if nIdAll <> nil
      ::lAgeAll      := .T.
   end








   oAgeOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cAgeOrg, ::cAgeOrg:= u ) }, ::oFld:aDialogs[1],,, {||    cAgentes( oAgeOrg, This:oDbfAge:cAlias, oSayAgeOrg )}, "N/W*",,,,, .F., {||     ( ValType( ::lAgeAll ) == "L" .AND. !::lAgeAll )},, .F., .F.,,,,, {|Self|BrwAgentes( oAgeOrg, oSayAgeOrg )}, nil, "LUPA",, )





   oSayAgeOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayAgeOrg, cSayAgeOrg:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )








   oAgeDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cAgeDes, ::cAgeDes:= u ) }, ::oFld:aDialogs[1],,, {||    cAgentes( oAgeDes, This:oDbfAge:cAlias, oSayAgeDes )}, "N/W*",,,,, .F., {||     ( ValType( ::lAgeAll ) == "L" .AND. !::lAgeAll )},, .F., .F.,,,,, {|Self|BrwAgentes( oAgeDes, oSayAgeDes )}, nil, "LUPA",, )




   oSayAgeDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayAgeDes, cSayAgeDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   if nIdAll <> nil



   TCheckBox():ReDefine( ( nIdAll ), { | u | If( PCount()==0, ::lAgeAll, ::lAgeAll:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

   end

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfAge )
         ::oDbfAge:End()
      end
      lOpen          := .F.

   end
   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_lDefFamInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllFam ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oFamDes
   local oFamHas
   local oSayFamDes
   local cSayFamDes
   local oSayFamHas
   local cSayFamHas
   local lOpen    := .T.
   local oError
   local oBlock   := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   if ::oDbfFam == nil .OR. !::oDbfFam:Used()
      ::oDbfFam := DbfServer( "FAMILIAS.DBF", ):NewOpen( "FAMILIAS.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFam:AddBag( "FAMILIAS.CDX" ) ; ::oDbfFam:AddBag( ) ; ::oDbfFam:AutoIndex()
   end





   ::cFamOrg         := dbFirst( ::oDbfFam, 1 )
   ::cFamDes         := dbLast ( ::oDbfFam, 1 )
   cSayFamDes        := dbFirst( ::oDbfFam, 2 )
   cSayFamHas        := dbLast ( ::oDbfFam, 2 )

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   if !Empty( nIdAllFam )

      ::lAllFam      := .T.



      TCheckBox():ReDefine( ( nIdAllFam ), { | u | If( PCount()==0, ::lAllFam, ::lAllFam:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

   else

         ::lAllFam   := .F.

   end








   oFamDes := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cFamOrg, ::cFamOrg:= u ) }, ::oFld:aDialogs[1],,, {||    cFamilia( oFamDes, ::oDbfFam:cAlias, oSayFamDes )}, "N/W*",,,,, .F., {||     ( !::lAllFam )},, .F., .F.,,,,, {|Self|BrwFamilia( oFamDes, oSayFamDes )}, nil, "LUPA",, )





   oSayFamDes := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayFamDes, cSayFamDes:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )








   oFamHas := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cFamDes, ::cFamDes:= u ) }, ::oFld:aDialogs[1],,, {||    cFamilia( oFamHas, ::oDbfFam:cAlias, oSayFamHas )}, "N/W*",,,,, .F., {||     ( !::lAllFam )},, .F., .F.,,,,, {|Self|BrwFamilia( oFamHas, oSayFamHas )}, nil, "LUPA",, )




   oSayFamHas := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayFamHas, cSayFamHas:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oDbfFam )
         ::oDbfFam:End()
      end
      lOpen          := .F.

   end
   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefFpgInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllFpg ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oFpgDes
   local oFpgHas
   local oSayFpgDes
   local cSayFpgDes
   local oSayFpgHas
   local cSayFpgHas
   local lOpen       := .T.
   local oError
   local oBlock      := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   ::oDbfFpg := DbfServer( "FPago.Dbf", ):NewOpen( "FPago.Dbf",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfFpg:AddBag( "FPago.Cdx" ) ; ::oDbfFpg:AddBag( ) ; ::oDbfFpg:AutoIndex()





   ::cFpgDes         := dbFirst( ::oDbfFpg, 1 )
   ::cFpgHas         := dbLast ( ::oDbfFpg, 1 )
   cSayFpgDes        := dbFirst( ::oDbfFpg, 2 )
   cSayFpgHas        := dbLast ( ::oDbfFpg, 2 )

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   if !Empty( nIdAllFpg )
   ::lAllFpg      := .T.


   TCheckBox():ReDefine( ( nIdAllFpg ), { | u | If( PCount()==0, ::lAllFpg, ::lAllFpg:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )
   else
      ::lAllFpg   := .F.
   end





   oFpgDes := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cFpgDes, ::cFpgDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lAllFpg )},, .F., .F.,,,,,, nil, "LUPA",, )
      oFpgDes:bHelp  := {|| BrwFPago( oFpgDes, oSayFpgDes ) }
      oFpgDes:bValid := {|| cFpago( oFpgDes, ::oDbfFpg:cAlias, oSayFpgDes ) }




   oSayFpgDes := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayFpgDes, cSayFpgDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )






   oFpgHas := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cFpgHas, ::cFpgHas:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F., {||     ( !::lAllFpg )},, .F., .F.,,,,,, nil, "LUPA",, )
      oFpgHas:bHelp  := {|| BrwFPago( oFpgHas, oSayFpgHas ) }
      oFpgHas:bValid := {|| cFpago( oFpgHas, ::oDbfFpg:cAlias, oSayFpgHas ) }




   oSayFpgHas := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayFpgHas, cSayFpgHas:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oDbfFpg )
         ::oDbfFpg:End()
      end
      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefTipInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllTip ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oTipOrg
   local oTipDes
   local oSayTipDes
   local cSayTipDes
   local oSayTipOrg
   local cSayTipOrg
   local lOpen       := .T.
   local oError
   local oBlock      := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   ::oTipArt         :=  TTipArt():New( cPatEmp(), cDriver() )
   ::oTipArt:OpenFiles()





   ::cTipOrg         := dbFirst( ::oTipArt:oDbf, 1 )
   ::cTipDes         := dbLast ( ::oTipArt:oDbf, 1 )
   cSayTipOrg        := dbFirst( ::oTipArt:oDbf, 2 )
   cSayTipDes        := dbLast ( ::oTipArt:oDbf, 2 )

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   if !Empty( nIdAllTip )
   ::lAllTip      := .T.


   TCheckBox():ReDefine( ( nIdAllTip ), { | u | If( PCount()==0, ::lAllTip, ::lAllTip:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )
   else
      ::lAllTip   := .F.
   end





   oTipOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cTipOrg, ::cTipOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lAllTip )},, .F., .F.,,,,,, nil, "LUPA",, )

      oTipOrg:bValid := {|| ::oTipArt:Existe( oTipOrg, oSayTipOrg ) }
      oTipOrg:bHelp  := {|| ::oTipArt:Buscar( oTipOrg ) }




   oSayTipOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayTipOrg, cSayTipOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )





   oTipDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cTipDes, ::cTipDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lAllTip )},, .F., .F.,,,,,, nil, "LUPA",, )

      oTipDes:bValid := {|| ::oTipArt:Existe( oTipDes, oSayTipDes ) }
      oTipDes:bHelp  := {|| ::oTipArt:Buscar( oTipDes ) }




   oSayTipDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayTipDes, cSayTipDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oTipArt )
         ::oTipArt:End()
      end
      lOpen       := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefFabInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllFab ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oFabOrg
   local oFabDes
   local oSayFabDes
   local cSayFabDes
   local oSayFabOrg
   local cSayFabOrg
   local lOpen       := .T.
   local oError
   local oBlock      := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   ::oDbfFab         :=  TFabricantes():New( cPatEmp() )
   ::oDbfFab:OpenFiles()





   ::cFabOrg         := dbFirst( ::oDbfFab:oDbf, 1 )
   ::cFabDes         := dbLast ( ::oDbfFab:oDbf, 1 )
   cSayFabOrg        := dbFirst( ::oDbfFab:oDbf, 2 )
   cSayFabDes        := dbLast ( ::oDbfFab:oDbf, 2 )

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   if !Empty( nIdAllFab )
   ::lAllFab      := .T.


   TCheckBox():ReDefine( ( nIdAllFab ), { | u | If( PCount()==0, ::lAllFab, ::lAllFab:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )
   else
      ::lAllFab   := .F.
   end





   oFabOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cFabOrg, ::cFabOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lAllFab )},, .F., .F.,,,,,, nil, "LUPA",, )

      oFabOrg:bValid := {|| ::oDbfFab:Existe( oFabOrg, oSayFabOrg ) }
      oFabOrg:bHelp  := {|| ::oDbfFab:Buscar( oFabOrg ) }




   oSayFabOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayFabOrg, cSayFabOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )





   oFabDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cFabDes, ::cFabDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lAllFab )},, .F., .F.,,,,,, nil, "LUPA",, )

      oFabDes:bValid := {|| ::oDbfFab:Existe( oFabDes, oSayFabDes ) }
      oFabDes:bHelp  := {|| ::oDbfFab:Buscar( oFabDes ) }




   oSayFabDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayFabDes, cSayFabDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oDbfFab )
         ::oDbfFab:End()
      end
      lOpen       := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefTipActInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllAct ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oTipOrg
   local oTipDes
   local oSayTipDes
   local cSayTipDes
   local oSayTipOrg
   local cSayTipOrg
   local lOpen       := .T.
   local oError
   local oBlock      := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   ::oTipAct         :=  TActuaciones():New( cPatEmp() )
   ::oTipAct:OpenFiles()





   ::cTipActOrg      := dbFirst( ::oTipAct:oDbf, 1 )
   ::cTipActDes      := dbLast ( ::oTipAct:oDbf, 1 )
   cSayTipOrg        := dbFirst( ::oTipAct:oDbf, 2 )
   cSayTipDes        := dbLast ( ::oTipAct:oDbf, 2 )

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   if !Empty( nIdAllAct )
   ::lAllTipAct      := .T.


   TCheckBox():ReDefine( ( nIdAllAct ), { | u | If( PCount()==0, ::lAllTipAct, ::lAllTipAct:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )
   else
      ::lAllTipAct   := .F.
   end





   oTipOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cTipActOrg, ::cTipActOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lAllTipAct )},, .F., .F.,,,,,, nil, "LUPA",, )

      oTipOrg:bValid := {|| ::oTipAct:Existe( oTipOrg, oSayTipOrg ) }
      oTipOrg:bHelp  := {|| ::oTipAct:Buscar( oTipOrg ) }




   oSayTipOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayTipOrg, cSayTipOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )





   oTipDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cTipActDes, ::cTipActDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lAllTipAct )},, .F., .F.,,,,,, nil, "LUPA",, )

      oTipDes:bValid := {|| ::oTipAct:Existe( oTipDes, oSayTipDes ) }
      oTipDes:bHelp  := {|| ::oTipAct:Buscar( oTipDes ) }




   oSayTipDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayTipDes, cSayTipDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oTipAct )
         ::oTipAct:End()
      end
      lOpen       := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefGrpCli( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdGrp, oDlg ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oGrpOrg
   local oGrpDes
   local oSayGrpDes
   local cSayGrpDes
   local oSayGrpOrg
   local cSayGrpOrg
   local lOpen

   ::oGrpCli         :=  TGrpCli():Create( cPatEmp() )

   if ::oGrpCli:OpenFiles()





      ::cGrpOrg         := dbFirst( ::oGrpCli:oDbf, 1 )
      ::cGrpDes         := dbLast ( ::oGrpCli:oDbf, 1 )
      cSayGrpOrg        := dbFirst( ::oGrpCli:oDbf, 2 )
      cSayGrpDes        := dbLast ( ::oGrpCli:oDbf, 2 )

      If( nIdOrg == nil, nIdOrg := 70, ) ;
      If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
      If( nIdDes == nil, nIdDes := 80, ) ;
      If( nIdSayDes == nil, nIdSayDes := 81, ) ;
      If( nIdGrp == nil, nIdGrp := 90, ) ;





      oGrpOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cGrpOrg, ::cGrpOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lGrpAll )},, .F., .F.,,,,,, nil, "LUPA",, )

         oGrpOrg:bValid := {|| ::oGrpCli:Existe( oGrpOrg, oSayGrpOrg ) }
         oGrpOrg:bHelp  := {|| ::oGrpCli:Buscar( oGrpOrg ) }




      oSayGrpOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayGrpOrg, cSayGrpOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )





      oGrpDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cGrpDes, ::cGrpDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lGrpAll )},, .F., .F.,,,,,, nil, "LUPA",, )

         oGrpDes:bValid := {|| ::oGrpCli:Existe( oGrpDes, oSayGrpDes ) }
         oGrpDes:bHelp  := {|| ::oGrpCli:Buscar( oGrpDes ) }




      oSayGrpDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayGrpDes, cSayGrpDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

      if !Empty( nIdGrp )

         ::lGrpAll      := .T.


         TCheckBox():ReDefine( ( nIdGrp ), { | u | If( PCount()==0, ::lGrpAll, ::lGrpAll:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )
      else
         ::lGrpAll   := .F.
      end

      lOpen := .T.

   else
      lOpen := .F.
   end

RETURN ( lOpen )



static FUNCTION TInfGen_oDefGrpPrv( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdGrp, oDlg ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oGrpPrvOrg
   local oGrpPrvDes
   local oSayGrpPrvDes
   local cSayGrpPrvDes
   local oSayGrpPrvOrg
   local cSayGrpPrvOrg
   local lOpen

   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   ::oGrpPrv         :=  TGrpPrv():Create( cPatEmp() )
   if ::oGrpPrv:OpenFiles()





      ::cGrpPrvOrg         := dbFirst( ::oGrpPrv:oDbf, 1 )
      ::cGrpPrvDes         := dbLast ( ::oGrpPrv:oDbf, 1 )
      cSayGrpPrvOrg        := dbFirst( ::oGrpPrv:oDbf, 2 )
      cSayGrpPrvDes        := dbLast ( ::oGrpPrv:oDbf, 2 )

      If( nIdOrg == nil, nIdOrg := 70, ) ;
      If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
      If( nIdDes == nil, nIdDes := 80, ) ;
      If( nIdSayDes == nil, nIdSayDes := 81, ) ;
      If( nIdGrp == nil, nIdGrp := 90, ) ;





      oGrpPrvOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cGrpPrvOrg, ::cGrpPrvOrg:= u ) }, oDlg,,,,,,,,, .F., {||     ( !::lGrpPrvAll )},, .F., .F.,,,,,, nil, "LUPA",, )

         oGrpPrvOrg:bValid := {|| ::oGrpPrv:Existe( oGrpPrvOrg, oSayGrpPrvOrg ) }
         oGrpPrvOrg:bHelp  := {|| ::oGrpPrv:Buscar( oGrpPrvOrg ) }




      oSayGrpPrvOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayGrpPrvOrg, cSayGrpPrvOrg:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )





      oGrpPrvDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cGrpPrvDes, ::cGrpPrvDes:= u ) }, oDlg,,,,,,,,, .F., {||     ( !::lGrpPrvAll )},, .F., .F.,,,,,, nil, "LUPA",, )

         oGrpPrvDes:bValid := {|| ::oGrpPrv:Existe( oGrpPrvDes, oSayGrpPrvDes ) }
         oGrpPrvDes:bHelp  := {|| ::oGrpPrv:Buscar( oGrpPrvDes ) }




      oSayGrpPrvDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayGrpPrvDes, cSayGrpPrvDes:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

      if !Empty( nIdGrp )

         ::lGrpPrvAll      := .T.


         TCheckBox():ReDefine( ( nIdGrp ), { | u | If( PCount()==0, ::lGrpPrvAll, ::lGrpPrvAll:= u ) }, oDlg,,,,,,, .F.,, .F. )
      else
         ::lGrpAll   := .F.
      end

      lOpen := .T.

   else
      lOpen := .F.
   end

RETURN ( lOpen )



static FUNCTION TInfGen_oDefEmpInf( nId, nIdSay, oDlg ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oCodEmp
   local oNomEmp
   local cNomEmp
   local This        := Self

   If( nId == nil, nId := 90, ) ;
   If( nIdSay == nil, nIdSay := 91, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   ::oDbfEmp := DbfServer( "EMPRESA.DBF", ):NewOpen( "EMPRESA.DBF",, ( cDriver() ),, ( cPatDat() ), .F., .T., .F., .F. ) ; ::oDbfEmp:AddBag( "EMPRESA.CDX" ) ; ::oDbfEmp:AddBag( ) ; ::oDbfEmp:AutoIndex()

   ::cCodEmp         := ::oDbfEmp:CodEmp
   cNomEmp           := ::oDbfEmp:cNombre






   oCodEmp := TGetHlp():ReDefine( ( nId ), { | u | If( PCount()==0, ::cCodEmp, ::cCodEmp:= u ) }, oDlg,,, {||    ( cEmpresa( oCodEmp, This:oDbfEmp:cAlias, oNomEmp ) )},,,,,, .F.,,, .F., .F.,,,,, {|Self|( BrwEmpresa( oCodEmp, This:oDbfEmp:cAlias, oNomEmp ) )}, nil, "LUPA",, )




   oNomEmp := TGetHlp():ReDefine( ( nIdSay ), { | u | If( PCount()==0, cNomEmp, cNomEmp:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )


RETURN ( Self )



static FUNCTION TInfGen_oDefCliInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, oDlg, nIdAllCli ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oCliOrg
   local oCliDes
   local oSayCliOrg
   local oSayCliDes
   local cSayCliOrg
   local cSayCliDes
   local lOpen       := .T.
   local oError
   local oBlock

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   oBlock            := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   ::oDbfCli := DbfServer( "CLIENT.DBF", ):NewOpen( "CLIENT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfCli:AddBag( "CLIENT.CDX" ) ; ::oDbfCli:AddBag( ) ; ::oDbfCli:AutoIndex()





   ::cCliOrg         := dbFirst( ::oDbfCli, 1 )
   ::cCliDes         := dbLast(  ::oDbfCli, 1 )
   cSayCliOrg        := dbFirst( ::oDbfCli, 2 )
   cSayCliDes        := dbLast(  ::oDbfCli, 2 )

   if !Empty( nIdAllCli )
   ::lAllCli         := .T.


   TCheckBox():ReDefine( ( nIdAllCli ), { | u | If( PCount()==0, ::lAllCli, ::lAllCli:= u ) }, oDlg,,,,,,, .F.,, .F. )
   else
      ::lAllCli      := .F.
   end






   oCliOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cCliOrg, ::cCliOrg:= u ) }, oDlg,,, {||    cClient( oCliOrg, ::oDbfCli:cAlias, oSayCliOrg )},,,,,, .F., {||     ( !::lAllCli )},, .F., .F.,,,,,, nil, "LUPA",, )
   oCliOrg:bHelp     := {|| BrwCli( oCliOrg, oSayCliOrg, ::oDbfCli:cAlias ) }




   oSayCliOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayCliOrg, cSayCliOrg:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )






   oCliDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cCliDes, ::cCliDes:= u ) }, oDlg,,, {||    cClient( oCliDes, ::oDbfCli:cAlias, oSayCliDes )},,,,,, .F., {||     ( !::lAllCli )},, .F., .F.,,,,,, nil, "LUPA",, )
   oCliDes:bHelp     := {|| BrwCli( oCliDes, oSayCliDes, ::oDbfCli:cAlias ) }




   oSayCliDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayCliDes, cSayCliDes:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oDbfCli )
         ::oDbfCli:End()
      end
      lOpen       := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefTmpInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, oDlg, nIdAllTmp ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oTmpOrg
   local oTmpDes
   local oSayTmpOrg
   local oSayTmpDes
   local cSayTmpOrg
   local cSayTmpDes
   local lOpen       := .T.
   local oError
   local oBlock

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   oBlock            := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   ::oDbfTmp := DbfServer( "Temporadas.DBF", ):NewOpen( "Temporadas.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfTmp:AddBag( "Temporadas.CDX" ) ; ::oDbfTmp:AddBag( ) ; ::oDbfTmp:AutoIndex()





   ::cTmpOrg         := dbFirst( ::oDbfTmp, 1 )
   ::cTmpDes         := dbLast(  ::oDbfTmp, 1 )
   cSayTmpOrg        := dbFirst( ::oDbfTmp, 2 )
   cSayTmpDes        := dbLast(  ::oDbfTmp, 2 )

   if !Empty( nIdAllTmp )

   ::lAllTmp      := .T.



   TCheckBox():ReDefine( ( nIdAllTmp ), { | u | If( PCount()==0, ::lAllTmp, ::lAllTmp:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

   else

      ::lAllTmp   := .F.

   end







   oTmpOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cTmpOrg, ::cTmpOrg:= u ) }, oDlg,,, {||    cTemporada( oTmpOrg, ::oDbfTmp:cAlias, oSayTmpOrg )},,,,,, .F., {||     ( !::lAllTmp )},, .F., .F.,,,,,, nil, "LUPA",, )
   oTmpOrg:bHelp     := {|| BrwTemporada( oTmpOrg, oSayTmpOrg, ::oDbfTmp:cAlias ) }




   oSayTmpOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayTmpOrg, cSayTmpOrg:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )






   oTmpDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cTmpDes, ::cTmpDes:= u ) }, oDlg,,, {||    cTemporada( oTmpDes, ::oDbfTmp:cAlias, oSayTmpDes )},,,,,, .F., {||     ( !::lAllTmp )},, .F., .F.,,,,,, nil, "LUPA",, )
   oTmpDes:bHelp     := {|| BrwTemporada( oTmpDes, oSayTmpDes, ::oDbfTmp:cAlias ) }




   oSayTmpDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayTmpDes, cSayTmpDes:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oDbfTmp )
         ::oDbfTmp:End()
      end
      lOpen       := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefGrfInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllGrp ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oGruFamOrg
   local oGruFamDes
   local oSayGrFOrg
   local cSayGrFOrg
   local oSayGrFDes
   local cSayGrFDes
   local oThis
   local lOpen    := .T.
   local oError
   local oBlock   := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   ::oGruFam      := TGrpFam():Create( cPatEmp(), "GRPFAM" )
   ::oGruFam:OpenFiles()

   oThis          := ::oGruFam





   ::cGruFamOrg   := dbFirst( ::oGruFam:oDbf, 1 )
   ::cGruFamDes   := dbLast ( ::oGruFam:oDbf, 1 )
   cSayGrFOrg     := dbFirst( ::oGruFam:oDbf, 2 )
   cSayGrFDes     := dbLast ( ::oGruFam:oDbf, 2 )

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   if !Empty( nIdAllGrp )
   ::lAllGrp      := .T.


   TCheckBox():ReDefine( ( nIdAllGrp ), { | u | If( PCount()==0, ::lAllGrp, ::lAllGrp:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )
   else
      ::lAllGrp   := .F.
   end








   oGruFamOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cGruFamOrg, ::cGruFamOrg:= u ) }, ::oFld:aDialogs[1],,, {||    oThis:Existe( oGruFamOrg, oSayGrfOrg )}, "N/W*",,,,, .F., {||     ( !::lAllGrp )},, .F., .F.,,,,, {|Self|oThis:Buscar( oGruFamOrg )}, nil, "LUPA",, )





   oSayGrFOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayGrFOrg, cSayGrFOrg:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )








   oGruFamDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cGruFamDes, ::cGruFamDes:= u ) }, ::oFld:aDialogs[1],,, {||    oThis:Existe( oGruFamDes, oSayGrfDes )}, "N/W*",,,,, .F., {||     ( !::lAllGrp )},, .F., .F.,,,,, {|Self|oThis:Buscar( oGruFamDes )}, nil, "LUPA",, )




   oSayGrFDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayGrFDes, cSayGrFDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oGruFam )
         ::oGruFam:End()
      end
      lOpen       := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefTurInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oTurOrg
   local oTurDes
   local oSayTurOrg
   local cSayTurOrg
   local oSayTurDes
   local cSayTurDes

   ::oDbfTur      := TTurno():New( "Turno", "TURNO", cPatEmp() )
   ::oDbfTur:OpenFiles()





   ::cTurOrg      := dbFirst( ::oDbfTur:oDbf, 1 )
   ::cTurDes      := dbLast ( ::oDbfTur:oDbf, 1 )
   cSayTurOrg     := dbFirst( ::oDbfTur:oDbf, 2 )
   cSayTurDes     := dbLast ( ::oDbfTur:oDbf, 2 )

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;





   oTurOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cTurOrg, ::cTurOrg:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F.,,, .F., .F.,,,,,, nil, "LUPA",, )

   oTurOrg:bValid := {|| ::oDbfTur:Existe( oTurOrg, oSayTurOrg ) }
   oTurOrg:bHelp  := {|| ::oDbfTur:Buscar( oTurOrg ) }





   oSayTurOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayTurOrg, cSayTurOrg:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )





   oTurDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cTurDes, ::cTurDes:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F.,,, .F., .F.,,,,,, nil, "LUPA",, )

   oTurDes:bValid := {|| ::oDbfTur:Existe( oTurDes, oSayTurDes ) }
   oTurDes:bHelp  := {|| ::oDbfTur:Buscar( oTurDes ) }




   oTurDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayTurDes, cSayTurDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

RETURN ( Self )



static FUNCTION TInfGen_oDefObrInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllObr ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oObrOrg
   local oObrDes
   local oSayObrOrg
   local oSayObrDes
   local cSayObrOrg
   local cSayObrDes
   local oThis       := Self
   local lOpen       := .T.
   local oError
   local oBlock      := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   ::oDbfObr := DbfServer( "OBRAST.DBF", ):NewOpen( "OBRAST.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfObr:AddBag( "OBRAST.CDX" ) ; ::oDbfObr:AddBag( ) ; ::oDbfObr:AutoIndex()





   ::cObrOrg   := Space( 3 )
   ::cObrDes   := Space( 3 )
   cSayObrOrg  := ""
   cSayObrDes  := ""

   if nIdAllObr <> nil

      ::lAllObr := .T.



      TCheckBox():ReDefine( ( nIdAllObr ), { | u | If( PCount()==0, ::lAllObr, ::lAllObr:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

   end







   oObrOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cObrOrg, ::cObrOrg:= u ) }, ::oFld:aDialogs[1],,, {||    cObras( oObrOrg, oSayObrOrg, oThis:cCliOrg, oThis:oDbfObr:cAlias )},,,,,, .F., {||     ( ::cCliOrg == ::cCliDes .AND. !::lAllObr )},, .F., .F.,,,,, {|Self|BrwObras( oObrOrg, oSayObrOrg, oThis:cCliOrg, oThis:oDbfObr:cAlias )}, nil, "LUPA",, )




   oSayObrOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayObrOrg, cSayObrOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )







   oObrDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cObrDes, ::cObrDes:= u ) }, ::oFld:aDialogs[1],,, {||    cObras( oObrDes, oSayObrDes, oThis:cCliOrg, oThis:oDbfObr:cAlias )},,,,,, .F., {||     ( ::cCliOrg == ::cCliDes .AND. !::lAllObr )},, .F., .F.,,,,, {|Self|BrwObras( oObrDes, oSayObrDes, oThis:cCliOrg, oThis:oDbfObr:cAlias )}, nil, "LUPA",, )




   oSayObrDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayObrDes, cSayObrDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oDbfObr )
         ::oDbfObr:End()
      end
      lOpen       := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefRutInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllRut ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oRutOrg
   local oRutDes
   local oSayRutOrg
   local cSayRutOrg
   local oSayRutDes
   local cSayRutDes
   local This     := Self
   local lOpen    := .T.
   local oError
   local oBlock   := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   ::oDbfRut := DbfServer( "RUTA.DBF", ):NewOpen( "RUTA.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfRut:AddBag( "RUTA.CDX" ) ; ::oDbfRut:AddBag( ) ; ::oDbfRut:AutoIndex()





   ::cRutOrg         := dbFirst( ::oDbfRut, 1 )
   ::cRutDes         := dbLast( ::oDbfRut, 1 )
   cSayRutOrg        := RTrim( dbFirst( ::oDbfRut, 2 ) )
   cSayRutDes        := RTrim( dbLast(  ::oDbfRut, 2 ) )

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   if !Empty( nIdAllRut )
   ::lAllRut      := .T.


   TCheckBox():ReDefine( ( nIdAllRut ), { | u | If( PCount()==0, ::lAllRut, ::lAllRut:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )
   else
      ::lAllRut   := .F.
   end








   oRutOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cRutOrg, ::cRutOrg:= u ) }, ::oFld:aDialogs[1],,, {||    cRuta( oRutOrg, This:oDbfRut:cAlias, oSayRutOrg )}, "N/W*",,,,, .F., {||     ( !::lAllRut )},, .F., .F.,,,,, {|Self|BrwRuta( oRutOrg, This:oDbfRut:cAlias, oSayRutOrg )}, nil, "LUPA",, )





   oSayRutOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayRutOrg, cSayRutOrg:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )








   oRutDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cRutDes, ::cRutDes:= u ) }, ::oFld:aDialogs[1],,, {||    cRuta( oRutDes, This:oDbfRut:cAlias, oSayRutDes )}, "N/W*",,,,, .F., {||     ( !::lAllRut )},, .F., .F.,,,,, {|Self|BrwRuta( oRutDes, This:oDbfRut:cAlias, oSayRutDes )}, nil, "LUPA",, )




   oSayRutDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayRutDes, cSayRutDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oDbfRut )
         ::oDbfRut:End()
      end
      lOpen       := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefUsrInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllUsr ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oUsrOrg
   local oUsrDes
   local oSayUsrOrg
   local cSayUsrOrg
   local oSayUsrDes
   local cSayUsrDes
   local lOpen       := .T.

   ::lAllUsr         := .T.
   ::cUsrOrg         := ""
   ::cUsrDes         := ""
   cSayUsrOrg        := ""
   cSayUsrDes        := ""

   If( nIdOrg == nil, nIdOrg := 70, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
   If( nIdDes == nil, nIdDes := 80, ) ;
   If( nIdSayDes == nil, nIdSayDes := 81, ) ;

   if !Empty( nIdAllUsr )




      TCheckBox():ReDefine( ( nIdAllUsr ), { | u | If( PCount()==0, ::lAllUsr, ::lAllUsr:= u ) }, ::oFld:aDialogs[1],,,,,,, .F., {||     ( .F. )}, .F. )

   end




   oUsrOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cUsrOrg, ::cUsrOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lAllUsr )},, .F., .F.,,,,,, nil,,, )




   oSayUsrOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayUsrOrg, cSayUsrOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )





   oUsrDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cUsrDes, ::cUsrDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     ( !::lAllUsr )},, .F., .F.,,,,,, nil, "LUPA",, )




   oSayUsrDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayUsrDes, cSayUsrDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

RETURN ( lOpen )



static FUNCTION TInfGen_oDefCajInf( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, nIdAllCaj ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oCajOrg
   local oCajDes
   local oSayCajOrg
   local cSayCajOrg
   local oSayCajDes
   local cSayCajDes
   local lOpen    := .T.
   local oError
   local oBlock   := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

      ::oDbfCaj := DbfServer( "Cajas.Dbf", ):NewOpen( "Cajas.Dbf",, ( cDriver() ),, ( cPatDat() ), .F., .T., .F., .F. ) ; ::oDbfCaj:AddBag( "Cajas.Cdx" ) ; ::oDbfCaj:AddBag( ) ; ::oDbfCaj:AutoIndex()





      ::cCajOrg         := dbFirst( ::oDbfCaj, 1 )
      ::cCajDes         := dbLast( ::oDbfCaj, 1 )
      cSayCajOrg        := RTrim( dbFirst( ::oDbfCaj, 2 ) )
      cSayCajDes        := RTrim( dbLast( ::oDbfCaj, 2 ) )

      If( nIdOrg == nil, nIdOrg := 70, ) ;
      If( nIdSayOrg == nil, nIdSayOrg := 71, ) ;
      If( nIdDes == nil, nIdDes := 80, ) ;
      If( nIdSayDes == nil, nIdSayDes := 81, ) ;

      if !Empty( nIdAllCaj )

         ::lAllCaj      := .T.


         TCheckBox():ReDefine( ( nIdAllCaj ), { | u | If( PCount()==0, ::lAllCaj, ::lAllCaj:= u ) }, ::oFld:aDialogs[1],,,,,,, .F.,, .F. )

      else

         ::lAllCaj      := .F.

      end






      oCajOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cCajOrg, ::cCajOrg:= u ) }, ::oFld:aDialogs[1],,, {||    cCajas( oCajOrg, ::oDbfCaj:cAlias, oSayCajOrg )},,,,,, .F., {||     ( !::lAllCaj )},, .F., .F.,,,,,, nil, "LUPA",, )

      oCajOrg:bHelp  := {|| BrwCajas( oCajOrg, oSayCajOrg ) }





      oSayCajOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayCajOrg, cSayCajOrg:= u ) }, ::oFld:aDialogs[1],,,, "N/W*",,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )






      oCajDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cCajDes, ::cCajDes:= u ) }, ::oFld:aDialogs[1],,, {||    cCajas( oCajDes, ::oDbfCaj:cAlias, oSayCajDes )},,,,,, .F., {||     ( !::lAllCaj )},, .F., .F.,,,,,, nil, "LUPA",, )

      oCajDes:bHelp  := {|| BrwCajas( oCajDes, oSayCajDes ) }




      oSayCajDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayCajDes, cSayCajDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty ( ::oDbfCaj )
         ::oDbfCaj:End()
      end
      lOpen       := .F.

      return lOpen

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_PutOriginal( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::CreateColumn()

   ::oBrwCol:SetArray( ::aoCols )
   ::oBrwCol:Refresh()

return nil



static FUNCTION TInfGen_PrnTiket( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

return ( Self )



static FUNCTION TInfGen_FldCliente( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField( "cCodCli", "C", 12, 0,  {|| "@!" },         "Cód. cli.",                 .T., "Código cliente",              8 )
   ::AddField( "cNomCli", "C", 50, 0,  {|| "@!" },         "Cliente",                   .T., "Nombre cliente",             30 )
   ::AddField( "cNifCli", "C", 15, 0,  {|| "@!" },         "Nif",                       .F., "Nif",                        12 )
   ::AddField( "cDomCli", "C", 35, 0,  {|| "@!" },         "Domicilio",                 .F., "Domicilio",                  20 )
   ::AddField( "cPobCli", "C", 25, 0,  {|| "@!" },         "Población",                 .F., "Población",                  25 )
   ::AddField( "cProCli", "C", 20, 0,  {|| "@!" },         "Provincia",                 .F., "Provincia",                  20 )
   ::AddField( "cCdpCli", "C",  7, 0,  {|| "@!" },         "Cod. pos.",                 .F., "Código postal",               7 )
   ::AddField( "cTlfCli", "C", 12, 0,  {|| "@!" },         "Teléfono",                  .F., "Teléfono",                   12 )
   ::AddField( "cObrCli", "C", 10, 0,  {|| "@!" },         "Dirección",                      .F., "Código dirección",                12 )
   ::AddField( "cNbrEst", "C", 35, 0,  {|| "@!" },         "Establecimiento",           .F., "Nombre establecimiento",     50 )

RETURN nil



static FUNCTION TInfGen_FldPropiedades( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField( "cCodPr1", "C", 20, 0, {|| "@!" },        "Cod. prp. 1",       .F., "Código propiedad 1",        6, .F. )
   ::AddField( "cNomPr1", "C", 35, 0, {|| "@!" },        "Nom. prp. 1",       .F., "Nombre propiedad 1",       20, .F. )
   ::AddField( "cValPr1", "C", 20, 0, {|| "@!" },        "Val. prp. 1",       .F., "Valor propiedad 1",         6, .F. )
   ::AddField( "cNomVl1", "C", 30, 0, {|| "@!" },        "Nom. val. prp. 1",  .F., "Nombre valor propiedad 1", 20, .F. )
   ::AddField( "cCodPr2", "C", 20, 0, {|| "@!" },        "Cod. prp. 2",       .F., "Código propiedad 2",        6, .F. )
   ::AddField( "cNomPr2", "C", 35, 0, {|| "@!" },        "Nom. prp. 2",       .F., "Nombre propiedad 2",       20, .F. )
   ::AddField( "cValPr2", "C", 20, 0, {|| "@!" },        "Val. prp. 2",       .F., "Valor propiedad 2",         6, .F. )
   ::AddField( "cNomVl2", "C", 30, 0, {|| "@!" },        "Nom. val. prp. 2",  .F., "Nombre valor propiedad 2", 20, .F. )

RETURN nil



static FUNCTION TInfGen_FldArticulo( lVisible, lPropiedades, lLote ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( lVisible == nil, lVisible := .F., ) ;
   If( lPropiedades == nil, lPropiedades := .T., ) ;
   If( lLote == nil, lLote := .T., ) ;

   ::AddField( "cCodArt",  "C", 18, 0, {|| "@!" },                "Cod. artículo",     lVisible, "Código del artículo",       14, .F. )
   ::AddField( "cNomArt",  "C",100, 0, {|| "@!" },                "Descripción",       lVisible, "Nombre del artículo",       35, .F. )

   if lPropiedades

      ::AddField( "cCodPr1",  "C", 20, 0, {|| "@!" },                "Cod. prp. 1",       .F., "Código propiedad 1",              6, .F. )
      ::AddField( "cNomPr1",  "C", 35, 0, {|| "@!" },                "Nom. prp. 1",       .F., "Nombre propiedad 1",             20, .F. )
      ::AddField( "cValPr1",  "C", 20, 0, {|| "@!" },                "Val. prp. 1",       .F., "Valor propiedad 1",               6, .F. )
      ::AddField( "cNomVl1",  "C", 30, 0, {|| "@!" },                "Nom. val. prp. 1",  .F., "Nombre valor propiedad 1",       20, .F. )
      ::AddField( "cCodPr2",  "C", 20, 0, {|| "@!" },                "Cod. prp. 2",       .F., "Código propiedad 2",              6, .F. )
      ::AddField( "cNomPr2",  "C", 35, 0, {|| "@!" },                "Nom. prp. 2",       .F., "Nombre propiedad 2",             20, .F. )
      ::AddField( "cValPr2",  "C", 20, 0, {|| "@!" },                "Val. prp. 2",       .F., "Valor propiedad 2",               6, .F. )
      ::AddField( "cNomVl2",  "C", 30, 0, {|| "@!" },                "Nom. val. prp. 2",  .F., "Nombre valor propiedad 2",       20, .F. )

   end

   if lLote

      ::AddField( "cLote",    "C", 64, 0, {|| "@!" },                "Lote",              .F., "Número de lote",                 10, .F. )

   end

   ::AddField( "nMinimo",  "N", 15, 6, {|| "@!" },                "Stk. mínimo",       .F., "Número de stock mínimo",         20, .F. )
   ::AddField( "nMaximo",  "N", 15, 6, {|| "@!" },                "Stk. máximo",       .F., "Número de stock maximo",         20, .F. )
   ::AddField( "nPesoKg",  "N", 16, 6, {|| "@E 999,999.999999" }, "Peso artículo",     .F., "Peso del artículo",              20, .F. )
   ::AddField( "cUnidad",  "C",  2, 0, {|| "@!" },                "Unidad peso",       .F., "Unidad de medición del peso",    20, .F. )
   ::AddField( "nVolumen", "N", 16, 6, {|| "@E 999,999.999999" }, "Vol. artículo",     .F., "Volumen del artículo",           20, .F. )
   ::AddField( "cVolumen", "C",  2, 0, {|| "@!" },                "Unidad vol.",       .F., "Unidad de medición del volumen", 20, .F. )
   ::AddField( "nLngArt",  "N", 16, 6, {|| "@E 999,999.999999" }, "Largo art.",        .F., "Largo del artículo",             20, .F. )
   ::AddField( "nAltArt",  "N", 16, 6, {|| "@E 999,999.999999" }, "Alto art.",         .F., "Alto del artículo",              20, .F. )
   ::AddField( "nAncArt",  "N", 16, 6, {|| "@E 999,999.999999" }, "Ancho art.",        .F., "Ancho del artículo",             20, .F. )
   ::AddField( "cUndDim",  "C",  2, 0, {|| "@!" },                "Und. longitud",     .F., "Unidad de las longitudes",       20, .F. )
   ::AddField( "nLngCaj",  "N", 16, 6, {|| "@E 999,999.999999" }, "Largo caja",        .F., "Largo del la caja",              20, .F. )
   ::AddField( "nAltCaj",  "N", 16, 6, {|| "@E 999,999.999999" }, "Alto caja",         .F., "Alto de la caja",                20, .F. )
   ::AddField( "nAncCaj",  "N", 16, 6, {|| "@E 999,999.999999" }, "Ancho caja",        .F., "Ancho de la caja",               20, .F. )
   ::AddField( "nPesCaj",  "N", 16, 6, {|| "@E 999,999.999999" }, "Peso caja",         .F., "Peso de la caja",                20, .F. )
   ::AddField( "nVolCaj",  "N", 16, 6, {|| "@E 999,999.999999" }, "Vol. caja",         .F., "Volumen de la caja",             20, .F. )
   ::AddField( "nCajPlt",  "N", 16, 6, {|| "@E 999,999.999999" }, "Cajas/Palet",       .F., "Número de cajas por palets",     20, .F. )
   ::AddField( "nBasPlt",  "N", 16, 6, {|| "@E 999,999.999999" }, "Base palet",        .F., "Base del palet",                 20, .F. )
   ::AddField( "nAltPlt",  "N", 16, 6, {|| "@E 999,999.999999" }, "Altura Palet",      .F., "Altura del palet",               20, .F. )

Return nil



static FUNCTION TInfGen_AddArticulo( cCodArt, oDbfArt, oDbfLin, lPrp, lLote ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oError
   local oBlock
   local lOpen    := .F.

   If( lPrp == nil, lPrp := .T., ) ;
   If( lLote == nil, lLote := .T., ) ;

   oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   if oDbfArt == nil
      oDbfArt := DbfServer( "ARTICULO.DBF", ):NewOpen( "ARTICULO.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; oDbfArt:AddBag( "ARTICULO.CDX" ) ; oDbfArt:AddBag( ) ; oDbfArt:AutoIndex()
      lOpen       := .T.
   end

   if oDbfArt:Seek( cCodArt )
      ::oDbf:cCodArt    := cCodArt
      ::oDbf:cNomArt    := oDbfArt:Nombre
      ::oDbf:nMinimo    := oDbfArt:nMinimo
      ::oDbf:nMaximo    := oDbfArt:nMaximo
      ::oDbf:nPesoKg    := oDbfArt:nPesoKg
      ::oDbf:cUnidad    := oDbfArt:cUnidad
      ::oDbf:nVolumen   := oDbfArt:nVolumen
      ::oDbf:cVolumen   := oDbfArt:cVolumen
      ::oDbf:nLngArt    := oDbfArt:nLngArt
      ::oDbf:nAltArt    := oDbfArt:nAltArt
      ::oDbf:nAncArt    := oDbfArt:nAncArt
      ::oDbf:cUndDim    := oDbfArt:cUndDim
      ::oDbf:nLngCaj    := oDbfArt:nLngCaj
      ::oDbf:nAltCaj    := oDbfArt:nAltCaj
      ::oDbf:nAncCaj    := oDbfArt:nAncCaj
      ::oDbf:nPesCaj    := oDbfArt:nPesCaj
      ::oDbf:nVolCaj    := oDbfArt:nVolCaj
      ::oDbf:nCajPlt    := oDbfArt:nCajPlt
      ::oDbf:nBasPlt    := oDbfArt:nBasPlt
      ::oDbf:nAltPlt    := oDbfArt:nAltPlt
   end

   if oDbfLin <> nil

      if lPrp

         ::oDbf:cCodPr1 := oDbfLin:cCodPr1
         ::oDbf:cNomPr1 := retProp( oDbfLin:cCodPr1 )
         ::oDbf:cValPr1 := oDbfLin:cValPr1
         ::oDbf:cNomVl1 := retValProp( oDbfLin:cCodPr1 + oDbfLin:cValPr1 )
         ::oDbf:cCodPr2 := oDbfLin:cCodPr2
         ::oDbf:cNomPr2 := retProp( oDbfLin:cCodPr2 )
         ::oDbf:cValPr2 := oDbfLin:cValPr2
         ::oDbf:cNomVl2 := retValProp( oDbfLin:cCodPr2 + oDbfLin:cValPr2 )

      end

      if lLote

         ::oDbf:cLote   := oDbfLin:cLote

      end

   end

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if lOpen
         oDbfArt:End()
      end

   end

   ErrorBlock( oBlock )

Return ( Self )



static FUNCTION TInfGen_FldDiario( lTiket ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( lTiket == nil, lTiket := .F., ) ;

   if lTiket
   ::AddField( "cDocMov", "C", 14, 0, {|| "@R #/##########/##" }, "Doc.",     .T., "Documento",     14 )
   else
   ::AddField( "cDocMov", "C", 14, 0, {|| "@R #/#########/##" },  "Doc.",     .T., "Documento",     14 )
   end
   ::AddField( "dFecMov", "D",  8, 0, {|| "@!" },                 "Fecha",    .T., "Fecha",         10 )
   ::FldCliente()
   ::AddField( "nTotNet", "N", 16, 6, {|| ::cPicOut },            "Neto",     .T., "Neto",          10, .T. )
   ::AddField( "nTotPnt", "N", 16, 6, {|| ::cPicPnt },            "P.V.",     .F., "Punto verde",   10, .T. )
   ::AddField( "nTotTrn", "N", 16, 6, {|| ::cPicOut },            "Transp.",  .F., "Transporte",    10, .T. )
   ::AddField( "nTotIva", "N", 16, 6, {|| ::cPicOut },            cImp(),      .T., cImp(),           10, .T. )
   ::AddField( "nTotReq", "N", 16, 3, {|| ::cPicOut },            "Rec",      .T., "Rec",           10, .T. )
   ::AddField( "nTotDoc", "N", 16, 6, {|| ::cPicOut },            "Total",    .T., "Total",         10, .T. )
   ::AddField( "cTipVen", "C", 20, 0, {|| "@!" },                 "Venta",    .F., "Tipo de venta", 20 )

RETURN nil



static FUNCTION TInfGen_FldDiaPrv( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField( "cCodPrv", "C", 12, 0, {|| "@!" },         "Prv.",                      .T., "Cod. Proveedor",             9 )
   ::AddField( "cNomPrv", "C", 50, 0, {|| "@!" },         "Proveedor",                 .T., "Nombre Proveedor",          35 )
   ::AddField( "cNifPrv", "C", 15, 0, {|| "@!" },         "Nif",                       .F., "Nif",                       15 )
   ::AddField( "cDomPrv", "C", 35, 0, {|| "@!" },         "Domicilio",                 .F., "Domicilio",                 35 )
   ::AddField( "cPobPrv", "C", 25, 0, {|| "@!" },         "Población",                 .F., "Población",                 25 )
   ::AddField( "cProPrv", "C", 20, 0, {|| "@!" },         "Provincia",                 .F., "Provincia",                 20 )
   ::AddField( "cCdpPrv", "C",  7, 0, {|| "@!" },         "CP",                        .F., "Cod. Postal",                7 )
   ::AddField( "cTlfPrv", "C", 12, 0, {|| "@!" },         "Tlf",                       .F., "Teléfono",                  12 )
   ::AddField( "nTotNet", "N", 16, 6, {|| ::cPicOut  },   "Neto",                      .T., "Neto",                      10 )
   ::AddField( "nTotPnt", "N", 16, 6, {|| ::cPicPnt },    "P.V.",                      .T., "Punto Verde",               10 )
   ::AddField( "nTotTrn", "N", 16, 6, {|| ::cPicOut },    "Transp.",                   .T., "Transporte",                10 )
   ::AddField( "nTotIva", "N", 16, 6, {|| ::cPicOut  },   cImp(),                       .T., cImp(),                       10 )
   ::AddField( "nTotReq", "N", 16, 3, {|| ::cPicOut  },   "Rec",                       .F., "Rec",                       10 )
   ::AddField( "nTotDoc", "N", 16, 6, {|| ::cPicOut },    "Total",                     .T., "Total",                     10 )
   ::AddField( "cDocMov", "C", 14, 0, {|| "@!" },         "Doc.",                      .T., "Documento",                 14 )
   ::AddField( "dFecMov", "D",  8, 0, {|| "@!" },         "Fecha",                     .T., "Fecha",                     14 )

RETURN nil



static FUNCTION TInfGen_CreateFldAnu( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField( "cCodArt", "C", 18, 0, {|| "@!" },         "Cod. articulo",           .F., "Cod. Artículo",           14 )
   ::AddField( "cNomArt", "C",100, 0, {|| "@!" },         "Artículo",                .F., "Nom. Artículo",           20 )
   ::AddField( "cCodAlm", "C", 16, 0, {|| "@!" },         "Alm",                     .T., "Cod. almacén",             3 )
   ::AddField( "cNomAlm", "C", 50, 0, {|| "@!" },         "Almacém",                 .T., "Nombre almacén",          15 )
   ::AddField( "nImpEne", "N", 16, 6, {|| ::cPicOut },    "Ene",                     .T., "Enero",                   12 )
   ::AddField( "nImpFeb", "N", 16, 6, {|| ::cPicOut },    "Feb",                     .T., "Febrero",                 12 )
   ::AddField( "nImpMar", "N", 16, 6, {|| ::cPicOut },    "Mar",                     .T., "Marzo",                   12 )
   ::AddField( "nImpAbr", "N", 16, 6, {|| ::cPicOut },    "Abr",                     .T., "Abril",                   12 )
   ::AddField( "nImpMay", "N", 16, 6, {|| ::cPicOut },    "May",                     .T., "Mayo",                    12 )
   ::AddField( "nImpJun", "N", 16, 6, {|| ::cPicOut },    "Jun",                     .T., "Junio",                   12 )
   ::AddField( "nImpJul", "N", 16, 6, {|| ::cPicOut },    "Jul",                     .T., "Julio",                   12 )
   ::AddField( "nImpAgo", "N", 16, 6, {|| ::cPicOut },    "Ago",                     .T., "Agosto",                  12 )
   ::AddField( "nImpSep", "N", 16, 6, {|| ::cPicOut },    "Sep",                     .T., "Septiembre",              12 )
   ::AddField( "nImpOct", "N", 16, 6, {|| ::cPicOut },    "Oct",                     .T., "Octubre",                 12 )
   ::AddField( "nImpNov", "N", 16, 6, {|| ::cPicOut },    "Nov",                     .T., "Noviembre",               12 )
   ::AddField( "nImpDic", "N", 16, 6, {|| ::cPicOut },    "Dic",                     .T., "Diciembre",               12 )
   ::AddField( "nImpTot", "N", 16, 6, {|| ::cPicOut },    "Tot",                     .T., "Total",                   12 )
   ::AddField( "nMedia",  "N", 16, 6, {|| ::cPicOut },    "Media",                   .T., "Media",                   12 )

RETURN nil



static FUNCTION TInfGen_GrupoAnuCreateFld( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField ( "CCODART", "C", 18, 0, {|| "@!" },         "Cod. articulo",    .F., "Cod. Artículo",             14 )
   ::AddField ( "CNOMART", "C",100, 0, {|| "@!" },         "Artículo",         .F., "Nom. Artículo",             20 )
   ::AddField ( "CGRPFAM", "C",  5, 0, {|| "@!" },         "Cod. Grp.",        .T., "Codigo grupo familia",       8 )
   ::AddField ( "CNOMGRP", "C", 20, 0, {|| "@!" },         "Grupo",            .T., "Nom. grupo",                20 )
   ::AddField ( "NIMPENE", "N", 16, 6, {|| ::cPicOut },    "Ene",              .T., "Enero",                     12 )
   ::AddField ( "NIMPFEB", "N", 16, 6, {|| ::cPicOut },    "Feb",              .T., "Febrero",                   12 )
   ::AddField ( "NIMPMAR", "N", 16, 6, {|| ::cPicOut },    "Mar",              .T., "Marzo",                     12 )
   ::AddField ( "NIMPABR", "N", 16, 6, {|| ::cPicOut },    "Abr",              .T., "Abril",                     12 )
   ::AddField ( "NIMPMAY", "N", 16, 6, {|| ::cPicOut },    "May",              .T., "Mayo",                      12 )
   ::AddField ( "NIMPJUN", "N", 16, 6, {|| ::cPicOut },    "Jun",              .T., "Junio",                     12 )
   ::AddField ( "NIMPJUL", "N", 16, 6, {|| ::cPicOut },    "Jul",              .T., "Julio",                     12 )
   ::AddField ( "NIMPAGO", "N", 16, 6, {|| ::cPicOut },    "Ago",              .T., "Agosto",                    12 )
   ::AddField ( "NIMPSEP", "N", 16, 6, {|| ::cPicOut },    "Sep",              .T., "Septiembre",                12 )
   ::AddField ( "NIMPOCT", "N", 16, 6, {|| ::cPicOut },    "Oct",              .T., "Octubre",                   12 )
   ::AddField ( "NIMPNOV", "N", 16, 6, {|| ::cPicOut },    "Nov",              .T., "Noviembre",                 12 )
   ::AddField ( "NIMPDIC", "N", 16, 6, {|| ::cPicOut },    "Dic",              .T., "Diciembre",                 12 )
   ::AddField ( "NIMPTOT", "N", 16, 6, {|| ::cPicOut },    "Tot",              .T., "Total",                     12 )
   ::AddField ( "nMedia",  "N", 16, 6, {|| ::cPicOut },    "Media",            .T., "Media",                     12 )

RETURN nil



static FUNCTION TInfGen_FamAnuCreateFld( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField ( "cCodFam", "C", 16, 0, {|| "@!" },         "Cod.fam.",         .T., "Cod. familia",               5 )
   ::AddField ( "cNomFam", "C", 40, 0, {|| "@!" },         "Família",          .T., "Nom. família",              40 )
   ::AddField ( "cCodArt", "C", 18, 0, {|| "@!" },         "Código artículo",        .F., "Cod. artículo",             14 )
   ::AddField ( "cNomArt", "C",100, 0, {|| "@!" },         "Artículo",         .F., "Nom. artículo",             20 )
   ::AddField ( "nImpEne", "N", 16, 6, {|| ::cPicOut },    "Ene",              .T., "Enero",                     12 )
   ::AddField ( "nImpFeb", "N", 16, 6, {|| ::cPicOut },    "Feb",              .T., "Febrero",                   12 )
   ::AddField ( "nImpMar", "N", 16, 6, {|| ::cPicOut },    "Mar",              .T., "Marzo",                     12 )
   ::AddField ( "nImpAbr", "N", 16, 6, {|| ::cPicOut },    "Abr",              .T., "Abril",                     12 )
   ::AddField ( "nImpMay", "N", 16, 6, {|| ::cPicOut },    "May",              .T., "Mayo",                      12 )
   ::AddField ( "nImpJun", "N", 16, 6, {|| ::cPicOut },    "Jun",              .T., "Junio",                     12 )
   ::AddField ( "nImpJul", "N", 16, 6, {|| ::cPicOut },    "Jul",              .T., "Julio",                     12 )
   ::AddField ( "nImpAgo", "N", 16, 6, {|| ::cPicOut },    "Ago",              .T., "Agosto",                    12 )
   ::AddField ( "nImpSep", "N", 16, 6, {|| ::cPicOut },    "Sep",              .T., "Septiembre",                12 )
   ::AddField ( "nImpOct", "N", 16, 6, {|| ::cPicOut },    "Oct",              .T., "Octubre",                   12 )
   ::AddField ( "nImpNov", "N", 16, 6, {|| ::cPicOut },    "Nov",              .T., "Noviembre",                 12 )
   ::AddField ( "nImpDic", "N", 16, 6, {|| ::cPicOut },    "Dic",              .T., "Diciembre",                 12 )
   ::AddField ( "nImpTot", "N", 16, 6, {|| ::cPicOut },    "Tot",              .T., "Total",                     12 )
   ::AddField ( "nMedia",  "N", 16, 6, {|| ::cPicOut },    "Media",            .T., "Media",                     12 )

RETURN nil



static FUNCTION TInfGen_TipAnuCreateFld( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField ( "cCodTip", "C",  3, 0, {|| "@!" },         "Cod.",             .T., "Código tipo",                3 )
   ::AddField ( "cNomTip", "C", 50, 0, {|| "@!" },         "Tipo",             .T., "Tipo de artículo",          28 )
   ::AddField ( "cCodArt", "C", 18, 0, {|| "@!" },         "Cod. articulo",    .F., "Cod. Artículo",             14 )
   ::AddField ( "cNomArt", "C",100, 0, {|| "@!" },         "Artículo",         .F., "Nom. Artículo",             20 )
   ::AddField ( "nImpEne", "N", 16, 6, {|| ::cPicOut },    "Ene",              .T., "Enero",                     12 )
   ::AddField ( "nImpFeb", "N", 16, 6, {|| ::cPicOut },    "Feb",              .T., "Febrero",                   12 )
   ::AddField ( "nImpMar", "N", 16, 6, {|| ::cPicOut },    "Mar",              .T., "Marzo",                     12 )
   ::AddField ( "nImpAbr", "N", 16, 6, {|| ::cPicOut },    "Abr",              .T., "Abril",                     12 )
   ::AddField ( "nImpMay", "N", 16, 6, {|| ::cPicOut },    "May",              .T., "Mayo",                      12 )
   ::AddField ( "nImpJun", "N", 16, 6, {|| ::cPicOut },    "Jun",              .T., "Junio",                     12 )
   ::AddField ( "nImpJul", "N", 16, 6, {|| ::cPicOut },    "Jul",              .T., "Julio",                     12 )
   ::AddField ( "nImpAgo", "N", 16, 6, {|| ::cPicOut },    "Ago",              .T., "Agosto",                    12 )
   ::AddField ( "nImpSep", "N", 16, 6, {|| ::cPicOut },    "Sep",              .T., "Septiembre",                12 )
   ::AddField ( "nImpOct", "N", 16, 6, {|| ::cPicOut },    "Oct",              .T., "Octubre",                   12 )
   ::AddField ( "nImpNov", "N", 16, 6, {|| ::cPicOut },    "Nov",              .T., "Noviembre",                 12 )
   ::AddField ( "nImpDic", "N", 16, 6, {|| ::cPicOut },    "Dic",              .T., "Diciembre",                 12 )
   ::AddField ( "nImpTot", "N", 16, 6, {|| ::cPicOut },    "Tot",              .T., "Total",                     12 )
   ::AddField ( "nMedia",  "N", 16, 6, {|| ::cPicOut },    "Media",            .T., "Media",                     12 )

RETURN nil



static FUNCTION TInfGen_ArtAnuCreateFld( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField ( "cCodArt", "C", 18, 0, {|| "@!" },         "Cod. articulo",    .T., "Cod. Artículo",             14 )
   ::AddField ( "cNomArt", "C",100, 0, {|| "@!" },         "Artículo",         .T., "Nom. Artículo",             20 )
   ::AddField ( "nImpEne", "N", 16, 6, {|| ::cPicOut },    "Ene",              .T., "Enero",                     12 )
   ::AddField ( "nImpFeb", "N", 16, 6, {|| ::cPicOut },    "Feb",              .T., "Febrero",                   12 )
   ::AddField ( "nImpMar", "N", 16, 6, {|| ::cPicOut },    "Mar",              .T., "Marzo",                     12 )
   ::AddField ( "nImpAbr", "N", 16, 6, {|| ::cPicOut },    "Abr",              .T., "Abril",                     12 )
   ::AddField ( "nImpMay", "N", 16, 6, {|| ::cPicOut },    "May",              .T., "Mayo",                      12 )
   ::AddField ( "nImpJun", "N", 16, 6, {|| ::cPicOut },    "Jun",              .T., "Junio",                     12 )
   ::AddField ( "nImpJul", "N", 16, 6, {|| ::cPicOut },    "Jul",              .T., "Julio",                     12 )
   ::AddField ( "nImpAgo", "N", 16, 6, {|| ::cPicOut },    "Ago",              .T., "Agosto",                    12 )
   ::AddField ( "nImpSep", "N", 16, 6, {|| ::cPicOut },    "Sep",              .T., "Septiembre",                12 )
   ::AddField ( "nImpOct", "N", 16, 6, {|| ::cPicOut },    "Oct",              .T., "Octubre",                   12 )
   ::AddField ( "nImpNov", "N", 16, 6, {|| ::cPicOut },    "Nov",              .T., "Noviembre",                 12 )
   ::AddField ( "nImpDic", "N", 16, 6, {|| ::cPicOut },    "Dic",              .T., "Diciembre",                 12 )
   ::AddField ( "nImpTot", "N", 16, 6, {|| ::cPicOut },    "Tot",              .T., "Total",                     12 )
   ::AddField ( "nMedia",  "N", 16, 6, {|| ::cPicOut },    "Media",            .T., "Media",                     12 )

RETURN nil



static FUNCTION TInfGen_CliAnuCreateFld( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::FldCliente()
   ::AddField ( "nImpEne", "N", 16, 6, {|| ::cPicOut },    "Ene",              .T., "Enero",                     12 )
   ::AddField ( "nImpFeb", "N", 16, 6, {|| ::cPicOut },    "Feb",              .T., "Febrero",                   12 )
   ::AddField ( "nImpMar", "N", 16, 6, {|| ::cPicOut },    "Mar",              .T., "Marzo",                     12 )
   ::AddField ( "nImpAbr", "N", 16, 6, {|| ::cPicOut },    "Abr",              .T., "Abril",                     12 )
   ::AddField ( "nImpMay", "N", 16, 6, {|| ::cPicOut },    "May",              .T., "Mayo",                      12 )
   ::AddField ( "nImpJun", "N", 16, 6, {|| ::cPicOut },    "Jun",              .T., "Junio",                     12 )
   ::AddField ( "nImpJul", "N", 16, 6, {|| ::cPicOut },    "Jul",              .T., "Julio",                     12 )
   ::AddField ( "nImpAgo", "N", 16, 6, {|| ::cPicOut },    "Ago",              .T., "Agosto",                    12 )
   ::AddField ( "nImpSep", "N", 16, 6, {|| ::cPicOut },    "Sep",              .T., "Septiembre",                12 )
   ::AddField ( "nImpOct", "N", 16, 6, {|| ::cPicOut },    "Oct",              .T., "Octubre",                   12 )
   ::AddField ( "nImpNov", "N", 16, 6, {|| ::cPicOut },    "Nov",              .T., "Noviembre",                 12 )
   ::AddField ( "nImpDic", "N", 16, 6, {|| ::cPicOut },    "Dic",              .T., "Diciembre",                 12 )
   ::AddField ( "nImpTot", "N", 16, 6, {|| ::cPicOut },    "Tot",              .T., "Total",                     12 )
   ::AddField ( "nMedia",  "N", 16, 6, {|| ::cPicOut },    "Media",            .T., "Media",                     12 )

RETURN nil



static FUNCTION TInfGen_AgeAnuCreateFld( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField ( "cCodAge", "C",  3, 0, {|| "@!" },         "Cod. Age. ",       .T., "Código agente",     3 )
   ::AddField ( "cNomAge", "C", 50, 0, {|| "@!" },         "Agente",           .T., "Nombre agente",    28 )
   ::AddField ( "nImpEne", "N", 16, 6, {|| ::cPicOut },    "Ene",              .T., "Enero",            12 )
   ::AddField ( "nImpFeb", "N", 16, 6, {|| ::cPicOut },    "Feb",              .T., "Febrero",          12 )
   ::AddField ( "nImpMar", "N", 16, 6, {|| ::cPicOut },    "Mar",              .T., "Marzo",            12 )
   ::AddField ( "nImpAbr", "N", 16, 6, {|| ::cPicOut },    "Abr",              .T., "Abril",            12 )
   ::AddField ( "nImpMay", "N", 16, 6, {|| ::cPicOut },    "May",              .T., "Mayo",             12 )
   ::AddField ( "nImpJun", "N", 16, 6, {|| ::cPicOut },    "Jun",              .T., "Junio",            12 )
   ::AddField ( "nImpJul", "N", 16, 6, {|| ::cPicOut },    "Jul",              .T., "Julio",            12 )
   ::AddField ( "nImpAgo", "N", 16, 6, {|| ::cPicOut },    "Ago",              .T., "Agosto",           12 )
   ::AddField ( "nImpSep", "N", 16, 6, {|| ::cPicOut },    "Sep",              .T., "Septiembre",       12 )
   ::AddField ( "nImpOct", "N", 16, 6, {|| ::cPicOut },    "Oct",              .T., "Octubre",          12 )
   ::AddField ( "nImpNov", "N", 16, 6, {|| ::cPicOut },    "Nov",              .T., "Noviembre",        12 )
   ::AddField ( "nImpDic", "N", 16, 6, {|| ::cPicOut },    "Dic",              .T., "Diciembre",        12 )
   ::AddField ( "nImpTot", "N", 16, 6, {|| ::cPicOut },    "Tot",              .T., "Total",            12 )
   ::AddField ( "nMedia",  "N", 16, 6, {|| ::cPicOut },    "Media",            .T., "Media",            12 )

RETURN nil



static FUNCTION TInfGen_CreateFldRut( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField( "CCODRUT", "C",  4, 0, {|| "@!" },          "Ruta",      .F.,        "Código ruta",                4  )
   ::AddField( "CCODCLI", "C", 12, 0, {|| "@!" },          "Cli.",      .F.,        "Código cliente",             8  )
   ::AddField( "CCODFAM", "C", 16, 0, {|| "@!" },          "Cod.",      .T.,        "Código grupo de familia",    5  )
   ::AddField( "CNOMGRF", "C", 35, 0, {|| "@!" },          "Gru. Fam.", .T.,        "Nombre grupo de familia",   25  )
   ::AddField( "CNOMCLI", "C", 50, 0, {|| "@!" },          "Nombre",    .F.,        "Nombre cliente",            25  )
   ::AddField( "NNUMCAJ", "N", 19, 6, {|| MasUnd() },      "Caj.",      lUseCaj(),  "Cajas",                     12  )
   ::AddField( "NNUMUND", "N", 19, 6, {|| MasUnd() },      "Und.",      .T.,        "Unidades",                  12  )
   ::AddField( "NUNDCAJ", "N", 19, 6, {|| MasUnd() },      "Tot. Und.", lUseCaj(),  "Unidades por caja",         12  )
   ::AddField( "NCOMAGE", "N", 19, 6, {|| ::cPicOut },     "Com. Age.", .F.,        "Comisión agente",           12  )
   ::AddField( "NACUIMP", "N", 19, 6, {|| ::cPicOut },     "Imp.",      .T.,        "Importe",                   12  )
   ::AddField( "NACUCAJ", "N", 19, 6, {|| MasUnd() },      "Caj. Acu.", lUseCaj(),  "Cajas acumuladas" ,         12  )
   ::AddField( "NACUUND", "N", 19, 6, {|| MasUnd() },      "Und. Acu.", .T.,        "Unidades acumuladas" ,      12  )
   ::AddField( "NACUUXC", "N", 19, 6, {|| MasUnd() },      "Tot. Acu.", lUseCaj(),  "Acumulado cajas x unidades",12  )
   ::AddField( "NTOTMOV", "N", 19, 6, {|| ::cPicOut },     "Imp. Acu.", .T.,        "Importe" ,                  12  )

RETURN nil



static FUNCTION TInfGen_AddCliente( cCodCli, oDbfDocT, lTiket ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oError
   local oBlock

   If( lTiket == nil, lTiket := .F., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

      if ::oDbfCli == nil
         ::oDbfCli := DbfServer( "CLIENT.DBF", ):NewOpen( "CLIENT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfCli:AddBag( "CLIENT.CDX" ) ; ::oDbfCli:AddBag( ) ; ::oDbfCli:AutoIndex()
      end

      ::oDbf:cCodCli    := cCodCli
      ::oDbf:cNifCli    := oDbfDocT:cDniCli

      if lTiket
         ::oDbf:cNomCli := oDbfDocT:cNomTik
      else
         ::oDbf:cNomCli := oDbfDocT:cNomCli
      end

      ::oDbf:cDomCli    := oDbfDocT:cDirCli
      ::oDbf:cPobCli    := oDbfDocT:cPobCli
      ::oDbf:cProCli    := oDbfDocT:cPrvCli
      ::oDbf:cCdpCli    := oDbfDocT:cPosCli

      if oDbfDocT:FieldPos( "cCodObr" ) <> 0 .AND. ::oDbf:FieldPos( "cObrCli" ) <> 0
         ::oDbf:cObrCli := oDbfDocT:cCodObr
      end

      if ::oDbfCli:Seek ( cCodCli )

         if Empty( ::oDbf:cNifCli )
            ::oDbf:cNifCli := ::oDbfCli:Nif
         end

         if Empty( ::oDbf:cNomCli )
            ::oDbf:cNomCli := ::oDbfCli:Titulo
         end

         if Empty( ::oDbf:cDomCli )
            ::oDbf:cDomCli := ::oDbfCli:Domicilio
         end

         if Empty( ::oDbf:cPobCli )
            ::oDbf:cPobCli := ::oDbfCli:Poblacion
         end

         if Empty( ::oDbf:cProCli )
            ::oDbf:cProCli := ::oDbfCli:Provincia
         end

         if Empty( ::oDbf:cCdpCli )
            ::oDbf:cCdpCli := ::oDbfCli:CodPostal
         end

         ::oDbf:cTlfCli := ::oDbfCli:Telefono

         if ::oDbf:FieldPos( "cNbrEst" ) <> 0
            ::oDbf:cNbrEst := ::oDbfCli:NbrEst
         end

      end

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      ::oDbf:cNifCli    := ""

   end

   ErrorBlock( oBlock )

RETURN ( Self )



static FUNCTION TInfGen_AddTemporada( cCodTmp, oDbfTmp ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oError
   local oBlock

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

      if ::oDbfTmp == nil
         ::oDbfTmp := DbfServer( "Temporadas.DBF", ):NewOpen( "Temporadas.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfTmp:AddBag( "Temporadas.CDX" ) ; ::oDbfTmp:AddBag( ) ; ::oDbfTmp:AutoIndex()
      end

      ::oDbf:cCodTmp    := cCodTmp
      ::oDbf:cNomTmp    := oDbfTmp:cNombre

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      ::oDbf:cNifCli    := ""

   end

   ErrorBlock( oBlock )

RETURN ( Self )



static FUNCTION TInfGen_FldProveedor( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::AddField( "cCodPrv", "C", 12, 0, {|| "@!" },         "Prv.",                      .T., "Cod. Proveedor",              9 )
   ::AddField( "cNomPrv", "C", 50, 0, {|| "@!" },         "Proveedor",                 .T., "Nombre Proveedor",           35 )
   ::AddField( "cNifPrv", "C", 15, 0, {|| "@!" },         "Nif",                       .F., "Nif",                        15 )
   ::AddField( "cDomPrv", "C", 35, 0, {|| "@!" },         "Domicilio",                 .F., "Domicilio",                  35 )
   ::AddField( "cPobPrv", "C", 25, 0, {|| "@!" },         "Población",                 .F., "Población",                  25 )
   ::AddField( "cProPrv", "C", 20, 0, {|| "@!" },         "Provincia",                 .F., "Provincia",                  20 )
   ::AddField( "cCdpPrv", "C",  7, 0, {|| "@!" },         "CP",                        .F., "Cod. Postal",                 7 )
   ::AddField( "cTlfPrv", "C", 12, 0, {|| "@!" },         "Tlf",                       .F., "Teléfono",                   12 )

RETURN ( Self )



static FUNCTION TInfGen_AddProveedor( cCodPrv ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   if ::oDbfPrv == nil
      ::oDbfPrv := DbfServer( "PROVEE.DBF", ):NewOpen( "PROVEE.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oDbfPrv:AddBag( "PROVEE.CDX" ) ; ::oDbfPrv:AddBag( ) ; ::oDbfPrv:AutoIndex()
   end

   if ::oDbfPrv:Seek ( cCodPrv )

      ::oDbf:cCodPrv := cCodPrv
      ::oDbf:cNifPrv := ::oDbfPrv:Nif
      ::oDbf:cNomPrv := ::oDbfPrv:Titulo
      ::oDbf:cDomPrv := ::oDbfPrv:Domicilio
      ::oDbf:cPobPrv := ::oDbfPrv:Poblacion
      ::oDbf:cProPrv := ::oDbfPrv:Provincia
      ::oDbf:cCdpPrv := ::oDbfPrv:CodPostal
      ::oDbf:cTlfPrv := ::oDbfPrv:Telefono

   end

RETURN nil



static FUNCTION TInfGen_AcuPesVol( cCodArt, nTotUni, nImporte, lAcumula ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( lAcumula == nil, lAcumula := .F., ) ;

   if lAcumula
      ::oDbf:nTotPes    += nTotUni * oRetFld( cCodArt, ::oDbfArt, "nPesoKg"  )
      ::oDbf:nTotVol    += nTotUni * oRetFld( cCodArt, ::oDbfArt, "nVolumen" )
   else
      ::oDbf:nTotPes    := nTotUni * oRetFld( cCodArt, ::oDbfArt, "nPesoKg"  )
      ::oDbf:nTotVol    := nTotUni * oRetFld( cCodArt, ::oDbfArt, "nVolumen" )
   end

   ::oDbf:nPreKgr       := if( ::oDbf:nTotPes <> 0, Div( nImporte, ::oDbf:nTotPes ), 0 )
   ::oDbf:nPreVol       := if( ::oDbf:nTotVol <> 0, Div( nImporte, ::oDbf:nTotVol ), 0 )

RETURN ( Self )



static FUNCTION TInfGen_Grafico( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

return ( Self )



static FUNCTION TInfGen_AddImporte( dFecDoc, nImpDoc ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::oDbf:Load()

   do case
      case Month( dFecDoc ) == 1
         ::oDbf:nImpEne += nImpDoc
      case Month( dFecDoc ) == 2
         ::oDbf:nImpFeb += nImpDoc
      case Month( dFecDoc ) == 3
         ::oDbf:nImpMar += nImpDoc
      case Month( dFecDoc ) == 4
         ::oDbf:nImpAbr += nImpDoc
      case Month( dFecDoc ) == 5
         ::oDbf:nImpMay += nImpDoc
      case Month( dFecDoc ) == 6
         ::oDbf:nImpJun += nImpDoc
      case Month( dFecDoc ) == 7
         ::oDbf:nImpJul += nImpDoc
      case Month( dFecDoc ) == 8
         ::oDbf:nImpAgo += nImpDoc
      case Month( dFecDoc ) == 9
         ::oDbf:nImpSep += nImpDoc
      case Month( dFecDoc ) == 10
         ::oDbf:nImpOct += nImpDoc
      case Month( dFecDoc ) == 11
         ::oDbf:nImpNov += nImpDoc
      case Month( dFecDoc ) == 12
         ::oDbf:nImpDic += nImpDoc
   end

   ::oDbf:nImpTot       += nImpDoc

   ::oDbf:Save()

return nil



static FUNCTION TInfGen_nMediaMes( nAnno ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nTotal   := 0
   local nMes     := Month( GetSysDate() ) -1

   do case
      case nMes == 1
         nTotal :=  ::oDbf:nImpEne
      case nMes == 2
         nTotal :=  ::oDbf:nImpEne + ::oDbf:nImpFeb
      case nMes == 3
         nTotal :=  ::oDbf:nImpEne + ::oDbf:nImpFeb + ::oDbf:nImpMar
      case nMes == 4
         nTotal :=  ::oDbf:nImpEne + ::oDbf:nImpFeb + ::oDbf:nImpMar + ::oDbf:nImpAbr
      case nMes == 5
         nTotal :=  ::oDbf:nImpEne + ::oDbf:nImpFeb + ::oDbf:nImpMar + ::oDbf:nImpAbr + ::oDbf:nImpMay
      case nMes == 6
         nTotal :=  ::oDbf:nImpEne + ::oDbf:nImpFeb + ::oDbf:nImpMar + ::oDbf:nImpAbr + ::oDbf:nImpMay + ::oDbf:nImpJun
      case nMes == 7
         nTotal :=  ::oDbf:nImpEne + ::oDbf:nImpFeb + ::oDbf:nImpMar + ::oDbf:nImpAbr + ::oDbf:nImpMay + ::oDbf:nImpJun + ::oDbf:nImpJul
      case nMes == 8
         nTotal :=  ::oDbf:nImpEne + ::oDbf:nImpFeb + ::oDbf:nImpMar + ::oDbf:nImpAbr + ::oDbf:nImpMay + ::oDbf:nImpJun + ::oDbf:nImpJul + ::oDbf:nImpAgo
      case nMes == 9
         nTotal :=  ::oDbf:nImpEne + ::oDbf:nImpFeb + ::oDbf:nImpMar + ::oDbf:nImpAbr + ::oDbf:nImpMay + ::oDbf:nImpJun + ::oDbf:nImpJul + ::oDbf:nImpAgo + ::oDbf:nImpSep
      case nMes == 10
         nTotal :=  ::oDbf:nImpEne + ::oDbf:nImpFeb + ::oDbf:nImpMar + ::oDbf:nImpAbr + ::oDbf:nImpMay + ::oDbf:nImpJun + ::oDbf:nImpJul + ::oDbf:nImpAgo + ::oDbf:nImpSep + ::oDbf:nImpOct
      case nMes == 11
         nTotal :=  ::oDbf:nImpEne + ::oDbf:nImpFeb + ::oDbf:nImpMar + ::oDbf:nImpAbr + ::oDbf:nImpMay + ::oDbf:nImpJun + ::oDbf:nImpJul + ::oDbf:nImpAgo + ::oDbf:nImpSep + ::oDbf:nImpOct + ::oDbf:nImpNov
   end


   if nAnno < Year( GetSysDate() )

      ::oDbf:Load()
      ::oDbf:nMedia     := ::oDbf:nImpTot / 12
      ::oDbf:Save()

   else

      if ( nMes ) == 0
         ::oDbf:Load()
         ::oDbf:nMedia     := 0
         ::oDbf:Save()
      else
         ::oDbf:Load()
         ::oDbf:nMedia     := nTotal / nMes
         ::oDbf:Save()
      end

   end

RETURN ( self )



static FUNCTION TInfGen_SetMetInf( oDbf ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   if ::oMtrInf <> nil
      ::oMtrInf:SetTotal( oDbf:Lastrec() )
      ::nEvery := Int( oDbf:Lastrec() / 10 )
   end

Return ( Self )



static FUNCTION TInfGen_RefMetInf( nPos ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen



   if ::oMtrInf <> nil
      ::oMtrInf:AutoInc( nPos )
   end

Return ( Self )



Function aGetFont()



   local hDC      := GetDC( 0 )
   local aFonts   := GetFontNames( hDC )
   ReleaseDC( 0, hDC )









   if Empty( aFonts )
      msgStop( "Error getting font names" )
   else
      aSort( aFonts,,, { |x, y| upper( x ) < upper( y ) } )
   endif

Return aFonts



static FUNCTION TInfGen_OpenData( cPath, lExclusive ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   If( cPath == nil, cPath := cPatEmp(), ) ;
   If( lExclusive == nil, lExclusive := .F., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

      if Empty( ::oDbfInf )
         ::oDbfInf      := ::DefineConfigUser( cPath )
      end

      if Empty( ::oDbfFnt )
         ::oDbfFnt      := ::DefineFont( cPath )
      end

      if Empty( ::oDbfGrp )
         ::oDbfGrp      := ::DefineGroup( cPath )
      end





      ::oDbfInf:Activate( .F., !( lExclusive ) )

      ::oDbfFnt:Activate( .F., !( lExclusive ) )

      ::oDbfGrp:Activate( .F., !( lExclusive ) )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      ::CloseFiles()

      lOpen             := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



static FUNCTION TInfGen_CloseData( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   if ::oDbfInf <> nil .AND. ::oDbfInf:Used()
      ::oDbfInf:end()
   end

   if ::oDbfFnt <> nil .AND. ::oDbfFnt:Used()
      ::oDbfFnt:end()
   end

   if ::oDbfGrp <> nil .AND. ::oDbfGrp:Used()
      ::oDbfGrp:end()
   end

RETURN ( Self )



static FUNCTION TInfGen_SyncAllDbf( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::OpenData( cPatEmp(), .T. )

   lCheckDbf( ::oDbfInf )
   lCheckDbf( ::oDbfFnt )
   lCheckDbf( ::oDbfGrp )

   ::CloseData()

RETURN ( Self )



static FUNCTION TInfGen_CreateFilter( aTField, oDbf, lMultyExpresion ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( lMultyExpresion == nil, lMultyExpresion := .F., ) ;

   ::oFilter                     := TFilterCreator():Init()

   do case
      case !Empty( aTField )
         ::oFilter:SetFields( aTField )

      case !Empty( oDbf )
         ::oFilter:SetDatabase( oDbf )
   end

RETURN ( Self )



static FUNCTION TInfGen_EvalFilter( oDbf ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local lFilter  := .T.

   If( oDbf == nil, oDbf := ::oDbfMai, ) ;

   if !Empty( ::oFilter ) .AND. !Empty( ::oFilter:bExpresionFilter )

      if IsObject( oDbf ) .AND. ( oDbf:Used() )

         lFilter  := ( oDbf:nArea )->( Eval( ::oFilter:bExpresionFilter ) )

      end

   end

RETURN ( lFilter )



static FUNCTION TInfGen_lGenerate( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local n
   local nFldPos
   local uFldVal

   if Empty( ::oParent )
      return .F.
   end

   if Empty( ::oDbfMai )
      return .F.
   end

   ::oDbf:Zap()


   ::aHeader      := {  {|| "Fecha  : " + Dtoc( Date() ) }, {|| "Código : " + AllTrim( ::cArtOrg ) + " > " + AllTrim( ::cArtDes ) } }





   if Empty( ::oDbfDet )

      ::SetMetInf( ::oDbfMai )
      ::oDbfMai:GetStatus()

      ::oDbfMai:GoTop()
      while !::oDbfMai:Eof()

      if ::oDbfMai:OrdKeyVal() >= ::cArtOrg .AND. ::oDbfMai:OrdKeyVal() <= ::cArtDes .AND. ::EvalFilter( ::oDbfMai )

         ::oDbf:Append()

         for n := 1 to ::oDbf:FieldCount

            nFldPos  := ::oDbfMai:FieldPos( ::oDbf:FieldName( n ) )
            uFldVal  := ::oDbfMai:FieldGetName( ::oDbf:FieldName( n ) )

            ::oDbf:FieldPut( nFldPos, uFldVal )

         next

         ::RefMetInf( ::oDbfMai:OrdKeyNo() )

      end

      ::oDbfMai:Skip()

      end

      ::RefMetInf( ::oDbfMai:LastRec() )

      ::oDbfMai:SetStatus()

   else

      ::SetMetInf( ::oDbfMai )

      ::oDbfMai:GetStatus()
      ::oDbfDet:GetStatus()

      ::oDbfMai:GoTop()
      while !::oDbfMai:Eof()

      if ::oDbfMai:OrdKeyVal() >= ::cArtOrg .AND. ::oDbfMai:OrdKeyVal() <= ::cArtDes

         if ::oDbfDet:Seek( ::oDbfMai:OrdKeyVal() )

            while ::oDbfDet:OrdKeyVal() == ::oDbfMai:OrdKeyVal() .AND. !::oDbfDet:Eof()

               ::oDbf:Append()

               for n := 1 to ::oDbf:FieldCount

                  nFldPos  := ::oDbfDet:FieldPos( ::oDbf:FieldName( n ) )
                  uFldVal  := ::oDbfDet:FieldGetName( ::oDbf:FieldName( n ) )

                  ::oDbf:FieldPut( nFldPos, uFldVal )

               next

               ::oDbfDet:Skip()

           end

        end

      end

      ::RefMetInf( ::oDbfMai:OrdKeyNo() )

      ::oDbfMai:Skip()

      end

      ::RefMetInf( ::oDbfMai:LastRec() )

      ::oDbfMai:SetStatus()
      ::oDbfDet:SetStatus()

   end

RETURN .T.



static FUNCTION TInfGen_oDefDesHas( nIdOrg, nIdSayOrg, nIdDes, nIdSayDes, oDlg ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oArtOrg
   local oArtDes
   local oSayArtOrg
   local oSayArtDes
   local cSayArtOrg
   local cSayArtDes

   If( nIdOrg == nil, nIdOrg := 1110, ) ;
   If( nIdSayOrg == nil, nIdSayOrg := 1111, ) ;
   If( nIdDes == nil, nIdDes := 1120, ) ;
   If( nIdSayDes == nil, nIdSayDes := 1121, ) ;
   If( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   ::oDbfMai:GoBottom()
   ::cArtDes         := ::oDbfMai:OrdkeyVal()
   cSayArtDes        := ::oDbfMai:FieldGet( 2 )

   ::oDbfMai:GoTop()
   ::cArtOrg         := ::oDbfMai:OrdkeyVal()
   cSayArtOrg        := ::oDbfMai:FieldGet( 2 )




   oArtOrg := TGetHlp():ReDefine( ( nIdOrg ), { | u | If( PCount()==0, ::cArtOrg, ::cArtOrg:= u ) }, oDlg,,,,,,,,, .F.,,, .F., .F.,,,,,, nil, "LUPA",, )

      oArtOrg:bHelp  := {|| ::oParent:Buscar( oArtOrg ) }
      oArtOrg:bValid := {|| ::oParent:lValid( oArtOrg, oSayArtOrg ) }




   oSayArtOrg := TGetHlp():ReDefine( ( nIdSayOrg ), { | u | If( PCount()==0, cSayArtOrg, cSayArtOrg:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )




   oArtDes := TGetHlp():ReDefine( ( nIdDes ), { | u | If( PCount()==0, ::cArtDes, ::cArtDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F.,,, .F., .F.,,,,,, nil, "LUPA",, )

      oArtDes:bHelp  := {|| ::oParent:Buscar( oArtDes ) }
      oArtDes:bValid := {|| ::oParent:lValid( oArtDes, oSayArtDes ) }




   oSayArtDes := TGetHlp():ReDefine( ( nIdSayDes ), { | u | If( PCount()==0, cSayArtDes, cSayArtDes:= u ) }, ::oFld:aDialogs[1],,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

RETURN ( Self )



static FUNCTION TInfGen_MakeVisor( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   if file( cPatHtml() + "Visor.htm" )
      fErase( cPatHtml() + "Visor.htm" )
   end

   ::hFile    := fCreate( cPatHtml() + "Visor.htm" )

   fWrite( ::hFile,  "<HTML>"                                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<HEAD>"                                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TITLE>Visor de informes</TITLE>"                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<script LANGUAGE='JavaScript'>"                      + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var cPage = 'REP';"                                  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var nPaginas = " + Str( ::oReport:nPage, 4 ) + ";"   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var nPagina = 1;"                                    + Chr(13)+Chr(10) )

   fWrite( ::hFile,  "function cGetPageName( nPagina )"                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var cPageName = cPage;"                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var cPagina = new String( nPagina );"                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var nLen = ( cPageName.length + cPagina.length )"    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ""                                                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "for( var i = 0; i < ( 8 - nLen ); i ++ )"            + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "cPageName = cPageName + '0';"                        + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "cPageName = cPageName + cPagina + '.htm';"           + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "return cPageName;"                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ""                                                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "function MovePage( nModo, nNewPagina )"              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "switch( nModo )"                                     + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "case 1:"                                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "nPagina = 1;"                                        + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "break;"                                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "case 2:"                                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "nPagina --;"                                         + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "if( nPagina < 1 )"                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "nPagina = 1;"                                        + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "break;"                                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "case 3:"                                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "nPagina ++;"                                         + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "if( nPagina > nPaginas )"                            + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "nPagina = nPaginas;"                                 + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "break;"                                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "case 4:"                                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "nPagina = nPaginas;"                                 + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "break;"                                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "case 5:"                                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "if( nNewPagina > 0 && nNewPagina <= nPaginas )"      + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "nPagina = nNewPagina;"                               + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "break;"                                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )

   fWrite( ::hFile,  "cPageName = cGetPageName( nPagina );"                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.frames.DATOS.location = cPageName;"         + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "DisplayPages();"                                     + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ""                                                    + Chr(13)+Chr(10) )

   fWrite( ::hFile,  "function DisplayPages()"                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "PAGINA.innerText = 'Página ' + nPagina + ' de ' + nPaginas;"  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )

   fWrite( ::hFile,  "function Zoom(inc)"                                  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var oSel = document.all.zoomPorcentaje;"             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var newZoom = parseInt(document.all.DivPagina.style.zoom) + parseInt(inc);"  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ""                                                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "if (newZoom < 0 )"                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "alert('El porcentaje no puede ser menos que cero.')" + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "return;"                                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ""                                                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.DivPagina.style.zoom = newZoom+'%';"    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.zoomPorcentaje.options.add"             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "if (newZoom != 100 && newZoom != 75 && newZoom != 50 && newZoom != 25)" + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var oOption;"                                        + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "if (typeof(document.all.SelActual) == 'undefined')"  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "oOption = document.createElement('OPTION');"         + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "oOption.id = 'SelActual';"                           + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "oSel.options.add(oOption);"                          + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "else"                                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "oOption = document.all.SelActual;"                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "oOption.innerText = newZoom+'%';"                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "oOption.selected = true;"                            + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "else"                                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "for(var i=0;i<oSel.options.length;i++)"              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var impuestosl = parseInt(oSel.options(i).innerText);"     + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "if (newZoom == impuestosl)"                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "oSel.options(i).selected = true;"                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "break;"                                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )

   fWrite( ::hFile,  "function Zoom2(oSel)"                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var newZoom = oSel.options[oSel.selectedIndex].innerText;" + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.DivPagina.style.zoom=newZoom;"          + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ""                                                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "function BrowserCheck()"                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "var b = navigator.appName"                           + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "if (b=='Netscape')"                                  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.b = 'ns'"                                       + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "else"                                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "if (b=='Microsoft Internet Explorer')"               + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.b = 'ie'"                                       + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "else"                                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.b = b"                                          + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ""                                                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.version = navigator.appVersion"                 + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.v = parseInt(this.version)"                     + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.ns = (this.b=='ns' && this.v>=4)"               + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.ns4 = (this.b=='ns' && this.v==4)"              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.ns5 = (this.b=='ns' && this.v==5)"              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.ie = (this.b=='ie' && this.v>=4)"               + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.ie4 = (this.version.indexOf('MSIE 4')>0)"       + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.ie5 = (this.version.indexOf('MSIE 5')>0)"       + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.ie55 = (this.version.indexOf('MSIE 5.5')>0)"    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "this.ie6 = (this.version.indexOf('MSIE 6')>0 )"      + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ""                                                    + Chr(13)+Chr(10) )

   fWrite( ::hFile,  "function window.onload()"                            + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "BrowserCheck();"                                     + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "if( ! ( this.ie55 || this.ie6 ) )"                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.ListBoxZoom.style.visibility = 'hidden'"+ Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.zoomPorcentaje.style.visibility = 'hidden'"   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.ButtonZoomPlus.style.visibility = 'hidden'"   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.ButtonZoomMinus.style.visibility = 'hidden'"  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "DisplayPages();"                                     + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "function LaunchApolo()"                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "window.open( 'http://www.apolosoftware.com' );"      + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "function window.onbeforeprint()"                     + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.todo.style.display='none';"             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.gruposp.style.display='none';"          + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "function window.onafterprint()"                      + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.gruposp.style.display='block';"         + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "document.all.todo.style.display='block';"            + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )

   fWrite( ::hFile,  "</SCRIPT>"                                           + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<STYLE TYPE='text/css'>"                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ".ButtonStyle"                                        + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "font-family: 'MS Sans Serif';"                       + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "font-size:xx-small;"                                 + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "font-weight:lighter;"                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "color:black;"                                        + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "cursor:hand;"                                        + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "padding: 1px 3px 1px 3px;"                           + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ".DEFAULT"                                            + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "{"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "font-family:MS Sans Serif;"                          + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "font-size:9;"                                        + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "font-weight:normal;"                                 + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "font-style:normal;"                                  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "}"                                                   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</STYLE>"                                            + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</HEAD>"                                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<BODY BGCOLOR='#EDEFEA'>"                            + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<DIV ID='todo'>"                                     + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TABLE BORDER='0' ALIGN='CENTER' ID='botones'>"      + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TR>"                                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD ID='ButtonFirst' ALIGN='left' STYLE='display:'><INPUT CLASS='ButtonStyle' TYPE='Button' VALUE=' Primera ' ONCLICK='JavaScript:MovePage( 1 )'></TD>" + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD ID='ButtonPrev' ALIGN='left' STYLE='display:'><INPUT CLASS='ButtonStyle' TYPE='Button' VALUE=' Anterior ' ONCLICK='JavaScript:MovePage( 2 )'></TD>" + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD ID='ButtonNext' ALIGN='left' STYLE='display:'><INPUT CLASS='ButtonStyle' TYPE='Button' VALUE=' Siguiente ' ONCLICK='JavaScript:MovePage( 3 )'></TD>"+ Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD ID='ButtonLast' ALIGN='left' STYLE='display:'><INPUT CLASS='ButtonStyle' TYPE='Button' VALUE=' Ultima ' ONCLICK='JavaScript:MovePage( 4 )'></TD>"   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD ID='ButtonZoomPlus' ALIGN='left' STYLE='display:'><INPUT CLASS='ButtonStyle' TYPE='Button' VALUE=' Zoom + ' ONCLICK='Zoom(+10)'></TD>"              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD ID='ButtonZoomMinus' ALIGN='left' STYLE='display:'><INPUT CLASS='ButtonStyle' TYPE='Button' VALUE=' Zoom - ' ONCLICK='Zoom(-10)'></TD>"             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD ID='ListBoxZoom'>"                               + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<SELECT ID='zoomPorcentaje' ONCHANGE='Zoom2(zoomPorcentaje);'>"  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<OPTION VALUE='100%'>100%</OPTION>"                  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<OPTION VALUE='75%'>75%</OPTION>"                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<OPTION VALUE='50%'>50%</OPTION>"                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<OPTION VALUE='25%'>25%</OPTION>"                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</SELECT>"                                           + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</TD>"                                               + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</TR>"                                               + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TR>"                                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD ALIGN='left' ><P CLASS='DEFAULT' ID='PAGINA'></P></TD>"   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD>&nbsp;</TD>"                                     + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD COLSPAN='5' ALIGN='left'>"                       + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<P CLASS='DEFAULT'>"                                 + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "Ir a Página&nbsp;&nbsp;&nbsp;&nbsp;"                 + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<INPUT CLASS='DEFAULT' TYPE='text' NAME='GOTOPAGE' VALUE='1' SIZE='5' >"  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "&nbsp;&nbsp;"                                        + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<INPUT CLASS='ButtonStyle' TYPE='Button' VALUE=' Ir ' ONCLICK='JavaScript:MovePage( 5, GOTOPAGE.value )'>"  + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</P>"                                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</TD>"                                               + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<TD COLSPAN='2'></TD>"                               + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</TR>"                                               + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</TABLE>"                                            + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<CENTER>"                                            + Chr(13)+Chr(10) )
   fWrite( ::hFile,  ""                                                    + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<BR>"                                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</DIV>"                                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<DIV ID='DivPagina' style='zoom=100%'>"              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<IFRAME SRC='REP00001.htm' NAME='DATOS' ID='DATOS' STYLE='overflow-x: hidden;' width='100%' height='400' marginwidth='1' marginheight='1' border='0' frameborder='0' align='center'>" + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</IFRAME>"                                           + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</DIV>"                                              + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</CENTER>"                                           + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<P CLASS='DEFAULT' ALIGN='center' id='apolo'>"       + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "<A HREF='Javascript:LaunchApolo()'>http://www.apolosoftware.com</A>"   + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</P>"                                                + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</BODY>"                                             + Chr(13)+Chr(10) )
   fWrite( ::hFile,  "</HTML>"                                             + Chr(13)+Chr(10) )

   fClose( ::hFile )

   ::hFile := 0

   if File( cPatHtml() + "Visor.Htm" )
      GoWeb( cPatHtml() + "Visor.Htm" )
   end

RETURN ( Self )



static FUNCTION TInfGen_GenReport( nOption ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( nOption == nil, nOption := ::oCmbReport:nAt, ) ;

   ::lBreak             := .F.
   ::oBtnCancel:bAction := {|| ::lBreak := .T. }

   ::oFld:SetOption( 1 )

   if Valtype( ::bPreGenerate ) == "B"
      Eval( ::bPreGenerate )
   end

   ::CreaGrupos()

   if ::lGenerate()
      if !::lBreak
         ::Print( nOption )
      end
   else
      if !::lBreak
         msgStop( "No hay registros en las condiciones solictadas" )
      end
   end

   if Valtype( ::bPostGenerate ) == "B"
      Eval( ::bPostGenerate )
   end

   ::oBtnCancel:bAction := {|| ::lBreak := .T., ::End() }

RETURN ( Self )



static FUNCTION TInfGen_Xml( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oCol
   local nFor
   local nRow
   local nCol
   local oBook
   local cType
   local uValue
   local oExcel
   local oSheet

   nRow                    := 0
   nCol                    := 0
   oExcel                  := ExcelObj()

   if Empty( oExcel )
      Return Self
   end

   oExcel:ScreenUpdating   := .F.
   oBook                   := oExcel:WorkBooks:Add()
   oSheet                  := oExcel:ActiveSheet





   ++nRow

   for each oCol in ::aoCols

      if oCol <> nil .AND. oCol:lSelect

         oSheet:Cells( nRow, ++nCol ):Value                 := oCol:cTitle
         oExcel:Cells( nRow, nCol ):Borders( 3 ):LineStyle  := 1
         oExcel:Cells( nRow, nCol ):Borders( 9 ):LineStyle  := 1
         oExcel:Cells( nRow, nCol ):Borders( 3 ):Weight     := -4138
         oExcel:Cells( nRow, nCol ):Borders( 9 ):Weight     := -4138
         oSheet:Cells( nRow, nCol ):Font:Bold               := .T.

         cType                                              := Valtype( Eval( oCol:bFld ) )

         do case
            case cType == "N"
               oSheet:Columns( nCol ):NumberFormat          := Clp2xlNumPic( Eval( oCol:bPict ) )
               oSheet:Columns( nCol ):HorizontalAlignment   := - 4152

            case cType == "D"


               oSheet:Columns( nCol ):HorizontalAlignment   := - 4152

            case cType == "C"
               oSheet:Columns( nCol ):NumberFormat          := "@"
               oSheet:Columns( nCol ):HorizontalAlignment   := - 4131

         end

         oSheet:Columns( nCol ):ColumnWidth                 := oCol:nSize

      end

   next





   ::oDbf:GoTop()
   while !::lBreak .AND. !::oDbf:eof()

      ++nRow

      nCol                 := 0

      for each oCol in ::aoCols
         if oCol <> nil .AND. oCol:lSelect

            uValue         := Eval( oCol:bFld )

            if ( ValType( uValue ) $ "DT" ) .AND. !Empty( uValue )
               uValue      := DToC( uValue )
            endif

            if uValue <> nil
               oSheet:Cells( nRow, ++nCol ):Value  := uValue
            end

         end
      next

      ::oDbf:Skip()

   end





   nCol                    := 0

   for each oCol in ::aoCols

      if oCol <> nil .AND. oCol:lSelect

         oSheet:Columns( ++nCol ):AutoFit()

         oExcel:Cells( nRow, nCol ):Borders( 9 ):LineStyle  := 1
         oExcel:Cells( nRow, nCol ):Borders( 9 ):Weight     := -4138

      end

   next





   oSheet:Cells( 1, 1 ):Select()

   oExcel:ActiveWindow:SplitRow     := 1
   oExcel:ActiveWindow:FreezePanes  := .T.

   oExcel:ScreenUpdating            := .T.
   oExcel:Visible                   := .T.

   ShowWindow( oExcel:hWnd, 3 )

   BringWindowToTop( oExcel:hWnd )

RETURN ( Self )




static FUNCTION TInfGen_nTotAlbPrv( cCodArt ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nTotal   := 0
   local nOrden   := ::oAlbPrvL:OrdSetFocus( "cRef" )

   if ::oAlbPrvL:Seek( cCodArt )

      while ::oAlbPrvL:cRef == cCodArt .AND. !::oAlbPrvL:Eof()




         if ::oAlbPrvT:Seek( ::oAlbPrvL:cSerAlb + Str( ::oAlbPrvL:nNumAlb ) + ::oAlbPrvL:cSufAlb ) .AND. !::oAlbPrvT:lFacturado                                                                 .AND. ::oAlbPrvT:dFecAlb >= ::dIniInf                                                        .AND. ::oAlbPrvT:dFecAlb <= ::dFinInf

            nTotal += nTotNAlbPrv( ::oAlbPrvL )

         end

         ::oAlbPrvL:Skip()

      end

   end

   ::oAlbPrvL:OrdSetFocus( nOrden )

RETURN ( nTotal )



static FUNCTION TInfGen_nTotFacPrv( cCodArt ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nTotal   := 0
   local nOrden   := ::oFacPrvL:OrdSetFocus( "cRef" )

   if ::oFacPrvL:Seek( cCodArt )

      while ::oFacPrvL:cRef == cCodArt .AND. !::oFacPrvL:Eof()



         if ::oFacPrvT:Seek( ::oFacPrvL:cSerFac + Str( ::oFacPrvL:nNumFac ) + ::oFacPrvL:cSufFac ) .AND. ::oFacPrvT:dFecFac >= ::dIniInf                                                        .AND. ::oFacPrvT:dFecFac <= ::dFinInf

            nTotal += nTotNFacPrv( ::oFacPrvL )

         end

         ::oFacPrvL:Skip()

      end

   end

   ::oFacPrvL:OrdSetFocus( nOrden )

RETURN ( nTotal )



static FUNCTION TInfGen_nTotAlbCli( cCodArt ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nTotal   := 0
   local nOrden   := ::oAlbCliL:OrdSetFocus( "cRef" )

   if ::oAlbCliL:Seek( cCodArt )

      while ::oAlbCliL:cRef == cCodArt .AND. !::oAlbCliL:Eof()




         if ::oAlbCliT:Seek( ::oAlbCliL:cSerAlb + Str( ::oAlbCliL:nNumAlb ) + ::oAlbCliL:cSufAlb ) .AND. !lFacturado( ::oAlbCliT )                                                              .AND. ::oAlbCliT:dFecAlb >= ::dIniInf                                                        .AND. ::oAlbCliT:dFecAlb <= ::dFinInf

            nTotal += nTotNAlbCli( ::oAlbCliL )

         end

         ::oAlbCliL:Skip()

      end

   end

   ::oAlbCliL:OrdSetFocus( nOrden )

RETURN ( nTotal )



static FUNCTION TInfGen_nTotFacCli( cCodArt ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nTotal   := 0
   local nOrden   := ::oFacCliL:OrdSetFocus( "cRef" )

   if ::oFacCliL:Seek( cCodArt )

      while ::oFacCliL:cRef == cCodArt .AND. !::oFacCliL:Eof()



         if ::oFacCliT:Seek( ::oFacCliL:cSerie + Str( ::oFacCliL:nNumFac ) + ::oFacCliL:cSufFac ) .AND. ::oFacCliT:dFecFac >= ::dIniInf                                                       .AND. ::oFacCliT:dFecFac <= ::dFinInf

            nTotal += nTotNFacCli( ::oFacCliL )

         end

         ::oFacCliL:Skip()

      end

   end

   ::oFacCliL:OrdSetFocus( nOrden )

RETURN ( nTotal )



static FUNCTION TInfGen_nTotTikCli( cCodArt ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nTotal   := 0
   local nOrden   := ::oTikCliL:OrdSetFocus( "cCbaTil" )

   if ::oTikCliL:Seek( cCodArt )
      while ::oTikCliL:cCbaTil == cCodArt .AND. !::oTikCliL:Eof()



         if ::oTikCliT:Seek( ::oTikCliL:cSerTil + ::oTikCliL:cNumTil + ::oTikCliL:cSufTil ) .AND. ::oTikCliT:dFecTik >= ::dIniInf                                                 .AND. ::oTikCliT:dFecTik <= ::dFinInf

            nTotal += ::oTikCliL:nUntTil

         end

         ::oTikCliL:Skip()

      end

   end

   ::oTikCliT:OrdSetFocus( "cComTil" )

   if ::oTikCliL:Seek( cCodArt )

      while ::oTikCliL:cComTil == cCodArt .AND. !::oTikCliL:Eof()



         if ::oTikCliT:Seek( ::oTikCliL:cSerTil + ::oTikCliL:cNumTil + ::oTikCliL:cSufTil ) .AND. ::oTikCliT:dFecTik >= ::dIniInf                                                 .AND. ::oTikCliT:dFecTik <= ::dFinInf

            nTotal += ::oTikCliL:nUntTil

         end

         ::oTikCliL:Skip()

      end

   end

   ::oTikCliL:OrdSetFocus( nOrden )

RETURN ( nTotal )



static FUNCTION TInfGen_nStkTotal( cCodArt ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nStkTotal   := 0

   If( cCodArt == nil, cCodArt := ::oReport:aGroups[ 1 ]:cValue, ) ;

   nStkTotal         += ::nTotAlbPrv( cCodArt )
   nStkTotal         += ::nTotFacPrv( cCodArt )

   nStkTotal         -= ::nTotAlbCli( cCodArt )
   nStkTotal         -= ::nTotFacCli( cCodArt )
   nStkTotal         -= ::nTotTikCli( cCodArt )

RETURN ( nStkTotal )



static FUNCTION TInfGen_Play( uParam ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::Create( uParam )

   if ::lOpenFiles
      if ::lResource()
         ::Activate()
      end
   end

   ::End()

RETURN ( Self )



static FUNCTION TInfGen_AddSelectedGroup( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local oItemSelect := ::oTreeGroups:GetSelected()

   if oItemSelect <> nil .AND. oItemSelect:ClassName() == "TTVITEM"

      if aScan( ::aSelectedGroup, {|a| a:Cargo:Nombre == oItemSelect:cPrompt } ) == 0

         aAdd( ::aSelectedGroup, oItemSelect:Cargo )

         ::ReLoadGroup()

      end

   end

Return ( Self )



static FUNCTION TInfGen_DelSelectedGroup( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nPos
   local oItemSelect := ::oTreeSelectedGroups:GetSelected()

   if oItemSelect <> nil .AND. oItemSelect:ClassName() == "TTVITEM"

      nPos  := aScan( ::aSelectedGroup, {|a| a:Cargo:Nombre == oItemSelect:cPrompt } )
      if nPos <> 0

         aDel( ::aSelectedGroup, nPos )
         aSize( ::aSelectedGroup, Len( ::aSelectedGroup ) - 1 )

         ::ReloadGroup()

      end

   end

   ::oTreeSelectedGroups:SetFocus()

Return ( Self )



static FUNCTION TInfGen_ReLoadGroup( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local n
   local oTree

   ::oTreeSelectedGroups:DeleteAll()

   for n := 1 to len( ::aSelectedGroup )
      if Empty( oTree )
         oTree := ::oTreeSelectedGroups:Add( ::aSelectedGroup[ n ]:Cargo:Nombre, ::aSelectedGroup[ n ]:Cargo:Imagen, ::aSelectedGroup[ n ] )
      else
         oTree := oTree:Add( ::aSelectedGroup[ n ]:Cargo:Nombre, ::aSelectedGroup[ n ]:Cargo:Imagen, ::aSelectedGroup[ n ] )
      end
   next

   ::oTreeSelectedGroups:ExpandAll()

Return ( Self )



static FUNCTION TInfGen_UpSelectedGroup( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nPos
   local oItemSelect := ::oTreeSelectedGroups:GetSelected()

   if oItemSelect <> nil .AND. oItemSelect:ClassName() == "TTVITEM"

      nPos  := aScan( ::aSelectedGroup, {|a| a:Cargo:Nombre == oItemSelect:cPrompt } )
      if nPos <> 0
         SwapUpArray( ::aSelectedGroup, nPos )
         ::ReLoadGroup()
      end

   end

   ::oTreeSelectedGroups:SetFocus()

Return ( Self )



static FUNCTION TInfGen_DownSelectedGroup( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nPos
   local oItemSelect := ::oTreeSelectedGroups:GetSelected()

   if oItemSelect <> nil .AND. oItemSelect:ClassName() == "TTVITEM"

      nPos  := aScan( ::aSelectedGroup, {|a| a:Cargo:Nombre == oItemSelect:cPrompt } )
      if nPos <> 0
         SwapDwArray( ::aSelectedGroup, nPos )
         ::ReLoadGroup()
      end

   end

   ::oTreeSelectedGroups:SetFocus()

Return ( Self )



static FUNCTION TInfGen_CreaGrupos( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local i
   local cExpIndex   := ""

   if ::lNewInforme
      ::aoGroup      := {}
   end

   for i := 1 to len( ::aSelectedGroup )
      if i == len( ::aSelectedGroup )
         cExpIndex      += ::aSelectedGroup[ i ]:Cargo:Expresion
      else
         cExpIndex      += ::aSelectedGroup[ i ]:Cargo:Expresion + " + "
      end
   next

   if !Empty( ::cPrefijoIndice )
      if !Empty( cExpIndex )
         cExpIndex      += " + " + ::cPrefijoIndice
      else
         cExpIndex      := ::cPrefijoIndice
      end
   end

   if Empty( cExpIndex ) .AND. ::lNewInforme
      cExpIndex         := ::cEmptyIndex
   end

   if !Empty( cExpIndex )
      ::oDbf:AddTmpIndex( "Grupos", ::cFileIndx, ( cExpIndex ), , , , , , , , , .T. )
   end

   for i := 1 to len( ::aSelectedGroup )
      if IsTrue( ::aSelectedGroup[ i ]:Cargo:lImprimir )
         aAdd( ::aoGroup, ::aSelectedGroup[ i ] )
      end
   next

Return ( Self )



static FUNCTION TInfGen_BtnDefectoGrupo( ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   ::aSelectedGroup  := {}

   if !Empty( ::aInitGroup )
      aEval( ::aInitGroup, {| oGroup | aAdd( ::aSelectedGroup, oGroup ) } )
   end

   ::ReLoadGroup()

   ::oTreeSelectedGroups:SetFocus()

RETURN ( Self )



static FUNCTION TInfGen_lSeekInAcumulado( cExpresion ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local i
   local cSeek          := ""

   If( cExpresion == nil, cExpresion := "", ) ;

   for i := 1 to len( ::aSelectedGroup )
      cSeek             += ::aSelectedGroup[ i ]:Cargo:Valor
   next

   cSeek                += cExpresion

Return ( ::oDbf:Seek( cSeek ) )



static FUNCTION TInfGen_SetValorGrupo( cNombre, cValor ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   local nPos  := aScan( ::aSelectedGroup, { |a| a:Cargo:Nombre == cNombre } )

   if nPos <> 0
      ::aSelectedGroup[ nPos ]:Cargo:Valor := cValor
   end

Return( Self )



static FUNCTION TInfGen_Reindexa( cPath ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   if Empty( ::oDbfInf )
      ::oDbfInf      := ::DefineConfigUser( cPath )
   end
   ::oDbfInf:IdxFDel()
   ::oDbfInf:Activate( .F., .T., .F. )
   ::oDbfInf:Pack()
   ::oDbfInf:End()

   if Empty( ::oDbfFnt )
      ::oDbfFnt      := ::DefineFont( cPath )
   end
   ::oDbfFnt:IdxFDel()
   ::oDbfFnt:Activate( .F., .T., .F. )
   ::oDbfFnt:Pack()
   ::oDbfFnt:End()

   if Empty( ::oDbfGrp )
      ::oDbfGrp      := ::DefineGroup( cPath )
   end
   ::oDbfGrp:IdxFDel()
   ::oDbfGrp:Activate( .F., .T., .F. )
   ::oDbfGrp:Pack()
   ::oDbfGrp:End()

RETURN ( Self )



static FUNCTION TInfGen_DefineConfigUser( cPath ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( cPath == nil, cPath := cPatEmp(), ) ;

   ::oDbfInf := DbfServer( "CfgInf.Dbf", "InfCfg" ):New( "CfgInf.Dbf",, ( cDriver() ), "Configuracion de usuarios", ( cPath ) )

      ::oDbfInf:AddField( "cCodUse", "C", 3, 0,,,,, "Código usuario", .F.,, .F., {} )
      ::oDbfInf:AddField( "cNomInf", "C", 100, 0,,,,, "Nombre del informe", .F.,, .F., {} )
      ::oDbfInf:AddField( "lSelInf", "L", 1, 0,,,,, "Selección de columna", .F.,, .F., {} )
      ::oDbfInf:AddField( "cTitInf", "C", 30, 0,,,,, "Titulo del informe", .F.,, .F., {} )
      ::oDbfInf:AddField( "nPosInf", "N", 10, 0,,,,, "Posición de la columna", .F.,, .F., {} )
      ::oDbfInf:AddField( "nSizInf", "N", 10, 0,,,,, "Tamaño de la columna", .F.,, .F., {} )
      ::oDbfInf:AddField( "lAlnInf", "L", 1, 0,,,,, "Alineación columna", .F.,, .F., {} )
      ::oDbfInf:AddField( "lTotInf", "L", 1, 0,,,,, "Columna totalizada", .F.,, .F., {} )
      ::oDbfInf:AddField( "lSomInf", "L", 1, 0,,,,, "Columna sombreada", .F.,, .F., {} )
      ::oDbfInf:AddField( "lSepInf", "L", 1, 0,,,,, "Separación del informe", .F.,, .F., {} )

      ::oDbfInf:AddIndex( "cCodUse", "CfgInf.Cdx", "cCodUse + cNomInf",,, .F., .F., "Código",,, .T., .F. )



Return ( ::oDbfInf )



static FUNCTION TInfGen_DefineFont( cPath ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( cPath == nil, cPath := cPatEmp(), ) ;

   ::oDbfFnt := DbfServer( "CfgFnt.Dbf", "FntCfg" ):New( "CfgFnt.Dbf",, ( cDriver() ),, ( cPath ) )

      ::oDbfFnt:AddField( "cCodUse", "C", 3, 0,,,,, "Código usuario", .F.,, .F., {} )
      ::oDbfFnt:AddField( "cNomInf", "C", 50, 0,,,,, "Nombre del informe", .F.,, .F., {} )
      ::oDbfFnt:AddField( "cFntIn1", "C", 20, 0,,,,, "Nombre de la fuente 1", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nSizIn1", "N", 3, 0,,,,, "Tamaño del informe 1", .F.,, .F., {} )
      ::oDbfFnt:AddField( "cStyIn1", "C", 20, 0,,,,, "Estilo del informe 1", .F.,, .F., {} )
      ::oDbfFnt:AddField( "cFntIn2", "C", 20, 0,,,,, "Nombre de la fuente 2", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nSizIn2", "N", 3, 0,,,,, "Tamaño del informe 2", .F.,, .F., {} )
      ::oDbfFnt:AddField( "cStyIn2", "C", 20, 0,,,,, "Estilo del informe 2", .F.,, .F., {} )
      ::oDbfFnt:AddField( "cFntIn3", "C", 30, 0,,,,, "Nombre de la fuente 3", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nSizIn3", "N", 3, 0,,,,, "Tamaño del informe 3", .F.,, .F., {} )
      ::oDbfFnt:AddField( "cStyIn3", "C", 30, 0,,,,, "Estilo del informe 3", .F.,, .F., {} )
      ::oDbfFnt:AddField( "lCelVie", "L", 1, 0,,,,, "Visualizar en celdas", .F.,, .F., {} )
      ::oDbfFnt:AddField( "lShadow", "L", 1, 0,,,,, "Visualizar con sombreado", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nWidPag", "N", 16, 6,,,,, "Ancho de documento", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nLenPag", "N", 16, 6,,,,, "Longitud de decumento", .F.,, .F., {} )
      ::oDbfFnt:AddField( "cPrnInf", "C", 100, 0,,,,, "Impresora", .F.,, .F., {} )
      ::oDbfFnt:AddField( "cImgInf", "C", 250, 0,,,,, "Imagen", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nRowImg", "N", 9, 2,,,,, "Fila de la imagen", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nColImg", "N", 9, 2,,,,, "Columna de la imagen", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nWidImg", "N", 9, 2,,,,, "Ancho de la imagen", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nHeiImg", "N", 9, 2,,,,, "Alto de la imagen", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nDisInf", "N", 1, 0,,,,, "Dispositivo de salida", .F.,, .F., {} )
      ::oDbfFnt:AddField( "nOrnInf", "N", 1, 0,,,,, "Orientación del informe", .F.,, .F., {} )
      ::oDbfFnt:AddField( "cAliInf", "C", 100, 0,,,,, "Alias del informe", .F.,, .F., {} )

      ::oDbfFnt:AddIndex( "cCodUse", "CfgFnt.Cdx", "cCodUse + cNomInf",,, .F., .F., "Código",,, .T., .F. )



Return ( ::oDbfFnt )



static FUNCTION TInfGen_DefineGroup( cPath ) ; local Self AS CLASS TInfGen := QSelf() AS CLASS TInfGen

   If( cPath == nil, cPath := cPatEmp(), ) ;

   ::oDbfGrp := DbfServer( "CfgGrp.Dbf", "GrpCfg" ):New( "CfgGrp.Dbf",, ( cDriver() ),, ( cPath ) )

      ::oDbfGrp:AddField( "cCodUse", "C", 3, 0,,,,, "Código usuario", .F.,, .F., {} )
      ::oDbfGrp:AddField( "cNomInf", "C", 100, 0,,,,, "Nombre del informe", .F.,, .F., {} )
      ::oDbfGrp:AddField( "cNomGrp", "C", 50, 0,,,,, "Nombre del grupo", .F.,, .F., {} )

      ::oDbfGrp:AddIndex( "cCodUse", "CfgGrp.Cdx", "cCodUse + cNomInf",,, .F., .F., "Código",,, .T., .F. )



Return ( ::oDbfGrp )



Function clp2xlnumpic( cPic )

   local cFormat, aPic, c, lEnglish := lxlEnglish

   if cPic == nil
      cFormat  := If( lThouSep, If( lEnglish, "#,##0", "#.##0" ), "0" )
   else
      cPic     := StrTran( cPic, "#", "9" )
      aPic     := HB_ATokens( cPic, " " )

      cFormat  := ""
      for each c in aPic
         if Left( c, 1 ) == "@"





         else
            if "9" $ c
               if Left( c, 1 ) == "$"
                  cFormat  += "$"
               endif
               cFormat  += If( lThouSep .OR. ",9" $ cPic, If( lEnglish, "#,##0", "#.##0" ), "0" )
               if ".9" $ c
                  cFormat  += If( lEnglish, ".", "," )
                  cFormat  += StrTran( SubStr( c, At( ".", c ) + 1 ), "9", "0" )

               endif
               cFormat  += " "
            else
               cFormat  += ( '"' + c + '" ' )
            endif
         endif
      next
   endif

return Trim( cFormat )



Function oTInfGen( cMsg, u1, u2, u3, u4, u5, u6, u7, u8, u9, u10 )

   local uReturn  := ""

   if !Empty( oThis ) .AND. !Empty( cMsg )
      uReturn     := apoloSender( oThis, cMsg, u1, u2, u3, u4, u5, u6, u7, u8, u9, u10 )
   end

Return ( uReturn )
