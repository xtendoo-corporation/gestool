#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 7 ".\.\Prg\Tinternet.prg"
_HB_CLASS TInternet ; function TInternet ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TInternet", iif( .F., { }, { @HBObject() } ), @TInternet() ) ) ;

   _HB_MEMBER { hWinINet } ; oClass:AddMultiClsData(,, nScope + iif( .F., 16, 0 ) + iif( .T., 32, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"hWinINet"}, .F. )
   _HB_MEMBER { hSession } ; oClass:AddMultiClsData(,, nScope + iif( .F., 16, 0 ) + iif( .T., 32, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"hSession"}, .F. )

   _HB_MEMBER { aFTPs } ; oClass:AddMultiClsData(, {}, nScope + iif( .F., 16, 0 ) + iif( .T., 32, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aFTPs"}, .F. )

   _HB_MEMBER New() AS CLASS TInternet; oClass:AddMethod( "New", @TInternet_New(), nScope + iif( .T., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER End(); oClass:AddMethod( "End", @TInternet_End(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER FTP( cFTPSite); oClass:AddMethod( "FTP", @TInternet_FTP(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TInternet ;



static FUNCTION TInternet_New( ) ; local Self AS CLASS TInternet := QSelf() AS CLASS TInternet

   local hWinINet := WinINet()

   if hWinINet < 0 .OR. hWinINet >= 32
      ::hSession  := InternetOpen( 0, 0, 0, 0, 0 )
   endif

return Self



static FUNCTION TInternet_End( ) ; local Self AS CLASS TInternet := QSelf() AS CLASS TInternet

   aSend( ::aFTPs, "End()" )

   if ::hSession <> nil
      InternetCloseHandle( ::hSession )
      ::hSession = nil
   endif

return nil



static FUNCTION TInternet_FTP( cFTPSite ) ; local Self AS CLASS TInternet := QSelf() AS CLASS TInternet

return TFTP():New( cFTPSite, Self )
