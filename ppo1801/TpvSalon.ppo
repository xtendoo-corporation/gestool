#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 102 ".\.\Prg\TpvSalon.prg"
_HB_CLASS TTpvSalon ; function TTpvSalon ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "TTpvSalon", iif( .F., { }, { @HBObject() } ), @TTpvSalon() ) ) ;

   _HB_MEMBER { oWnd } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oWnd"}, .F. )
   _HB_MEMBER { oOfficeBar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oOfficeBar"}, .F. )

   _HB_MEMBER { oDbfSala } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfSala"}, .F. )
   _HB_MEMBER { oDbfSalon } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDbfSalon"}, .F. )

   _HB_MEMBER { nItemToInsert } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nItemToInsert"}, .F. )

   _HB_MEMBER { lDesign } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lDesign"}, .F. )

   _HB_MEMBER { oSelectedPunto } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSelectedPunto"}, .F. )

   _HB_MEMBER { oSalaVenta } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSalaVenta"}, .F. )

   _HB_MEMBER { nRowToInsert } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nRowToInsert"}, .F. )
   _HB_MEMBER { nColToInsert } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nColToInsert"}, .F. )

   _HB_MEMBER { oBtnBmp } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnBmp"}, .F. )

   _HB_MEMBER { oBtnGenerico } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnGenerico"}, .F. )
   _HB_MEMBER { oBtnLlevar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnLlevar"}, .F. )
   _HB_MEMBER { oBtnRecoger } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnRecoger"}, .F. )
   _HB_MEMBER { oBtnEncargar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnEncargar"}, .F. )
   _HB_MEMBER { oBtnSalirSalon } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnSalirSalon"}, .F. )

   _HB_MEMBER { aMesas } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aMesas"}, .F. )

   _HB_MEMBER { oSender } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSender"}, .F. )

   _HB_MEMBER { nTop } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nTop"}, .F. )
   _HB_MEMBER { nLeft } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nLeft"}, .F. )
   _HB_MEMBER { nType } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nType"}, .F. )

   _HB_MEMBER { Title } ; oClass:AddMultiData(, "Seleccione puntos de venta", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Title"}, .F. )

   _HB_MEMBER { aBitmapsState } ; oClass:AddMultiClsData(,, nScope + iif( .F., 16, 0 ) + iif( .T., 32, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aBitmapsState"}, .F. )

   _HB_MEMBER New( oSender); oClass:AddMethod( "New", @TTpvSalon_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER End(); oClass:AddMethod( "End", @TTpvSalon_End(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER Close(); oClass:AddMethod( "Close", @TTpvSalon_Close(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Design(); oClass:AddMethod( "Design", @TTpvSalon_Design(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER InitDesign(); oClass:AddMethod( "InitDesign", @TTpvSalon_InitDesign(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Selector( oDlg); oClass:AddMethod( "Selector", @TTpvSalon_Selector(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER InitSelector(); oClass:AddMethod( "InitSelector", @TTpvSalon_InitSelector(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER StartSelector(); oClass:AddMethod( "StartSelector", @TTpvSalon_StartSelector(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SelectSala( oBtnItem); oClass:AddMethod( "SelectSala", @TTpvSalon_SelectSala(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SelectPunto( oPunto); oClass:AddMethod( "SelectPunto", @TTpvSalon_SelectPunto(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER SelectGenerico(); oClass:AddMethod( "SelectGenerico", @TTpvSalon_SelectGenerico(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER SelectLlevar(); oClass:AddMethod( "SelectLlevar", @TTpvSalon_SelectLlevar(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SaveToDatabase(); oClass:AddMethod( "SaveToDatabase", @TTpvSalon_SaveToDatabase(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER LoadFromDatabase(); oClass:AddMethod( "LoadFromDatabase", @TTpvSalon_LoadFromDatabase(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER SelectItem( nItem); oClass:AddMethod( "SelectItem", @TTpvSalon_SelectItem(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER UnSelectButtons(); oClass:AddMethod( "UnSelectButtons", @TTpvSalon_UnSelectButtons(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateFromPunto( sPunto); oClass:AddMethod( "CreateFromPunto", @TTpvSalon_CreateFromPunto(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER LoadGenericosPendientes( lPuntosPendientes); oClass:AddMethod( "LoadGenericosPendientes", @TTpvSalon_LoadGenericosPendientes(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER LoadLlevarPendientes( lPuntosPendientes); oClass:AddMethod( "LoadLlevarPendientes", @TTpvSalon_LoadLlevarPendientes(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER LoadEncargarPendientes( lPuntosPendientes); oClass:AddMethod( "LoadEncargarPendientes", @TTpvSalon_LoadEncargarPendientes(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER LoadRecogerPendientes( lPuntosPendientes); oClass:AddMethod( "LoadRecogerPendientes", @TTpvSalon_LoadRecogerPendientes(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CreateItemMesa( nRow, nCol, uTooltip, nType, cBitmap); oClass:AddMethod( "CreateItemMesa", @TTpvSalon_CreateItemMesa(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CreateItemMesaRedonda(); oClass:AddInline( "CreateItemMesaRedonda", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 1, "Shape_circle_80" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemMesaEliptica(); oClass:AddInline( "CreateItemMesaEliptica", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 2, "Shape_ellipse_80" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemMesaCuadrada(); oClass:AddInline( "CreateItemMesaCuadrada", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 3, "Shape_square_80" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemMesaRectangular(); oClass:AddInline( "CreateItemMesaRectangular", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 4, "Shape_rectangle_80" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemBarraHorizontal(); oClass:AddInline( "CreateItemBarraHorizontal", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 5, "Bar_center_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemBarraVertical(); oClass:AddInline( "CreateItemBarraVertical", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 6, "Bar_left_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemBarrraEsquinaDerechaAbajo(); oClass:AddInline( "CreateItemBarrraEsquinaDerechaAbajo", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 7, "Bar_corner_left_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemBarrraEsquinaIzquierdaAbajo(); oClass:AddInline( "CreateItemBarrraEsquinaIzquierdaAbajo", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 8, "Bar_corner_right_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemBarrraEsquinaDerechaArriba(); oClass:AddInline( "CreateItemBarrraEsquinaDerechaArriba", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 9, "Bar_corner_top_left_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemBarrraEsquinaIzquierdaArriba(); oClass:AddInline( "CreateItemBarrraEsquinaIzquierdaArriba", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 10, "Bar_corner_top_right_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPlantaBlanca(); oClass:AddInline( "CreateItemPlantaBlanca", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 11, "Flower_white_32" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPlantaAzul(); oClass:AddInline( "CreateItemPlantaAzul", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 13, "Flower_blue_32" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPlantaRoja(); oClass:AddInline( "CreateItemPlantaRoja", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 14, "Flower_red_32" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPlantaAmarilla(); oClass:AddInline( "CreateItemPlantaAmarilla", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 12, "Flower_yellow_32" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelHorizontal(); oClass:AddInline( "CreateItemPanelHorizontal", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 15, "Navigate2_minus_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelVertical(); oClass:AddInline( "CreateItemPanelVertical", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 16, "Navigate_panel_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelCruce(); oClass:AddInline( "CreateItemPanelCruce", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 17, "Navigate2_plus_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelConexionArriba(); oClass:AddInline( "CreateItemPanelConexionArriba", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 19, "Navigate_connection_up_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelConexionAbajo(); oClass:AddInline( "CreateItemPanelConexionAbajo", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 18, "Navigate_connection_down_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelConexionDerecha(); oClass:AddInline( "CreateItemPanelConexionDerecha", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 20, "Navigate_right_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelConexionIzquierda(); oClass:AddInline( "CreateItemPanelConexionIzquierda", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 21, "Navigate_left_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelCurvaAbajo(); oClass:AddInline( "CreateItemPanelCurvaAbajo", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 22, "Navigate_corner_left_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelCurvaArriba(); oClass:AddInline( "CreateItemPanelCurvaArriba", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 25, "Navigate_corner_right_top_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelCurvaDerecha(); oClass:AddInline( "CreateItemPanelCurvaDerecha", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 23, "Navigate_corner_right_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemPanelCurvaIzquierda(); oClass:AddInline( "CreateItemPanelCurvaIzquierda", {|Self, nRow, nCol | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, nil, 24, "Navigate_corner_right_down_64" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CreateItemGenerico(); oClass:AddInline( "CreateItemGenerico", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 26, "gc_cash_register_160" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemLlevar(); oClass:AddInline( "CreateItemLlevar", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 27, "gc_motor_scooter_160" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemEncargar(); oClass:AddInline( "CreateItemEncargar", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 31, "gc_notebook2_160" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemNewGenerico(); oClass:AddInline( "CreateItemNewGenerico", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 28, "gc_cash_register_160" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemNewLlevar(); oClass:AddInline( "CreateItemNewLlevar", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 29, "gc_motor_scooter_160" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER CreateItemRecoger(); oClass:AddInline( "CreateItemRecoger", {|Self, nRow, nCol, uTooltip | ( ( Self ) ), ::CreateItemMesa( nRow, nCol, uTooltip, 30, "gc_shopping_basket_160" ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )



   _HB_MEMBER cCodForSalon( cSalon); oClass:AddMethod( "cCodForSalon", @TTpvSalon_cCodForSalon(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lLimpiaSalon(); oClass:AddMethod( "lLimpiaSalon", @TTpvSalon_lLimpiaSalon(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER AddResource( cResource); oClass:AddMethod( "AddResource", @TTpvSalon_AddResource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER CreateItem(); oClass:AddMethod( "CreateItem", @TTpvSalon_CreateItem(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER LoadFromMemory(); oClass:AddMethod( "LoadFromMemory", @TTpvSalon_LoadFromMemory(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER aNumerosTickets(); oClass:AddMethod( "aNumerosTickets", @TTpvSalon_aNumerosTickets(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER oTactil(); oClass:AddInline( "oTactil", {|Self | ( ( Self ) ), ( ::oSender:oSender ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER oTiketCabecera(); oClass:AddInline( "oTiketCabecera", {|Self | ( ( Self ) ), ( ::oTactil():oTiketCabecera ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER lBrowseMultiplesTickets( aNumerosTickets); oClass:AddMethod( "lBrowseMultiplesTickets", @TTpvSalon_lBrowseMultiplesTickets(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER StartResource( oDlg); oClass:AddMethod( "StartResource", @TTpvSalon_StartResource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER LineaPrimera(); oClass:AddInline( "LineaPrimera", {|Self, oBrw | ( ( Self ) ), ( oBrw:GoTop(),    oBrw:Select(0), oBrw:Select(1) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER PaginaAnterior(); oClass:AddInline( "PaginaAnterior", {|Self, oBrw | ( ( Self ) ), ( oBrw:PageUp(),   oBrw:Select(0), oBrw:Select(1) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER PaginaSiguiente(); oClass:AddInline( "PaginaSiguiente", {|Self, oBrw | ( ( Self ) ), ( oBrw:PageDown(), oBrw:Select(0), oBrw:Select(1) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER LineaAnterior(); oClass:AddInline( "LineaAnterior", {|Self, oBrw | ( ( Self ) ), ( oBrw:GoUp(),     oBrw:Select(0), oBrw:Select(1) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER LineaSiguiente(); oClass:AddInline( "LineaSiguiente", {|Self, oBrw | ( ( Self ) ), ( oBrw:GoDown(),   oBrw:Select(0), oBrw:Select(1) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER LineaUltima(); oClass:AddInline( "LineaUltima", {|Self, oBrw | ( ( Self ) ), ( oBrw:GoBottom(), oBrw:Select(0), oBrw:Select(1) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER cTitle(); oClass:AddInline( "cTitle", {|Self, uValue | ( ( Self ) ), ( if( !Empty( uValue ), ::Title := uValue, ::Title ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS TTpvSalon ;



static FUNCTION TTpvSalon_New( oSender ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   ::oSender                  := oSender

   ::nItemToInsert            := 0
   ::aBitmapsState            := {}
   ::aMesas                   := {}

   if Empty( ::aBitmapsState )
      ::AddResource( "gc_check_12" )
      ::AddResource( "gc_shape_square_12" )
      ::AddResource( "gc_delete_12" )
   end

Return ( Self )



static FUNCTION TTpvSalon_End( nId ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   ::Close( nId )

   if !Empty( ::aBitmapsState )
      aEval( ::aBitmapsState, {|a| PalBmpFree( a[1], a[2] ) } )
   end

   ::aBitmapsState   := nil

Return ( Self )



static FUNCTION TTpvSalon_Close( nId ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   if !Empty( ::aMesas )
      aEval( ::aMesas, {|o| o:End() } )
   end

   ::aMesas          := {}

   if !Empty( ::oWnd )
      ::oWnd:End( nId )
   end

Return ( Self )






static FUNCTION TTpvSalon_Design( oSender, oDlg ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   ::oSender                  := oSender

   ::lDesign                  := .T.

   ::oWnd                     := TDialog():New( , , , , "Diseñando sala de ventas", "SelectMesa" )

   ::oWnd:Activate( , , , .T., , , {|| ::InitDesign() } )

Return ( .T. )



static FUNCTION TTpvSalon_InitDesign( ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local oGrupo
   local oBoton
   local oCarpeta

   ::oOfficeBar               := TDotNetBar():New( 0, 0, 1000, 120, ::oWnd, 1 )
   ::oOfficeBar:lPaintAll     := .F.
   ::oOfficeBar:lDisenio      := .F.

   ::oOfficeBar:SetStyle( 1 )

   ::oWnd:oTop                := ::oOfficeBar

   ::oWnd:oClient             := TPanelEx():New()

   ::oWnd:oClient:OnClick     := {| nRow, nCol | ::CreateItem( nil, nRow, nCol, .T. ) }

   oCarpeta                   := TCarpeta():New( ::oOfficeBar, "Objetos" )

   oGrupo                     := TDotNetGroup():New( oCarpeta, 126, "Acciones", .F., , "gc_floppy_disk_32" )

   oBoton                     := TDotNetButton():New( 60, oGrupo, "gc_floppy_disk_32",         "Grabar y salir",    1, {|| ::SaveToDatabase() }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "End32",                "Salir sin grabar",  2, {|| ::End() }, , , .F., .F., .F. )

   oGrupo                     := TDotNetGroup():New( oCarpeta, 66, "Selección", .F. )

   oBoton                     := TDotNetButton():New( 60, oGrupo, "gc_sign_stop_32",              "Quitar selección",  1, {|| ::UnSelectButtons() }, , , .F., .F., .F. )

   oGrupo                     := TDotNetGroup():New( oCarpeta, 246, "Mesas", .F., , "Shape_circle_32" )

   oBoton                     := TDotNetButton():New( 60, oGrupo, "Shape_circle_32",      "Redonda",        1, {| oBtn | ::SelectItem( 1, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Shape_ellipse_32",     "Eliptica",       2, {| oBtn | ::SelectItem( 2, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Shape_square_32",      "Cuadrada",       3, {| oBtn | ::SelectItem( 3, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Shape_rectangle_32",   "Rectangular",    4, {| oBtn | ::SelectItem( 4, oBtn ) }, , , .F., .F., .F. )

   oGrupo                     := TDotNetGroup():New( oCarpeta, 366, "Barra", .F., , "Bar_center_32" )

   oBoton                     := TDotNetButton():New( 60, oGrupo, "Bar_center_32",           "Horizontal",        1, {| oBtn | ::SelectItem( 5, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Bar_left_32",             "Vertical",          2, {| oBtn | ::SelectItem( 6, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Bar_corner_left_32",      "Derecha abajo",     3, {| oBtn | ::SelectItem( 7, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Bar_corner_right_32",     "Izquierda abajo",   4, {| oBtn | ::SelectItem( 8, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Bar_corner_top_left_32",  "Derecha arriba",    5, {| oBtn | ::SelectItem( 9, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Bar_corner_top_right_32", "Izquierda arriba",  6, {| oBtn | ::SelectItem( 10, oBtn ) }, , , .F., .F., .F. )

   oGrupo                     := TDotNetGroup():New( oCarpeta, 246, "Plantas", .F., , "Flower_white_32" )

   oBoton                     := TDotNetButton():New( 60, oGrupo, "Flower_white_32",      "Blanca",         1, {| oBtn | ::SelectItem( 11, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Flower_blue_32",       "Azul",           2, {| oBtn | ::SelectItem( 13, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Flower_red_32",        "Roja",           3, {| oBtn | ::SelectItem( 14, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Flower_yellow_32",     "Amarilla",       4, {| oBtn | ::SelectItem( 12, oBtn ) }, , , .F., .F., .F. )

   oGrupo                     := TDotNetGroup():New( oCarpeta, 666, "Paneles", .F., , "Navigate2_minus_32" )

   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate2_minus_32",            "Horizontal",              1, {| oBtn | ::SelectItem( 15, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate_panel_32",             "Vertical",                2, {| oBtn | ::SelectItem( 16, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate2_plus_32",             "Cruce",                   3, {| oBtn | ::SelectItem( 17, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate_connection_down_32",   "Conexión abajo",          4, {| oBtn | ::SelectItem( 18, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate_connection_up_32",     "Conexión arriba",         5, {| oBtn | ::SelectItem( 19, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate_left_32",              "Conexión izquierda",      6, {| oBtn | ::SelectItem( 21, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate_right_32",             "Conexión derecha",        7, {| oBtn | ::SelectItem( 20, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate_corner_left_32",       "Izquierda abajo",         8, {| oBtn | ::SelectItem( 22, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate_corner_right_32",      "Abajo derecha",           9, {| oBtn | ::SelectItem( 23, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate_corner_right_down_32", "Derecha abajo",          10, {| oBtn | ::SelectItem( 24, oBtn ) }, , , .F., .F., .F. )
   oBoton                     := TDotNetButton():New( 60, oGrupo, "Navigate_corner_right_top_32",  "Arriba derecha",         11, {| oBtn | ::SelectItem( 25, oBtn ) }, , , .F., .F., .F. )

   ::LoadFromDatabase()

   ::oWnd:Maximize()

Return ( Self )



static FUNCTION TTpvSalon_LoadFromDatabase( cCodigoSala ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local oMesa
   local oDbfVir  := ::oSender:oDetSalaVta:oDbfVir

   if empty( cCodigoSala )

      if !empty( oDbfVir ) .AND. ( oDbfVir:Used() )

         oDbfVir:GoTop()
         while !oDbfVir:Eof()

            oMesa    := TTpvMesa():New( oDbfVir:nFila, oDbfVir:nColumna, oDbfVir:nTipo, ::oWnd:oClient )
            oMesa:LoadFromSala( ::oSender )

            oDbfVir:Skip()

         end

         oDbfVir:GoTop()

      end

   end

Return ( Self )



static FUNCTION TTpvSalon_SaveToDatabase( ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local oControl
   local aPuntoVenta := {}

   for each oControl in ::oWnd:oClient:aControls
      if aScan( aPuntoVenta, {|c| if( !Empty( c ) .AND. !Empty( oControl:cPuntoVenta ), Rtrim( c ) == Rtrim( oControl:cPuntoVenta ), .F. ) } ) == 0
         if !Empty( oControl:cPuntoVenta )
            aAdd( aPuntoVenta, Rtrim( oControl:cPuntoVenta ) )
         end
      else
         msgStop( "El nombre " + Rtrim( oControl:cPuntoVenta ) + " esta duplicado." )
         Return ( Self )
      end
   next

   if !Empty( ::oSender:oDetSalaVta:oDbfVir ) .AND. ( ::oSender:oDetSalaVta:oDbfVir:Used() )

      ::oSender:oDetSalaVta:oDbfVir:Zap()

      for each oControl in ::oWnd:oClient:aControls
         ::oSender:oDetSalaVta:oDbfVir:Blank()
         ::oSender:oDetSalaVta:oDbfVir:nTipo    := oControl:nType
         ::oSender:oDetSalaVta:oDbfVir:nFila    := oControl:nTop
         ::oSender:oDetSalaVta:oDbfVir:nColumna := oControl:nLeft
         ::oSender:oDetSalaVta:oDbfVir:cDescrip := oControl:cPuntoVenta
         ::oSender:oDetSalaVta:oDbfVir:Insert()
      next

      ::oSender:oDetSalaVta:oDbfVir:GoTop()

   end

   ::End( 1 )

Return ( Self )



static FUNCTION TTpvSalon_SelectPunto( oPunto ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   if oPunto:nUbicacion == 2 .AND. Len( ::aNumerosTickets( oPunto ) ) > 1

      if ::lBrowseMultiplesTickets( oPunto )

         ::oSelectedPunto  := oPunto

         ::Close( 1 )

      end

   else

      ::oSelectedPunto     := oPunto

      ::Close( 1 )

   end

RETURN nil



static FUNCTION TTpvSalon_aNumerosTickets( oPunto ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local aNumeros    := {}

   with object ( ::oTactil():oTiketCabecera )

      :GetStatus()

      :OrdSetFocus( "cCodSal" )

      if :Seek( oPunto:cCodigoSala + Padr( oPunto:cPuntoVenta, 30 ) )

         while :FieldGetByName( "cCodSala" ) + :FieldGetByName( "cPntVenta" ) == oPunto:cCodigoSala + Padr( oPunto:cPuntoVenta, 30 ) .AND. !:Eof()

            aAdd( aNumeros, :FieldGetByName( "cSerTik" ) + :FieldGetByName( "cNumTik" ) + :FieldGetByName( "cSufTik" ) )

            :Skip()

         end

      end

      :SetStatus()

   end

Return ( aNumeros )



static FUNCTION TTpvSalon_lBrowseMultiplesTickets( oPunto ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local oDlg
   local oBrw
   local oFont                := TFont():New( "Segoe UI",  0, 20, .F., .T. )

   ::oTiketCabecera():GetStatus()

   ::oTiketCabecera():OrdSetFocus( "cCodSal" )
   ::oTiketCabecera():OrdScope( oPunto:cCodigoSala + Padr( oPunto:cPuntoVenta, 30 ) )

   ::oTiketCabecera():GoTop()

   oDlg = TDialog():New(,,,,, ( "Tpv_Lista_Multiples" ),, .F.,,,,,, .F.,,,,,, .F.,, "oDlg", nil, )

      oBrw                   := IXBrowse():New( oDlg )

      oBrw:lRecordSelector   := .F.
      oBrw:lHScroll          := .F.
      oBrw:lVScroll          := .T.
      oBrw:nHeaderLines      := 2
      oBrw:nDataLines        := 2
      oBrw:cName             := "Tpv.Lista multiples tickets"
      oBrw:nRowHeight        := 54

      oBrw:nMarqueeStyle     := 5
      oBrw:nRowDividerStyle  := 4

      oBrw:bClrSel           := {|| { 16777215, ( 53 + ( 142 * 256 ) + ( 182 * 65536 ) ) } }
      oBrw:bClrSelFocus      := {|| { 16777215, ( 53 + ( 142 * 256 ) + ( 182 * 65536 ) ) } }

      oBrw:bLDblClick        := {|| oDlg:End( 1 ) }

      oBrw:oFont             := oFont

      ::oTiketCabecera():SetBrowse( oBrw )

      oBrw:CreateFromResource( 100 )

      with object ( oBrw:AddCol() )
         :cHeader          := "Número"
         :bEditValue       := {|| ::oTiketCabecera():FieldGetByName( "cSerTik" ) + "/" + AllTrim( ::oTiketCabecera():FieldGetByName( "cNumTik" ) ) + "/" + ::oTiketCabecera():FieldGetByName( "cSufTik" ) }
         :nWidth           := 90
      end

      with object ( oBrw:AddCol() )
         :cHeader          := "Fecha" + Chr(13)+Chr(10) + "Hora"
         :bEditValue       := {|| dToc( ::oTiketCabecera():FieldGetByName( "dFecTik" ) ) + Chr(13)+Chr(10) + ::oTiketCabecera():FieldGetByName( "cHorTik" ) }
         :nWidth           := 100
      end

      with object ( oBrw:AddCol() )
         :cHeader          := "Caja"
         :bEditValue       := {|| ::oTiketCabecera():FieldGetByName( "cNcjTik" ) }
         :nWidth           := 75
      end

      with object ( oBrw:AddCol() )
         :cHeader          := "Usuario"
         :bEditValue       := {|| ::oTiketCabecera():FieldGetByName( "cCcjTik" ) }
         :nWidth           := 75
      end

      with object ( oBrw:AddCol() )
         :cHeader          := "Estado"
         :bEditValue       := {|| ::oTactil():cEstado() }
         :nWidth           := 90
      end

      with object ( oBrw:AddCol() )
         :cHeader          := "Cliente"
         :bEditValue       := {|| ::oTiketCabecera():FieldGetByName( "cCliTik" ) + Chr(13)+Chr(10) + ::oTiketCabecera():FieldGetByName( "cNomTik" ) }
         :nWidth           := 275
      end

      with object ( oBrw:AddCol() )
         :cHeader          := "Total"
         :bEditValue       := {|| ::oTiketCabecera():FieldGetByName( "nTotTik" ) }
         :cEditPicture     := ::oTactil():cPictureTotal
         :nDataStrAlign    := 1
         :nHeadStrAlign    := 1
         :nWidth           := 100
      end

      oDlg:bStart          := {|| ::StartResource( oBrw, oDlg ) }

   oDlg:Activate( oDlg:bLClicked, oDlg:bMoved, oDlg:bPainted, .T.,,,, oDlg:bRClicked,,, )

   if oDlg:nResult == 1

      oPunto:cSerie        := ::oTiketCabecera():FieldGetByName( "cSerTik" )
      oPunto:cNumero       := ::oTiketCabecera():FieldGetByName( "cNumTik" )
      oPunto:cSufijo       := ::oTiketCabecera():FieldGetByName( "cSufTik" )

   end

   ::oTiketCabecera():OrdClearScope()

   ::oTiketCabecera():SetStatus()

   oFont:End()

Return ( oDlg:nResult == 1 )



static FUNCTION TTpvSalon_StartResource( oBrw, oDlg ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local oBoton
   local oGrupo
   local oCarpeta
   local oOfficeBar

   if Empty( oOfficeBar )





      oOfficeBar            := TDotNetBar():New( 0, 0, 1020, 120, oDlg, 1 )

      oOfficeBar:lPaintAll  := .F.
      oOfficeBar:lDisenio   := .F.

      oOfficeBar:SetStyle( 1 )

      oDlg:oTop    := oOfficeBar

      oCarpeta       := TCarpeta():New( oOfficeBar, "Inicio" )

      oGrupo         := TDotNetGroup():New( oCarpeta, 366,  "Seleción de tickets", .F. )
         oBoton      := TDotNetButton():New( 60, oGrupo,    "gc_navigate_line_up_32",   "Primera línea",      1, {|| ::LineaPrimera( oBrw ) } )
         oBoton      := TDotNetButton():New( 60, oGrupo,    "gc_navigate_line_down_32", "Última línea",       2, {|| ::LineaUltima( oBrw ) } )
         oBoton      := TDotNetButton():New( 60, oGrupo,    "gc_navigate_up2a_32",      "Página anterior",    3, {|| ::PaginaAnterior( oBrw ) } )
         oBoton      := TDotNetButton():New( 60, oGrupo,    "gc_navigate_down2a_32",    "Página siguiente",   4, {|| ::PaginaSiguiente( oBrw ) } )
         oBoton      := TDotNetButton():New( 60, oGrupo,    "gc_arrow_up_32",           "Línea anterior",     5, {|| ::LineaAnterior( oBrw ) } )
         oBoton      := TDotNetButton():New( 60, oGrupo,    "gc_arrow_down_32",         "Línea siguiente",    6, {|| ::LineaSiguiente( oBrw ) } )

      oGrupo         := TDotNetGroup():New( oCarpeta, 126,  "Salida", .F. )
         oBoton      := TDotNetButton():New( 60, oGrupo,    "gc_check_32",                "Aceptar",            1, {|| oDlg:End( 1 ) }, , , .F., .F., .F. )
         oBoton      := TDotNetButton():New( 60, oGrupo,    "End32",                   "Salida",             2, {|| oDlg:End() }, , , .F., .F., .F. )

   end

Return ( nil )



static FUNCTION TTpvSalon_SelectGenerico( ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   ::oSelectedPunto           :=  ::oSender:oGenerico

   ::End( 1 )

RETURN nil



static FUNCTION TTpvSalon_SelectLlevar( ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   ::oSelectedPunto           :=  ::oSender:oLlevar

   ::End( 1 )

RETURN nil



static FUNCTION TTpvSalon_SelectSala( oBtnItem, lPuntosPendientes ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   ::UnSelectButtons()





   oBtnItem:lSelected   := .T.





   ::LoadFromMemory( oBtnItem:cName, lPuntosPendientes )

Return ( Self )



static FUNCTION TTpvSalon_CreateItemMesa( nRow, nCol, cPuntoVenta, nType ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local oItemMesa

   If( nRow == nil, nRow := 0, ) ;
   If( nCol == nil, nCol := 0, ) ;
   If( nType == nil, nType := 4, ) ;

   oItemMesa                     := TTpvMesa():New( nRow, nCol, nType, ::oWnd:oClient, Self )

   oItemMesa:lDesign             := ::lDesign

   do case
      case IsNil( cPuntoVenta )
         oItemMesa:cPuntoVenta   := nil
      case IsChar( cPuntoVenta )
         oItemMesa:cPuntoVenta   := Rtrim( cPuntoVenta )
      case IsTrue( cPuntoVenta )
         oItemMesa:cPuntoVenta   := VirtualKey( .F., "", "Nombre de la mesa" )
   end

   oItemMesa:Refresh()

   aAdd( ::aMesas, oItemMesa )

Return ( oItemMesa )



static FUNCTION TTpvSalon_SelectItem( nItem, oBtnItem ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   ::UnSelectButtons()





   oBtnItem:lSelected   := .T.





   ::nItemToInsert      := nItem

Return ( Self )



static FUNCTION TTpvSalon_UnSelectButtons( ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local oGrupo
   local oBoton
   local oCarpeta





   for each oCarpeta in ::oOfficeBar:aCarpetas
      for each oGrupo in oCarpeta:aGrupos
         for each oBoton in oGrupo:aItems
            oBoton:lSelected  := .F.
         next
      next
   next

   ::nItemToInsert            := 0

Return ( Self )



static FUNCTION TTpvSalon_CreateFromPunto( sPunto ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local oItemMesa

   oItemMesa               := ::CreateItem( sPunto:nTipo, sPunto:nFila, sPunto:nColumna, sPunto:cPuntoVenta )
   if !Empty( oItemMesa )
      oItemMesa:sPunto     := sPunto
      if IsChar( oItemMesa:cTooltip )
         oItemMesa:nState := ::oSender:nStatePunto( sPunto )
      end
   end

Return ( Self )



static FUNCTION TTpvSalon_LoadGenericosPendientes( lPuntosPendientes ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local n
   local sPunto
   local nHorizontal

   If( lPuntosPendientes == nil, lPuntosPendientes := .F., ) ;

   n                          := 0
   nHorizontal                := ::oWnd:nHorzRes() - 203

   ::nTop                     := 5
   ::nLeft                    := 1
   ::nType                    := 26





   while len( ::oWnd:oClient:aControls ) > 0
      ::oWnd:oClient:aControls[ 1 ]:End()
   end





   ::oSender:oSender:oTiketCabecera:GetStatus()
   ::oSender:oSender:oTiketCabecera:OrdSetFocus( "lCloUbiTik" )

   if ::oSender:oSender:oTiketCabecera:Seek( Str( 0, 1 ) )

      while ::oSender:oSender:oTiketCabecera:FieldGetByName( "nUbiTik" ) == 0 .AND. !::oSender:oSender:oTiketCabecera:Eof()

         sPunto               := sTpvPunto():CreateFromSalon( n++, Self )
         sPunto:CreateMesa( lPuntosPendientes )

         ::nLeft              += 164

         if ::nLeft > nHorizontal
            ::nLeft           := 1
            ::nTop            += 85
         end

         ::oSender:oSender:oTiketCabecera:Skip()

      end

   end

   ::oSender:oSender:oTiketCabecera:SetStatus()





   if !Empty( ::oBtnGenerico )
      ::UnSelectButtons()
      ::oBtnGenerico:lSelected  := .T.
   end

RETURN ( nil )



static FUNCTION TTpvSalon_LoadRecogerPendientes( lPuntosPendientes ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local n
   local sPunto
   local nHorizontal

   If( lPuntosPendientes == nil, lPuntosPendientes := .F., ) ;

   n                          := 0
   nHorizontal                := ::oWnd:nHorzRes() - 203

   ::nTop                     := 5
   ::nLeft                    := 1
   ::nType                    := 30





   while len( ::oWnd:oClient:aControls ) > 0
      ::oWnd:oClient:aControls[ 1 ]:End()
   end





   ::oSender:oSender:oTiketCabecera:GetStatus()
   ::oSender:oSender:oTiketCabecera:OrdSetFocus( "nUbiTik" )

   if ::oSender:oSender:oTiketCabecera:Seek( Str( 3, 1 ) )

      while ::oSender:oSender:oTiketCabecera:FieldGetByName( "nUbiTik" ) == 3 .AND. !::oSender:oSender:oTiketCabecera:Eof()

         sPunto               := sTpvPunto():CreateFromSalon( n++, Self )
         sPunto:CreateMesa( lPuntosPendientes )

         ::nLeft              += 164

         if ::nLeft > nHorizontal
            ::nLeft           := 1
            ::nTop            += 85
         end

         ::oSender:oSender:oTiketCabecera:Skip()

      end

   end

   ::oSender:oSender:oTiketCabecera:SetStatus()





   if !Empty( ::oBtnRecoger )
      ::UnSelectButtons()
      ::oBtnRecoger:lSelected  := .T.
   end

RETURN ( nil )



static FUNCTION TTpvSalon_LoadLlevarPendientes( lPuntosPendientes ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local n
   local sPunto
   local nHorizontal

   If( lPuntosPendientes == nil, lPuntosPendientes := .F., ) ;

   n                          := 0
   nHorizontal                := ::oWnd:nHorzRes() - 203

   ::nTop                     := 5
   ::nLeft                    := 1
   ::nType                    := 27





   while len( ::oWnd:oClient:aControls ) > 0
      ::oWnd:oClient:aControls[ 1 ]:End()
   end





   ::oSender:oSender:oTiketCabecera:GetStatus()
   ::oSender:oSender:oTiketCabecera:OrdSetFocus( "nUbiTik" )

   if ::oSender:oSender:oTiketCabecera:Seek( Str( 1, 1 ) )

      while ::oSender:oSender:oTiketCabecera:FieldGetByName( "nUbiTik" ) == 1 .AND. !::oSender:oSender:oTiketCabecera:Eof()

         sPunto               := sTpvPunto():CreateFromSalon( n++, Self )
         sPunto:CreateMesa( lPuntosPendientes )

         ::nLeft              += 164

         if ::nLeft > nHorizontal
            ::nLeft           := 1
            ::nTop            += 85
         end

         ::oSender:oSender:oTiketCabecera:Skip()

      end

   end

   ::oSender:oSender:oTiketCabecera:SetStatus()





   if !Empty( ::oBtnLlevar )
      ::UnSelectButtons()
      ::oBtnLlevar:lSelected  := .T.
   end

RETURN ( nil )



static FUNCTION TTpvSalon_LoadEncargarPendientes( lPuntosPendientes ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local n
   local sPunto
   local nHorizontal

   If( lPuntosPendientes == nil, lPuntosPendientes := .F., ) ;

   n                          := 0
   nHorizontal                := ::oWnd:nHorzRes() - 203

   ::nTop                     := 5
   ::nLeft                    := 1
   ::nType                    := 31





   while len( ::oWnd:oClient:aControls ) > 0
      ::oWnd:oClient:aControls[ 1 ]:End()
   end





   ::oSender:oSender:oTiketCabecera:GetStatus()
   ::oSender:oSender:oTiketCabecera:OrdSetFocus( "nUbiTik" )

   if ::oSender:oSender:oTiketCabecera:Seek( Str( 4, 1 ) )

      while ::oSender:oSender:oTiketCabecera:FieldGetByName( "nUbiTik" ) == 4 .AND. !::oSender:oSender:oTiketCabecera:Eof()

         sPunto               := sTpvPunto():CreateFromSalon( n++, Self )
         sPunto:CreateMesa( lPuntosPendientes )

         ::nLeft              += 164

         if ::nLeft > nHorizontal
            ::nLeft           := 1
            ::nTop            += 85
         end

         ::oSender:oSender:oTiketCabecera:Skip()

      end

   end

   ::oSender:oSender:oTiketCabecera:SetStatus()





   if !Empty( ::oBtnEncargar )
      ::UnSelectButtons()
      ::oBtnEncargar:lSelected  := .T.
   end

RETURN ( nil )



static FUNCTION TTpvSalon_AddResource( cResource ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local aBmpPal

   aBmpPal        := PalBmpLoad( cResource )

   if aBmpPal[ 1 ] <> 0
      aAdd( aBmpPal, nBmpWidth( aBmpPal[ 1 ] ) )
      aAdd( aBmpPal, nBmpHeight( aBmpPal[ 1 ] ) )
      aAdd( aBmpPal, nil )
      aAdd( ::aBitmapsState, aBmpPal )
      return .T.
   endif

return .F.



static FUNCTION TTpvSalon_Selector( lPuntosPendientes, lLlevar, nSelectOption ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local n
   local sSala

   If( nSelectOption == nil, nSelectOption := 2, ) ;

   if len( ::oSender:aSalas ) == 0
      MsgStop( "No existen salones definidos." )
      Return .F.
   end

   ::lDesign                  := .F.

   ::oWnd                     := TDialog():New( , , , , ::cTitle(), "SelectMesa" )

   ::oWnd:bStart              := {|| ::StartSelector( lPuntosPendientes, lLlevar, nSelectOption ) }

   ::oWnd:Activate( , , , .T., , .T., {|| ::InitSelector( lPuntosPendientes, lLlevar, nSelectOption ) } )

Return ( ::oWnd:nResult == 1 )



static FUNCTION TTpvSalon_InitSelector( lPuntosPendientes, lShowLlevar, nSelectOption ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local nSala
   local sSala
   local oGrupo
   local oBoton
   local nWidth
   local oCarpeta

   nSala                      := len( ::oSender:aSalas )

   nWidth                     := ( nSala * 60 )

   if lShowLlevar

      nWidth                  += 60

      if uFieldEmpresa( "lRecoger" )
         nWidth               += 60
      end

      if uFieldEmpresa( "lLlevar" )
         nWidth               += 60
      end

      if uFieldEmpresa( "lRecoger" )
         nWidth               += 60
      end

   end

   nWidth                     += 6

   ::oOfficeBar               := TDotNetBar():New( 0, 0, 1008, 120, ::oWnd, 1 )
   ::oOfficeBar:lPaintAll     := .F.
   ::oOfficeBar:lDisenio      := .F.

   ::oOfficeBar:SetStyle( 1 )

   ::oWnd:oTop                := ::oOfficeBar

   oCarpeta                   := TCarpeta():New( ::oOfficeBar, "Salones" )
      oGrupo                  := TDotNetGroup():New( oCarpeta, nWidth, "Salones", .F. )

      for each sSala in ::oSender:aSalas

         oBoton               := TDotNetButton():New( 60, oGrupo, sSala:cImagen, sSala:cDescripcion, hb_enumindex(), {| oBoton | ::SelectSala( oBoton, lPuntosPendientes ) }, , , .F., .F., .F. )
         oBoton:cName         := sSala:cCodigo



         if !empty( oUser():SalaVenta() )
            oBoton:lSelected  := ( sSala:cCodigo == oUser():SalaVenta() )
         else
            oBoton:lSelected  := ( hb_enumindex() == 1 )
         end

      next

   if lShowLlevar

      nSala++

      ::oBtnGenerico          := TDotNetButton():New( 60, oGrupo, "gc_cash_register_32", "General", nSala, {|| ::LoadGenericosPendientes( lPuntosPendientes ) }, , , .F., .F., .F. )

      if uFieldEmpresa( "lRecoger" )
         ::oBtnRecoger        := TDotNetButton():New( 60, oGrupo, "gc_shopping_basket_32", "Para recoger", ++nSala, {|| ::LoadRecogerPendientes( lPuntosPendientes ) }, , , .F., .F., .F. )
      end

      if uFieldEmpresa( "lLlevar" )
         ::oBtnLlevar         := TDotNetButton():New( 60, oGrupo, "gc_motor_scooter_32", "Para llevar", ++nSala, {|| ::LoadLlevarPendientes( lPuntosPendientes ) }, , , .F., .F., .F. )
      end

      if uFieldEmpresa( "lEncargar" )
         ::oBtnEncargar       := TDotNetButton():New( 60, oGrupo, "gc_notebook2_32", "Encargar", ++nSala, {|| ::LoadEncargarPendientes( lPuntosPendientes ) }, , , .F., .F., .F. )
      end

   end

   oGrupo                     := TDotNetGroup():New( oCarpeta, 66, "Acciones", .F., , "gc_door_open2_32" )
      oBoton                  := TDotNetButton():New( 60, oGrupo, "End32", "Salir", 1, {|| ::oSelectedPunto := nil, ::Close( 2 ) }, , , .F., .F., .F. )

   oGrupo                     := TDotNetGroup():New( oCarpeta, 246, "Leyenda ubicaciones", .F., , "" )
      oBoton                  := TDotNetButton():New( 120, oGrupo, "gc_check_12", "Libre", 1, nil, , , .F., .F., .F. )
      oBoton                  := TDotNetButton():New( 120, oGrupo, "gc_shape_square_12", "Ocupada", 1, nil, , , .F., .F., .F. )
      oBoton                  := TDotNetButton():New( 120, oGrupo, "gc_delete_12", "Ticket entregado", 1, nil, , , .F., .F., .F. )
      oBoton                  := TDotNetButton():New( 120, oGrupo, "", "[...] Multiples tickets", 2, nil, , , .F., .F., .F. )

   ::oWnd:oClient             := TPanelEx():New()

Return ( Self )



static FUNCTION TTpvSalon_StartSelector( lPuntosPendientes, lShowLlevar, nSelectOption ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   ::oWnd:Maximize()



   if !Empty( oUser():SalaVenta() )
      ::LoadFromMemory( oUser():SalaVenta(), lPuntosPendientes )
   else
      ::LoadFromMemory( nil, lPuntosPendientes )
   end





   do case
      case nSelectOption == 0

         ::oBtnGenerico:Selected()
         ::oBtnLlevar:UnSelected()
         ::oBtnRecoger:UnSelected()
         ::oBtnEncargar:UnSelected()

         ::LoadGenericosPendientes( lPuntosPendientes )

      case nSelectOption == 1

         ::oBtnLlevar:Selected()
         ::oBtnGenerico:UnSelected()
         ::oBtnRecoger:UnSelected()
         ::oBtnEncargar:UnSelected()

         ::LoadLlevarPendientes( lPuntosPendientes )

      case nSelectOption == 3

         ::oBtnRecoger:Selected()
         ::oBtnGenerico:UnSelected()
         ::oBtnLlevar:UnSelected()
         ::oBtnEncargar:UnSelected()

         ::LoadRecogerPendientes( lPuntosPendientes )

      case nSelectOption == 4

         ::oBtnRecoger:UnSelected()
         ::oBtnGenerico:UnSelected()
         ::oBtnLlevar:UnSelected()
         ::oBtnEncargar:Selected()

         ::LoadEncargarPendientes( lPuntosPendientes )

   end

RETURN ( self )



static FUNCTION TTpvSalon_cCodForSalon( cSalon ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local i
   local nPos
   local cCodSalon   := ""

   if ( nPos := aScan( ::oSender:aSalas, {|a| a:cDescripcion == cSalon } ) ) <> 0
      cCodSalon      := ::oSender:aSalas[ nPos ]:cCodigo
   end

return cCodSalon



static FUNCTION TTpvSalon_lLimpiaSalon( lPuntosPendientes ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local n
   local oMesas

   ::nItemToInsert               := 0
   ::nRowToInsert                := 28
   ::nColToInsert                := 2

   for each oMesas in ::oWnd:aControls

      if oMesas:ClassName() == "TBTNBMP" .AND. !Empty( oMesas:Cargo )
         oMesas:Hide()
         oMesas:Destroy()
      end

   next

   ::oWnd:aControls              := {}
   ::oWnd:Refresh()

   UpdateWindow()

Return .T.



static FUNCTION TTpvSalon_CreateItem( nItem, nRow, nCol, uToolTip ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   If( nItem == nil, nItem := ::nItemToInsert, ) ;
   If( nRow == nil, nRow := 0, ) ;
   If( nCol == nil, nCol := 0, ) ;
   If( uToolTip == nil, uToolTip := .F., ) ;

   do case
      case nItem == 1
         Return( ::CreateItemMesaRedonda( nRow, nCol, uToolTip ) )

      case nItem == 2
         Return( ::CreateItemMesaEliptica( nRow, nCol, uToolTip ) )

      case nItem == 3
         Return( ::CreateItemMesaCuadrada( nRow, nCol, uToolTip ) )

      case nItem == 4
         Return( ::CreateItemMesaRectangular( nRow, nCol, uToolTip ) )

      case nItem == 5
         Return( ::CreateItemBarraHorizontal( nRow, nCol, uToolTip ) )

      case nItem == 6
         Return( ::CreateItemBarraVertical( nRow, nCol, uToolTip ) )

      case nItem == 7
         Return( ::CreateItemBarrraEsquinaDerechaAbajo( nRow, nCol, uToolTip ) )

      case nItem == 8
         Return( ::CreateItemBarrraEsquinaIzquierdaAbajo( nRow, nCol, uToolTip ) )

      case nItem == 9
         Return( ::CreateItemBarrraEsquinaDerechaArriba( nRow, nCol, uToolTip ) )

      case nItem == 10
         Return( ::CreateItemBarrraEsquinaIzquierdaArriba( nRow, nCol, uToolTip ) )

      case nItem == 11
         Return( ::CreateItemPlantaBlanca( nRow, nCol ) )

      case nItem == 13
         Return( ::CreateItemPlantaAzul( nRow, nCol ) )

      case nItem == 12
         Return( ::CreateItemPlantaAmarilla( nRow, nCol ) )

      case nItem == 14
         Return( ::CreateItemPlantaRoja( nRow, nCol ) )

      case nItem == 15
         Return( ::CreateItemPanelHorizontal( nRow, nCol ) )

      case nItem == 16
         Return( ::CreateItemPanelVertical( nRow, nCol ) )

      case nItem == 17
         Return( ::CreateItemPanelCruce( nRow, nCol ) )

      case nItem == 19
         Return( ::CreateItemPanelConexionArriba( nRow, nCol ) )

      case nItem == 18
         Return( ::CreateItemPanelConexionAbajo( nRow, nCol ) )

      case nItem == 22
         Return( ::CreateItemPanelCurvaAbajo( nRow, nCol ) )

      case nItem == 25
         Return( ::CreateItemPanelCurvaArriba( nRow, nCol ) )

      case nItem == 23
         Return( ::CreateItemPanelCurvaDerecha( nRow, nCol ) )

      case nItem == 24
         Return( ::CreateItemPanelCurvaIzquierda( nRow, nCol ) )

      case nItem == 20
         Return( ::CreateItemPanelConexionDerecha( nRow, nCol ) )

      case nItem == 21
         Return( ::CreateItemPanelConexionIzquierda( nRow, nCol ) )

      case nItem == 26
         Return( ::CreateItemGenerico( nRow, nCol, uToolTip ) )

      case nItem == 27
         Return( ::CreateItemLlevar( nRow, nCol, uToolTip ) )

      case nItem == 31
         Return( ::CreateItemEncargar( nRow, nCol, uToolTip ) )

      case nItem == 28
         Return( ::CreateItemNewGenerico( nRow, nCol, uToolTip ) )

      case nItem == 29
         Return( ::CreateItemNewLlevar( nRow, nCol, uToolTip ) )

      case nItem == 30
         Return( ::CreateItemRecoger( nRow, nCol, uToolTip ) )

   end

Return ( nil )



static FUNCTION TTpvSalon_LoadFromMemory( cCodigoSala, lPuntosPendientes ) ; local Self AS CLASS TTpvSalon := QSelf() AS CLASS TTpvSalon

   local sSala
   local sPunto
   local oBlock
   local oError

   CursorWait()

   oBlock            := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   if empty( cCodigoSala ) .AND. len( ::oSender:aSalas ) >= 1
      cCodigoSala    := ::oSender:aSalas[ 1 ]:cCodigo
   end

   if isChar( cCodigoSala )

      while len( ::oWnd:oClient:aControls ) > 0
         ::oWnd:oClient:aControls[ 1 ]:End()
      end

      for each sSala in ::oSender:aSalas

         if sSala:cCodigo == cCodigoSala

            for each sPunto in sSala:aPunto

               sPunto:LoadMesa()
               sPunto:CreateMesa( lPuntosPendientes )

            next

         end

      next

   end

   RECOVER USING oError
      msgStop( ErrorMessage( oError ), "Error al crear las mesas" )
   end
   ErrorBlock( oBlock )

   CursorWE()

Return ( Self )









_HB_CLASS sTpvSala ; function sTpvSala ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "sTpvSala", iif( .F., { }, { @HBObject() } ), @sTpvSala() ) ) ;

   _HB_MEMBER { oSender } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSender"}, .F. )

   _HB_MEMBER { cCodigo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cCodigo"}, .F. )
   _HB_MEMBER { cDescripcion } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cDescripcion"}, .F. )
   _HB_MEMBER { nPrecio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPrecio"}, .F. )
   _HB_MEMBER { nPreCmb } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nPreCmb"}, .F. )
   _HB_MEMBER { cImagen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cImagen"}, .F. )
   _HB_MEMBER { lComensal } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lComensal"}, .F. )
   _HB_MEMBER { cArticulo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cArticulo"}, .F. )
   _HB_MEMBER { lMultiplicar } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"lMultiplicar"}, .F. )

   _HB_MEMBER { AS ARRAY aPunto } ; oClass:AddMultiData( "ARRAY", {}, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"aPunto"}, .F. )

   _HB_MEMBER New( oSender); oClass:AddMethod( "New", @sTpvSala_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER BuildPuntos(); oClass:AddMethod( "BuildPuntos", @sTpvSala_BuildPuntos(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER AddPunto( nNumero); oClass:AddMethod( "AddPunto", @sTpvSala_AddPunto(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS sTpvSala ;



static FUNCTION sTpvSala_New( oSender ) ; local Self AS CLASS sTpvSala := QSelf() AS CLASS sTpvSala

   ::oSender      := oSender

   ::cCodigo      := oSender:oDbf:cCodigo
   ::nPrecio      := oSender:oDbf:nPrecio
   ::nPreCmb      := oSender:oDbf:nPreCmb
   ::cDescripcion := Rtrim( oSender:oDbf:cDescrip )
   ::lComensal    := oSender:oDbf:lComensal
   ::cArticulo    := oSender:oDbf:cArticulo
   ::lMultiplicar := oSender:oDbf:lMultipli

   ::cImagen      := oSender:cBigResource()

   ::aPunto       := {}

Return ( Self )



static FUNCTION sTpvSala_AddPunto( nNumero ) ; local Self AS CLASS sTpvSala := QSelf() AS CLASS sTpvSala

   aAdd( ::aPunto, sTpvPunto():Create( nNumero, Self ) )

Return ( Self )



static FUNCTION sTpvSala_BuildPuntos( ) ; local Self AS CLASS sTpvSala := QSelf() AS CLASS sTpvSala

   local n        := 0
   local sPunto

   if ::oSender:oDetSalaVta:oDbf:Seek( ::oSender:oDbf:cCodigo )

      while ( ::oSender:oDetSalaVta:oDbf:cCodigo == ::oSender:oDbf:cCodigo ) .AND. !( ::oSender:oDetSalaVta:oDbf:eof() )

         if !::oSender:lPuntosVenta
            ::oSender:lPuntosVenta  := .T.
         end

         sPunto   := sTpvPunto():CreateFromSala( n++, Self )

         aAdd( ::aPunto, sPunto )

         ::oSender:oDetSalaVta:oDbf:Skip()

      end

   end

Return ( Self )
