#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 7 ".\Prg\tablet\view\ViewBase.prg"
_HB_CLASS ViewBase ; function ViewBase ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ViewBase", iif( .F., { }, { @HBObject() } ), @ViewBase() ) ) ;

   _HB_MEMBER { buttonEnd } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"buttonEnd"}, .F. )
   _HB_MEMBER { buttonCancel } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"buttonCancel"}, .F. )
   _HB_MEMBER { buttonOk } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"buttonOk"}, .F. )

   _HB_MEMBER { oSayTitle } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayTitle"}, .F. )

   _HB_MEMBER { columnLabel } ; oClass:AddMultiData(, 0.2, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"columnLabel"}, .F. )
   _HB_MEMBER { widthLabel } ; oClass:AddMultiData(, 1.8, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"widthLabel"}, .F. )

   _HB_MEMBER { oDlg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDlg"}, .F. )

   _HB_MEMBER { oBrowse } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrowse"}, .F. )

   _HB_MEMBER { oSender } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSender"}, .F. )

   _HB_MEMBER { cErrorValidator } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cErrorValidator"}, .F. )

   _HB_MEMBER { Style } ; oClass:AddMultiData(, ( nOR( 128, 2147483648, 12582912, 524288, 131072, 65536 ) ), nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"Style"}, .F. )

   _HB_MEMBER { cTitleDocumento } ; oClass:AddMultiData(, "", nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"cTitleDocumento"}, .F. )

   _HB_MEMBER { nRow } ; oClass:AddMultiData(, 40, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nRow"}, .F. )

   _HB_MEMBER { bPreShowDialog } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bPreShowDialog"}, .F. )
   _HB_MEMBER { bPostDialog } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"bPostDialog"}, .F. )

   _HB_MEMBER setBrowseConfigurationName(); oClass:AddInline( "setBrowseConfigurationName", {|Self, cName | ( ( Self ) ), ( if( !empty( ::oBrowse ), ::oBrowse:cName := cName, ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getBrowseConfigurationName(); oClass:AddInline( "getBrowseConfigurationName", {|Self | ( ( Self ) ), ( if( !empty( ::oBrowse ), ::oBrowse:cName, "" ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER loadBrowseConfiguration(); oClass:AddInline( "loadBrowseConfiguration", {|Self | ( ( Self ) ), ( if( !empty( ::oBrowse ) .AND. !empty( ::oBrowse:cName ), ::oBrowse:Load(), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setTitleDocumento(); oClass:AddInline( "setTitleDocumento", {|Self, cTitleDocumento | ( ( Self ) ), ( if( !empty( cTitleDocumento ), ::cTitleDocumento := cTitleDocumento, ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getTitleDocumento(); oClass:AddInline( "getTitleDocumento", {|Self | ( ( Self ) ), ( if( !empty( ::oSender:textMode() ), ::oSender:textMode() + lower( ::cTitleDocumento ), ::cTitleDocumento ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setPreShowDialog(); oClass:AddInline( "setPreShowDialog", {|Self, bPreShowDialog | ( ( Self ) ), ( ::bPreShowDialog := bPreShowDialog ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER evalPreShowDialog(); oClass:AddInline( "evalPreShowDialog", {|Self | ( ( Self ) ), ( if( !empty( ::bPreShowDialog ), eval( ::bPreShowDialog, self ), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setPostShowDialog(); oClass:AddInline( "setPostShowDialog", {|Self, bPostShowDialog | ( ( Self ) ), ( ::bPostShowDialog := bPostShowDialog ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER evalPostDialog(); oClass:AddInline( "evalPostDialog", {|Self | ( ( Self ) ), ( if( !empty( ::bPostDialog ), eval( ::bPostDialog, self ), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER showView(); oClass:AddMethod( "showView", @ViewBase_showView(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @ViewBase_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER insertControls() ; oClass:AddVirtual( "insertControls" )

   _HB_MEMBER getView(); oClass:AddInline( "getView", {|Self | ( ( Self ) ), ( ::oSender:nView ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getMode(); oClass:AddInline( "getMode", {|Self | ( ( Self ) ), ( ::oSender:nMode ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getChangePrecio(); oClass:AddInline( "getChangePrecio", {|Self | ( ( Self ) ), ( RolesModel():getRolCambiarPrecios( Auth():rolUuid() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineTitulo(); oClass:AddMethod( "defineTitulo", @ViewBase_defineTitulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineAceptarCancelar(); oClass:AddMethod( "defineAceptarCancelar", @ViewBase_defineAceptarCancelar(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineSalir(); oClass:AddMethod( "defineSalir", @ViewBase_defineSalir(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER resizeDialog(); oClass:AddMethod( "resizeDialog", @ViewBase_resizeDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER initDialog(); oClass:AddMethod( "initDialog", @ViewBase_initDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER endDialog() ; oClass:AddVirtual( "endDialog" )
   _HB_MEMBER startDialog() ; oClass:AddVirtual( "startDialog" )
   _HB_MEMBER validDialog(); oClass:AddInline( "validDialog", {|Self | ( ( Self ) ), ( .T. ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setDialog(); oClass:AddInline( "setDialog", {|Self, oDlg | ( ( Self ) ), ( ::oDlg := oDlg ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )



   _HB_MEMBER setGetValue(); oClass:AddInline( "setGetValue", {|Self, uValue, cName | ( ( Self ) ), ( iif(  isNil( uValue ), hGet( ::oSender:hDictionaryMaster, cName ), hSet( ::oSender:hDictionaryMaster, cName, uValue ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getValue(); oClass:AddInline( "getValue", {|Self, cName | ( ( Self ) ), ( hGet( ::oSender:hDictionaryMaster, cName ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER setValue(); oClass:AddInline( "setValue", {|Self, uValue, cFieldName | ( ( Self ) ), ( hSet( ::oSender:hDictionaryMaster, cFieldName, uValue ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setErrorValidator( cErrorText); oClass:AddMethod( "setErrorValidator", @ViewBase_setErrorValidator(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER showErrorValidator(); oClass:AddInline( "showErrorValidator", {|Self | ( ( Self ) ), ( if( !empty( ::cErrorValidator ), apoloMsgStop( ::cErrorValidator ), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER errorValidator(); oClass:AddMethod( "errorValidator", @ViewBase_errorValidator(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )



   _HB_MEMBER endView(); oClass:AddInline( "endView", {|Self | ( ( Self ) ), ( ::oDlg:goNextCtrl( GetFocus() ), ::oDlg:goPrevCtrl( GetFocus() ), if( ::validateDialog(), ::oDlg:End( 1 ), ::showErrorValidator() ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER cancelView(); oClass:AddInline( "cancelView", {|Self | ( ( Self ) ), ( if( ApoloMsgNoYes( "¿Desea terminar el proceso?", "¡Atención!", .T. ), ::oDlg:End(), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER evalDialog(); oClass:AddMethod( "evalDialog", @ViewBase_evalDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER validateDialog(); oClass:AddInline( "validateDialog", {|Self | ( ( Self ) ), ( ::evalDialog() .AND. ::validDialog() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getRow(); oClass:AddInline( "getRow", {|Self | ( ( Self ) ), ( ::nRow ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER resetRow(); oClass:AddInline( "resetRow", {|Self | ( ( Self ) ), ( ::nRow := 40 ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER nextRow(); oClass:AddInline( "nextRow", {|Self | ( ( Self ) ), ( ::nRow += 25 ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ViewBase ;



static FUNCTION ViewBase_showView( ) ; local Self AS CLASS ViewBase := QSelf() AS CLASS ViewBase

   ::evalPreShowDialog()

   ::Resource()

   ::evalPostDialog()

Return ( self )



static FUNCTION ViewBase_Resource( ) ; local Self AS CLASS ViewBase := QSelf() AS CLASS ViewBase

   ::resetRow()

   ::oDlg                  := TDialog():New( 1, 5, 40, 100, "gestool TABLET",,, .F., ::Style,, ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ),,, .F.,, oGridFont(),,,, .F.,, "oDlg" )

   ::defineTitulo()

   ::defineAceptarCancelar()

   ::insertControls()

   ::oDlg:bResized         := {|| ::resizeDialog() }

   ::oDlg:bStart           := {|| ::startDialog() }

   ::oDlg:Activate( , , , .T., , , {|| ::initDialog() } )

Return ( ::oDlg:nResult == 1 )



static FUNCTION ViewBase_defineTitulo( ) ; local Self AS CLASS ViewBase := QSelf() AS CLASS ViewBase











   ::oSayTitle    := TGridSay():Build(    {  "nRow"      => 0, "nCol"      => {|| GridWidth( ::columnLabel, ::oDlg ) }, "bText"     => {|| ::getTitleDocumento() }, "oWnd"      => ::oDlg, "oFont"     => oGridFontBold(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 7, ::oDlg ) }, "nHeight"   => 42, "lDesign"   => .F. } )

Return ( self )



static FUNCTION ViewBase_defineSalir( ) ; local Self AS CLASS ViewBase := QSelf() AS CLASS ViewBase







   ::buttonEnd       :=    TGridImage():Build(  {  "nTop"      => 5, "nLeft"     => {|| GridWidth( 10.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_door_open_64", "bLClicked" => {|| if ( !Empty( ::oDlg ), ::oDlg:End(), ) }, "oWnd"      => ::oDlg } )

Return ( self )



static FUNCTION ViewBase_defineAceptarCancelar( ) ; local Self AS CLASS ViewBase := QSelf() AS CLASS ViewBase







   ::buttonCancel    :=    TGridImage():Build(  {  "nTop"      => 5, "nLeft"     => {|| GridWidth( 9.0, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_error_64", "bLClicked" => {|| ::cancelView() }, "oWnd"      => ::oDlg } )







   ::buttonOk        :=    TGridImage():Build(  {  "nTop"      => 5, "nLeft"     => {|| GridWidth( 10.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_ok_64", "bLClicked" => {|| ::endView() }, "oWnd"      => ::oDlg } )

Return ( self )



static FUNCTION ViewBase_resizeDialog( ) ; local Self AS CLASS ViewBase := QSelf() AS CLASS ViewBase

   gridResize( ::oDlg )

   ::loadBrowseConfiguration()

Return ( self )



static FUNCTION ViewBase_initDialog( ) ; local Self AS CLASS ViewBase := QSelf() AS CLASS ViewBase

   GridMaximize( ::oDlg )

Return ( self )



static FUNCTION ViewBase_setErrorValidator( cErrorText ) ; local Self AS CLASS ViewBase := QSelf() AS CLASS ViewBase

   ::cErrorValidator    += cErrorText + Chr(13)+Chr(10)

Return ( .T. )



static FUNCTION ViewBase_errorValidator( ) ; local Self AS CLASS ViewBase := QSelf() AS CLASS ViewBase

   ::cErrorValidator    := ""

   ::oDlg:aEvalValid()

Return ( !empty( ::cErrorValidator ) )



static FUNCTION ViewBase_evalDialog( ) ; local Self AS CLASS ViewBase := QSelf() AS CLASS ViewBase

   local oControl
   local lValid      := .T.
   local aControls   := ::oDlg:aControls

   if empty( aControls )
      Return ( lValid )
   end

   for each oControl in aControls

      if empty( oControl:bWhen ) .OR. eval( oControl:bWhen )

         if !empty( oControl:bValid ) .AND. !eval( oControl:bValid )

            lValid   := .F.

            oControl:SetFocus()

         endif

      end

   next

return ( lValid )
