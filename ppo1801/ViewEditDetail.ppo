#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 9 ".\Prg\tablet\view\ViewEditDetail.prg"
_HB_CLASS ViewDetail ; function ViewDetail ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ViewDetail", iif( .T., { @ViewBase() }, { @HBObject() } ), @ViewDetail() ) ) ;

   _HB_MEMBER { oDlg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDlg"}, .F. )
   _HB_MEMBER { nMode } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nMode"}, .F. )
   _HB_MEMBER { oSender } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSender"}, .F. )

   _HB_MEMBER { oGetArticulo } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetArticulo"}, .F. )
   _HB_MEMBER { ogetDescriptionArticle } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"ogetDescriptionArticle"}, .F. )

   _HB_MEMBER { oGetIva } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetIva"}, .F. )

   _HB_MEMBER { oGetLote } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetLote"}, .F. )
   _HB_MEMBER { oSayLote } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayLote"}, .F. )

   _HB_MEMBER { oGetStock } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetStock"}, .F. )
   _HB_MEMBER { nGetStock } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nGetStock"}, .F. )

   _HB_MEMBER { oGetStockAlmacen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetStockAlmacen"}, .F. )
   _HB_MEMBER { nGetStockAlmacen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"nGetStockAlmacen"}, .F. )

   _HB_MEMBER { oSayGetCajas } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayGetCajas"}, .F. )
   _HB_MEMBER { oGetCajas } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetCajas"}, .F. )
   _HB_MEMBER { oGetUnidades } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetUnidades"}, .F. )
   _HB_MEMBER { oGetPrecio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetPrecio"}, .F. )
   _HB_MEMBER { oGetDescuento } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetDescuento"}, .F. )
   _HB_MEMBER { oGetDescuentoLineal } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetDescuentoLineal"}, .F. )
   _HB_MEMBER { oSayAlmacen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSayAlmacen"}, .F. )
   _HB_MEMBER { oGetAlmacen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetAlmacen"}, .F. )
   _HB_MEMBER { oGetNombreAlmacen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetNombreAlmacen"}, .F. )
   _HB_MEMBER { textNombreAlmacen } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"textNombreAlmacen"}, .F. )

   _HB_MEMBER { oGetUltPrecio } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetUltPrecio"}, .F. )
   _HB_MEMBER { oGetUltFecha } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oGetUltFecha"}, .F. )

   _HB_MEMBER { oTotalLinea } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oTotalLinea"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @ViewDetail_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @ViewDetail_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER getSenderDocument(); oClass:AddInline( "getSenderDocument", {|Self | ( ( Self ) ), ( ::oSender:getSender() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER setGetValue(); oClass:AddInline( "setGetValue", {|Self, uValue, cFieldName | ( ( Self ) ), ( if( isNil( uValue ), ::getValue( cFieldName ), ::setValue( uValue, cFieldName ) ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER getValue(); oClass:AddInline( "getValue", {|Self, cFieldName | ( ( Self ) ), ( hGet( ::getSenderDocument():oDocumentLineTemporal:hDictionary, cFieldName ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER setValue(); oClass:AddInline( "setValue", {|Self, uValue, cFieldName | ( ( Self ) ), ( hSet( ::getSenderDocument():oDocumentLineTemporal:hDictionary, cFieldName, uValue ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER getChangePrecio(); oClass:AddInline( "getChangePrecio", {|Self | ( ( Self ) ), ( ::Super:getChangePrecio() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineAceptarCancelar(); oClass:AddMethod( "defineAceptarCancelar", @ViewDetail_defineAceptarCancelar(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineArticulo(); oClass:AddMethod( "defineArticulo", @ViewDetail_defineArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineIva(); oClass:AddMethod( "defineIva", @ViewDetail_defineIva(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineLote(); oClass:AddMethod( "defineLote", @ViewDetail_defineLote(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineCajas(); oClass:AddMethod( "defineCajas", @ViewDetail_defineCajas(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineUnidades(); oClass:AddMethod( "defineUnidades", @ViewDetail_defineUnidades(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER definePrecio(); oClass:AddMethod( "definePrecio", @ViewDetail_definePrecio(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineDescuentoPorcentual(); oClass:AddMethod( "defineDescuentoPorcentual", @ViewDetail_defineDescuentoPorcentual(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineDescuentoLineal(); oClass:AddMethod( "defineDescuentoLineal", @ViewDetail_defineDescuentoLineal(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineTotal(); oClass:AddMethod( "defineTotal", @ViewDetail_defineTotal(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineAlmacen(); oClass:AddMethod( "defineAlmacen", @ViewDetail_defineAlmacen(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineStock(); oClass:AddMethod( "defineStock", @ViewDetail_defineStock(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER defineUltimoPrecio(); oClass:AddMethod( "defineUltimoPrecio", @ViewDetail_defineUltimoPrecio(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER showLote(); oClass:AddInline( "showLote", {|Self | ( ( Self ) ), ( ::oGetLote:Show(), ::oSayLote:Show() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER hideLote(); oClass:AddInline( "hideLote", {|Self | ( ( Self ) ), ( ::oGetLote:Hide(), ::oSayLote:Hide() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshLote(); oClass:AddInline( "refreshLote", {|Self | ( ( Self ) ), ( ::oGetLote:Refresh() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER hideCajas(); oClass:AddInline( "hideCajas", {|Self | ( ( Self ) ), ( ::oGetCajas:Hide(), ::oSayGetCajas:Hide() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER refreshGetArticulo(); oClass:AddInline( "refreshGetArticulo", {|Self | ( ( Self ) ), ( ::oGetArticulo:Refresh() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshGetDescripcion(); oClass:AddInline( "refreshGetDescripcion", {|Self | ( ( Self ) ), ( ::ogetDescriptionArticle:Refresh() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshGetLote(); oClass:AddInline( "refreshGetLote", {|Self | ( ( Self ) ), ( ::oGetLote:Refresh() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshGetCajas(); oClass:AddInline( "refreshGetCajas", {|Self | ( ( Self ) ), ( ::oGetCajas:Refresh() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshGetUnidades(); oClass:AddInline( "refreshGetUnidades", {|Self | ( ( Self ) ), ( ::oGetUnidades:Refresh() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshGetPrecio(); oClass:AddInline( "refreshGetPrecio", {|Self | ( ( Self ) ), ( ::oGetPrecio:Refresh() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshGetDescuento(); oClass:AddInline( "refreshGetDescuento", {|Self | ( ( Self ) ), ( ::oGetDescuento:Refresh() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshGetDescuentoLineal(); oClass:AddInline( "refreshGetDescuentoLineal", {|Self | ( ( Self ) ), ( ::oGetDescuentoLineal:Refresh() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshGetAlmacen(); oClass:AddInline( "refreshGetAlmacen", {|Self | ( ( Self ) ), ( ::oGetAlmacen:Refresh() ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshGetStock(); oClass:AddInline( "refreshGetStock", {|Self | ( ( Self ) ), ( if( !Empty( ::oGetStock ), ::oGetStock:Refresh(), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER refreshUltPrecio(); oClass:AddInline( "refreshUltPrecio", {|Self | ( ( Self ) ), ( if( !Empty( ::oGetUltPrecio ), ::oGetUltPrecio:Refresh(), ), if( !Empty( ::oGetUltFecha ), ::oGetUltFecha:Refresh(), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER RefreshDialog(); oClass:AddMethod( "RefreshDialog", @ViewDetail_RefreshDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
      _HB_MEMBER startDialog(); oClass:AddMethod( "startDialog", @ViewDetail_startDialog(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER disableDialog(); oClass:AddInline( "disableDialog", {|Self | ( ( Self ) ), ( if( !empty( ::oDlg ), ::oDlg:Disable(), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )
   _HB_MEMBER enableDialog(); oClass:AddInline( "enableDialog", {|Self | ( ( Self ) ), ( if( !empty( ::oDlg ), ::oDlg:Enable(), ) ) }, nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ViewDetail ;



static FUNCTION ViewDetail_New( oSender ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail

   ::oSender            := oSender

   ::nGetStock          := 0
   ::nGetStockAlmacen   := 0

Return ( self )



static FUNCTION ViewDetail_Resource( nMode ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail

   ::nMode  := nMode

   ::oDlg   := TDialog():New( 1, 5, 40, 100, "gestool TABLET",,, .F., ::Style,, ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ),,, .F.,, oGridFont(),,,, .F.,, "oDlg" )

   ::defineTitulo()

   ::defineArticulo()

   ::defineLote()

   ::defineIva()

   ::defineCajas()

   ::defineUnidades()

   ::definePrecio()

   ::defineDescuentoPorcentual()

   ::defineDescuentoLineal()

   ::defineTotal()

   ::defineAlmacen()

   ::defineStock()

   ::defineUltimoPrecio()

   ::defineAceptarCancelar()

   ::oDlg:bResized         := {|| ::resizeDialog() }

   ::oDlg:bStart           := {|| ::startDialog() }

   ::oDlg:Activate( ,,,.T.,,, {|| ::initDialog() } )

   ::oSender:resetOldCodigoArticulo()

Return ( ::oDlg:nResult == 1 )



static FUNCTION ViewDetail_startDialog( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail

   if !lUseCaj()
      ::hideCajas()
      ::refreshGetCajas()
   end

   ::hideLote()

   ::oSender:StartResourceDetail()

   ::oGetIva:lValid()
   ::oGetIva:Refresh()

   ::oGetArticulo:SetFocus()

Return( Self )



static FUNCTION ViewDetail_defineAceptarCancelar( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail







   TGridImage():Build(  {  "nTop"      => 5, "nLeft"     => {|| GridWidth( 9.0, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_error_64", "bLClicked" => {|| ::oDlg:End() }, "oWnd"      => ::oDlg } )







   TGridImage():Build(  {  "nTop"      => 5, "nLeft"     => {|| GridWidth( 10.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_ok_64", "bLClicked" => {|| if( ::oSender:lValidResourceDetail(), ::oDlg:End( 1 ), ) }, "oWnd"      => ::oDlg } )

Return ( self )



static FUNCTION ViewDetail_defineArticulo( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail










   TGridUrllink():Build(                           {  "nTop"      => ::getRow(), "nLeft"     => {|| GridWidth( 0.5, ::oDlg ) }, "cURL"      => "Artículo", "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixel"    => .T., "nClrInit"  => nGridColor(), "nClrOver"  => nGridColor(), "nClrVisit" => nGridColor(), "bAction"   => {|| ::oSender:runGridProduct() } } )








   ::oGetArticulo             := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| ::oSender:setCodeBar( u ), ::SetGetValue( u, "Articulo" ) }, "oWnd"      => ::oDlg, "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "nHeight"   => 23, "lPixels"   => .T., "bValid"    => {|| ::oSender:CargaArticulo(), ::oSender:recalcularTotal() } } )







   ::oGetDescriptionArticle   := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 5.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "DescripcionArticulo" ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 6, ::oDlg ) }, "nHeight"   => 23 } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_defineIva( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail










   TGridUrllink():Build(                           {  "nTop"      => ::getRow(), "nLeft"     => {|| GridWidth( 0.5, ::oDlg ) }, "cURL"      => "Tipo Imp.", "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixel"    => .T., "nClrInit"  => nGridColor(), "nClrOver"  => nGridColor(), "nClrVisit" => nGridColor(), "bAction"   => {|| ::oSender:runGridImpuesto() } } )








   ::oGetIva                  := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "PorcentajeImpuesto" ) }, "oWnd"      => ::oDlg, "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "nHeight"   => 23, "lPixels"   => .T., "bValid"    => {|| ::oSender:CargaImpuesto() } } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_defineLote( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail










   ::oSayLote              :=TGridUrllink():Build( {  "nTop"      => ::getRow(), "nLeft"     => {|| GridWidth( 0.5, ::oDlg ) }, "cURL"      => "Lote", "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixel"    => .T., "nClrInit"  => nGridColor(), "nClrOver"  => nGridColor(), "nClrVisit" => nGridColor(), "bAction"   => {|| ::oSender:runGridLote() } } )








   ::oGetLote              := TGridGet():Build( {     "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "Lote" ) }, "oWnd"      => ::oDlg, "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "nHeight"   => 23, "lPixels"   => .T., "bValid"    => {|| ::oSender:CargaLote() } } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_defineCajas( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail











   ::oSayGetCajas :=    TGridSay():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Cajas" }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )










   ::oGetCajas    :=    TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "Cajas" ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "cPict"     => MasUnd(), "lRight"    => .T., "nHeight"   => 23, "bValid"    => {|| ::oSender:recalcularTotal() } } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_defineUnidades( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail











   TGridSay():Build(                   {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Unidades" }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )











   ::oGetUnidades := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "Unidades" ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "cPict"     => MasUnd(), "lRight"    => .T., "nHeight"   => 23, "bWhen"     => {|| accessCode():lUnitsModify }, "bValid"    => {|| ::oSender:recalcularTotal() } } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_definePrecio( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail











   TGridSay():Build(                   {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Precio" }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )











   ::oGetPrecio   := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "PrecioVenta" ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "cPict"     => cPouDiv( hGet( ::getSenderDocument():hDictionaryMaster, "Divisa" ), D():Divisas( ::oSender:getView( ) ) ), "lRight"    => .T., "nHeight"   => 23, "bWhen"     => {|| ::getChangePrecio() }, "bValid"    => {|| if( ::oSender:lValidPrecio( ::oGetPrecio ), ::oSender:recalcularTotal(), .F. ) } } )

   if ( GetPvProfString( "Tablet", "Obsequio", ".F.", cIniAplication() ) == ".T." )










      TGridUrllink():Build(            {  "nTop"      => ::getRow(), "nLeft"     => {|| GridWidth( 5.5, ::oDlg ) }, "cURL"      => "Obsequio", "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixel"    => .T., "nClrInit"  => nGridColor(), "nClrOver"  => nGridColor(), "nClrVisit" => nGridColor(), "bAction"   => {|| ::oSender:setObsequio() } } )

   end

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_defineDescuentoPorcentual( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail











   TGridSay():Build(                      {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "% Dto" }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )











   ::oGetDescuento   := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "DescuentoPorcentual" ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "cPict"     => "@E 999.99", "lRight"    => .T., "nHeight"   => 23, "bWhen"     => {|| ::getChangePrecio() }, "bValid"    => {|| ::oSender:recalcularTotal() } } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_defineDescuentoLineal( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail











   TGridSay():Build(                            {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Dto. lineal" }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )











   ::oGetDescuentoLineal   := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "DescuentoLineal" ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "cPict"     => cPouDiv( hGet( ::getSenderDocument():hDictionaryMaster, "Divisa" ), D():Divisas( ::oSender:getView() ) ), "lRight"    => .T., "nHeight"   => 23, "bWhen"     => {|| ::getChangePrecio() }, "bValid"    => {|| ::oSender:recalcularTotal() } } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_defineTotal( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail

   local nTotal   := 0











   TGridSay():Build(                   {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Total" }, "oWnd"      => ::oDlg, "oFont"     => oGridFontBold(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )










   ::oTotalLinea  := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, nTotal, nTotal := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "cPict"     => cPouDiv( hGet( ::getSenderDocument():hDictionaryMaster, "Divisa" ), D():Divisas( ::oSender:getView() ) ), "lRight"    => .T., "nHeight"   => 23, "bWhen"     => {|| .F. } } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_defineAlmacen( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail










   TGridUrllink():Build(                           {  "nTop"      => ::getRow(), "nLeft"     => {|| GridWidth( 0.5, ::oDlg ) }, "cURL"      => "Almacén", "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixel"    => .T., "nClrInit"  => nGridColor(), "nClrOver"  => nGridColor(), "nClrVisit" => nGridColor(), "bAction"   => {|| ::oSender:runGridStore() } } )









   ::oGetAlmacen              := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "Almacen" ) }, "oWnd"      => ::oDlg, "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "nHeight"   => 23, "lPixels"   => .T., "bWhen"     => {|| ( GetPvProfString( "Tablet", "BloqueoAlmacen", ".F.", cIniAplication() ) == ".F." ) }, "bValid"    => {|| ::oSender:CargaAlmacen() } } )








   ::oGetNombreAlmacen        := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 5.5, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::textNombreAlmacen, ::textNombreAlmacen := u ) }, "oWnd"      => ::oDlg, "nWidth"    => {|| GridWidth( 6, ::oDlg ) }, "lPixels"   => .T., "bWhen"     => {|| .F. }, "nHeight"   => 23 } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_defineStock( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail

   if GetPvProfString( "Tablet", "Stock", ".F.", cIniAplication() ) <> ".T."
      Return ( Self )
   end











   TGridSay():Build(                   {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Stock" }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )










   ::oGetStock          := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::nGetStock, ::nGetStock := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "cPict"     => MasUnd(), "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "lRight"    => .T., "nHeight"   => 23, "bWhen"     => {|| .F. } } )










   ::oGetStockAlmacen   := TGridGet():Build( {  "nRow"     => ::getRow(), "nCol"      => {|| GridWidth( 5.5, ::oDlg ) }, "bSetGet"   => {|u| if( PCount() == 0, ::nGetStockAlmacen, ::nGetStockAlmacen := u ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "cPict"     => MasUnd(), "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "lRight"    => .T., "nHeight"   => 23, "bWhen"     => {|| .F. } } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_defineUltimoPrecio( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail

   if GetPvProfString( "Tablet", "UltimoPrecioVenta", ".F.", cIniAplication() ) <> ".T."
      Return ( Self )
   end











   TGridSay():Build(                   {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 0.5, ::oDlg ) }, "bText"     => {|| "Ult. fecha" }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )









   ::oGetUltFecha := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 2.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "FechaUltimaVenta" ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 3, ::oDlg ) }, "lRight"    => .T., "nHeight"   => 23, "bWhen"     => {|| .F. } } )











   TGridSay():Build(                   {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 5.5, ::oDlg ) }, "bText"     => {|| "Ult. precio" }, "oWnd"      => ::oDlg, "oFont"     => oGridFont(), "lPixels"   => .T., "nClrText"  => ( 0 + ( 0 * 256 ) + ( 0 * 65536 ) ), "nClrBack"  => ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), "nWidth"    => {|| GridWidth( 2, ::oDlg ) }, "nHeight"   => 23, "lDesign"   => .F. } )









   ::oGetUltPrecio := TGridGet():Build( {  "nRow"      => ::getRow(), "nCol"      => {|| GridWidth( 7.5, ::oDlg ) }, "bSetGet"   => {|u| ::SetGetValue( u, "PrecioUltimaVenta" ) }, "oWnd"      => ::oDlg, "lPixels"   => .T., "nWidth"    => {|| GridWidth( 4, ::oDlg ) }, "lRight"    => .T., "nHeight"   => 23, "bWhen"     => {|| .F. } } )

   ::nextRow()

Return ( self )



static FUNCTION ViewDetail_RefreshDialog( ) ; local Self AS CLASS ViewDetail := QSelf() AS CLASS ViewDetail

   ::refreshGetArticulo()
   ::refreshGetDescripcion()
   ::refreshGetLote()
   ::refreshGetCajas()
   ::refreshGetUnidades()
   ::refreshGetPrecio()
   ::refreshGetDescuento()
   ::refreshGetDescuentoLineal()
   ::refreshGetAlmacen()
   ::refreshGetStock()
   ::refreshUltPrecio()

Return ( Self )
