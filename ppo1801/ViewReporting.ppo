#line 91 "\fwh1801\include\FiveWin.Ch"
         EXTERNAL FW_GT
















extern errorsys









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































static aFwStack      := {}
#line 5 ".\Prg\tablet\view\ViewReporting.prg"
_HB_CLASS ViewReporting ; function ViewReporting ( ... ) ; STATIC s_oClass ; LOCAL nScope, oClass, oInstance ; IF s_oClass == NIL .AND. __clsLockDef( @s_oClass ) ; BEGIN SEQUENCE ; nScope := 1 ; ( ( nScope ) ) ; oClass := iif( .F.,, HBClass():new( "ViewReporting", iif( .T., { @ViewBase() }, { @HBObject() } ), @ViewReporting() ) ) ;

   _HB_MEMBER { oDlg } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oDlg"}, .F. )
   _HB_MEMBER { oSender } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oSender"}, .F. )
   _HB_MEMBER { hInformes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"hInformes"}, .F. )

   _HB_MEMBER { oBtnInformesArticulos } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnInformesArticulos"}, .F. )
   _HB_MEMBER { oBtnInformesClientes } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBtnInformesClientes"}, .F. )

   _HB_MEMBER { oBrowse } ; oClass:AddMultiData(,, nScope + iif( .F., 16, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ), {"oBrowse"}, .F. )

   _HB_MEMBER New(); oClass:AddMethod( "New", @ViewReporting_New(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER Resource(); oClass:AddMethod( "Resource", @ViewReporting_Resource(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineBotonSalir(); oClass:AddMethod( "defineBotonSalir", @ViewReporting_defineBotonSalir(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineBotonesGenerales(); oClass:AddMethod( "defineBotonesGenerales", @ViewReporting_defineBotonesGenerales(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineBrowseReporting(); oClass:AddMethod( "defineBrowseReporting", @ViewReporting_defineBrowseReporting(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER defineBotonesMovimiento(); oClass:AddMethod( "defineBotonesMovimiento", @ViewReporting_defineBotonesMovimiento(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER changeTypeReporting( cType); oClass:AddMethod( "changeTypeReporting", @ViewReporting_changeTypeReporting(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER loadHashReport(); oClass:AddMethod( "loadHashReport", @ViewReporting_loadHashReport(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER loadHashReportArticulo(); oClass:AddMethod( "loadHashReportArticulo", @ViewReporting_loadHashReportArticulo(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

   _HB_MEMBER loadHashReportCliente(); oClass:AddMethod( "loadHashReportCliente", @ViewReporting_loadHashReportCliente(), nScope + iif( .F., 8, 0 ) + iif( .F., 256, 0 ) + iif( .F., 2048, 0 ) )

oClass:Create() ; ; ALWAYS ; __clsUnlockDef( @s_oClass, oClass ) ; end ; oInstance := oClass:Instance() ; IF __objHasMsg( oInstance, "InitClass" ) ; oInstance:InitClass( ... ) ; END ; RETURN oInstance ; END ; RETURN s_oClass:Instance() AS CLASS ViewReporting ;



static FUNCTION ViewReporting_New( oSender ) ; local Self AS CLASS ViewReporting := QSelf() AS CLASS ViewReporting

   ::oSender      := oSender

   ::hInformes    := {=>}

Return ( self )



static FUNCTION ViewReporting_Resource( ) ; local Self AS CLASS ViewReporting := QSelf() AS CLASS ViewReporting

   ::loadHashReport()

   ::resetRow()

   ::oDlg                  := TDialog():New( 1, 5, 40, 100, "gestool TABLET",,, .F., ::Style,, ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ),,, .F.,, oGridFont(),,,, .F.,, "oDlg" )

   ::defineTitulo()

   ::defineBotonSalir()

   ::defineBotonesGenerales()

   ::defineBotonesMovimiento()

   ::defineBrowseReporting()

   ::oDlg:bResized         := {|| ::resizeDialog() }

   ::oDlg:Activate( ,,,.T.,,, {|| ::InitDialog() } )

Return ( ::oDlg:nResult == 1 )



static FUNCTION ViewReporting_defineBotonSalir( ) ; local Self AS CLASS ViewReporting := QSelf() AS CLASS ViewReporting







   TGridImage():Build(  {  "nTop"      => 5, "nLeft"     => {|| GridWidth( 7.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_monitor_64", "bLClicked" => {|| ::oSender:ExecuteReporting( ::hInformes[ ::oBrowse:nArrayAt ], 2 ) }, "oWnd"      => ::oDlg } )







   TGridImage():Build(  {  "nTop"      => 5, "nLeft"     => {|| GridWidth( 9, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_printer_64", "bLClicked" => {|| ::oSender:ExecuteReporting( ::hInformes[ ::oBrowse:nArrayAt ], 1 ) }, "oWnd"      => ::oDlg } )







   TGridImage():Build(  {  "nTop"      => 5, "nLeft"     => {|| GridWidth( 10.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_door_open_64", "bLClicked" => {|| ::oDlg:End() }, "oWnd"      => ::oDlg } )

Return ( self )



static FUNCTION ViewReporting_defineBotonesGenerales( ) ; local Self AS CLASS ViewReporting := QSelf() AS CLASS ViewReporting







   ::oBtnInformesArticulos := TGridImage():Build(  {  "nTop"      => 45, "nLeft"     => {|| GridWidth( 0.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_object_cube_cabinet_open_64", "bLClicked" => {|| ::changeTypeReporting( "20" ), ::loadHashReport() }, "oWnd"      => ::oDlg } )







   ::oBtnInformesClientes  := TGridImage():Build(  {  "nTop"      => 45, "nLeft"     => {|| GridWidth( 2, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_user_cabinet_open_64", "bLClicked" => {|| ::changeTypeReporting( "21" ), ::loadHashReport() }, "oWnd"      => ::oDlg } )

Return ( self )



static FUNCTION ViewReporting_defineBrowseReporting( ) ; local Self AS CLASS ViewReporting := QSelf() AS CLASS ViewReporting

   ::oBrowse                  := TGridIXBrowse():New( ::oDlg )

   ::oBrowse:nTop             := ::oBrowse:EvalRow( 85 )
   ::oBrowse:nLeft            := ::oBrowse:EvalCol( {|| GridWidth( 0.5, ::oDlg ) } )
   ::oBrowse:nWidth           := ::oBrowse:EvalWidth( {|| GridWidth( 11, ::oDlg ) } )
   ::oBrowse:nHeight          := ::oBrowse:EvalHeight( {|| GridHeigth( ::oDlg ) - ::oBrowse:nTop - 10 } )
   ::oBrowse:nMarqueeStyle    := 6

   with object ( ::oBrowse:AddCol() )
      :cHeader                := "Informe"
      :bStrData               := {|| hGet( ::hInformes[ ::oBrowse:nArrayAt ], "cReportName" ) }
      :nWidth                 := 800
   end

   ::oBrowse:bLDblClick       := {|| ::oSender:ExecuteReporting( ::hInformes[ ::oBrowse:nArrayAt ] ) }

   ::oBrowse:nHeaderHeight    := 48
   ::oBrowse:nFooterHeight    := 48
   ::oBrowse:nRowHeight       := 96
   ::oBrowse:nDataLines       := 2

   ::oBrowse:SetArray( ::hInformes, , , .F. )

   ::oBrowse:CreateFromCode()

Return ( self )



static FUNCTION ViewReporting_defineBotonesMovimiento( ) ; local Self AS CLASS ViewReporting := QSelf() AS CLASS ViewReporting







   TGridImage():Build(  {  "nTop"      => 45, "nLeft"     => {|| GridWidth( 7.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_navigate_up2_64", "bLClicked" => {|| ::oBrowse:PageUp(), ::oBrowse:Select( 0 ), ::oBrowse:Select( 1 ), ::oBrowse:Refresh()  }, "oWnd"      => ::oDlg } )







   TGridImage():Build(  {  "nTop"      => 45, "nLeft"     => {|| GridWidth( 8.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_navigate_up_64", "bLClicked" => {|| ::oBrowse:GoUp(), ::oBrowse:Select( 0 ), ::oBrowse:Select( 1 ), ::oBrowse:Refresh()  }, "oWnd"      => ::oDlg } )







   TGridImage():Build(  {  "nTop"      => 45, "nLeft"     => {|| GridWidth( 9.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_navigate_down_64", "bLClicked" => {|| ::oBrowse:GoDown(), ::oBrowse:Select( 0 ), ::oBrowse:Select( 1 ), ::oBrowse:Refresh() }, "oWnd"      => ::oDlg } )







   TGridImage():Build(  {  "nTop"      => 45, "nLeft"     => {|| GridWidth( 10.5, ::oDlg ) }, "nWidth"    => 64, "nHeight"   => 64, "cResName"  => "gc_navigate_down2_64", "bLClicked" => {|| ::oBrowse:PageDown(), ::oBrowse:Select( 0 ), ::oBrowse:Select( 1 ), ::oBrowse:Refresh() }, "oWnd"      => ::oDlg } )

Return ( self )



static FUNCTION ViewReporting_changeTypeReporting( cType ) ; local Self AS CLASS ViewReporting := QSelf() AS CLASS ViewReporting

   ::oSender:cReportType      := cType

   if ::oSender:cReportType == "20"
      ::oSayTitle:VarPut( "Galería de informes: Artículos" )
      ::oSayTitle:Refresh()
   end

   if ::oSender:cReportType == "21"
      ::oSayTitle:VarPut( "Galería de informes: Clientes" )
      ::oSayTitle:Refresh()
   end

Return ( self )



static FUNCTION ViewReporting_loadHashReport( ) ; local Self AS CLASS ViewReporting := QSelf() AS CLASS ViewReporting

   if ::oSender:cReportType == "20"
      ::loadHashReportArticulo()
   end

   if ::oSender:cReportType == "21"
      ::loadHashReportCliente()
   end

   if !Empty( ::oBrowse )
      ::oBrowse:SetArray( ::hInformes, , , .F. )
      ::oBrowse:Select( 0 )
      ::oBrowse:Select( 1 )
      ::oBrowse:Refresh()
   end

Return ( self )



static FUNCTION ViewReporting_loadHashReportArticulo( ) ; local Self AS CLASS ViewReporting := QSelf() AS CLASS ViewReporting












   ::hInformes    := {  {  "cReportType" => "Stocks", "cReportDirectory" => cPatReporting() + "Articulos\Existencias\Stocks", "cReportName" => "Stocks artículos tablet", "cReportFile" => cPatReporting() + "Articulos\Existencias\Stocks\Stocks artículos tablet.fr3" }, {  "cReportType" => "Ventas", "cReportDirectory" => cPatReporting() + "Articulos\Ventas\Ventas", "cReportName" => "Ventas por artículos diarias", "cReportFile" => cPatReporting() + "Articulos\Ventas\Ventas\Ventas por articulos tablet.fr3" }, {  "cReportType" => "Ventas", "cReportDirectory" => cPatReporting() + "Articulos\Ventas\Ventas", "cReportName" => "Ventas por familias diarias", "cReportFile" => cPatReporting() + "Articulos\Ventas\Ventas\Ventas por familias tablet.fr3" } }

Return ( self )



static FUNCTION ViewReporting_loadHashReportCliente( ) ; local Self AS CLASS ViewReporting := QSelf() AS CLASS ViewReporting












   ::hInformes    := {  {  "cReportType" => "Recibos cobro", "cReportDirectory" => cPatReporting() + "Clientes\Ventas\RecibosCobro", "cReportName" => "Diario recibos tablet", "cReportFile" => cPatReporting() + "Clientes\Ventas\RecibosCobro\Diario recibos tablet.fr3" }, {  "cReportType" => "Facturas de clientes", "cReportDirectory" => cPatReporting() + "Clientes\Ventas\Facturas de clientes", "cReportName" => "Diario facturas tablet", "cReportFile" => cPatReporting() + "Clientes\Ventas\Facturas de clientes\Diario facturas tablet.fr3" }, {  "cReportType" => "Ventas", "cReportDirectory" => cPatReporting() + "Clientes\Ventas\Ventas", "cReportName" => "Diario ventas tablet", "cReportFile" => cPatReporting() + "Clientes\Ventas\Ventas\Diario ventas tablet.fr3" } }

Return ( self )
